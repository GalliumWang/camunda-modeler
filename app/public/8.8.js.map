{"version":3,"sources":["webpack:///./node_modules/cmmn-js/lib/util/ModelUtil.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/helper/CmdHelper.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/util/ModelingUtil.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/helper/CmmnElementHelper.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/layout/LayoutUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/command/CommandInterceptor.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/factory/EntryFactory.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/Elements.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/Collections.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/SvgTransformUtil.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/Utils.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/selection/Selection.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/selection/SelectionVisuals.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/selection/SelectionBehavior.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/selection/index.js","webpack:///./node_modules/cmmn-js/lib/util/DiUtil.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/util/PlanItemDefinitionUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/dragging/Dragging.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/dragging/HoverFix.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/dragging/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/rules/Rules.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/rules/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/Event.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/snapping/SnapUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/keyboard/KeyboardUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/Geometry.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/Mouse.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/Platform.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/PositionUtil.js","webpack:///./node_modules/@bpmn-io/add-exporter/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/model/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/GraphicsUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/Removal.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/factory/EntryFieldDescription.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/tool-manager/ToolManager.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/tool-manager/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/RenderUtil.js","webpack:///./node_modules/cmmn-js/lib/util/LabelUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/Cursor.js","webpack:///./node_modules/cmmn-js/lib/features/label-editing/LabelUtil.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/implementation/IdProp.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/implementation/NameProp.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/implementation/TransitionProp.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/helper/ExtensionElementsHelper.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/implementation/ExtensionElements.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/helper/ElementHelper.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/implementation/ListenerElements.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/IdGenerator.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/overlays/Overlays.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/overlays/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/interaction-events/InteractionEvents.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/interaction-events/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/keyboard/Keyboard.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/keyboard/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/preview-support/PreviewSupport.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/preview-support/index.js","webpack:///./node_modules/cmmn-js/lib/Viewer.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/draw/BaseRenderer.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/core/ElementFactory.js","webpack:///./node_modules/cmmn-js/lib/import/Util.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/outline/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/outline/Outline.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/ClickTrap.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/keyboard/KeyboardBindings.js","webpack:///./node_modules/path-intersection/intersect.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/EscapeUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/resize/ResizeUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/rules/RuleProvider.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/editor-actions/EditorActions.js","webpack:///./node_modules/cmmn-js/lib/features/snapping/CmmnSnappingUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/AttachUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/AppendShapeHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/ReplaceShapeHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/space-tool/SpaceUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/ReconnectConnectionHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/snapping/CreateMoveSnapping.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/snapping/SnapContext.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/factory/TextInputEntryFactory.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/implementation/DocumentationProp.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/implementation/ConditionProp.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/helper/ListenerHelper.js","webpack:///./node_modules/cmmn-js/dist/assets/cmmn-font/font/cmmn.eot","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/Math.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/navigation/zoomscroll/ZoomUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/navigation/zoomscroll/ZoomScroll.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/navigation/zoomscroll/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/move/Move.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/move/MovePreview.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/move/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/connect/Connect.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/connect/ConnectPreview.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/connect/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/navigation/movecanvas/MoveCanvas.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/navigation/movecanvas/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/create/Create.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/create/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/command/CommandStack.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/command/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/change-support/ChangeSupport.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/change-support/index.js","webpack:///./node_modules/cmmn-js/lib/Modeler.js","webpack:///./node_modules/cmmn-js/node_modules/ids/index.js","webpack:///./node_modules/cmmn-js/lib/import/Importer.js","webpack:///./node_modules/cmmn-js/lib/import/CmmnTreeWalker.js","webpack:///./node_modules/cmmn-js/lib/core/index.js","webpack:///./node_modules/cmmn-js/lib/draw/index.js","webpack:///./node_modules/cmmn-js/lib/draw/CmmnRenderer.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/Text.js","webpack:///./node_modules/cmmn-js/lib/draw/PathMap.js","webpack:///./node_modules/cmmn-js/lib/import/index.js","webpack:///./node_modules/cmmn-js/lib/import/CmmnImporter.js","webpack:///./node_modules/cmmn-js/lib/core/ItemRegistry.js","webpack:///./node_modules/cmmn-js/lib/util/PoweredByUtil.js","webpack:///./node_modules/cmmn-js/lib/NavigatedViewer.js","webpack:///./node_modules/cmmn-js/lib/features/outline/index.js","webpack:///./node_modules/cmmn-js/lib/features/outline/Outline.js","webpack:///./node_modules/cmmn-js/lib/features/auto-resize/index.js","webpack:///./node_modules/cmmn-js/lib/features/auto-resize/CmmnAutoResizeProvider.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/auto-resize/AutoResizeProvider.js","webpack:///./node_modules/cmmn-js/lib/features/context-pad/index.js","webpack:///./node_modules/cmmn-js/lib/features/popup-menu/index.js","webpack:///./node_modules/cmmn-js/lib/features/popup-menu/ReplaceMenuProvider.js","webpack:///./node_modules/cmmn-js/lib/features/replace/ReplaceOptions.js","webpack:///./node_modules/cmmn-js/lib/features/context-pad/ContextPadProvider.js","webpack:///./node_modules/cmmn-js/lib/features/editor-actions/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/editor-actions/index.js","webpack:///./node_modules/cmmn-js/lib/features/editor-actions/CmmnEditorActions.js","webpack:///./node_modules/cmmn-js/lib/features/keyboard/index.js","webpack:///./node_modules/cmmn-js/lib/features/keyboard/CmmnKeyboardBindings.js","webpack:///./node_modules/cmmn-js/lib/features/label-editing/index.js","webpack:///./node_modules/cmmn-js/lib/features/label-editing/LabelEditingProvider.js","webpack:///./node_modules/cmmn-js/lib/features/label-editing/cmd/UpdateLabelHandler.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/index.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/index.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/AttachCriterionBehavior.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/CaseFileItemUpdater.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/LabelBehavior.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/PlanItemDefinitionUpdater.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/PlanningTableUpdater.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/ReplaceConnectionBehavior.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/ReplaceElementBehavior.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/ResizeCasePlanModelBehavior.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/SentryUpdater.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/behavior/UnclaimIdBehavior.js","webpack:///./node_modules/cmmn-js/lib/features/ordering/index.js","webpack:///./node_modules/cmmn-js/lib/features/ordering/CmmnOrderingProvider.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/ordering/OrderingProvider.js","webpack:///./node_modules/cmmn-js/lib/features/replace/index.js","webpack:///./node_modules/cmmn-js/lib/features/replace/CmmnReplace.js","webpack:///./node_modules/cmmn-js/lib/features/rules/index.js","webpack:///./node_modules/cmmn-js/lib/features/rules/CmmnRules.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/CmmnFactory.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/CmmnUpdater.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/ElementFactory.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/Modeling.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/cmd/AppendShapeHandler.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/cmd/ReconnectConnectionHandler.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/cmd/ReplaceShapeHandler.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/cmd/UpdatePropertiesHandler.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/cmd/UpdateSemanticParentHandler.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/cmd/UpdateControlsHandler.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/cmd/IdClaimHandler.js","webpack:///./node_modules/cmmn-js/lib/features/modeling/CmmnLayouter.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/layout/BaseLayouter.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/layout/ManhattanLayout.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/layout/CroppingConnectionDocking.js","webpack:///./node_modules/cmmn-js/lib/features/palette/index.js","webpack:///./node_modules/cmmn-js/lib/features/palette/PaletteProvider.js","webpack:///./node_modules/cmmn-js/lib/features/snapping/index.js","webpack:///./node_modules/cmmn-js/lib/features/snapping/CmmnConnectSnapping.js","webpack:///./node_modules/cmmn-js/lib/features/snapping/CmmnCreateMoveSnapping.js","webpack:///./node_modules/cmmn-js/lib/features/snapping/CmmnResizeSnapping.js","webpack:///./node_modules/cmmn-js/lib/features/search/index.js","webpack:///./node_modules/cmmn-js/lib/features/search/CmmnSearchProvider.js","webpack:///./node_modules/cmmn-js/lib/features/replace-preview/index.js","webpack:///./node_modules/cmmn-js/lib/features/replace-preview/CmmnReplacePreview.js","webpack:///./node_modules/cmmn-js-properties-panel/index.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/index.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/cmd/index.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/cmd/UpdateBusinessObjectHandler.js","webpack:///./node_modules/lodash/transform.js","webpack:///./node_modules/lodash/_getPrototype.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/cmd/UpdateBusinessObjectListHandler.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/cmd/MultiCommandHandler.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/PropertiesPanel.js","webpack:///./node_modules/cmmn-js-properties-panel/node_modules/ids/index.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/index.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/CamundaPropertiesProvider.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/PropertiesActivator.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/CaseProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/factory/CheckboxEntryFactory.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/factory/SelectEntryFactory.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/factory/TextBoxEntryFactory.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/factory/ValidationAwareTextInput.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/factory/LabelFactory.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/IdProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/NameProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/DocumentationProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/IfPartProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/HumanTaskProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/OnPartProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/VariableMappingProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/PlanItemControlProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/implementation/RuleProp.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/RepeatOnStandardEventProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/DefinitionIdProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/DefinitionNameProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/DefinitionDocumentationProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/cmmn/parts/CallableProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/CallableExtensionProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/implementation/BusinessKeyProp.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/CaseExecutionListenerProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/VariableListenerProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/TaskListenerProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/ListenerDetailProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/implementation/ListenerEventTypeProp.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/implementation/ListenerDelegateProp.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/implementation/ScriptProp.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/ListenerFieldInjectionProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/implementation/FieldInjection.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/HistoryTimeToLiveProps.js","webpack:///./node_modules/cmmn-js-properties-panel/lib/provider/camunda/parts/implementation/HistoryTimeToLiveProp.js","webpack:///./node_modules/cmmn-js-properties-panel/styles/properties.less?a083","webpack:///./node_modules/cmmn-js-properties-panel/styles/properties.less","webpack:///./node_modules/cmmn-js/dist/assets/diagram-js.css?a808","webpack:///./node_modules/cmmn-js/dist/assets/diagram-js.css","webpack:///./node_modules/cmmn-js/dist/assets/cmmn-font/css/cmmn-embedded.css?da82","webpack:///./node_modules/cmmn-js/dist/assets/cmmn-font/css/cmmn-embedded.css","webpack:///./node_modules/cmmn-js/dist/assets/cmmn-font/font/cmmn.svg","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/CreateShapeHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/DeleteShapeHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/helper/AnchorsHelper.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveClosure.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveHelper.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/MoveShapeHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/ResizeShapeHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/ToggleShapeCollapseHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/SpaceToolHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/CreateLabelHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/CreateConnectionHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/DeleteConnectionHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/MoveConnectionHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/LayoutConnectionHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/UpdateWaypointsHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/MoveElementsHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/DeleteElementsHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/DistributeElementsHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/AlignElementsHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/UpdateAttachmentHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/cmd/PasteHandler.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/modeling/Modeling.js","webpack:///./node_modules/moddle/lib/base.js","webpack:///./node_modules/moddle/lib/factory.js","webpack:///./node_modules/moddle/lib/types.js","webpack:///./node_modules/moddle/lib/ns.js","webpack:///./node_modules/moddle/lib/descriptor-builder.js","webpack:///./node_modules/moddle/lib/registry.js","webpack:///./node_modules/moddle/lib/properties.js","webpack:///./node_modules/moddle/lib/moddle.js","webpack:///./node_modules/moddle-xml/lib/common.js","webpack:///./node_modules/moddle-xml/lib/read.js","webpack:///./node_modules/moddle-xml/lib/write.js","webpack:///./node_modules/cmmn-moddle/lib/cmmn-moddle.js","webpack:///./node_modules/cmmn-moddle/lib/simple.js","webpack:///./node_modules/cmmn-moddle/index.js","webpack:///./node_modules/didi/dist/index.esm.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/draw/DefaultRenderer.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/draw/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/draw/Styles.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/core/Canvas.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/core/ElementRegistry.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/core/EventBus.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/core/GraphicsFactory.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/core/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/Diagram.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/util/LineIntersection.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/bendpoints/BendpointUtil.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/bendpoints/Bendpoints.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/bendpoints/BendpointMove.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/bendpoints/BendpointMovePreview.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/bendpoints/ConnectionSegmentMove.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/bendpoints/BendpointSnapping.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/bendpoints/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/mouse-tracking/MouseTracking.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/mouse-tracking/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/auto-scroll/AutoScroll.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/auto-scroll/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/resize/Resize.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/resize/ResizePreview.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/resize/ResizeHandles.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/resize/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/space-tool/SpaceTool.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/space-tool/SpaceToolPreview.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/space-tool/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/snapping/ResizeSnapping.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/snapping/Snapping.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/snapping/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/navigation/keyboard-move/KeyboardMove.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/navigation/keyboard-move/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/keyboard-move-selection/KeyboardMoveSelection.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/keyboard-move-selection/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/connection-preview/ConnectionPreview.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/connection-preview/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/auto-resize/AutoResize.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/auto-resize/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/context-pad/ContextPad.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/context-pad/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/label-support/LabelSupport.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/label-support/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/attach-support/AttachSupport.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/attach-support/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/palette/Palette.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/palette/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/lasso-tool/LassoTool.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/lasso-tool/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/hand-tool/HandTool.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/hand-tool/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/global-connect/GlobalConnect.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/global-connect/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/search-pad/SearchPad.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/search-pad/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/popup-menu/PopupMenu.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/popup-menu/index.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/replace/Replace.js","webpack:///./node_modules/cmmn-js/node_modules/diagram-js/lib/features/replace/index.js"],"names":["is","element","type","bo","$instanceOf","isInstanceOf","getBusinessObject","businessObject","isCasePlanModel","$parent","getDefinition","definitionRef","getDefaultControl","definition","defaultControl","getItemControl","itemControl","getRule","rule","getTransitions","module","exports","isRequired","isRepeatable","isManualActivation","isAutoComplete","autoComplete","hasPlanningTable","planningTable","getName","cmmnElementRef","name","getSentry","sentryRef","getStandardEvent","standardEvent","getStandardEvents","exitCriterionRef","sourceRef","CmdHelper","updateProperties","properties","shape","cmd","context","updateSemanticParent","newParent","containment","updateBusinessObject","newProperties","addElementsTolist","listPropertyName","objectsToAdd","currentObject","propertyName","removeElementsFromList","referencePropertyName","objectsToRemove","addAndRemoveElementsFromList","some","ModelUtil","Model","isSame","a","b","getCase","getParent","anyType","parent","isAny","types","t","isSameCase","getParents","parents","push","isLabel","Label","filter","isOnPartConnection","getCMMNElementRef","isHumanTask","isPlanItem","isItemCapable","isCriterion","isCMMNEdge","isDiscretionaryConnection","isAssociationConnection","isTextAnnotation","isCMMNDiagram","isAssignable","isFormSupported","isTask","isMilestone","isEventListener","isStage","isInOutBindingCapable","getOutgoingOnParts","onPartFilter","outgoing","con","isCallable","isCaseExecutionListenerCapable","isTaskListenerCapable","isVariableListenerCapable","roundBounds","bounds","x","Math","round","y","width","height","roundPoint","point","asTRBL","top","right","bottom","left","asBounds","trbl","getMid","getOrientation","rect","reference","padding","rectOrientation","referenceOrientation","vertical","horizontal","getElementLineIntersection","elementPath","linePath","cropStart","intersections","getIntersections","length","i","distance","floor","t2","segment2","filterRedundantWaypoints","waypoints","slice","previousPoint","nextPoint","idx","splice","CommandInterceptor","eventBus","this","_eventBus","$inject","prototype","on","events","hook","priority","handlerFn","unwrap","that","Error","event","fullEvent","e","join","fn","call","command","unwrapEvent","textInputField","checkboxField","selectBoxField","textBoxField","validationAwareTextInputField","labelEntry","cmdHelper","ensureNotNull","prop","setDefaultParameters","options","getReferencedObject","get","defaultGet","node","res","modelProperty","defaultSet","values","undefined","defaultValidate","id","description","set","validate","html","hideEntry","EntryFactory","textField","validationAwareTextField","checkbox","textBox","selectBox","label","add","elements","unique","canAdd","indexOf","eachElement","depth","s","selfAndChildren","maxDepth","result","processedChildren","children","selfAndDirectChildren","allowDuplicates","selfAndAllChildren","getClosure","isTopLevel","closure","allShapes","copyObject","allConnections","enclosedElements","enclosedConnections","topLevel","handleConnection","c","source","target","incoming","getBBox","stopRecursion","minX","minY","maxX","maxY","bbox","getEnclosedElements","filteredElements","getType","isFrameElement","isFrame","src1","src2","remove","collection","currentIdx","transform","gfx","angle","amount","translate","setTranslate","rotate","setRotate","scale","setScale","Ids","SPACE_REGEX","QNAME_REGEX","ID_REGEX","HTML_ESCAPE_MAP","'","validateId","idValue","containsSpace","test","value","addEmptyParameter","list","isIdValid","assigned","$model","ids","nextId","prefix","nextPrefixed","triggerClickEvent","evt","document","createEvent","MouseEvent","view","window","bubbles","cancelable","initEvent","dispatchEvent","createEventObject","fireEvent","escapeHTML","str","replace","match","Selection","_selectedElements","self","deselect","select","selectedElements","oldSelection","fire","newSelection","isSelected","SelectionVisuals","canvas","selection","styles","addMarker","cls","removeMarker","_multiSelectionBox","SelectionBehavior","elementRegistry","canExecute","previousSelection","selectedShape","getRootElement","isMultiSelect","__init__","__depends__","selectionVisuals","selectionBehavior","isCollapsed","di","isPlanningTableCollapsed","isStandardEventVisible","cmmnElement","getAllDiscretionaryItems","isPlanningTableCapable","items","item","isDiscretionaryItem","getDirectItemCapables","isDiscretionaryToHumanTask","isPlanFragment","preventDefault","Dragging","defaultOptions","threshold","trapClick","toLocalPoint","globalPosition","viewbox","clientRect","_container","getBoundingClientRect","dragContext","payload","data","isTouch","move","activate","displacement","globalStart","globalCurrent","globalDelta","localStart","localCurrent","localDelta","active","sqrt","pow","dx","dy","originalEvent","cancel","keepSelection","cursor","end","returnValue","cleanup","checkCancel","which","trapClickAndEnd","untrap","setTimeout","trapTouch","hover","hoverGfx","out","restore","previousContext","wasActive","endDrag","unbind","off","init","relativeTo","TouchEvent","isTouchEvent","manual","bind","autoActivate","setOptions","HoverFix","dragging","once","ensureHover","setDragHover","unsetHover","ensureOut","position","getGfx","elementFromPoint","hoverFix","Rules","injector","_commandStack","allowed","action","commandStack","rules","__stopPropagation","stopPropagation","getOriginal","srcEvent","immediate","toPoint","pointers","touches","clientX","clientY","abs","snapTo","tolerance","snapValue","topLeft","topRight","bottomLeft","bottomRight","mid","defaultValue","isNaN","isSnapped","axis","snapped","setSnapped","delta","previousValue","getChildren","hasModifier","ctrlKey","metaKey","shiftKey","altKey","isCmd","isKey","keys","key","isShift","pointDistance","pointsOnLine","p","q","r","accuracy","val","dist","pointsAligned","pointInRect","getMidPoint","isPrimaryButton","button","hasPrimaryModifier","navigator","platform","hasSecondaryModifier","center","parentRefs","enumerable","labelRefs","attacherRefs","outgoingRefs","incomingRefs","Base","Object","defineProperty","writable","labels","newLabel","Shape","Root","Connection","connection","root","create","attrs","Type","getVisual","parentNode","childNodes","saveClear","removeFn","escapeText","text","index","escaped","pattern","exec","substring","link","encodeURI","ToolManager","_dragging","_tools","_active","registerTool","tools","bindEvents","isActive","tool","setActive","eventsToRegister","reactivate","toolManager","componentsToPath","toSVGPoints","points","createLine","line","updateLine","assign","DEFAULT_LABEL_SIZE","hasExternalLabel","semantic","getWaypointsMid","first","second","ceil","getExternalLabelMid","waypoint","getExternalLabelBounds","size","max","hasLabelBounds","getLabelBounds","CURSOR_CLS_PATTERN","mode","classes","body","removeMatching","unset","getLabelAttr","getSemantic","isReferencing","getLabel","attr","hasEditableLabel","setLabel","isExternal","isExclusiveRef","hidden","entryFactory","idError","forEach","getter","setter","exclude","validator","disabled","emptyParameter","selectOptions","getOptions","ExtensionElementsHelper","getExtensionElements","extensionElements","extensionValues","removeEntry","entry","domQuery","query","domClosest","closest","domify","elementHelper","utils","getSelectBox","currentTab","getSelected","selectedIndex","cmmnFactory","idGeneration","getElements","createElement","createExtensionElement","canCreate","removeElement","removeExtensionElement","canRemove","onSelectionChange","hideElements","hideExtensionElements","canBeHidden","setOptionLabelValue","defaultSize","resizable","selectionChanged","scope","createOption","initSelectionSize","optionsLength","getBO","elem","extensionElementValue","__action","commands","createListEntryTemplate","setControlValue","option","property","generatedId","generateElementId","template","appendChild","lastChild","selected","removeChild","entryNode","scopeNode","disableRemove","selectElement","ElementHelper","elementType","factory","extensionElementsEntry","extensionElementsHelper","getListenerType","noop","LISTENER_TYPE_LABEL","class","expression","delegateExpression","script","getListeners","getListener","listenerEntry","isApplicable","initialEvent","entries","listenerElementSiblings","register","getSelectedListener","listener","createListener","listenerType","sibling","isListenerElements","groups","group","IdGenerator","_counter","_prefix","random","next","Overlays","config","_canvas","_elementRegistry","_ids","_overlayDefaults","show","defaults","_overlays","_overlayContainers","_overlayRoot","getContainer","insertBefore","firstChild","_init","setPosition","el","style","setVisible","visible","display","setTransform","search","container","_getOverlayContainer","overlays","overlay","_addOverlay","htmlContainer","hide","clear","_updateOverlayContainer","_updateOverlay","_createOverlayContainer","_updateRoot","matrix","raw","overlayContainer","constructor","jquery","_updateOverlayVisibilty","minZoom","maxZoom","_updateOverlayScale","minScale","maxScale","shouldScale","min","_updateOverlaysVisibilty","o","marker","allowAll","InteractionEvents","HIT_STYLE","stroke","strokeWidth","localEventName","ignoredFilters","isIgnored","getGraphics","delegateTarget","handlers","mouseHandler","bindings","mouseover","mouseout","click","dblclick","mousedown","mousemove","mouseup","contextmenu","registerEvent","localEvent","ignoredFilter","handler","$delegate","unregisterEvent","svg","hit","triggerMouseEvent","eventName","targetElement","interactionEvents","Keyboard","_config","_keydownHandler","_keyupHandler","_fire","bindTo","_keyHandler","contentEditable","isInput","keyEvent","_node","getBinding","addListener","removeListener","keyboard","keyboardBindings","KeyboardBindings","MARKER_TYPES","NODES_CAN_HAVE_MARKER","PreviewSupport","_styles","_clonedMarkers","clonedMarker","addDragger","dragger","_cloneMarkers","addFrame","frame","nodeName","markerType","getMarker","_cloneMarker","markerId","clonedMarkerId","defs","_svg","previewSupport","omit","isNumber","inherits","domRemove","innerSVG","Diagram","default","CmmnModdle","Importer","DEFAULT_OPTIONS","ensureUnit","Viewer","linkMarkup","linkElement","_moddle","_createModdle","_createContainer","PoweredBy","LINK_STYLES","BPMNIO_IMG","domEvent","open","importXML","xml","done","_emit","fromXML","err","definitions","error","parseWarnings","warnings","message","checkValidationError","importDefinitions","importWarnings","allWarnings","concat","saveXML","_definitions","toXML","console","saveSVG","contentNode","getDefaultLayer","defsNode","contents","outerHTML","importCmmnDiagram","attachTo","detach","resized","getDefinitions","getModules","_modules","destroy","callback","moddle","baseModules","modules","additionalModules","diagramModules","cmmnjs","diagramOptions","moddleOptions","_moddleExtensions","moddleExtensions","BaseRenderer","renderPriority","visuals","canRender","drawShape","drawConnection","getShapePath","getConnectionPath","ElementFactory","_uid","createRoot","createLabel","createShape","createConnection","elementToString","$type","outline","Outline","offset","OUTLINE_STYLE","createOutline","updateShapeOutline","updateConnectionOutline","install","trap","editorActions","registerBindings","isRegistered","trigger","has","p2s","toFloat","parseFloat","math","PI","mmin","mmax","pathCommand","pathValues","String","toLowerCase","isFinite","Array","isArray","toString","clone","obj","repush","array","ii","paths","ps","sleep","box","w","h","x2","y2","cx","cy","r1","r2","r0","path","rectPath","vb","pathToString","pathClone","pathArray","findDotsAtSegment","p1x","p1y","c1x","c1y","c2x","c2y","p2x","p2y","t1","t13","t12","t3","mx","my","nx","ny","m","n","start","alpha","atan2","bezierBBox","curveBBox","apply","isPointInsideBBox","base3","p1","p2","p3","p4","bezlen","x1","y1","x3","y3","x4","y4","z","z2","Tvalues","Cvalues","sum","ct","xbase","ybase","comb","intersectLines","denominator","px","py","px2","toFixed","py2","findBezierIntersections","bez1","bez2","justCount","bbox1","bbox2","isBBoxIntersect","n1","n2","dots1","dots2","xy","j","di1","dj","dj1","ci","cj","ellipsePath","rx","ry","rad","cos","sin","pathToAbsolute","pth","pathString","arr","paramCounts","l","v","u","params","parsePathString","pa0","pa","crz","toUpperCase","dots","jj","pop","catmulRomToBezier","k","kk","lineToCurve","qubicToCurve","ax","ay","arcToCurve","large_arc_flag","sweep_flag","recursive","f","postprocessor","_120","newf","arg","arguments","args","cache","count","shift","f1","f2","rx2","ry2","asin","df","f2old","x2old","y2old","c1","s1","c2","s2","tan","hx","hy","m1","m2","m3","m4","newres","split","crp","d","iLen","x0","y0","b2ac","sqrtb2ac","tvalues","mt","jlen","pathToCurve","path2","curve","bx","by","X","Y","qx","qy","attrs2","processPath","pcom","T","Q","fixArc","pp","pi","pcoms1","pcoms2","fixM","path1","a1","a2","pfirst","seg","seg2","seglen","seg2len","x1m","y1m","x2m","y2m","pj","intr","segment1","substractTRBL","trblA","trblB","resizeBounds","direction","resizeTRBL","resize","reattachPoint","newBounds","sx","sy","applyConstraints","resizeConstraints","minValue","maxValue","ensureConstraints","currentBounds","currentTrbl","getMinResizeBounds","minDimensions","childrenBounds","currentBox","minBox","childrenBox","combinedBox","asPadding","mayBePadding","addPadding","isBBoxChild","computeChildrenBBox","shapeOrChildren","RuleProvider","addRule","actions","EditorActions","_actions","_registerDefaultActions","modeling","zoomScroll","copyPaste","mouseTracking","keyboardMove","keyboardMoveSelection","undo","redo","copy","getHoverContext","paste","opts","stepZoom","zoom","removableElements","removeElements","moveCanvas","moveSelection","accelerated","_registerAction","unregister","getActions","getCornerlessOrientation","getCriterionAttachment","orientation","getNewAttachPoint","oldBounds","oldCenter","newCenter","oldDelta","newDelta","getNewAttachShapeDelta","shapeCenter","shapeDelta","oldCenterDelta","newCenterDelta","newShapeCenter","AppendShapeHandler","_modeling","preExecute","attach","postExecute","connectionParent","connect","ReplaceShapeHandler","_rules","newShape","oldShape","newData","hints","canReconnect","host","updateAttachment","moveChildren","moveElements","docking","reconnectEnd","layoutConnection","reconnectStart","endChanged","startChanged","removeShape","execute","revert","newSource","dockingPoint","newTarget","getDirection","ReconnectConnectionHandler","dockingOrPoints","oldWaypoints","oldSource","oldTarget","newWaypoint","movedEnd","layoutHints","original","CreateMoveSnapping","snapping","initSnap","snapContext","snapPoints","pointsForTarget","initialized","addSnapTargetPoints","snap","labelTarget","shapeMid","shapeTopLeft","shapeBottomRight","setSnapOrigin","snapTargets","getSnapTargets","snapTarget","child","SnapContext","_targets","_snapOrigins","_snapLocations","_defaultSnaps","SnapPoints","defaultSnaps","_snapValues","getSnapOrigin","snapLocation","initialValue","addDefaultSnap","snapValues","getSnapLocations","setSnapLocations","snapLocations","targetId","initDefaults","snappingValues","entryFieldDescription","defaultParameters","resource","dataValueLabel","buttonLabel","actionName","buttonAction","actionMethod","method","inputNode","showName","buttonShow","showMethod","canBeDisabled","isDisabled","cssClasses","getDocumentations","getDocumentation","documentations","documentation","isRoot","cmds","doc","noopEmptyList","getCondition","createdCondition","removedCondition","condition","log10","log","getStepSize","range","steps","minLinearRange","maxLinearRange","sign","RANGE","ZoomScroll","_enabled","_handleWheel","_totalDelta","_scale","enabled","scroll","reset","stepSize","NUM_STEPS","_zoom","isZoom","isHorizontalScroll","factor","deltaMode","elementRect","deltaY","deltaX","currentLinearZoomLevel","newLinearZoomLevel","newLogZoomLevel","toggle","newEnabled","handleWheel","oldEnabled","MoveEvents","canMove","shapes","referencePoint","validatedShapes","isAttach","primaryShape","MARKER_OK","MARKER_NOT_OK","MARKER_NEW_PARENT","MARKER_ATTACH","MovePreview","getVisualDragShapes","isConnection","removeEdges","getAllDraggedElements","setMarker","dragShapes","allDraggedElements","visuallyDraggedShapes","dragGroup","defaultLayer","differentParents","makeDraggable","movePreview","Connect","canConnect","sourcePosition","targetPosition","connectionStart","connectionEnd","ConnectPreview","connectionPreview","endPosition","drawPreview","cleanUp","connectPreview","MoveCanvas","handleMove","lastPosition","last","handleEnd","handleStart","Create","graphicsFactory","ctx","targetParent","targetAttach","visual","preview","visualGroup","createVisual","appendShape","sourceOrContext","createConstraints","CommandStack","_handlerMap","_stack","_stackIdx","_currentExecution","dirty","_injector","_pushAction","_internalExecute","_popAction","_getHandler","emit","_getUndoAction","_internalUndo","_getRedoAction","_setHandler","registerHandler","handlerCls","instantiate","canUndo","canRedo","_atomicDo","_markDirty","_revertedAction","qualifier","names","cancelBubble","_createId","execution","atomic","_executedAction","baseAction","stackIdx","ChangeSupport","updateContainments","update","changeSupport","NavigatedViewer","Modeler","_collectIds","createDiagram","elementsById","claim","_interactionModules","_modelingModules","hat","seed","_seed","rack","unclaim","hats","CmmnTreeWalker","diagram","importer","itemRegistry","parentShape","addItem","handleDefinitions","render","Refs","Collections","diRefs","deferred","connections","discretionaryConnections","cases","handledDiscretionaryItems","elementsWithoutParent","associations","visit","visitIfDi","logError","contextual","registerDi","_case","shouldHandle","edge","targetRef","targetCMMNElementRef","isReferencingTarget","sourceCMMNElementRef","isReferencingSource","handleDiagram","diagramElements","handleDiagramElement","diagramElement","handlePlanFragment","planFragment","planItems","handleItem","handlePlanItems","stage","handlePlanningTable","handleStage","tableItems","tableItem","discretionayItem","handledDiscretionaryItem","handleDiscretionaryItem","newCtx","exitCriteria","handleCriterion","entryCriteria","handleElementsWithoutParent","edges","handleDiscretionaryConnection","criterion","unshift","handleElementWithoutParent","annotation","handleTextAnnotation","caseFileItem","handleCaseFileItem","handleAssociation","association","cmmndi","CMMNDI","diagrams","visitRoot","casePlanModelContext","casePlanModel","handleCasePlanModel","handleDeferred","handleCase","handleCases","cmmnRenderer","pathMap","isObject","TextUtil","DiUtil","svgAppend","append","svgAttr","svgClasses","svgCreate","CmmnRenderer","textUtil","fontFamily","fontSize","markers","initMarkers","createMarker","fill","strokeLinecap","strokeDasharray","ref","viewBox","refX","refY","markerWidth","markerHeight","orient","associationStart","associationEnd","computeStyle","custom","traits","defaultStyles","drawCircle","parentGfx","circle","drawRect","drawDiamond","x_2","y_2","pointsString","map","polygon","drawPath","drawPolygon","createPathFromConnection","pathData","renderLabel","createText","renderEmbeddedLabel","align","renderer","strokeDashoffset","fillOpacity","drawOctagon","textbox","renderExpandedStageLabel","attachPlanningTableMarker","attachStageMarkers","textBoxWidth","polygonWidth","minWidth","renderCasePlanModelLabel","drawMarker","attachCasePlanModelMarkers","attachTaskMarkers","outerCircle","getScaledPath","xScaleFactor","yScaleFactor","containerWidth","containerHeight","linePathData","abspos","task","isBlocking","textElement","strokeLinejoin","associationDirection","markerEnd","markerStart","drawLine","markerRect","planningTableRect","textBBox","standardEventVisible","renderExternalLabel","leftMarkers","rightMarkers","getTextBBox","fakeText","textContent","emptyLine","layoutNext","lines","maxWidth","originalLine","fitLine","fit","shortenLine","remainder","trim","shortenedLine","maxLength","part","parts","shortenedParts","semanticShorten","Text","layoutText","getDimensions","dimensions","parseAlign","parsePadding","fitBox","lineHeight","parseInt","getLineHeight","layouted","helperText","helperSvg","getElementById","getHelperSvg","totalHeight","maxLineWidth","tspan","PATH_USER_TYPE_1","PATH_USER_TYPE_2","PATH_USER_TYPE_3","heightElements","widthElements","getRawPath","pathId","param","rawPath","coordinates","heightRatio","widthRatio","heightIndex","widthIndex","tokenRegex","all","objNotationRegex","quote","quotedName","isFunc","replacer","cmmnImporter","LabelUtil","elementData","notYetDrawn","refSemantic","CmmnImporter","elementFactory","_elementFactory","setRootElement","parentElement","_getElement","collapsed","_attachCriterion","addShape","_getSource","_getTarget","addConnection","addLabel","criterionSemantic","criterionElement","hostSemantic","attachers","_getEnd","side","ItemRegistry","_items","_referencedBy","getReference","isDefinition","_clear","definitionId","referencingItems","updateId","newId","updateReference","newReference","oldDefinition","oldDefinitionId","newReferenceId","filtered","getAll","getReferences","getShape","getShapes","referencedBy","domDelegate","delegate","css","lightbox","LIGHTBOX_MARKUP","_navigationModules","BaseOutline","baseUpdateShapeOutline","cmmnAutoResizeProvider","AutoResizeProvider","CmmnAutoResizeProvider","canResize","criterionsOnly","contextPadProvider","replaceMenuProvider","replaceOptions","isDifferentType","isDifferentDefinitionType","definitionType","canReplaceElementByTarget","ReplaceMenuProvider","popupMenu","cmmnReplace","_popupMenu","_cmmnReplace","_cmmnFactory","registerProvider","getEntries","TASK","_createEntries","PLAN_FRAGMENT_EXPANDED","EVENT_LISTENER","CRITERION","getHeaderEntries","headerEntries","_getBlockingEntry","_getAutoCompleteEntry","ensureSupportRules","_getRuleEntries","menuEntries","_createMenuEntry","replaceElement","className","title","blocking","updateControls","toggleControlEntry","control","repeatable","required","manualActivation","ContextPadProvider","contextPad","_contextPad","_connect","_create","getContextPadEntries","startConnect","appendAction","appendListener","dragstart","createCriterionShape","isBlockingHumanTask","createDiscretionaryItemShape","appendDiscretionaryItemAction","isEmpty","diagramContainer","pad","getPad","diagramRect","padRect","getReplaceMenuPosition","deleteAllowed","EditorActionsModule","CmmnEditorActions","invoke","spaceTool","lassoTool","handTool","globalConnect","directEditing","searchPad","rootElement","currentSelection","CmmnKeyboardBindings","labelEditingProvider","UpdateLabelHandler","LabelEditingProvider","complete","props","getEditingBBox","centerVertically","autoResize","maxBounds","getAbsoluteBBox","textAlign","maxHeight","minHeight","LINE_HEIGHT","setText","oldLabel","cmmnUpdater","layouter","connectionDocking","attachCriterionBehavior","caseFileItemUpdater","labelBehavior","planItemDefinitionUpdater","planningTableUpdater","replaceConnectionBehavior","replaceElementBehavior","resizeCasePlanModelBehavior","sentryUpdater","unclaimIdBehavior","AttachCriterionBehavior","newHost","reduce","ModelingUtil","CaseFileItemUpdater","createCaseFileModel","caseFileModel","clearCaseFileItemContainer","isCaseFileModel","clearSourceRef","clearTargetRefs","canRemoveFilter","targets","targetRefs","canMoveFilter","childrenElement","preExecuted","caseFileItemDefinition","parentBusinessObject","isCaseFileItem","oldParent","oldCaseFileModel","getParentCaseFile","oldSemanticParent","parentCaseFileItem","postExecuted","LabelBehavior","moveShape","executed","createDiLabel","createDiBounds","unionBy","PlanItemDefinitionUtil","PlanItemDefinitionUpdater","_itemRegistry","getParentStage","updatePlanItemDefinitions","deletePlanItemDefinitions","discretionaryItems","shapeItem","newTargetCase","replacements","movedItemCapables","movedShapes","newDefinition","replacePlanItemDefinition","definitionReplacements","handledElements","sharedParent","candidates","getParentStages","getSharedParent","itemCapables","isHandled","handled","PlanningTableUpdater","isReconnectStart","oldPlanningTable","getParentPlanningTable","isReferencedByAnotherDiscretionaryConnection","getTargetDefinition","createPlanningTable","deletePlanningTable","replacedPlanningTableArray","planningTableReplacedBy","discretionaryTo","replacedBy","planningTables","previousPlanningTable","newPlanningTables","newPlanningTable","applicabilityRules","clonePlanningTable","fixTarget","ReplaceConnectionBehavior","cmmnRules","canConnectPlanItemOnPartConnection","canConnectCaseFileItemOnPartConnection","canConnectDiscretionaryConnection","fixConnection","replacement","getCmmnElement","canConnectAssociation","removeConnection","newConnection","HIGH_PRIORITY","nested","reverse","attacher","getAttachersOutgoingConnections","changed","ReplaceElementBehavior","_cmmnRules","_selection","canReplace","sentry","newElementType","newDefinitionType","replaceElements","unclaimId","LOW_PRIORITY","newElements","executedReplacements","oldElement","oldElementId","newElement","ResizeUtil","computeMinResizeBox","exitCriterion","childrenBoxPadding","ResizeCasePlanModelBehavior","minBounds","flatten","groupBy","SentryUpdater","getAttachersRecurse","getAttachers","handleEachElement","createSentry","setSentryRef","setCmmnElementRef","cloneOnPart","onPart","getOnPart","getSentryParent","existsAnotherConnection","oldCriterion","oldSentry","newCriterion","newSentry","possibleStandardEvents","isValidStandardEvent","getDefaultStandardEvent","updateSentriesSemanticParent","deleteSentry","criteria","groupedCriteria","groupBySentry","oldElem","newElem","getReplacement","references","criterionShape","shouldReplace","replaceSentry","replaceBy","UnclaimIdBehavior","cmmnOrderingProvider","OrderingProvider","findIndex","find","CmmnOrderingProvider","orders","order","level","containers","getOrder","computeOrder","getOrdering","elementOrder","actualParent","findActualParent","currentIndex","insertIndex","ordering","parentIndex","newParentIndex","CmmnReplace","replaceCriterion","createCriterion","isPlanItemControlCapable","replacePlanItemControl","setParent","replaceItemCapable","newItem","newControl","repetitionRule","canSetRepetitionRule","replaceRule","requiredRule","canSetRequiredRule","manualActivationRule","canSetManualActivationRule","newRule","replaceCondition","newCondition","language","newBusinessObject","oldBusinessObject","ifPart","newIfPart","isCriterionAttachment","CmmnRules","isParent","possibleParent","nonExistingOrLabel","hasIncomingOnPartConnections","isEntryCriterion","isExitCriterion","canStartConnection","canReplaceConnectionEnd","canAttach","every","canMoveDiscretionaryItem","canDrop","canCreateDiscretionaryItem","isArtifact","sourceDefinition","targetDefinition","sourceParent","isUniqueDiscretionaryConnection","hasIncomingDiscretionaryConnections","canAttachCriterion","canAttachEntryCriterion","canAttachExitCriterion","canReplaceSource","canReplaceTarget","isSameParent","pick","CmmnFactory","_model","_needsId","_ensureId","createDiShape","createDiEdge","createDiWaypoints","pos","createDiWaypoint","createItem","itemType","criterionType","createCasePlanModel","createCaseFileItem","CmmnUpdater","updateBounds","updateConnection","updateConnectionWaypoints","removeItem","cropped","getCroppedWaypoints","reverted","ifCmmn","updateParent","businessObjectHost","businessObjectDi","parentDi","shouldUpdateSemanticParent","updateDiParent","_getLabel","sourceElem","targetElem","sourceAttr","targetAttr","newExitCriterionRef","BaseElementFactory","baseCreate","createCmmnElement","_getDefaultSize","createPlanItemShape","createCasePlanModelShape","createCaseFileItemShape","BaseModeling","UpdatePropertiesHandler","UpdateSemanticParentHandler","UpdateControlsHandler","IdClaimHandler","Modeling","getHandlers","targetIndex","claimId","moddleElement","claiming","BaseHandler","ID","isIdChange","isDefinitionRefChange","isSentryRefChange","setProperties","unwrappedProps","referencePropertyNames","unwrapBusinessObjects","oldProperties","propertyNames","getProperties","changedShape","PLAN_ITEM_CONTROL_PROPS","getUpdate","canReplaceDefinition","_updateRule","_updateDecorator","_getReferencingShapes","_replaceDefinition","isRulePresent","canDeletePlanItemControl","setRule","oldValue","localItemControl","localDefaultControl","deleteRule","BaseLayouter","ManhattanLayout","CmmnLayouter","getConnectionDocking","repairConnection","ORIENTATION_THRESHOLD","getSegmentBendpoints","directions","segmentEnd","segmentDirections","targetOrientation","startDirection","xmid","ymid","layoutStraight","layoutHorizontal","turnNextDirections","needsTurn","getBendpoints","invertDirections","isValidDirections","isExplicitDirections","startSegment","getStartSegment","endSegment","invertedSegment","getEndSegment","midSegment","endDirection","getMidSegment","getSimpleBendpoints","connectPoints","withoutRedundantPoints","connectRectangles","preferredLayouts","preferredLayout","defaultLayout","getDirections","directionSplit","getDockingPoint","invertOrientation","repairedWaypoints","tryLayoutStraight","moved","other","newDocking","_tryRepairConnectionSide","tryRepairConnectionEnd","isInRange","inRange","primaryAxis","preserveDocking","needsRelayout","slicedPoints","oldDocking","newPoints","candidate","oldPeer","newPeer","repairBendpoint","removeOverlapping","rectangle","dockingDirection","previous","dockingToPoint","actual","CroppingConnectionDocking","_graphicsFactory","sourceDocking","targetDocking","croppedWaypoints","dockStart","dockingIdx","_getIntersection","takeFirst","shapePath","_getShapePath","connectionPath","_getConnectionPath","_getGfx","paletteProvider","PaletteProvider","palette","_globalConnect","_handTool","_palette","_lassoTool","_spaceTool","getPaletteEntries","createPlanItem","shortType","activateHand","activateSelection","separator","CmmnConnectSnapping","CmmnCreateMoveSnapping","CmmnResizeSnapping","SnappingModule","connectSnapping","createMoveSnapping","resizeSnapping","SnapUtil","initialSourcePosition","connectionAttrs","isCenterSnapTarget","snapToPosition","targetTRBL","snapCriterion","includes","SLIGHTLY_HIGHER_PRIORITY","cmmnSearch","sortBy","labelUtil","CmmnSearchProvider","hasMatched","tokens","matched","matchAndSplit","originalText","normal","substr","primaryTokens","secondaryTokens","cmmnReplacePreview","cssEscape","svgRemove","CmmnReplacePreview","initVisualReplacements","visualReplacements","replaceVisualGraphics","replaceVisual","gfxSelector","tempShape","replaceCandidate","restoreVisual","selector","propertiesPanel","HANDLERS","CommandInitializer","UpdateBusinessObjectHandler","arrayEach","baseForOwn","baseIteratee","getPrototype","isBuffer","isFunction","isTypedArray","object","iteratee","accumulator","isArr","isArrLike","Ctor","overArg","getPrototypeOf","UpdateBusinessObjectListHandler","updatedObjectList","objectList","previousList","listCopy","parentObject","MultiCommandHandler","domQueryAll","queryAll","domClasses","domAttr","domMatches","matches","xor","debounce","updateSelection","scrollTabs","isToggle","isContentEditable","getFormControls","controls","getFormControlValuesInScope","controlNodes","controlNode","checked","innerText","getFormControlValues","listContainer","listNodes","listNode","valueEqual","extractEntries","tabs","keyBy","flattenDeep","PropertiesPanel","propertiesProvider","_propertiesProvider","tabBarNode","scroller","selectors","tabsContainer","tab","ignore","newActiveNode","oldActiveNode","linkNode","tabId","activateTab","current","_current","_bindListeners","panelNode","panel","allTabNodes","allTabLinkNodes","tabNode","currentTabId","tabLinkNode","tabLink","needsCreate","newTabs","getTabs","_entriesChanged","activeTabId","activeTabNode","_updateActivation","oldEntryIds","newEntryIds","handleChange","entryId","getEntry","onChangeAction","getAttribute","executeAction","applyChanges","updateState","clipboardData","getData","execCommand","actionId","isEntryDirty","force","eventHandlerId","updateShow","updateDisable","showNodes","showNode","expr","shouldShow","hasClass","nodes","currentNode","shouldDisable","containerElement","oldValues","valuesEqual","commandToExecute","applyValidationResults","validationResults","messageNode","nextSibling","warning","listEntryNodes","listValue","validateListItem","listEntryNode","containerNode","_createPanel","extractGroups","_bindTemplate","placeholders","inputNodes","newValue","editable","isPropertyEditable","nodeValue","setToggleValue","isSelect","setSelectValue","activeElement","getSelection","focusNode","focusOffset","anchorOffset","contains","getContentEditableSelection","selectionStart","selectionEnd","domRange","domSelection","createRange","setStart","setEnd","removeAllRanges","addRange","setContentEditableSelection","setSelection","setInputValue","setTextValue","toggleVisible","updateLabel","labelNode","tabVisible","groupVisible","groupNode","entryVisible","isEntryVisible","listEntryContainer","existingElements","listItemNode","entriesToRemove","isGroupVisible","isTabVisible","labelId","getHeaderLabel","headerNode","tabLinksNode","tabContainerNode","tabIndex","querySelector","addEventListener","defaultPrevented","cssClass","CmmnElementHelper","PropertiesActivator","caseProps","idProps","nameProps","documentationProps","ifPartProps","humanTaskProps","onPartProps","variableMapping","planItemControlProps","repeatOnStandardEventProps","definitionIdProps","definitionNameProps","definitionDocumentationProps","callableProps","callableExtensionProps","caseExecutionListenerProps","variableListenerProps","taskListenerProps","listenerDetailProps","listenerFields","historyTimeToLive","createGeneralTabGroups","generalGroup","detailsGroup","documentationGroup","historyTimeToLiveGroup","createRulesTabGroups","itemControlGroup","defaultControlGroup","isDefaultControl","createVariablesTabGroups","variablesGroup","createListenerTabGroups","caseExecutionListenerGroup","caseExecutionListenerProvider","taskListenerGroup","taskListenerProvider","variableListenerGroup","variableListenerProvider","listenerDetailsGroup","listenerFieldsGroup","createDefinitionTabGroups","CamundaPropertiesProvider","IdProp","NameProp","getValue","setValue","canBeShown","isShown","__lastInvalidValue","validationErrors","propertyValue","divider","labelText","showLabel","DocumentationProp","ConditionProp","getIfPart","getIfPartCondition","TransitionProp","inOutTypeOptions","getVariableMappings","camundaMappings","getCamundaInOutMappings","mapping","businessKey","getInOutType","inOutType","variables","sourceExpression","inEntry","parameter","outEntry","mappingValue","mappingType","sourceLabel","validation","selectedMapping","local","RuleProp","itemControlProp","defaultControlProp","isPlanItemControlAvailable","hasDefaultControl","hasItemControl","validateRule","itemRule","defaultRule","idPrefix","controlRef","canBeAdded","canBeRemoved","ruleType","ruleRef","getPlanItemControl","getRuleCondition","ruleUpdate","getRepetitionRule","getRepeatOnStandardEvent","isEntryCriteriaAttached","repeatOnStandardEvent","itemControlRule","defaultControlRule","defaultRepeatOnStandardEvent","itemRepeatOnStandardEvent","ATTR_DECL","refAttr","expAttr","refExpAttr","BusinessKeyProp","cmmnElementHelper","attributeInfo","binding","version","tenantId","bindingOptions","mapDecisionResultOptions","modelProp","callableBinding","attrVer","callableVersion","getCallableBindingValue","resultVariable","mapDecisionResult","getCamundaInWithBusinessKey","camundaIn","camundaInParams","callableBusinessKey","setBusinessKey","camundaInExtensions","deleteBusinessKey","listenerElements","listenerProps","ListenerEventTypeProp","ListenerDelegateProp","getEventType","setEventType","eventType","ScriptProp","getDelegate","setDelegate","hideDelegateEntry","elment","getScript","getScriptType","expectedType","fieldInjection","fieldInjectionEntry","DEFAULT_PROPS","fieldTypeOptions","getSelectedField","fieldEntry","getCamundaListenerFields","selectedListener","fields","getFieldType","fieldType","expressionValue","string","stringValue","newFieldElem","field","fieldName","selectedField","nameValue","fieldValue","HistoryTimeToLiveProp","content","locals","escape","CreateShapeHandler","positionOrBounds","DeleteShapeHandler","oldParentIndex","getResizedSourceAnchor","oldAnchor","safeGetWaypoints","getResizedTargetAnchor","getMovedSourceAnchor","moveDelta","substractPosition","getMovedTargetAnchor","MoveClosure","MoveHelper","MoveShapeHandler","_helper","ResizeShapeHandler","addAll","newClosure","moveRecursive","moveClosure","keepParent","recurse","layout","sourceMoved","targetMoved","moveConnection","getNewParent","ToggleShapeCollapseHandler","oldChildrenVisibility","newHidden","setHidden","lastState","SpaceToolHandler","resizingShapes","resizeShape","movingShapes","CreateLabelHandler","originalExecute","ensureValidDimensions","originalRevert","CreateConnectionHandler","_layouter","DeleteConnectionHandler","MoveConnectionHandler","LayoutConnectionHandler","UpdateWaypointsHandler","newWaypoints","MoveElementsHandler","DeleteElementsHandler","DistributeElements","OFF_AXIS","AlignElements","UpdateAttachmentHandler","removeAttacher","addAttacher","removeProperties","PasteHandler","registerHandlers","dimension","updateRange","lastIdx","rangeDiff","margin","spaceInBetween","firstGroup","lastGroupIdx","lastGroup","groupsSize","sortedElements","refElem","refCenter","centerElement","groupIdx","prevGroup","alignment","middle","oldHost","attacherIdx","tree","topParent","createdElements","depthStr","descriptor","newPosition","_getCreatedElement","_createConnection","_createShape","topLevelElements","labelDescriptor","labelTargetPos","toplevel","parentCenter","distributeElements","replaceShape","pasteElements","alignElements","createSpace","updateWaypoints","toggleCollapse","Factory","model","createType","isMany","defineModel","defineDescriptor","ns","ModdleElement","define","hasType","BUILTINS","Boolean","Integer","Real","Element","TYPE_CONVERTERS","coerceType","converter","isBuiltIn","isSimple","parseName","defaultPrefix","localName","DescriptorBuilder","nameNs","allTypes","allTypesByName","propertiesByName","Registry","packages","packageMap","typeMap","registerPackage","ensureAvailable","pkg","identifierKey","Properties","isReference","configurable","Moddle","registry","typeCache","build","addProperty","addNamedProperty","replaceProperty","oldProperty","newProperty","oldNameNs","rename","isId","setIdProperty","isBody","setBodyProperty","redefineProperty","targetPropertyName","nsPrefix","attrName","redefinedProperty","redefines","propsByName","assertNotDefined","removeNamedProperty","bodyProperty","idProperty","definedProperty","definedBy","hasProperty","addTrait","inherited","typesByName","typeName","replaces","getPackage","uriOrPrefix","getPackages","pkgMap","registerType","uri","superClass","extends","meta","propertyNs","extendsName","extended","definePackage","mapTypes","nsName","iterator","trait","traverseTrait","traverseSuper","parentNs","getEffectiveDescriptor","builder","$pkg","getPropertyDescriptor","$attrs","createAny","nsUri","isGeneric","getElementDescriptor","$descriptor","getTypeDescriptor","hasLowerCaseAlias","tagAlias","DEFAULT_NS_MAP","serializeFormat","serialize","serializeAsType","aliasToName","aliasNs","charAt","getModdleDescriptor","Context","addReference","addElement","addWarning","NoopHandler","BodyHandler","ReferenceHandler","ValueHandler","propertyDesc","BaseElementHandler","ElementHandler","RootElementHandler","GenericElementHandler","Reader","lax","handleText","handleNode","createReference","parser","handleChild","propNameNs","attributes","instance","getPropertyForNode","elementTypeName","typePrefix","prefixedToName","normalizeXsiTypeName","effectiveType","isVirtual","isAttribute","valueHandler","referenceHandler","childHandler","originalName","$children","$body","rootHandler","proxy","stack","createStack","handleError","getContext","column","handleWarning","PREAMBLE_START_PATTERN","ENCODING_PATTERN","UTF_8_PATTERN","handleCData","peek","uriMap","decodeStr","selfClosing","decodedAttrs","handleOpen","question","encoding","decodeEntities","parse","resolveReferences","ESCAPE_ATTR_CHARS","ESCAPE_CHARS","Namespaces","prefixMap","used","wellknown","byUri","isWellknown","mapPrefix","uriByPrefix","logUsed","getUsed","ctor","superCtor","super_","ESCAPE_ATTR_MAP","ESCAPE_MAP","charPattern","replaceMap","ReferenceSerializer","tagName","BodySerializer","ValueSerializer","ElementSerializer","propertyDescriptor","TypeSerializer","SavingWriter","write","FormatingWriter","format","indent","appendNewLine","appendIndent","unindent","Writer","preamble","writer","internalWriter","formatingWriter","serializeTo","serializeValue","otherAttrs","elementDescriptor","parseGeneric","parseNsAttributes","nsPropertyTagName","nsTagName","addTagName","hasOwnProperty","getSerializableProperties","parseAttributes","isAttr","parseContainments","filterContained","parseGenericAttributes","getElementNs","logNamespaceUsed","getPropertyNs","isLocalNs","nsAttributeName","effectiveNs","getNamespaces","parseNsAttribute","logNamespace","actualNs","genericAttrs","nonNsAttr","addAttribute","warn","asType","asProperty","serializeAsProperty","serializer","parentNamespaces","namespaces","newPrefix","wellknownUri","serializeAttributes","getNsAttrs","firstBody","typeNs","xmlStr","reader","cmmn","dc","additionalPackages","CLASS_PATTERN","annotate","CONSTRUCTOR_ARGS","FN_ARGS","FN_ARG","isClass","Module","providers","_typeof","Symbol","_toConsumableArray","arr2","from","Injector","strict","currentlyResolving","_providers","instances","_instances","msg","pivot","hasProp","fnDef","inject","dependencies","dep","_fnDef","Function","func","_fnDef2","createPrivateInjectorFactory","privateChildInjector","factoryMap","_value","arrayUnwrap","provider","__exports__","clonedModule","privateInjector","__modules__","getFromPrivateInjector","createChild","forceNewInstances","cacheIdx","privateChildInjectorFactory","fromParentModule","matchedScopes","privateInjectorsCache","privateChildInjectors","privateChildFactories","$scope","DefaultRenderer","CONNECTION_STYLE","SHAPE_STYLE","FRAME_STYLE","defaultRenderer","defaultTraits","strokeOpacity","pointerEvents","additionalAttrs","number","resolution","ensurePx","createGroup","childIndex","REQUIRED_MODEL_ATTRS","Canvas","setCTM","mstr","setAttribute","overflow","createContainer","viewport","_viewport","_layers","deferUpdate","_viewboxChanged","_cachedViewbox","_destroy","_rootElement","_removeElement","getLayer","layer","_createLayer","_updateMarker","_elements","secondaryGfx","hasMarker","toggleMarker","override","_ensureValid","currentRoot","requiredAttrs","_setParent","_addElement","secondary","_changeViewbox","changeFn","innerBox","outerBox","getSize","createSVGMatrix","inner","outer","getCTM","multiply","newScale","_fitViewport","_setZoom","newViewbox","vbox","originalPoint","currentMatrix","scaleMatrix","newMatrix","createSVGPoint","currentScale","matrixTransform","inverse","clientWidth","clientHeight","ELEMENT_ID","ElementRegistry","_validateId","EventBus","_listeners","InternalEvent","actualCallback","_addListener","wrappedCallback","_removeListener","firstListener","originalType","_invokeListeners","_invokeListener","invokeFunction","newListener","previousListener","_getListeners","_setListeners","nextListener","listenerCallback","GraphicsFactory","prependTo","newNode","siblingNode","_getChildren","childrenGfx","outerGfx","childGfx","bootstrap","bootstrapModules","components","hasModule","addModule","createInjector","getApproxIntersection","bendpoint","getBendpointIntersection","segments","getPathIntersection","getConnectionIntersection","toCanvasCoordinates","addBendpoint","groupGfx","createParallelDragger","segmentStart","draggerGfx","hitWidth","segmentLengthXAxis","segmentLengthYAxis","calculateSegmentMoveRegion","calculateHitWidth","addSegmentDragger","segmentLength","Bendpoints","bendpointMove","connectionSegmentMove","activateBendpointMove","intersection","treshold","p0","aligned","xDelta","yDelta","isIntersectionMiddle","relevantSegment","calculateIntersectionThreshold","bindInteractionEvents","getBendpointsContainer","getSegmentDragger","createBendpoints","createSegmentDraggers","segmentDraggerGfx","addHandles","updateHandles","clearSegmentDraggers","clearBendpoints","bendpointsGfx","floating","updateFloatingBendpointPosition","draggerVisual","relativePosition","updateSegmentDraggerPosition","primary","bendpointContainer","BendpointMove","bendpointIndex","insert","connectionGfx","originalWaypoints","BendpointMovePreview","moveType","noCropping","noLayout","axisAdd","axisSet","flipAxis","getDocking","referenceElement","moveAxis","referenceMid","inverseAxis","ConnectionSegmentMove","cropConnection","redrawConnection","updateDragger","segmentOffset","draggerPosition","axisFenced","segmentStartIndex","segmentEndIndex","dragPosition","sourceToSegmentOrientation","targetToSegmentOrientation","newSegmentStart","newSegmentEnd","waypointCount","newSegmentStartIndex","segmentMove","BendpointSnapping","rem","referenceWaypoints","getConnectionSegmentSnaps","getBendpointSnaps","targetMid","bendpoints","bendpointMovePreview","bendpointSnapping","MouseTracking","_hoverElement","_mouseX","_mouseY","_setMousePosition","removeEventListener","_setHoverElement","layerX","layerY","AutoScroll","_mouseTracking","_opts","scrollThresholdIn","scrollThresholdOut","scrollRepeatTimeout","scrollStep","_toBorderPoint","startScroll","stopScroll","between","diff","_scrolling","clearTimeout","autoScroll","Resize","boundsChanged","contextOrDirection","ResizePreview","ResizeHandles","_resize","removeResizers","addResizer","startResize","_createResizer","rotation","resizersParent","_getResizersParent","CLS_RESIZER","createResizer","resizer","resizePreview","resizeHandles","AXIS_TO_DIMENSION","AXIS_INVERTED","SpaceTool","_toolManager","SVGElement","activateMakeSpace","initializeMakeSpace","insideBounds","makeSpace","spacePos","rootShape","adjustments","calculateAdjustments","shapeStart","shapeEnd","SpaceToolPreview","addPreviewGfx","space","crosshairGroup","pathX","pathY","spaceLayer","movingConnections","sourceIsMoving","targetIsMoving","sourceIsResizing","targetIsResizing","frameGroup","frames","initialBounds","spaceToolPreview","ResizeSnapping","getCorner","snapCorner","isHidden","Snapping","_asyncHide","location","snapOrigin","snapCurrent","locationSnapping","originValue","showSnapLine","axisSnapping","_createLine","_createSnapLines","_snapLines","getSnapLine","snapLine","DEFAULT_CONFIG","moveSpeed","moveSpeedAccelerated","KeyboardMove","speed","actualSpeed","KEY_TO_DIRECTION","ArrowLeft","Left","ArrowUp","Up","ArrowRight","Right","ArrowDown","Down","DIRECTIONS_DELTA","up","down","KeyboardMoveSelection","ConnectionPreview","_connectionDocking","returnValues","connectionPreviewGfx","getConnection","noNoop","createConnectionPreviewGfx","firstArgument","JSON","stringify","drawNoopPreview","cropWaypoints","createNoopConnection","sourcePath","targetPath","ensureConnectionAttrs","AutoResize","_expand","expandings","parentId","_getOptimalBounds","getOffset","getPadding","elementsTrbl","targetTrbl","newTrbl","resizeDirections","getResizeDirections","ContextPad","_overlaysConfig","close","isOpen","_updateAndOpen","grouping","classNames","addClasses","imageUrl","overlaysConfig","_overlayId","LabelSupport","removeLabels","enclosedLabels","labelTargetIndex","labelSupport","AttachSupport","removeAttached","attachSupportInitialized","staticAttachers","attachSupport","Palette","updateToolHighlight","_update","_diagramInitialized","HTML_MARKUP","TOGGLE_SELECTOR","_layoutChanged","_toggleState","state","twoColumn","_getParentContainer","_needsCollapse","_entries","entriesContainer","availableHeight","isActiveTool","_activeTool","toolsContainer","_toolsContainer","toolClasses","LassoTool","activateLasso","toBBox","HandTool","activateMove","isSpace","deactivateMove","GlobalConnect","startTarget","canStartConnect","startPosition","SearchPad","_open","_results","_eventMaps","BOX_HTML","_searchInput","INPUT_SELECTOR","_resultsContainer","RESULTS_CONTAINER_SELECTOR","createInnerTextNode","htmlText","RESULT_HIGHLIGHT_CLASS","createHtmlText","childNode","innerHTML","_bindEvents","listen","focus","RESULT_SELECTOR","_scrollToNode","_preselect","_select","keyCode","_getCurrentResult","_scrollToDirection","_search","_unbindEvents","_clearResults","searchResults","_searchProvider","_createResultNode","previousElementSibling","nextElementSibling","nodeOffset","offsetTop","containerScroll","scrollTop","bottomScroll","_resetOverlay","RESULT_SELECTED_SELECTOR","RESULT_HTML","RESULT_PRIMARY_HTML","RESULT_SECONDARY_HTML","RESULT_ID_ATTRIBUTE","blur","selectedNode","RESULT_SELECTED_CLASS","_centerViewbox","OVERLAY_CLASS","constructOverlay","CONTAINER_SELECTOR","PopupMenu","providerId","hasEntries","hasHeaderEntries","_attachContainer","_unbindHandlers","_getEntry","visibility","_updateScale","_assureIsInbounds","_bindHandlers","scaleConfig","containerX","offsetLeft","containerY","scrollWidth","scrollHeight","overAxis","cursorPosition","entryContainer","_createEntry","entryClasses","Replace","newElementData"],"mappings":"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","file":"8.8.js","sourcesContent":["'use strict';\n\nfunction isInstanceOf(bo, type) {\n  return !!(bo && ((typeof bo.$instanceOf === 'function') && bo.$instanceOf(type)));\n}\n\n/**\n * Is an element of the given CMMN type?\n *\n * @param  {djs.model.Base|ModdleElement} element\n * @param  {String} type\n *\n * @return {Boolean}\n */\nfunction is(element, type) {\n  return isInstanceOf(getBusinessObject(element), type);\n}\n\nmodule.exports.is = is;\n\n\n/**\n * Return the business object for a given element.\n *\n * @param  {djs.model.Base|ModdleElement} element\n *\n * @return {ModdleElement}\n */\nfunction getBusinessObject(element) {\n  return element && element.businessObject ? element.businessObject : element;\n}\n\nmodule.exports.getBusinessObject = getBusinessObject;\n\nfunction isCasePlanModel(element) {\n  element = getBusinessObject(element);\n  return is(element, 'cmmn:Stage') && element.$parent && is(element.$parent, 'cmmn:Case');\n}\n\nmodule.exports.isCasePlanModel = isCasePlanModel;\n\nfunction getDefinition(element) {\n  var bo = getBusinessObject(element);\n\n  if (is(element, 'cmmn:PlanItemDefinition') || is(element, 'cmmn:CaseFileItemDefinition')) {\n    return bo;\n  }\n\n  return bo && bo.definitionRef;\n}\n\nmodule.exports.getDefinition = getDefinition;\n\nfunction getDefaultControl(element) {\n  var definition = getDefinition(element);\n  return definition && definition.defaultControl;\n}\n\nmodule.exports.getDefaultControl = getDefaultControl;\n\nfunction getItemControl(element) {\n  element = getBusinessObject(element);\n  return element && element.itemControl;\n}\n\nmodule.exports.getItemControl = getItemControl;\n\n\nfunction getRule(element, rule) {\n  var itemControl = getItemControl(element),\n      defaultControl = getDefaultControl(element);\n\n  if (itemControl && itemControl[rule]) {\n    return itemControl[rule];\n  }\n\n  return defaultControl && defaultControl[rule];\n}\n\nfunction isRequired(element) {\n  return !!getRule(element, 'requiredRule');\n}\n\nmodule.exports.isRequired = isRequired;\n\nfunction isRepeatable(element) {\n  return !!getRule(element, 'repetitionRule');\n}\n\nmodule.exports.isRepeatable = isRepeatable;\n\nfunction isManualActivation(element) {\n  return !!getRule(element, 'manualActivationRule');\n}\n\nmodule.exports.isManualActivation = isManualActivation;\n\nfunction isAutoComplete(element) {\n  element = getBusinessObject(element);\n  var definition = getDefinition(element);\n  return element.autoComplete || (definition && definition.autoComplete);\n}\n\nmodule.exports.isAutoComplete = isAutoComplete;\n\nfunction hasPlanningTable(element) {\n  element = getBusinessObject(element);\n  return element.planningTable || (getDefinition(element) && getDefinition(element).planningTable);\n}\n\nmodule.exports.hasPlanningTable = hasPlanningTable;\n\nfunction getName(element) {\n  element = getBusinessObject(element);\n\n  if (is(element, 'cmmndi:CMMNEdge') && element.cmmnElementRef) {\n    element = element.cmmnElementRef;\n  }\n\n  var name = element.name;\n  if (!name) {\n\n    if (element.definitionRef) {\n      name = element.definitionRef.name;\n    }\n  }\n\n  return name;\n}\n\nmodule.exports.getName = getName;\n\n\n/**\n * Returns the referenced sentry, if present.\n *\n * @param {djs.model.Base} criterion\n *\n * @result {ModdleElement} referenced sentry\n */\nfunction getSentry(element) {\n  var bo = getBusinessObject(element);\n\n  if (is(bo, 'cmmn:Sentry')) {\n    return bo;\n  }\n\n  return bo && bo.sentryRef;\n}\n\nmodule.exports.getSentry = getSentry;\n\n\nfunction getStandardEvent(element) {\n  element = getBusinessObject(element);\n  return element.cmmnElementRef && element.cmmnElementRef.standardEvent;\n}\n\nmodule.exports.getStandardEvent = getStandardEvent;\n\nfunction getStandardEvents(element) {\n\n  if (is(element, 'cmmndi:CMMNEdge')) {\n    element = getBusinessObject(element).cmmnElementRef;\n  }\n\n  if (is(element, 'cmmn:OnPart')) {\n\n    if (is(element.exitCriterionRef, 'cmmn:ExitCriterion')) {\n      return [ 'exit' ];\n    }\n\n    return getTransitions(element.sourceRef);\n\n  }\n\n  return [];\n\n}\n\nmodule.exports.getStandardEvents = getStandardEvents;\n\n\nfunction getTransitions(element) {\n\n  element = getBusinessObject(element);\n\n  if (is(element, 'cmmn:CaseFileItem')) {\n\n    return [\n      'addChild',\n      'addReference',\n      'create',\n      'delete',\n      'removeChild',\n      'removeReference',\n      'replace',\n      'update'\n    ];\n\n  }\n\n  if (is(element, 'cmmn:PlanItem') || is(element, 'cmmn:DiscretionaryItem')) {\n\n    var definition = getDefinition(element);\n\n    if (is(definition, 'cmmn:EventListener') || is(definition, 'cmmn:Milestone')) {\n\n      return [\n        'create',\n        'occur',\n        'resume',\n        'suspend',\n        'terminate'\n      ];\n\n    }\n\n    return [\n      'complete',\n      'create',\n      'disable',\n      'enable',\n      'exit',\n      'fault',\n      'manualStart',\n      'parentResume',\n      'parentSuspend',\n      'reactivate',\n      'reenable',\n      'resume',\n      'start',\n      'suspend',\n      'terminate'\n    ];\n\n  }\n\n  if (isCasePlanModel(element)) {\n\n    return [\n      'close',\n      'complete',\n      'create',\n      'fault',\n      'reactivate',\n      'suspend',\n      'terminate'\n    ];\n\n  }\n\n  return [];\n\n}\n\nmodule.exports.getTransitions = getTransitions;","'use strict';\n\nvar CmdHelper = {};\nmodule.exports = CmdHelper;\n\nCmdHelper.updateProperties = function(element, properties, shape) {\n  return {\n    cmd: 'element.updateProperties',\n    context: { element: element, properties: properties, shape: shape }\n  };\n};\n\nCmdHelper.updateSemanticParent = function(element, newParent, containment, shape) {\n  return {\n    cmd: 'element.updateSemanticParent',\n    context: {\n      element: element,\n      newParent: newParent,\n      containment: containment,\n      shape: shape\n    }\n  };\n};\n\nCmdHelper.updateBusinessObject = function(element, businessObject, newProperties) {\n  return {\n    cmd: 'properties-panel.update-businessobject',\n    context: {\n      element: element,\n      businessObject: businessObject,\n      properties: newProperties\n    }\n  };\n};\n\nCmdHelper.addElementsTolist = function(element, businessObject, listPropertyName, objectsToAdd) {\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      objectsToAdd: objectsToAdd\n    }\n  };\n};\n\nCmdHelper.removeElementsFromList = function(element, businessObject, listPropertyName, referencePropertyName, objectsToRemove) {\n\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      referencePropertyName: referencePropertyName,\n      objectsToRemove: objectsToRemove\n    }\n  };\n};\n\n\nCmdHelper.addAndRemoveElementsFromList = function(element, businessObject, listPropertyName, referencePropertyName, objectsToAdd, objectsToRemove) {\n\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      referencePropertyName: referencePropertyName,\n      objectsToAdd: objectsToAdd,\n      objectsToRemove: objectsToRemove\n    }\n  };\n};\n","'use strict';\n\nvar some = require('min-dash').some;\n\nvar ModelUtil = require('../../../util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar Model = require('diagram-js/lib/model');\n\n/**\n * Return true if given elements are the same.\n *\n * @param {Object} a\n * @param {Object} b\n *\n * @return {boolean}\n */\nfunction isSame(a, b) {\n  return a === b;\n}\n\nmodule.exports.isSame = isSame;\n\n\n/**\n * Return true if given cases are the same.\n *\n * @param {ModdleElement} a\n * @param {ModdleElement} b\n *\n * @return {boolean}\n */\nfunction isSameCase(a, b) {\n  return isSame(getCase(a), getCase(b));\n}\n\nmodule.exports.isSameCase = isSameCase;\n\nfunction getCase(element) {\n  return getParent(getBusinessObject(element), 'cmmn:Case');\n}\n\nmodule.exports.getCase = getCase;\n\n\n/**\n * Return the parents of the element with any of the given types.\n *\n * @param {ModdleElement} element\n * @param {String|Array<String>} anyType\n *\n * @return {Array<ModdleElement>}\n */\nfunction getParents(element, anyType) {\n\n  var parents = [];\n\n  if (typeof anyType === 'string') {\n    anyType = [ anyType ];\n  }\n\n  while (element) {\n    element = element.$parent || element.parent;\n\n    if (element) {\n\n      if (anyType) {\n        if (isAny(element, anyType)) {\n          parents.push(element);\n        }\n      }\n      else {\n        parents.push(element);\n      }\n\n    }\n\n  }\n\n  return parents;\n}\n\nmodule.exports.getParents = getParents;\n\n/**\n * Return the parent of the element with any of the given types.\n *\n * @param {ModdleElement} element\n * @param {String|Array<String>} anyType\n *\n * @return {ModdleElement}\n */\nfunction getParent(element, anyType) {\n\n  if (typeof anyType === 'string') {\n    anyType = [ anyType ];\n  }\n\n  while ((element = element.$parent || element.parent)) {\n    if (anyType) {\n      if (isAny(element, anyType)) {\n        return element;\n      }\n    }\n    else {\n      return element;\n    }\n  }\n\n  return null;\n}\n\nmodule.exports.getParent = getParent;\n\n\n/**\n * Return true if element has any of the given types.\n *\n * @param {djs.model.Base} element\n * @param {Array<String>} types\n *\n * @return {Boolean}\n */\nfunction isAny(element, types) {\n  return some(types, function(t) {\n    return is(element, t);\n  });\n}\n\nmodule.exports.isAny = isAny;\n\n\nfunction isLabel(element) {\n  return element instanceof Model.Label;\n}\n\nmodule.exports.isLabel = isLabel;","'use strict';\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject,\n    getDefinition = ModelUtil.getDefinition,\n    isCasePlanModel = ModelUtil.isCasePlanModel;\n\nvar isAny = require('cmmn-js/lib/features/modeling/util/ModelingUtil').isAny;\n\nvar filter = require('lodash/filter');\n\nfunction isItemCapable(element) {\n  return isAny(element, [\n    'cmmn:PlanItem',\n    'cmmn:DiscretionaryItem',\n    'cmmn:CaseFileItem'\n  ]);\n}\n\nmodule.exports.isItemCapable = isItemCapable;\n\n\nfunction isCriterion(element) {\n  return is(element, 'cmmn:Criterion');\n}\n\nmodule.exports.isCriterion = isCriterion;\n\n\nfunction isCMMNEdge(element) {\n  return is(element, 'cmmndi:CMMNEdge');\n}\n\nmodule.exports.isCMMNEdge = isCMMNEdge;\n\n\nfunction isDiscretionaryConnection(element) {\n  return !getCMMNElementRef(element);\n}\n\nmodule.exports.isDiscretionaryConnection = isDiscretionaryConnection;\n\n\nfunction isAssociationConnection(element) {\n  return is(getCMMNElementRef(element), 'cmmn:Association');\n}\n\nmodule.exports.isAssociationConnection = isAssociationConnection;\n\n\nfunction isOnPartConnection(element) {\n  return is(getCMMNElementRef(element), 'cmmn:OnPart');\n}\n\nmodule.exports.isOnPartConnection = isOnPartConnection;\n\n\nfunction getCMMNElementRef(element) {\n  var bo = getBusinessObject(element);\n  return bo && bo.cmmnElementRef;\n}\n\nmodule.exports.getCMMNElementRef = getCMMNElementRef;\n\n\nfunction isTextAnnotation(element) {\n  return is(element, 'cmmn:TextAnnotation');\n}\n\nmodule.exports.isTextAnnotation = isTextAnnotation;\n\n\nfunction isCMMNDiagram(element) {\n  return is(element, 'cmmndi:CMMNDiagram');\n}\n\nmodule.exports.isCMMNDiagram = isCMMNDiagram;\n\n\nfunction isAssignable(element) {\n  return is(getDefinition(element), 'camunda:Assignable');\n}\n\nmodule.exports.isAssignable = isAssignable;\n\n\nfunction isFormSupported(element) {\n  return is(getDefinition(element), 'camunda:FormSupported');\n}\n\nmodule.exports.isFormSupported = isFormSupported;\n\n\nfunction isTask(element) {\n  return is(getDefinition(element), 'cmmn:Task');\n}\n\nmodule.exports.isTask = isTask;\n\n\nfunction isHumanTask(element) {\n  return is(getDefinition(element), 'cmmn:HumanTask');\n}\n\nmodule.exports.isHumanTask = isHumanTask;\n\n\nfunction isMilestone(element) {\n  return is(getDefinition(element), 'cmmn:Milestone');\n}\n\nmodule.exports.isMilestone = isMilestone;\n\n\nfunction isEventListener(element) {\n  return is(getDefinition(element), 'cmmn:EventListener');\n}\n\nmodule.exports.isEventListener = isEventListener;\n\n\nfunction isStage(element) {\n  return is(getDefinition(element), 'cmmn:Stage');\n}\n\nmodule.exports.isStage = isStage;\n\n\nfunction isInOutBindingCapable(element) {\n  return isAny(getDefinition(element), [\n    'cmmn:ProcessTask',\n    'cmmn:CaseTask'\n  ]);\n}\n\nmodule.exports.isInOutBindingCapable = isInOutBindingCapable;\n\n\nfunction getOutgoingOnParts(element, onPartFilter) {\n\n  return filter(element.outgoing, function(con) {\n\n    if (isOnPartConnection(con)) {\n\n      if (onPartFilter && getCMMNElementRef(con) !== onPartFilter) {\n        return false;\n      }\n\n      return true;\n\n    }\n\n    return false;\n\n  });\n\n}\n\nmodule.exports.getOutgoingOnParts = getOutgoingOnParts;\n\n\nfunction isCallable(element) {\n  return isAny(getDefinition(element), [\n    'cmmn:ProcessTask',\n    'cmmn:CaseTask',\n    'cmmn:DecisionTask'\n  ]);\n}\n\nmodule.exports.isCallable = isCallable;\n\n\nfunction isPlanItem(element) {\n  return is(element, 'cmmn:PlanItem');\n}\n\nmodule.exports.isPlanItem = isPlanItem;\n\n\nfunction isCaseExecutionListenerCapable(element) {\n\n  if (isCasePlanModel(element)) {\n    return true;\n  }\n\n  if (isPlanItem(element)) {\n\n    var definition = getDefinition(element);\n    return isAny(definition, [\n      'cmmn:Task',\n      'cmmn:Stage',\n      'cmmn:Milestone'\n    ]);\n\n  }\n\n  return false;\n\n}\n\nmodule.exports.isCaseExecutionListenerCapable = isCaseExecutionListenerCapable;\n\n\nfunction isTaskListenerCapable(element) {\n  return isPlanItem(element) && isHumanTask(element);\n}\n\nmodule.exports.isTaskListenerCapable = isTaskListenerCapable;\n\n\nfunction isVariableListenerCapable(element) {\n\n  if (isCasePlanModel(element)) {\n    return true;\n  }\n\n  if (isPlanItem(element)) {\n\n    var definition = getDefinition(element);\n    return isAny(definition, [\n      'cmmn:Task',\n      'cmmn:Stage'\n    ]);\n\n  }\n\n  return false;\n\n}\n\nmodule.exports.isVariableListenerCapable = isVariableListenerCapable;\n","import {\n  isObject,\n  sortBy\n} from 'min-dash';\n\nimport {\n  pointDistance,\n  pointsOnLine\n} from '../util/Geometry';\n\nimport intersectPaths from 'path-intersection';\n\n\nexport function roundBounds(bounds) {\n  return {\n    x: Math.round(bounds.x),\n    y: Math.round(bounds.y),\n    width: Math.round(bounds.width),\n    height: Math.round(bounds.height)\n  };\n}\n\n\nexport function roundPoint(point) {\n\n  return {\n    x: Math.round(point.x),\n    y: Math.round(point.y)\n  };\n}\n\n\n/**\n * Convert the given bounds to a { top, left, bottom, right } descriptor.\n *\n * @param {Bounds|Point} bounds\n *\n * @return {Object}\n */\nexport function asTRBL(bounds) {\n  return {\n    top: bounds.y,\n    right: bounds.x + (bounds.width || 0),\n    bottom: bounds.y + (bounds.height || 0),\n    left: bounds.x\n  };\n}\n\n\n/**\n * Convert a { top, left, bottom, right } to an objects bounds.\n *\n * @param {Object} trbl\n *\n * @return {Bounds}\n */\nexport function asBounds(trbl) {\n  return {\n    x: trbl.left,\n    y: trbl.top,\n    width: trbl.right - trbl.left,\n    height: trbl.bottom - trbl.top\n  };\n}\n\n\n/**\n * Get the mid of the given bounds or point.\n *\n * @param {Bounds|Point} bounds\n *\n * @return {Point}\n */\nexport function getMid(bounds) {\n  return roundPoint({\n    x: bounds.x + (bounds.width || 0) / 2,\n    y: bounds.y + (bounds.height || 0) / 2\n  });\n}\n\n\n// orientation utils //////////////////////\n\n/**\n * Get orientation of the given rectangle with respect to\n * the reference rectangle.\n *\n * A padding (positive or negative) may be passed to influence\n * horizontal / vertical orientation and intersection.\n *\n * @param {Bounds} rect\n * @param {Bounds} reference\n * @param {Point|Number} padding\n *\n * @return {String} the orientation; one of top, top-left, left, ..., bottom, right or intersect.\n */\nexport function getOrientation(rect, reference, padding) {\n\n  padding = padding || 0;\n\n  // make sure we can use an object, too\n  // for individual { x, y } padding\n  if (!isObject(padding)) {\n    padding = { x: padding, y: padding };\n  }\n\n\n  var rectOrientation = asTRBL(rect),\n      referenceOrientation = asTRBL(reference);\n\n  var top = rectOrientation.bottom + padding.y <= referenceOrientation.top,\n      right = rectOrientation.left - padding.x >= referenceOrientation.right,\n      bottom = rectOrientation.top - padding.y >= referenceOrientation.bottom,\n      left = rectOrientation.right + padding.x <= referenceOrientation.left;\n\n  var vertical = top ? 'top' : (bottom ? 'bottom' : null),\n      horizontal = left ? 'left' : (right ? 'right' : null);\n\n  if (horizontal && vertical) {\n    return vertical + '-' + horizontal;\n  } else {\n    return horizontal || vertical || 'intersect';\n  }\n}\n\n\n// intersection utils //////////////////////\n\n/**\n * Get intersection between an element and a line path.\n *\n * @param {PathDef} elementPath\n * @param {PathDef} linePath\n * @param {Boolean} cropStart crop from start or end\n *\n * @return {Point}\n */\nexport function getElementLineIntersection(elementPath, linePath, cropStart) {\n\n  var intersections = getIntersections(elementPath, linePath);\n\n  // recognize intersections\n  // only one -> choose\n  // two close together -> choose first\n  // two or more distinct -> pull out appropriate one\n  // none -> ok (fallback to point itself)\n  if (intersections.length === 1) {\n    return roundPoint(intersections[0]);\n  } else if (intersections.length === 2 && pointDistance(intersections[0], intersections[1]) < 1) {\n    return roundPoint(intersections[0]);\n  } else if (intersections.length > 1) {\n\n    // sort by intersections based on connection segment +\n    // distance from start\n    intersections = sortBy(intersections, function(i) {\n      var distance = Math.floor(i.t2 * 100) || 1;\n\n      distance = 100 - distance;\n\n      distance = (distance < 10 ? '0' : '') + distance;\n\n      // create a sort string that makes sure we sort\n      // line segment ASC + line segment position DESC (for cropStart)\n      // line segment ASC + line segment position ASC (for cropEnd)\n      return i.segment2 + '#' + distance;\n    });\n\n    return roundPoint(intersections[cropStart ? 0 : intersections.length - 1]);\n  }\n\n  return null;\n}\n\n\nexport function getIntersections(a, b) {\n  return intersectPaths(a, b);\n}\n\n\nexport function filterRedundantWaypoints(waypoints) {\n\n  // alter copy of waypoints, not original\n  waypoints = waypoints.slice();\n\n  var idx = 0,\n      point,\n      previousPoint,\n      nextPoint;\n\n  while (waypoints[idx]) {\n    point = waypoints[idx];\n    previousPoint = waypoints[idx - 1];\n    nextPoint = waypoints[idx + 1];\n\n    if (pointDistance(point, nextPoint) === 0 ||\n        pointsOnLine(previousPoint, nextPoint, point)) {\n\n      // remove point, if overlapping with {nextPoint}\n      // or on line with {previousPoint} -> {point} -> {nextPoint}\n      waypoints.splice(idx, 1);\n    } else {\n      idx++;\n    }\n  }\n\n  return waypoints;\n}\n","import {\n  forEach,\n  isFunction,\n  isArray,\n  isNumber,\n  isObject\n} from 'min-dash';\n\n\nvar DEFAULT_PRIORITY = 1000;\n\n/**\n * A utility that can be used to plug-in into the command execution for\n * extension and/or validation.\n *\n * @param {EventBus} eventBus\n *\n * @example\n *\n * import inherits from 'inherits';\n *\n * import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n *\n * function CommandLogger(eventBus) {\n *   CommandInterceptor.call(this, eventBus);\n *\n *   this.preExecute(function(event) {\n *     console.log('command pre-execute', event);\n *   });\n * }\n *\n * inherits(CommandLogger, CommandInterceptor);\n *\n */\nexport default function CommandInterceptor(eventBus) {\n  this._eventBus = eventBus;\n}\n\nCommandInterceptor.$inject = [ 'eventBus' ];\n\nfunction unwrapEvent(fn, that) {\n  return function(event) {\n    return fn.call(that || null, event.context, event.command, event);\n  };\n}\n\n/**\n * Register an interceptor for a command execution\n *\n * @param {String|Array<String>} [events] list of commands to register on\n * @param {String} [hook] command hook, i.e. preExecute, executed to listen on\n * @param {Number} [priority] the priority on which to hook into the execution\n * @param {Function} handlerFn interceptor to be invoked with (event)\n * @param {Boolean} unwrap if true, unwrap the event and pass (context, command, event) to the\n *                          listener instead\n * @param {Object} [that] Pass context (`this`) to the handler function\n */\nCommandInterceptor.prototype.on = function(events, hook, priority, handlerFn, unwrap, that) {\n\n  if (isFunction(hook) || isNumber(hook)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = hook;\n    hook = null;\n  }\n\n  if (isFunction(priority)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (isObject(unwrap)) {\n    that = unwrap;\n    unwrap = false;\n  }\n\n  if (!isFunction(handlerFn)) {\n    throw new Error('handlerFn must be a function');\n  }\n\n  if (!isArray(events)) {\n    events = [ events ];\n  }\n\n  var eventBus = this._eventBus;\n\n  forEach(events, function(event) {\n    // concat commandStack(.event)?(.hook)?\n    var fullEvent = [ 'commandStack', event, hook ].filter(function(e) { return e; }).join('.');\n\n    eventBus.on(fullEvent, priority, unwrap ? unwrapEvent(handlerFn, that) : handlerFn, that);\n  });\n};\n\n\nvar hooks = [\n  'canExecute',\n  'preExecute',\n  'preExecuted',\n  'execute',\n  'executed',\n  'postExecute',\n  'postExecuted',\n  'revert',\n  'reverted'\n];\n\n/*\n * Install hook shortcuts\n *\n * This will generate the CommandInterceptor#(preExecute|...|reverted) methods\n * which will in term forward to CommandInterceptor#on.\n */\nforEach(hooks, function(hook) {\n\n  /**\n   * {canExecute|preExecute|preExecuted|execute|executed|postExecute|postExecuted|revert|reverted}\n   *\n   * A named hook for plugging into the command execution\n   *\n   * @param {String|Array<String>} [events] list of commands to register on\n   * @param {Number} [priority] the priority on which to hook into the execution\n   * @param {Function} handlerFn interceptor to be invoked with (event)\n   * @param {Boolean} [unwrap=false] if true, unwrap the event and pass (context, command, event) to the\n   *                          listener instead\n   * @param {Object} [that] Pass context (`this`) to the handler function\n   */\n  CommandInterceptor.prototype[hook] = function(events, priority, handlerFn, unwrap, that) {\n\n    if (isFunction(events) || isNumber(events)) {\n      that = unwrap;\n      unwrap = handlerFn;\n      handlerFn = priority;\n      priority = events;\n      events = null;\n    }\n\n    this.on(events, hook, priority, handlerFn, unwrap, that);\n  };\n});\n","'use strict';\n\nvar getBusinessObject = require('cmmn-js/lib/util/ModelUtil').getBusinessObject;\n\n// input entities\nvar textInputField = require('./TextInputEntryFactory'),\n    checkboxField = require('./CheckboxEntryFactory'),\n    selectBoxField = require('./SelectEntryFactory'),\n    textBoxField = require('./TextBoxEntryFactory'),\n    validationAwareTextInputField = require('./ValidationAwareTextInput'),\n    labelEntry = require('./LabelFactory');\n\nvar cmdHelper = require('../helper/CmdHelper');\n\n// helpers ////////////////////////////////////////\n\nfunction ensureNotNull(prop) {\n  if (!prop) {\n    throw new Error(prop + ' must be set.');\n  }\n\n  return prop;\n}\n\n/**\n * sets the default parameters which are needed to create an entry\n *\n * @param options\n * @returns {{id: *, description: (*|string), get: (*|Function), set: (*|Function),\n *            validate: (*|Function), html: string}}\n */\nvar setDefaultParameters = function(options) {\n\n  function getReferencedObject(element, reference) {\n    var bo = getBusinessObject(element);\n\n    if (reference) {\n      return bo && bo.get(reference);\n    }\n\n    return bo;\n  }\n\n\n  // default /////////////////////////////////////////////////////////\n\n  // default method to fetch the current value of the input field\n  var defaultGet = function(element, node, bo) {\n    var res = {},\n        prop = ensureNotNull(options.modelProperty);\n\n    bo = bo || getBusinessObject(element);\n    res[prop] = bo && bo.get(prop);\n\n    return res;\n  };\n\n  // default method to set a new value to the input field\n  var defaultSet = function(element, values, node, bo) {\n    var res = {},\n        prop = ensureNotNull(options.modelProperty);\n\n    if (values[prop] !== '') {\n      res[prop] = values[prop];\n    } else {\n      res[prop] = undefined;\n    }\n\n    bo = bo || getBusinessObject(element);\n\n    return cmdHelper.updateProperties(bo, res, element);\n  };\n\n  // default validation method\n  var defaultValidate = function() {\n    return {};\n  };\n\n\n  // wrapper ////////////////////////////////////////\n\n  var wrapperGet = function(element, node) {\n\n    var reference = options.reference,\n        getter = options.get || defaultGet;\n\n    return getter(element, node, getReferencedObject(element, reference));\n\n  };\n\n  var wrapperSet = function(element, values, node) {\n\n    var reference = options.reference,\n        setter = options.set || defaultSet;\n\n    return setter(element, values, node, getReferencedObject(element, reference));\n\n  };\n\n  var wrapperValidate = function(element, values, node) {\n\n    var reference = options.reference,\n        validator = options.validate || defaultValidate;\n\n    return validator(element, values, node, getReferencedObject(element, reference));\n\n  };\n\n\n\n  return {\n    id : options.id,\n    description : (options.description || ''),\n    get : wrapperGet,\n    set : wrapperSet,\n    validate : wrapperValidate,\n    html: '',\n    reference: options.reference,\n    hideEntry: options.hideEntry\n  };\n};\n\nfunction EntryFactory() {\n\n}\n\n/**\n * Generates an text input entry object for a property panel.\n * options are:\n * - id: id of the entry - String\n *\n * - description: description of the property - String\n *\n * - label: label for the input field - String\n *\n * - set: setter method - Function\n *\n * - get: getter method - Function\n *\n * - validate: validation mehtod - Function\n *\n * - modelProperty: name of the model property - String\n *\n * - buttonAction: Object which contains the following properties: - Object\n * ---- name: name of the [data-action] callback - String\n * ---- method: callback function for [data-action] - Function\n *\n * - buttonShow: Object which contains the following properties: - Object\n * ---- name: name of the [data-show] callback - String\n * ---- method: callback function for [data-show] - Function\n *\n * @param options\n * @returns the propertyPanel entry resource object\n */\nEntryFactory.textField = function(options) {\n  return textInputField(options, setDefaultParameters(options));\n};\n\nEntryFactory.validationAwareTextField = function(options) {\n  return validationAwareTextInputField(options, setDefaultParameters(options));\n};\n\n/**\n * Generates a checkbox input entry object for a property panel.\n * options are:\n * - id: id of the entry - String\n *\n * - description: description of the property - String\n *\n * - label: label for the input field - String\n *\n * - set: setter method - Function\n *\n * - get: getter method - Function\n *\n * - validate: validation mehtod - Function\n *\n * - modelProperty: name of the model property - String\n *\n * @param options\n * @returns the propertyPanel entry resource object\n */\nEntryFactory.checkbox = function(options) {\n  return checkboxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.textBox = function(options) {\n  return textBoxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.selectBox = function(options) {\n  return selectBoxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.label = function(options) {\n  return labelEntry(options);\n};\n\nmodule.exports = EntryFactory;\n","import {\n  assign,\n  isArray,\n  isNumber,\n  isObject,\n  isUndefined,\n  groupBy,\n  forEach\n} from 'min-dash';\n\n\n/**\n * Adds an element to a collection and returns true if the\n * element was added.\n *\n * @param {Array<Object>} elements\n * @param {Object} e\n * @param {Boolean} unique\n */\nexport function add(elements, e, unique) {\n  var canAdd = !unique || elements.indexOf(e) === -1;\n\n  if (canAdd) {\n    elements.push(e);\n  }\n\n  return canAdd;\n}\n\n\n/**\n * Iterate over each element in a collection, calling the iterator function `fn`\n * with (element, index, recursionDepth).\n *\n * Recurse into all elements that are returned by `fn`.\n *\n * @param  {Object|Array<Object>} elements\n * @param  {Function} fn iterator function called with (element, index, recursionDepth)\n * @param  {Number} [depth] maximum recursion depth\n */\nexport function eachElement(elements, fn, depth) {\n\n  depth = depth || 0;\n\n  if (!isArray(elements)) {\n    elements = [ elements ];\n  }\n\n  forEach(elements, function(s, i) {\n    var filter = fn(s, i, depth);\n\n    if (isArray(filter) && filter.length) {\n      eachElement(filter, fn, depth + 1);\n    }\n  });\n}\n\n\n/**\n * Collects self + child elements up to a given depth from a list of elements.\n *\n * @param  {djs.model.Base|Array<djs.model.Base>} elements the elements to select the children from\n * @param  {Boolean} unique whether to return a unique result set (no duplicates)\n * @param  {Number} maxDepth the depth to search through or -1 for infinite\n *\n * @return {Array<djs.model.Base>} found elements\n */\nexport function selfAndChildren(elements, unique, maxDepth) {\n  var result = [],\n      processedChildren = [];\n\n  eachElement(elements, function(element, i, depth) {\n    add(result, element, unique);\n\n    var children = element.children;\n\n    // max traversal depth not reached yet\n    if (maxDepth === -1 || depth < maxDepth) {\n\n      // children exist && children not yet processed\n      if (children && add(processedChildren, children, unique)) {\n        return children;\n      }\n    }\n  });\n\n  return result;\n}\n\n/**\n * Return self + direct children for a number of elements\n *\n * @param  {Array<djs.model.Base>} elements to query\n * @param  {Boolean} allowDuplicates to allow duplicates in the result set\n *\n * @return {Array<djs.model.Base>} the collected elements\n */\nexport function selfAndDirectChildren(elements, allowDuplicates) {\n  return selfAndChildren(elements, !allowDuplicates, 1);\n}\n\n\n/**\n * Return self + ALL children for a number of elements\n *\n * @param  {Array<djs.model.Base>} elements to query\n * @param  {Boolean} allowDuplicates to allow duplicates in the result set\n *\n * @return {Array<djs.model.Base>} the collected elements\n */\nexport function selfAndAllChildren(elements, allowDuplicates) {\n  return selfAndChildren(elements, !allowDuplicates, -1);\n}\n\n\n/**\n * Gets the the closure for all selected elements,\n * their enclosed children and connections.\n *\n * @param {Array<djs.model.Base>} elements\n * @param {Boolean} [isTopLevel=true]\n * @param {Object} [existingClosure]\n *\n * @return {Object} newClosure\n */\nexport function getClosure(elements, isTopLevel, closure) {\n\n  if (isUndefined(isTopLevel)) {\n    isTopLevel = true;\n  }\n\n  if (isObject(isTopLevel)) {\n    closure = isTopLevel;\n    isTopLevel = true;\n  }\n\n\n  closure = closure || {};\n\n  var allShapes = copyObject(closure.allShapes),\n      allConnections = copyObject(closure.allConnections),\n      enclosedElements = copyObject(closure.enclosedElements),\n      enclosedConnections = copyObject(closure.enclosedConnections);\n\n  var topLevel = copyObject(\n    closure.topLevel,\n    isTopLevel && groupBy(elements, function(e) { return e.id; })\n  );\n\n\n  function handleConnection(c) {\n    if (topLevel[c.source.id] && topLevel[c.target.id]) {\n      topLevel[c.id] = [ c ];\n    }\n\n    // not enclosed as a child, but maybe logically\n    // (connecting two moved elements?)\n    if (allShapes[c.source.id] && allShapes[c.target.id]) {\n      enclosedConnections[c.id] = enclosedElements[c.id] = c;\n    }\n\n    allConnections[c.id] = c;\n  }\n\n  function handleElement(element) {\n\n    enclosedElements[element.id] = element;\n\n    if (element.waypoints) {\n      // remember connection\n      enclosedConnections[element.id] = allConnections[element.id] = element;\n    } else {\n      // remember shape\n      allShapes[element.id] = element;\n\n      // remember all connections\n      forEach(element.incoming, handleConnection);\n\n      forEach(element.outgoing, handleConnection);\n\n      // recurse into children\n      return element.children;\n    }\n  }\n\n  eachElement(elements, handleElement);\n\n  return {\n    allShapes: allShapes,\n    allConnections: allConnections,\n    topLevel: topLevel,\n    enclosedConnections: enclosedConnections,\n    enclosedElements: enclosedElements\n  };\n}\n\n/**\n * Returns the surrounding bbox for all elements in\n * the array or the element primitive.\n *\n * @param {Array<djs.model.Shape>|djs.model.Shape} elements\n * @param {Boolean} stopRecursion\n */\nexport function getBBox(elements, stopRecursion) {\n\n  stopRecursion = !!stopRecursion;\n  if (!isArray(elements)) {\n    elements = [elements];\n  }\n\n  var minX,\n      minY,\n      maxX,\n      maxY;\n\n  forEach(elements, function(element) {\n\n    // If element is a connection the bbox must be computed first\n    var bbox = element;\n    if (element.waypoints && !stopRecursion) {\n      bbox = getBBox(element.waypoints, true);\n    }\n\n    var x = bbox.x,\n        y = bbox.y,\n        height = bbox.height || 0,\n        width = bbox.width || 0;\n\n    if (x < minX || minX === undefined) {\n      minX = x;\n    }\n    if (y < minY || minY === undefined) {\n      minY = y;\n    }\n\n    if ((x + width) > maxX || maxX === undefined) {\n      maxX = x + width;\n    }\n    if ((y + height) > maxY || maxY === undefined) {\n      maxY = y + height;\n    }\n  });\n\n  return {\n    x: minX,\n    y: minY,\n    height: maxY - minY,\n    width: maxX - minX\n  };\n}\n\n\n/**\n * Returns all elements that are enclosed from the bounding box.\n *\n *   * If bbox.(width|height) is not specified the method returns\n *     all elements with element.x/y > bbox.x/y\n *   * If only bbox.x or bbox.y is specified, method return all elements with\n *     e.x > bbox.x or e.y > bbox.y\n *\n * @param {Array<djs.model.Shape>} elements List of Elements to search through\n * @param {djs.model.Shape} bbox the enclosing bbox.\n *\n * @return {Array<djs.model.Shape>} enclosed elements\n */\nexport function getEnclosedElements(elements, bbox) {\n\n  var filteredElements = {};\n\n  forEach(elements, function(element) {\n\n    var e = element;\n\n    if (e.waypoints) {\n      e = getBBox(e);\n    }\n\n    if (!isNumber(bbox.y) && (e.x > bbox.x)) {\n      filteredElements[element.id] = element;\n    }\n    if (!isNumber(bbox.x) && (e.y > bbox.y)) {\n      filteredElements[element.id] = element;\n    }\n    if (e.x > bbox.x && e.y > bbox.y) {\n      if (isNumber(bbox.width) && isNumber(bbox.height) &&\n          e.width + e.x < bbox.width + bbox.x &&\n          e.height + e.y < bbox.height + bbox.y) {\n\n        filteredElements[element.id] = element;\n      } else if (!isNumber(bbox.width) || !isNumber(bbox.height)) {\n        filteredElements[element.id] = element;\n      }\n    }\n  });\n\n  return filteredElements;\n}\n\n\nexport function getType(element) {\n\n  if ('waypoints' in element) {\n    return 'connection';\n  }\n\n  if ('x' in element) {\n    return 'shape';\n  }\n\n  return 'root';\n}\n\nexport function isFrameElement(element) {\n\n  return !!(element && element.isFrame);\n}\n\n// helpers ///////////////////////////////\n\nfunction copyObject(src1, src2) {\n  return assign({}, src1 || {}, src2 || {});\n}","/**\n * Failsafe remove an element from a collection\n *\n * @param  {Array<Object>} [collection]\n * @param  {Object} [element]\n *\n * @return {Number} the previous index of the element\n */\nexport function remove(collection, element) {\n\n  if (!collection || !element) {\n    return -1;\n  }\n\n  var idx = collection.indexOf(element);\n\n  if (idx !== -1) {\n    collection.splice(idx, 1);\n  }\n\n  return idx;\n}\n\n/**\n * Fail save add an element to the given connection, ensuring\n * it does not yet exist.\n *\n * @param {Array<Object>} collection\n * @param {Object} element\n * @param {Number} idx\n */\nexport function add(collection, element, idx) {\n\n  if (!collection || !element) {\n    return;\n  }\n\n  if (typeof idx !== 'number') {\n    idx = -1;\n  }\n\n  var currentIdx = collection.indexOf(element);\n\n  if (currentIdx !== -1) {\n\n    if (currentIdx === idx) {\n      // nothing to do, position has not changed\n      return;\n    } else {\n\n      if (idx !== -1) {\n        // remove from current position\n        collection.splice(currentIdx, 1);\n      } else {\n        // already exists in collection\n        return;\n      }\n    }\n  }\n\n  if (idx !== -1) {\n    // insert at specified position\n    collection.splice(idx, 0, element);\n  } else {\n    // push to end\n    collection.push(element);\n  }\n}\n\n\n/**\n * Fail save get the index of an element in a collection.\n *\n * @param {Array<Object>} collection\n * @param {Object} element\n *\n * @return {Number} the index or -1 if collection or element do\n *                  not exist or the element is not contained.\n */\nexport function indexOf(collection, element) {\n\n  if (!collection || !element) {\n    return -1;\n  }\n\n  return collection.indexOf(element);\n}\n","import {\r\n  transform as svgTransform,\r\n  createTransform\r\n} from 'tiny-svg';\r\n\r\n\r\n/**\r\n * @param {<SVGElement>} element\r\n * @param {Number} x\r\n * @param {Number} y\r\n * @param {Number} angle\r\n * @param {Number} amount\r\n */\r\nexport function transform(gfx, x, y, angle, amount) {\r\n  var translate = createTransform();\r\n  translate.setTranslate(x, y);\r\n\r\n  var rotate = createTransform();\r\n  rotate.setRotate(angle, 0, 0);\r\n\r\n  var scale = createTransform();\r\n  scale.setScale(amount || 1, amount || 1);\r\n\r\n  svgTransform(gfx, [ translate, rotate, scale ]);\r\n}\r\n\r\n\r\n/**\r\n * @param {SVGElement} element\r\n * @param {Number} x\r\n * @param {Number} y\r\n */\r\nexport function translate(gfx, x, y) {\r\n  var translate = createTransform();\r\n  translate.setTranslate(x, y);\r\n\r\n  svgTransform(gfx, translate);\r\n}\r\n\r\n\r\n/**\r\n * @param {SVGElement} element\r\n * @param {Number} angle\r\n */\r\nexport function rotate(gfx, angle) {\r\n  var rotate = createTransform();\r\n  rotate.setRotate(angle, 0, 0);\r\n\r\n  svgTransform(gfx, rotate);\r\n}\r\n\r\n\r\n/**\r\n * @param {SVGElement} element\r\n * @param {Number} amount\r\n */\r\nexport function scale(gfx, amount) {\r\n  var scale = createTransform();\r\n  scale.setScale(amount, amount);\r\n\r\n  svgTransform(gfx, scale);\r\n}","'use strict';\n\nvar Ids = require('ids');\n\nvar SPACE_REGEX = /\\s/;\n\n// for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\nvar QNAME_REGEX = /^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i;\n\n// for ID validation as per CMMN Schema (QName - Namespace)\nvar ID_REGEX = /^[a-z_][\\w-.]*$/i;\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\n/**\n * adds an empty option to the list\n */\nfunction addEmptyParameter(list) {\n  return list.push({ 'label': '', 'value': '', 'name': '' });\n}\n\nmodule.exports.addEmptyParameter = addEmptyParameter;\n\n\n/**\n * checks whether the id value is valid\n *\n * @param {ModdleElement} bo\n * @param {String} idValue\n *\n * @return {String} error message\n */\nfunction isIdValid(bo, idValue) {\n  var assigned = bo.$model.ids.assigned(idValue);\n\n  var idExists = assigned && assigned !== bo;\n\n  if (!idValue || idExists) {\n    return 'Element must have an unique id.';\n  }\n\n  return validateId(idValue);\n}\n\nmodule.exports.isIdValid = isIdValid;\n\n\nfunction validateId(idValue) {\n\n  if (containsSpace(idValue)) {\n    return 'Id must not contain spaces.';\n  }\n\n  if (!ID_REGEX.test(idValue)) {\n\n    if (QNAME_REGEX.test(idValue)) {\n      return 'Id must not contain prefix.';\n    }\n\n    return 'Id must be a valid QName.';\n  }\n}\n\nmodule.exports.validateId = validateId;\n\n\nfunction containsSpace(value) {\n  return SPACE_REGEX.test(value);\n}\n\nmodule.exports.containsSpace = containsSpace;\n\n/**\n * generate a semantic id with given prefix\n */\nfunction nextId(prefix) {\n  var ids = new Ids([32,32,1]);\n\n  return ids.nextPrefixed(prefix);\n}\n\nmodule.exports.nextId = nextId;\n\n\nfunction triggerClickEvent(element) {\n  var evt;\n  var eventType = 'click';\n\n  if (document.createEvent) {\n    try {\n      // Chrome, Safari, Firefox\n      evt = new MouseEvent((eventType), { view: window, bubbles: true, cancelable: true });\n    } catch (e) {\n      // IE 11, PhantomJS (wat!)\n      evt = document.createEvent('MouseEvent');\n\n      evt.initEvent((eventType), true, true);\n    }\n    return element.dispatchEvent(evt);\n  } else {\n    // Welcome IE\n    evt = document.createEventObject();\n\n    return element.fireEvent('on' + eventType, evt);\n  }\n}\n\nmodule.exports.triggerClickEvent = triggerClickEvent;\n\n\nfunction escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n\nmodule.exports.escapeHTML = escapeHTML;\n","import {\n  isArray,\n  forEach\n} from 'min-dash';\n\n\n/**\n * A service that offers the current selection in a diagram.\n * Offers the api to control the selection, too.\n *\n * @class\n *\n * @param {EventBus} eventBus the event bus\n */\nexport default function Selection(eventBus) {\n\n  this._eventBus = eventBus;\n\n  this._selectedElements = [];\n\n  var self = this;\n\n  eventBus.on([ 'shape.remove', 'connection.remove' ], function(e) {\n    var element = e.element;\n    self.deselect(element);\n  });\n\n  eventBus.on([ 'diagram.clear' ], function(e) {\n    self.select(null);\n  });\n}\n\nSelection.$inject = [ 'eventBus' ];\n\n\nSelection.prototype.deselect = function(element) {\n  var selectedElements = this._selectedElements;\n\n  var idx = selectedElements.indexOf(element);\n\n  if (idx !== -1) {\n    var oldSelection = selectedElements.slice();\n\n    selectedElements.splice(idx, 1);\n\n    this._eventBus.fire('selection.changed', { oldSelection: oldSelection, newSelection: selectedElements });\n  }\n};\n\n\nSelection.prototype.get = function() {\n  return this._selectedElements;\n};\n\nSelection.prototype.isSelected = function(element) {\n  return this._selectedElements.indexOf(element) !== -1;\n};\n\n\n/**\n * This method selects one or more elements on the diagram.\n *\n * By passing an additional add parameter you can decide whether or not the element(s)\n * should be added to the already existing selection or not.\n *\n * @method Selection#select\n *\n * @param  {Object|Object[]} elements element or array of elements to be selected\n * @param  {boolean} [add] whether the element(s) should be appended to the current selection, defaults to false\n */\nSelection.prototype.select = function(elements, add) {\n  var selectedElements = this._selectedElements,\n      oldSelection = selectedElements.slice();\n\n  if (!isArray(elements)) {\n    elements = elements ? [ elements ] : [];\n  }\n\n  // selection may be cleared by passing an empty array or null\n  // to the method\n  if (add) {\n    forEach(elements, function(element) {\n      if (selectedElements.indexOf(element) !== -1) {\n        // already selected\n        return;\n      } else {\n        selectedElements.push(element);\n      }\n    });\n  } else {\n    this._selectedElements = selectedElements = elements.slice();\n  }\n\n  this._eventBus.fire('selection.changed', { oldSelection: oldSelection, newSelection: selectedElements });\n};\n","import {\n  forEach\n} from 'min-dash';\n\nvar MARKER_HOVER = 'hover',\n    MARKER_SELECTED = 'selected';\n\n\n/**\n * A plugin that adds a visible selection UI to shapes and connections\n * by appending the <code>hover</code> and <code>selected</code> classes to them.\n *\n * @class\n *\n * Makes elements selectable, too.\n *\n * @param {EventBus} events\n * @param {SelectionService} selection\n * @param {Canvas} canvas\n */\nexport default function SelectionVisuals(events, canvas, selection, styles) {\n\n  this._multiSelectionBox = null;\n\n  function addMarker(e, cls) {\n    canvas.addMarker(e, cls);\n  }\n\n  function removeMarker(e, cls) {\n    canvas.removeMarker(e, cls);\n  }\n\n  events.on('element.hover', function(event) {\n    addMarker(event.element, MARKER_HOVER);\n  });\n\n  events.on('element.out', function(event) {\n    removeMarker(event.element, MARKER_HOVER);\n  });\n\n  events.on('selection.changed', function(event) {\n\n    function deselect(s) {\n      removeMarker(s, MARKER_SELECTED);\n    }\n\n    function select(s) {\n      addMarker(s, MARKER_SELECTED);\n    }\n\n    var oldSelection = event.oldSelection,\n        newSelection = event.newSelection;\n\n    forEach(oldSelection, function(e) {\n      if (newSelection.indexOf(e) === -1) {\n        deselect(e);\n      }\n    });\n\n    forEach(newSelection, function(e) {\n      if (oldSelection.indexOf(e) === -1) {\n        select(e);\n      }\n    });\n  });\n}\n\nSelectionVisuals.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'styles'\n];","import {\n  hasPrimaryModifier\n} from '../../util/Mouse';\n\nimport {\n  find\n} from 'min-dash';\n\n\nexport default function SelectionBehavior(\n    eventBus, selection, canvas,\n    elementRegistry) {\n\n  eventBus.on('create.end', 500, function(e) {\n\n    // select the created shape after a\n    // successful create operation\n    if (e.context.canExecute) {\n      selection.select(e.context.shape);\n    }\n  });\n\n  eventBus.on('connect.end', 500, function(e) {\n\n    // select the connect end target\n    // after a connect operation\n    if (e.context.canExecute && e.context.target) {\n      selection.select(e.context.target);\n    }\n  });\n\n  eventBus.on('shape.move.end', 500, function(e) {\n    var previousSelection = e.previousSelection || [];\n\n    var shape = elementRegistry.get(e.context.shape.id);\n\n    // make sure at least the main moved element is being\n    // selected after a move operation\n    var inSelection = find(previousSelection, function(selectedShape) {\n      return shape.id === selectedShape.id;\n    });\n\n    if (!inSelection) {\n      selection.select(shape);\n    }\n  });\n\n  // Shift + click selection\n  eventBus.on('element.click', function(event) {\n\n    var element = event.element;\n\n    // do not select the root element\n    // or connections\n    if (element === canvas.getRootElement()) {\n      element = null;\n    }\n\n    var isSelected = selection.isSelected(element),\n        isMultiSelect = selection.get().length > 1;\n\n    // mouse-event: SELECTION_KEY\n    var add = hasPrimaryModifier(event);\n\n    // select OR deselect element in multi selection\n    if (isSelected && isMultiSelect) {\n      if (add) {\n        return selection.deselect(element);\n      } else {\n        return selection.select(element);\n      }\n    } else\n    if (!isSelected) {\n      selection.select(element, add);\n    } else {\n      selection.deselect(element);\n    }\n  });\n}\n\nSelectionBehavior.$inject = [\n  'eventBus',\n  'selection',\n  'canvas',\n  'elementRegistry'\n];\n","import InteractionEventsModule from '../interaction-events';\nimport OutlineModule from '../outline';\n\nimport Selection from './Selection';\nimport SelectionVisuals from './SelectionVisuals';\nimport SelectionBehavior from './SelectionBehavior';\n\n\nexport default {\n  __init__: [ 'selectionVisuals', 'selectionBehavior' ],\n  __depends__: [\n    InteractionEventsModule,\n    OutlineModule\n  ],\n  selection: [ 'type', Selection ],\n  selectionVisuals: [ 'type', SelectionVisuals ],\n  selectionBehavior: [ 'type', SelectionBehavior ]\n};\n","'use strict';\n\nvar is = require('./ModelUtil').is,\n    getBusinessObject = require('./ModelUtil').getBusinessObject,\n    isCasePlanModel = require('./ModelUtil').isCasePlanModel;\n\nmodule.exports.isCollapsed = function(element) {\n\n  if (!isCasePlanModel(element)) {\n\n    element = getBusinessObject(element);\n\n    var definition = element.definitionRef;\n    if (is(definition, 'cmmn:PlanFragment')) {\n      return !!(element && element.di && element.di.isCollapsed);\n    }\n  }\n\n  return false;\n};\n\nmodule.exports.isPlanningTableCollapsed = function(element) {\n\n  element = getBusinessObject(element);\n\n  if (is(element, 'cmmn:Stage') ||\n     (element.definitionRef && (is(element.definitionRef, 'cmmn:Stage') ||\n      is(element.definitionRef, 'cmmn:HumanTask')))) {\n    return element.di && element.di.isPlanningTableCollapsed;\n  }\n\n  return false;\n};\n\nmodule.exports.isStandardEventVisible = function(element) {\n  element = getBusinessObject(element);\n  var cmmnElement = element.cmmnElementRef;\n  return !!(is(cmmnElement, 'cmmn:OnPart') && element.isStandardEventVisible);\n};","'use strict';\n\nvar ModelUtil = require('../../../util/ModelUtil'),\n    is = ModelUtil.is,\n    getDefinition = ModelUtil.getDefinition,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar isAny = require('./ModelingUtil').isAny,\n    getParent = require('./ModelingUtil').getParent;\n\nvar eachElement = require('diagram-js/lib/util/Elements').eachElement;\n\n\n/**\n * Returns all contained discretionary items.\n *\n * @param {ModdleElement} element\n *\n * @return {Array<ModdleElement>} all discretionary items\n */\nfunction getAllDiscretionaryItems(element) {\n\n  element = getBusinessObject(element);\n\n  if (isItemCapable(element)) {\n    element = getDefinition(element);\n  }\n\n  var result = [];\n\n  if (isPlanningTableCapable(element)) {\n    element = element.planningTable;\n\n    if (element) {\n\n      var items = element.get('tableItems');\n      eachElement(items, function(item) {\n        if (isDiscretionaryItem(item)) {\n          result.push(item);\n        }\n        else {\n          return item.get('tableItems');\n        }\n      });\n    }\n  }\n\n  return result;\n}\n\nmodule.exports.getAllDiscretionaryItems = getAllDiscretionaryItems;\n\n\n/**\n * Returns all directed item capables elements of the given element.\n *\n * @param {ModdleElement} element\n *\n * @return {Array<ModdleElement>} all direct item capables\n */\nfunction getDirectItemCapables(element) {\n\n  element = getBusinessObject(element);\n\n  if (isItemCapable(element)) {\n    element = getDefinition(element);\n  }\n\n  var result = [];\n\n  function add(item) {\n    result.push(item);\n  }\n\n  if (element) {\n\n    var items;\n\n    if (is(element, 'cmmn:PlanFragment')) {\n      items = element.get('planItems');\n      eachElement(items, add);\n    }\n\n    if (isPlanningTableCapable(element)) {\n      items = getAllDiscretionaryItems(element);\n      eachElement(items, add);\n    }\n\n  }\n\n  return result;\n}\n\nmodule.exports.getDirectItemCapables = getDirectItemCapables;\n\n\n/**\n * Returns true if the given element is either a discretionary item\n * or a plan item\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} when it is a discretionary item or a plan item\n */\nfunction isItemCapable(element) {\n  return isAny(element, [ 'cmmn:DiscretionaryItem', 'cmmn:PlanItem' ]);\n}\n\nmodule.exports.isItemCapable = isItemCapable;\n\n\n/**\n * Returns true if the given element is either a human task or\n * a stage.\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} when it is a human task or stage\n */\nfunction isPlanningTableCapable(element) {\n  return isAny(element, [ 'cmmn:HumanTask', 'cmmn:Stage' ]);\n}\n\nmodule.exports.isPlanningTableCapable = isPlanningTableCapable;\n\n\n/**\n * Returns true if the given element is a discretionary item.\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} when it is a discretionary item\n */\nfunction isDiscretionaryItem(element) {\n  return is(element, 'cmmn:DiscretionaryItem');\n}\n\nmodule.exports.isDiscretionaryItem = isDiscretionaryItem;\n\n\n/**\n * Returns true if the given element is a discretionary to a human task.\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} when it is discretionary to a human task\n */\nfunction isDiscretionaryToHumanTask(element) {\n  var bo = getBusinessObject(element);\n  var parent = getParent(bo, 'cmmn:PlanItemDefinition');\n  return is(parent, 'cmmn:HumanTask');\n}\n\nmodule.exports.isDiscretionaryToHumanTask = isDiscretionaryToHumanTask;\n\n\n/**\n * Returns true if the given element is a human task.\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} when it is a human task\n */\nfunction isHumanTask(element) {\n  return is(element, 'cmmn:HumanTask');\n}\n\nmodule.exports.isHumanTask = isHumanTask;\n\n\n/**\n * Returns true if the given element is a plan fragment and not\n * a stage.\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} when it is a plan fragment\n */\nfunction isPlanFragment(element) {\n  return is(element, 'cmmn:PlanFragment') && !is(element, 'cmmn:Stage');\n}\n\nmodule.exports.isPlanFragment = isPlanFragment;\n","/* global TouchEvent */\n\nvar round = Math.round;\n\nimport { assign } from 'min-dash';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  getOriginal,\n  toPoint,\n  stopPropagation\n} from '../../util/Event';\n\nimport {\n  set as cursorSet,\n  unset as cursorUnset\n} from '../../util/Cursor';\n\nimport {\n  install as installClickTrap\n} from '../../util/ClickTrap';\n\nimport {\n  delta as deltaPos\n} from '../../util/PositionUtil';\n\nvar DRAG_ACTIVE_CLS = 'djs-drag-active';\n\n\nfunction preventDefault(event) {\n  event.preventDefault();\n}\n\nfunction isTouchEvent(event) {\n  // check for TouchEvent being available first\n  // (i.e. not available on desktop Firefox)\n  return typeof TouchEvent !== 'undefined' && event instanceof TouchEvent;\n}\n\nfunction getLength(point) {\n  return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n}\n\n/**\n * A helper that fires canvas localized drag events and realizes\n * the general \"drag-and-drop\" look and feel.\n *\n * Calling {@link Dragging#activate} activates dragging on a canvas.\n *\n * It provides the following:\n *\n *   * emits life cycle events, namespaced with a prefix assigned\n *     during dragging activation\n *   * sets and restores the cursor\n *   * sets and restores the selection\n *   * ensures there can be only one drag operation active at a time\n *\n * Dragging may be canceled manually by calling {@link Dragging#cancel}\n * or by pressing ESC.\n *\n *\n * ## Life-cycle events\n *\n * Dragging can be in three different states, off, initialized\n * and active.\n *\n * (1) off: no dragging operation is in progress\n * (2) initialized: a new drag operation got initialized but not yet\n *                  started (i.e. because of no initial move)\n * (3) started: dragging is in progress\n *\n * Eventually dragging will be off again after a drag operation has\n * been ended or canceled via user click or ESC key press.\n *\n * To indicate transitions between these states dragging emits generic\n * life-cycle events with the `drag.` prefix _and_ events namespaced\n * to a prefix choosen by a user during drag initialization.\n *\n * The following events are emitted (appropriately prefixed) via\n * the {@link EventBus}.\n *\n * * `init`\n * * `start`\n * * `move`\n * * `end`\n * * `ended` (dragging already in off state)\n * * `cancel` (only if previously started)\n * * `canceled` (dragging already in off state, only if previously started)\n * * `cleanup`\n *\n *\n * @example\n *\n * function MyDragComponent(eventBus, dragging) {\n *\n *   eventBus.on('mydrag.start', function(event) {\n *     console.log('yes, we start dragging');\n *   });\n *\n *   eventBus.on('mydrag.move', function(event) {\n *     console.log('canvas local coordinates', event.x, event.y, event.dx, event.dy);\n *\n *     // local drag data is passed with the event\n *     event.context.foo; // \"BAR\"\n *\n *     // the original mouse event, too\n *     event.originalEvent; // MouseEvent(...)\n *   });\n *\n *   eventBus.on('element.click', function(event) {\n *     dragging.init(event, 'mydrag', {\n *       cursor: 'grabbing',\n *       data: {\n *         context: {\n *           foo: \"BAR\"\n *         }\n *       }\n *     });\n *   });\n * }\n */\nexport default function Dragging(eventBus, canvas, selection) {\n\n  var defaultOptions = {\n    threshold: 5,\n    trapClick: true\n  };\n\n  // the currently active drag operation\n  // dragging is active as soon as this context exists.\n  //\n  // it is visually _active_ only when a context.active flag is set to true.\n  var context;\n\n  /* convert a global event into local coordinates */\n  function toLocalPoint(globalPosition) {\n\n    var viewbox = canvas.viewbox();\n\n    var clientRect = canvas._container.getBoundingClientRect();\n\n    return {\n      x: viewbox.x + (globalPosition.x - clientRect.left) / viewbox.scale,\n      y: viewbox.y + (globalPosition.y - clientRect.top) / viewbox.scale\n    };\n  }\n\n  // helpers\n\n  function fire(type, dragContext) {\n    dragContext = dragContext || context;\n\n    var event = eventBus.createEvent(\n      assign(\n        {},\n        dragContext.payload,\n        dragContext.data,\n        { isTouch: dragContext.isTouch }\n      )\n    );\n\n    // default integration\n    if (eventBus.fire('drag.' + type, event) === false) {\n      return false;\n    }\n\n    return eventBus.fire(dragContext.prefix + '.' + type, event);\n  }\n\n  // event listeners\n\n  function move(event, activate) {\n    var payload = context.payload,\n        displacement = context.displacement;\n\n    var globalStart = context.globalStart,\n        globalCurrent = toPoint(event),\n        globalDelta = deltaPos(globalCurrent, globalStart);\n\n    var localStart = context.localStart,\n        localCurrent = toLocalPoint(globalCurrent),\n        localDelta = deltaPos(localCurrent, localStart);\n\n\n    // activate context explicitly or once threshold is reached\n    if (!context.active && (activate || getLength(globalDelta) > context.threshold)) {\n\n      // fire start event with original\n      // starting coordinates\n\n      assign(payload, {\n        x: round(localStart.x + displacement.x),\n        y: round(localStart.y + displacement.y),\n        dx: 0,\n        dy: 0\n      }, { originalEvent: event });\n\n      if (false === fire('start')) {\n        return cancel();\n      }\n\n      context.active = true;\n\n      // unset selection and remember old selection\n      // the previous (old) selection will always passed\n      // with the event via the event.previousSelection property\n      if (!context.keepSelection) {\n        payload.previousSelection = selection.get();\n        selection.select(null);\n      }\n\n      // allow custom cursor\n      if (context.cursor) {\n        cursorSet(context.cursor);\n      }\n\n      // indicate dragging via marker on root element\n      canvas.addMarker(canvas.getRootElement(), DRAG_ACTIVE_CLS);\n    }\n\n    stopPropagation(event);\n\n    if (context.active) {\n\n      // update payload with actual coordinates\n      assign(payload, {\n        x: round(localCurrent.x + displacement.x),\n        y: round(localCurrent.y + displacement.y),\n        dx: round(localDelta.x),\n        dy: round(localDelta.y)\n      }, { originalEvent: event });\n\n      // emit move event\n      fire('move');\n    }\n  }\n\n  function end(event) {\n    var previousContext,\n        returnValue = true;\n\n    if (context.active) {\n\n      if (event) {\n        context.payload.originalEvent = event;\n\n        // suppress original event (click, ...)\n        // because we just ended a drag operation\n        stopPropagation(event);\n      }\n\n      // implementations may stop restoring the\n      // original state (selections, ...) by preventing the\n      // end events default action\n      returnValue = fire('end');\n    }\n\n    if (returnValue === false) {\n      fire('rejected');\n    }\n\n    previousContext = cleanup(returnValue !== true);\n\n    // last event to be fired when all drag operations are done\n    // at this point in time no drag operation is in progress anymore\n    fire('ended', previousContext);\n  }\n\n\n  // cancel active drag operation if the user presses\n  // the ESC key on the keyboard\n\n  function checkCancel(event) {\n\n    if (event.which === 27) {\n      preventDefault(event);\n\n      cancel();\n    }\n  }\n\n\n  // prevent ghost click that might occur after a finished\n  // drag and drop session\n\n  function trapClickAndEnd(event) {\n\n    var untrap;\n\n    // trap the click in case we are part of an active\n    // drag operation. This will effectively prevent\n    // the ghost click that cannot be canceled otherwise.\n    if (context.active) {\n\n      untrap = installClickTrap(eventBus);\n\n      // remove trap after minimal delay\n      setTimeout(untrap, 400);\n\n      // prevent default action (click)\n      preventDefault(event);\n    }\n\n    end(event);\n  }\n\n  function trapTouch(event) {\n    move(event);\n  }\n\n  // update the drag events hover (djs.model.Base) and hoverGfx (Snap<SVGElement>)\n  // properties during hover and out and fire {prefix}.hover and {prefix}.out properties\n  // respectively\n\n  function hover(event) {\n    var payload = context.payload;\n\n    payload.hoverGfx = event.gfx;\n    payload.hover = event.element;\n\n    fire('hover');\n  }\n\n  function out(event) {\n    fire('out');\n\n    var payload = context.payload;\n\n    payload.hoverGfx = null;\n    payload.hover = null;\n  }\n\n\n  // life-cycle methods\n\n  function cancel(restore) {\n    var previousContext;\n\n    if (!context) {\n      return;\n    }\n\n    var wasActive = context.active;\n\n    if (wasActive) {\n      fire('cancel');\n    }\n\n    previousContext = cleanup(restore);\n\n    if (wasActive) {\n      // last event to be fired when all drag operations are done\n      // at this point in time no drag operation is in progress anymore\n      fire('canceled', previousContext);\n    }\n  }\n\n  function cleanup(restore) {\n    var previousContext,\n        endDrag;\n\n    fire('cleanup');\n\n    // reset cursor\n    cursorUnset();\n\n    if (context.trapClick) {\n      endDrag = trapClickAndEnd;\n    } else {\n      endDrag = end;\n    }\n\n    // reset dom listeners\n    domEvent.unbind(document, 'mousemove', move);\n\n    domEvent.unbind(document, 'dragstart', preventDefault);\n    domEvent.unbind(document, 'selectstart', preventDefault);\n\n    domEvent.unbind(document, 'mousedown', endDrag, true);\n    domEvent.unbind(document, 'mouseup', endDrag, true);\n\n    domEvent.unbind(document, 'keyup', checkCancel);\n\n    domEvent.unbind(document, 'touchstart', trapTouch, true);\n    domEvent.unbind(document, 'touchcancel', cancel, true);\n    domEvent.unbind(document, 'touchmove', move, true);\n    domEvent.unbind(document, 'touchend', end, true);\n\n    eventBus.off('element.hover', hover);\n    eventBus.off('element.out', out);\n\n    // remove drag marker on root element\n    canvas.removeMarker(canvas.getRootElement(), DRAG_ACTIVE_CLS);\n\n    // restore selection, unless it has changed\n    var previousSelection = context.payload.previousSelection;\n\n    if (restore !== false && previousSelection && !selection.get().length) {\n      selection.select(previousSelection);\n    }\n\n    previousContext = context;\n\n    context = null;\n\n    return previousContext;\n  }\n\n  /**\n   * Initialize a drag operation.\n   *\n   * If `localPosition` is given, drag events will be emitted\n   * relative to it.\n   *\n   * @param {MouseEvent|TouchEvent} [event]\n   * @param {Point} [localPosition] actual diagram local position this drag operation should start at\n   * @param {String} prefix\n   * @param {Object} [options]\n   */\n  function init(event, relativeTo, prefix, options) {\n\n    // only one drag operation may be active, at a time\n    if (context) {\n      cancel(false);\n    }\n\n    if (typeof relativeTo === 'string') {\n      options = prefix;\n      prefix = relativeTo;\n      relativeTo = null;\n    }\n\n    options = assign({}, defaultOptions, options || {});\n\n    var data = options.data || {},\n        originalEvent,\n        globalStart,\n        localStart,\n        endDrag,\n        isTouch;\n\n    if (options.trapClick) {\n      endDrag = trapClickAndEnd;\n    } else {\n      endDrag = end;\n    }\n\n    if (event) {\n      originalEvent = getOriginal(event) || event;\n      globalStart = toPoint(event);\n\n      stopPropagation(event);\n\n      // prevent default browser dragging behavior\n      if (originalEvent.type === 'dragstart') {\n        preventDefault(originalEvent);\n      }\n    } else {\n      originalEvent = null;\n      globalStart = { x: 0, y: 0 };\n    }\n\n    localStart = toLocalPoint(globalStart);\n\n    if (!relativeTo) {\n      relativeTo = localStart;\n    }\n\n    isTouch = isTouchEvent(originalEvent);\n\n    context = assign({\n      prefix: prefix,\n      data: data,\n      payload: {},\n      globalStart: globalStart,\n      displacement: deltaPos(relativeTo, localStart),\n      localStart: localStart,\n      isTouch: isTouch\n    }, options);\n\n    // skip dom registration if trigger\n    // is set to manual (during testing)\n    if (!options.manual) {\n\n      // add dom listeners\n\n      if (isTouch) {\n        domEvent.bind(document, 'touchstart', trapTouch, true);\n        domEvent.bind(document, 'touchcancel', cancel, true);\n        domEvent.bind(document, 'touchmove', move, true);\n        domEvent.bind(document, 'touchend', end, true);\n      } else {\n        // assume we use the mouse to interact per default\n        domEvent.bind(document, 'mousemove', move);\n\n        // prevent default browser drag and text selection behavior\n        domEvent.bind(document, 'dragstart', preventDefault);\n        domEvent.bind(document, 'selectstart', preventDefault);\n\n        domEvent.bind(document, 'mousedown', endDrag, true);\n        domEvent.bind(document, 'mouseup', endDrag, true);\n      }\n\n      domEvent.bind(document, 'keyup', checkCancel);\n\n      eventBus.on('element.hover', hover);\n      eventBus.on('element.out', out);\n    }\n\n    fire('init');\n\n    if (options.autoActivate) {\n      move(event, true);\n    }\n  }\n\n  // cancel on diagram destruction\n  eventBus.on('diagram.destroy', cancel);\n\n\n  // API\n\n  this.init = init;\n  this.move = move;\n  this.hover = hover;\n  this.out = out;\n  this.end = end;\n\n  this.cancel = cancel;\n\n  // for introspection\n\n  this.context = function() {\n    return context;\n  };\n\n  this.setOptions = function(options) {\n    assign(defaultOptions, options);\n  };\n}\n\nDragging.$inject = [\n  'eventBus',\n  'canvas',\n  'selection'\n];\n","import {\n  closest as domClosest\n} from 'min-dom';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\nvar HIGH_PRIORITY = 1500;\n\n\n/**\n * Browsers may swallow certain events (hover, out ...) if users are to\n * fast with the mouse.\n *\n * @see http://stackoverflow.com/questions/7448468/why-cant-i-reliably-capture-a-mouseout-event\n *\n * The fix implemented in this component ensure that we\n *\n * 1) have a hover state after a successive drag.move event\n * 2) have an out event when dragging leaves an element\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {ElementRegistry} elementRegistry\n */\nexport default function HoverFix(eventBus, dragging, elementRegistry) {\n\n  var self = this;\n\n  /**\n   * We wait for a specific sequence of events before\n   * emitting a fake drag.hover event.\n   *\n   * Event Sequence:\n   *\n   * drag.start\n   * drag.move\n   * drag.move >> ensure we are hovering\n   */\n  eventBus.on('drag.start', function(event) {\n\n    eventBus.once('drag.move', function() {\n\n      eventBus.once('drag.move', function(event) {\n\n        self.ensureHover(event);\n      });\n    });\n\n  });\n\n\n  /**\n   * We make sure that drag.out is always fired, even if the\n   * browser swallows an element.out event.\n   *\n   * Event sequence:\n   *\n   * drag.hover\n   * (element.out >> sometimes swallowed)\n   * element.hover >> ensure we fired drag.out\n   */\n  eventBus.on('drag.init', function() {\n\n    var hover, hoverGfx;\n\n    function setDragHover(event) {\n      hover = event.hover;\n      hoverGfx = event.hoverGfx;\n    }\n\n    function unsetHover() {\n      hover = null;\n      hoverGfx = null;\n    }\n\n    function ensureOut() {\n\n      if (!hover) {\n        return;\n      }\n\n      var element = hover,\n          gfx = hoverGfx;\n\n      hover = null;\n      hoverGfx = null;\n\n      // emit synthetic out event\n      dragging.out({\n        element: element,\n        gfx: gfx\n      });\n    }\n\n    eventBus.on('drag.hover', setDragHover);\n    eventBus.on('element.out', unsetHover);\n    eventBus.on('element.hover', HIGH_PRIORITY, ensureOut);\n\n    eventBus.once('drag.cleanup', function() {\n      eventBus.off('drag.hover', setDragHover);\n      eventBus.off('element.out', unsetHover);\n      eventBus.off('element.hover', ensureOut);\n    });\n\n  });\n\n\n  /**\n   * Make sure we are god damn hovering!\n   *\n   * @param {Event} dragging event\n   */\n  this.ensureHover = function(event) {\n\n    if (event.hover) {\n      return;\n    }\n\n    var originalEvent = event.originalEvent,\n        position,\n        target,\n        element,\n        gfx;\n\n    if (!(originalEvent instanceof MouseEvent)) {\n      return;\n    }\n\n    position = toPoint(originalEvent);\n\n    // damn expensive operation, ouch!\n    target = document.elementFromPoint(position.x, position.y);\n\n    gfx = getGfx(target);\n\n    if (gfx) {\n      element = elementRegistry.get(gfx);\n\n      dragging.hover({ element: element, gfx: gfx });\n    }\n  };\n\n}\n\nHoverFix.$inject = [\n  'eventBus',\n  'dragging',\n  'elementRegistry'\n];\n\n\n// helpers /////////////////////\n\nfunction getGfx(target) {\n  return domClosest(target, 'svg, .djs-element', true);\n}","import SelectionModule from '../selection';\n\nimport Dragging from './Dragging';\nimport HoverFix from './HoverFix';\n\nexport default {\n  __init__: [\n    'hoverFix'\n  ],\n  __depends__: [\n    SelectionModule\n  ],\n  dragging: [ 'type', Dragging ],\n  hoverFix: [ 'type', HoverFix ]\n};","/**\n * A service that provides rules for certain diagram actions.\n *\n * The default implementation will hook into the {@link CommandStack}\n * to perform the actual rule evaluation. Make sure to provide the\n * `commandStack` service with this module if you plan to use it.\n *\n * Together with this implementation you may use the {@link RuleProvider}\n * to implement your own rule checkers.\n *\n * This module is ment to be easily replaced, thus the tiny foot print.\n *\n * @param {Injector} injector\n */\nexport default function Rules(injector) {\n  this._commandStack = injector.get('commandStack', false);\n}\n\nRules.$inject = [ 'injector' ];\n\n\n/**\n * Returns whether or not a given modeling action can be executed\n * in the specified context.\n *\n * This implementation will respond with allow unless anyone\n * objects.\n *\n * @param {String} action the action to be checked\n * @param {Object} [context] the context to check the action in\n *\n * @return {Boolean} returns true, false or null depending on whether the\n *                   operation is allowed, not allowed or should be ignored.\n */\nRules.prototype.allowed = function(action, context) {\n  var allowed = true;\n\n  var commandStack = this._commandStack;\n\n  if (commandStack) {\n    allowed = commandStack.canExecute(action, context);\n  }\n\n  // map undefined to true, i.e. no rules\n  return allowed === undefined ? true : allowed;\n};","import Rules from './Rules';\n\nexport default {\n  __init__: [ 'rules' ],\n  rules: [ 'type', Rules ]\n};\n","function __stopPropagation(event) {\n  if (!event || typeof event.stopPropagation !== 'function') {\n    return;\n  }\n\n  event.stopPropagation();\n}\n\n\nexport function getOriginal(event) {\n  return event.originalEvent || event.srcEvent;\n}\n\n\nexport function stopPropagation(event, immediate) {\n  __stopPropagation(event, immediate);\n  __stopPropagation(getOriginal(event), immediate);\n}\n\n\nexport function toPoint(event) {\n\n  if (event.pointers && event.pointers.length) {\n    event = event.pointers[0];\n  }\n\n  if (event.touches && event.touches.length) {\n    event = event.touches[0];\n  }\n\n  return event ? {\n    x: event.clientX,\n    y: event.clientY\n  } : null;\n}","var abs = Math.abs,\n    round = Math.round;\n\n\n/**\n * Snap value to a collection of reference values.\n *\n * @param  {Number} value\n * @param  {Array<Number>} values\n * @param  {Number} [tolerance=10]\n *\n * @return {Number} the value we snapped to or null, if none snapped\n */\nexport function snapTo(value, values, tolerance) {\n  tolerance = tolerance === undefined ? 10 : tolerance;\n\n  var idx, snapValue;\n\n  for (idx = 0; idx < values.length; idx++) {\n    snapValue = values[idx];\n\n    if (abs(snapValue - value) <= tolerance) {\n      return snapValue;\n    }\n  }\n}\n\n\nexport function topLeft(bounds) {\n  return {\n    x: bounds.x,\n    y: bounds.y\n  };\n}\n\nexport function topRight(bounds) {\n  return {\n    x: bounds.x + bounds.width,\n    y: bounds.y\n  };\n}\n\nexport function bottomLeft(bounds) {\n  return {\n    x: bounds.x,\n    y: bounds.y + bounds.height\n  };\n}\n\nexport function bottomRight(bounds) {\n  return {\n    x: bounds.x + bounds.width,\n    y: bounds.y + bounds.height\n  };\n}\n\nexport function mid(bounds, defaultValue) {\n\n  if (!bounds || isNaN(bounds.x) || isNaN(bounds.y)) {\n    return defaultValue;\n  }\n\n  return {\n    x: round(bounds.x + bounds.width / 2),\n    y: round(bounds.y + bounds.height / 2)\n  };\n}\n\n\n/**\n * Retrieve the snap state of the given event.\n *\n * @param  {Event} event\n * @param  {String} axis\n *\n * @return {Boolean} the snapped state\n *\n */\nexport function isSnapped(event, axis) {\n  var snapped = event.snapped;\n\n  if (!snapped) {\n    return false;\n  }\n\n  if (typeof axis === 'string') {\n    return snapped[axis];\n  }\n\n  return snapped.x && snapped.y;\n}\n\n\n/**\n * Set the given event as snapped.\n *\n * This method may change the x and/or y position of the shape\n * from the given event!\n *\n * @param {Event} event\n * @param {String} axis\n * @param {Number|Boolean} value\n *\n * @return {Number} old value\n */\nexport function setSnapped(event, axis, value) {\n  if (typeof axis !== 'string') {\n    throw new Error('axis must be in [x, y]');\n  }\n\n  if (typeof value !== 'number' && value !== false) {\n    throw new Error('value must be Number or false');\n  }\n\n  var delta,\n      previousValue = event[axis];\n\n  var snapped = event.snapped = (event.snapped || {});\n\n\n  if (value === false) {\n    snapped[axis] = false;\n  } else {\n    snapped[axis] = true;\n\n    delta = value - previousValue;\n\n    event[axis] += delta;\n    event['d' + axis] += delta;\n  }\n\n  return previousValue;\n}\n\n/**\n * Get children of a shape.\n *\n * @param {djs.model.Shape} parent\n *\n * @returns {Array<djs.model.Shape|djs.model.Connection>}\n */\nexport function getChildren(parent) {\n  return parent.children || [];\n}","import { isArray } from 'min-dash';\r\n\r\n/**\r\n * Returns true if event was triggered with any modifier\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function hasModifier(event) {\r\n  return (event.ctrlKey || event.metaKey || event.shiftKey || event.altKey);\r\n}\r\n\r\n/**\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function isCmd(event) {\r\n\r\n  // ensure we don't react to AltGr\r\n  // (mapped to CTRL + ALT)\r\n  if (event.altKey) {\r\n    return false;\r\n  }\r\n\r\n  return event.ctrlKey || event.metaKey;\r\n}\r\n\r\n/**\r\n * Checks if key pressed is one of provided keys.\r\n *\r\n * @param {String|String[]} keys\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function isKey(keys, event) {\r\n  keys = isArray(keys) ? keys : [ keys ];\r\n\r\n  return keys.indexOf(event.key) > -1;\r\n}\r\n\r\n/**\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function isShift(event) {\r\n  return event.shiftKey;\r\n}","/**\n * Computes the distance between two points\n *\n * @param  {Point}  p\n * @param  {Point}  q\n *\n * @return {Number}  distance\n */\nexport function pointDistance(a, b) {\n  if (!a || !b) {\n    return -1;\n  }\n\n  return Math.sqrt(\n    Math.pow(a.x - b.x, 2) +\n    Math.pow(a.y - b.y, 2)\n  );\n}\n\n\n/**\n * Returns true if the point r is on the line between p and q\n *\n * @param  {Point}  p\n * @param  {Point}  q\n * @param  {Point}  r\n * @param  {Number} [accuracy=5] accuracy for points on line check (lower is better)\n *\n * @return {Boolean}\n */\nexport function pointsOnLine(p, q, r, accuracy) {\n\n  if (typeof accuracy === 'undefined') {\n    accuracy = 5;\n  }\n\n  if (!p || !q || !r) {\n    return false;\n  }\n\n  var val = (q.x - p.x) * (r.y - p.y) - (q.y - p.y) * (r.x - p.x),\n      dist = pointDistance(p, q);\n\n  // @see http://stackoverflow.com/a/907491/412190\n  return Math.abs(val / dist) <= accuracy;\n}\n\n\nvar ALIGNED_THRESHOLD = 2;\n\n/**\n * Returns whether two points are in a horizontal or vertical line.\n *\n * @param {Point} a\n * @param {Point} b\n *\n * @return {String|Boolean} returns false if the points are not\n *                          aligned or 'h|v' if they are aligned\n *                          horizontally / vertically.\n */\nexport function pointsAligned(a, b) {\n  if (Math.abs(a.x - b.x) <= ALIGNED_THRESHOLD) {\n    return 'v';\n  }\n\n  if (Math.abs(a.y - b.y) <= ALIGNED_THRESHOLD) {\n    return 'h';\n  }\n\n  return false;\n}\n\n\n/**\n * Returns true if the point p is inside the rectangle rect\n *\n * @param  {Point}  p\n * @param  {Rect}   rect\n * @param  {Number} tolerance\n *\n * @return {Boolean}\n */\nexport function pointInRect(p, rect, tolerance) {\n  tolerance = tolerance || 0;\n\n  return p.x > rect.x - tolerance &&\n         p.y > rect.y - tolerance &&\n         p.x < rect.x + rect.width + tolerance &&\n         p.y < rect.y + rect.height + tolerance;\n}\n\n/**\n * Returns a point in the middle of points p and q\n *\n * @param  {Point}  p\n * @param  {Point}  q\n *\n * @return {Point} middle point\n */\nexport function getMidPoint(p, q) {\n  return {\n    x: Math.round(p.x + ((q.x - p.x) / 2.0)),\n    y: Math.round(p.y + ((q.y - p.y) / 2.0))\n  };\n}\n","import {\n  getOriginal as getOriginalEvent\n} from './Event';\n\nimport {\n  isMac\n} from './Platform';\n\nexport {\n  isMac\n} from './Platform';\n\n\nexport function isPrimaryButton(event) {\n  // button === 0 -> left ka primary mouse button\n  return !(getOriginalEvent(event) || event).button;\n}\n\nexport function hasPrimaryModifier(event) {\n  var originalEvent = getOriginalEvent(event) || event;\n\n  if (!isPrimaryButton(event)) {\n    return false;\n  }\n\n  // Use alt as primary modifier key for mac OS\n  if (isMac()) {\n    return originalEvent.metaKey;\n  } else {\n    return originalEvent.ctrlKey;\n  }\n}\n\n\nexport function hasSecondaryModifier(event) {\n  var originalEvent = getOriginalEvent(event) || event;\n\n  return isPrimaryButton(event) && originalEvent.shiftKey;\n}","export function isMac() {\n  return (/mac/i).test(navigator.platform);\n}","export function center(bounds) {\n  return {\n    x: bounds.x + (bounds.width / 2),\n    y: bounds.y + (bounds.height / 2)\n  };\n}\n\n\nexport function delta(a, b) {\n  return {\n    x: a.x - b.x,\n    y: a.y - b.y\n  };\n}","import AddExporter from './add-exporter';\n\nexport default {\n  __init__: [ AddExporter ]\n};","import { assign } from 'min-dash';\nimport inherits from 'inherits';\n\nimport Refs from 'object-refs';\n\nvar parentRefs = new Refs({ name: 'children', enumerable: true, collection: true }, { name: 'parent' }),\n    labelRefs = new Refs({ name: 'labels', enumerable: true, collection: true }, { name: 'labelTarget' }),\n    attacherRefs = new Refs({ name: 'attachers', collection: true }, { name: 'host' }),\n    outgoingRefs = new Refs({ name: 'outgoing', collection: true }, { name: 'source' }),\n    incomingRefs = new Refs({ name: 'incoming', collection: true }, { name: 'target' });\n\n/**\n * @namespace djs.model\n */\n\n/**\n * @memberOf djs.model\n */\n\n/**\n * The basic graphical representation\n *\n * @class\n *\n * @abstract\n */\nexport function Base() {\n\n  /**\n   * The object that backs up the shape\n   *\n   * @name Base#businessObject\n   * @type Object\n   */\n  Object.defineProperty(this, 'businessObject', {\n    writable: true\n  });\n\n\n  /**\n   * Single label support, will mapped to multi label array\n   *\n   * @name Base#label\n   * @type Object\n   */\n  Object.defineProperty(this, 'label', {\n    get: function() {\n      return this.labels[0];\n    },\n    set: function(newLabel) {\n\n      var label = this.label,\n          labels = this.labels;\n\n      if (!newLabel && label) {\n        labels.remove(label);\n      } else {\n        labels.add(newLabel, 0);\n      }\n    }\n  });\n\n  /**\n   * The parent shape\n   *\n   * @name Base#parent\n   * @type Shape\n   */\n  parentRefs.bind(this, 'parent');\n\n  /**\n   * The list of labels\n   *\n   * @name Base#labels\n   * @type Label\n   */\n  labelRefs.bind(this, 'labels');\n\n  /**\n   * The list of outgoing connections\n   *\n   * @name Base#outgoing\n   * @type Array<Connection>\n   */\n  outgoingRefs.bind(this, 'outgoing');\n\n  /**\n   * The list of incoming connections\n   *\n   * @name Base#incoming\n   * @type Array<Connection>\n   */\n  incomingRefs.bind(this, 'incoming');\n}\n\n\n/**\n * A graphical object\n *\n * @class\n * @constructor\n *\n * @extends Base\n */\nexport function Shape() {\n  Base.call(this);\n\n  /**\n   * Indicates frame shapes\n   *\n   * @name Shape#isFrame\n   * @type Boolean\n   */\n\n  /**\n   * The list of children\n   *\n   * @name Shape#children\n   * @type Array<Base>\n   */\n  parentRefs.bind(this, 'children');\n\n  /**\n   * @name Shape#host\n   * @type Shape\n   */\n  attacherRefs.bind(this, 'host');\n\n  /**\n   * @name Shape#attachers\n   * @type Shape\n   */\n  attacherRefs.bind(this, 'attachers');\n}\n\ninherits(Shape, Base);\n\n\n/**\n * A root graphical object\n *\n * @class\n * @constructor\n *\n * @extends Shape\n */\nexport function Root() {\n  Shape.call(this);\n}\n\ninherits(Root, Shape);\n\n\n/**\n * A label for an element\n *\n * @class\n * @constructor\n *\n * @extends Shape\n */\nexport function Label() {\n  Shape.call(this);\n\n  /**\n   * The labeled element\n   *\n   * @name Label#labelTarget\n   * @type Base\n   */\n  labelRefs.bind(this, 'labelTarget');\n}\n\ninherits(Label, Shape);\n\n\n/**\n * A connection between two elements\n *\n * @class\n * @constructor\n *\n * @extends Base\n */\nexport function Connection() {\n  Base.call(this);\n\n  /**\n   * The element this connection originates from\n   *\n   * @name Connection#source\n   * @type Base\n   */\n  outgoingRefs.bind(this, 'source');\n\n  /**\n   * The element this connection points to\n   *\n   * @name Connection#target\n   * @type Base\n   */\n  incomingRefs.bind(this, 'target');\n}\n\ninherits(Connection, Base);\n\n\nvar types = {\n  connection: Connection,\n  shape: Shape,\n  label: Label,\n  root: Root\n};\n\n/**\n * Creates a new model element of the specified type\n *\n * @method create\n *\n * @example\n *\n * var shape1 = Model.create('shape', { x: 10, y: 10, width: 100, height: 100 });\n * var shape2 = Model.create('shape', { x: 210, y: 210, width: 100, height: 100 });\n *\n * var connection = Model.create('connection', { waypoints: [ { x: 110, y: 55 }, {x: 210, y: 55 } ] });\n *\n * @param  {String} type lower-cased model name\n * @param  {Object} attrs attributes to initialize the new model instance with\n *\n * @return {Base} the new model instance\n */\nexport function create(type, attrs) {\n  var Type = types[type];\n  if (!Type) {\n    throw new Error('unknown type: <' + type + '>');\n  }\n  return assign(new Type(), attrs);\n}","import {\n  query as domQuery\n} from 'min-dom';\n\n/**\n * SVGs for elements are generated by the {@link GraphicsFactory}.\n *\n * This utility gives quick access to the important semantic\n * parts of an element.\n */\n\n/**\n * Returns the visual part of a diagram element\n *\n * @param {Snap<SVGElement>} gfx\n *\n * @return {Snap<SVGElement>}\n */\nexport function getVisual(gfx) {\n  return domQuery('.djs-visual', gfx);\n}\n\n/**\n * Returns the children for a given diagram element.\n *\n * @param {Snap<SVGElement>} gfx\n * @return {Snap<SVGElement>}\n */\nexport function getChildren(gfx) {\n  return gfx.parentNode.childNodes[1];\n}","/**\n * Remove from the beginning of a collection until it is empty.\n *\n * This is a null-safe operation that ensures elements\n * are being removed from the given collection until the\n * collection is empty.\n *\n * The implementation deals with the fact that a remove operation\n * may touch, i.e. remove multiple elements in the collection\n * at a time.\n *\n * @param {Array<Object>} [collection]\n * @param {Function} removeFn\n *\n * @return {Array<Object>} the cleared collection\n */\nexport function saveClear(collection, removeFn) {\n\n  if (typeof removeFn !== 'function') {\n    throw new Error('removeFn iterator must be a function');\n  }\n\n  if (!collection) {\n    return;\n  }\n\n  var e;\n\n  while ((e = collection[0])) {\n    removeFn(e);\n  }\n\n  return collection;\n}\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\n/**\n * Create a linkified and HTML escaped entry field description.\n *\n * As a special feature, this description may contain both markdown,\n * plain <a href> links and <br />\n *\n * @param {String} description\n */\nmodule.exports = function entryFieldDescription(description) {\n\n  // we tokenize the description to extract text, HTML and markdown links\n  // text, links and new lines are handled seperately\n\n  var escaped = [];\n\n  // match markdown [{TEXT}]({URL}) and HTML links <a href=\"{URL}\">{TEXT}</a>\n  var pattern = /(?:\\[([^\\]]+)\\]\\((https?:\\/\\/[^)]+)\\))|(?:<a href=\"(https?:\\/\\/[^\"]+)\">(.+?(?=<\\/))<\\/a>)/gi;\n\n  var index = 0;\n  var match;\n  var link, text;\n\n  while ((match = pattern.exec(description))) {\n\n    // escape + insert text before match\n    if (match.index > index) {\n      escaped.push(escapeText(description.substring(index, match.index)));\n    }\n\n    link = match[2] && encodeURI(match[2]) || match[3];\n    text = match[1] || match[4];\n\n    // insert safe link\n    escaped.push('<a href=\"' + link + '\" target=\"_blank\">' + escapeText(text) + '</a>');\n\n    index = match.index + match[0].length;\n  }\n\n  // escape and insert text after last match\n  if (index < description.length) {\n    escaped.push(escapeText(description.substring(index)));\n  }\n\n  return '<div class=\"cpp-field-description\">' + escaped.join('') + '</div>';\n};\n\nfunction escapeText(text) {\n  var match, index = 0, escaped = [];\n\n  // match new line <br/> <br /> <br.... /> etc.\n  var pattern = /<br\\s*\\/?>/gi;\n\n  while ((match = pattern.exec(text))) {\n\n    if (match.index > index) {\n      escaped.push(escapeHTML(text.substring(index, match.index)));\n    }\n\n    escaped.push('<br />');\n\n    index = match.index + match[0].length;\n  }\n\n  if (index < text.length) {\n    escaped.push(escapeHTML(text.substring(index)));\n  }\n\n  return escaped.join('');\n}\n","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  closest as domClosest\n} from 'min-dom';\n\nvar LOW_PRIORITY = 250;\n\n/**\n * The tool manager acts as middle-man between the available tool's and the Palette,\n * it takes care of making sure that the correct active state is set.\n *\n * @param  {Object}    eventBus\n * @param  {Object}    dragging\n */\nexport default function ToolManager(eventBus, dragging) {\n  this._eventBus = eventBus;\n  this._dragging = dragging;\n\n  this._tools = [];\n  this._active = null;\n}\n\nToolManager.$inject = [ 'eventBus', 'dragging' ];\n\nToolManager.prototype.registerTool = function(name, events) {\n  var tools = this._tools;\n\n  if (!events) {\n    throw new Error('A tool has to be registered with it\\'s \"events\"');\n  }\n\n  tools.push(name);\n\n  this.bindEvents(name, events);\n};\n\nToolManager.prototype.isActive = function(tool) {\n  return tool && this._active === tool;\n};\n\nToolManager.prototype.length = function(tool) {\n  return this._tools.length;\n};\n\nToolManager.prototype.setActive = function(tool) {\n  var eventBus = this._eventBus;\n\n  if (this._active !== tool) {\n    this._active = tool;\n\n    eventBus.fire('tool-manager.update', { tool: tool });\n  }\n};\n\nToolManager.prototype.bindEvents = function(name, events) {\n  var eventBus = this._eventBus,\n      dragging = this._dragging;\n\n  var eventsToRegister = [];\n\n  eventBus.on(events.tool + '.init', function(event) {\n    var context = event.context;\n\n    // Active tools that want to reactivate themselves must do this explicitly\n    if (!context.reactivate && this.isActive(name)) {\n      this.setActive(null);\n\n      dragging.cancel();\n      return;\n    }\n\n    this.setActive(name);\n\n  }, this);\n\n  // Todo[ricardo]: add test cases\n  forEach(events, function(event) {\n    eventsToRegister.push(event + '.ended');\n    eventsToRegister.push(event + '.canceled');\n  });\n\n  eventBus.on(eventsToRegister, LOW_PRIORITY, function(event) {\n    var originalEvent = event.originalEvent;\n\n    // We defer the de-activation of the tool to the .activate phase,\n    // so we're able to check if we want to toggle off the current\n    // active tool or switch to a new one\n    if (!this._active) {\n      return;\n    }\n\n    if (originalEvent && domClosest(originalEvent.target, '.group[data-group=\"tools\"]')) {\n      return;\n    }\n\n    this.setActive(null);\n  }, this);\n};\n","import DraggingModule from '../dragging';\n\nimport ToolManager from './ToolManager';\n\nexport default {\n  __depends__: [\n    DraggingModule\n  ],\n  __init__: [ 'toolManager' ],\n  toolManager: [ 'type', ToolManager ]\n};\n","import {\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\n\nexport function componentsToPath(elements) {\n  return elements.join(',').replace(/,?([A-z]),?/g, '$1');\n}\n\nexport function toSVGPoints(points) {\n  var result = '';\n\n  for (var i = 0, p; (p = points[i]); i++) {\n    result += p.x + ',' + p.y + ' ';\n  }\n\n  return result;\n}\n\nexport function createLine(points, attrs) {\n\n  var line = svgCreate('polyline');\n  svgAttr(line, { points: toSVGPoints(points) });\n\n  if (attrs) {\n    svgAttr(line, attrs);\n  }\n\n  return line;\n}\n\nexport function updateLine(gfx, points) {\n  svgAttr(gfx, { points: toSVGPoints(points) });\n\n  return gfx;\n}\n","'use strict';\n\nvar is = require('../util/ModelUtil').is;\nvar assign = require('min-dash').assign;\n\nvar DEFAULT_LABEL_SIZE = module.exports.DEFAULT_LABEL_SIZE = {\n  width: 90,\n  height: 20\n};\n\n\n/**\n * Returns true if the given semantic has an external label\n *\n * @param {CmmnElement} semantic\n * @return {Boolean} true if has label\n */\nmodule.exports.hasExternalLabel = function(semantic) {\n\n  if (is(semantic, 'cmmn:PlanItem') || is(semantic, 'cmmn:DiscretionaryItem')) {\n    semantic = semantic.definitionRef;\n  }\n\n  if (is(semantic, 'cmmndi:CMMNEdge') && semantic.cmmnElementRef) {\n\n    if (is(semantic.cmmnElementRef, 'cmmn:OnPart')) {\n      semantic = semantic.cmmnElementRef;\n    }\n\n  }\n\n  return is(semantic, 'cmmn:EventListener') ||\n         is(semantic, 'cmmn:OnPart') ||\n         is(semantic, 'cmmn:CaseFileItem');\n};\n\n/**\n * Get the middle of a number of waypoints\n *\n * @param  {Array<Point>} waypoints\n * @return {Point} the mid point\n */\nvar getWaypointsMid = module.exports.getWaypointsMid = function(waypoints) {\n\n  var mid = waypoints.length / 2 - 1;\n\n  var first = waypoints[Math.floor(mid)];\n  var second = waypoints[Math.ceil(mid + 0.01)];\n\n  return {\n    x: first.x + (second.x - first.x) / 2,\n    y: first.y + (second.y - first.y) / 2\n  };\n};\n\n\nvar getExternalLabelMid = module.exports.getExternalLabelMid = function(element) {\n\n  var bo = element.businessObject,\n      di = bo.di;\n\n  if (!di && is(bo, 'cmmndi:CMMNEdge') && bo.cmmnElementRef) {\n    di = bo;\n  }\n\n  if (bo && di && di.waypoint) {\n    return getWaypointsMid(di.waypoint);\n  } else {\n    return {\n      x: element.x + element.width / 2,\n      y: element.y + element.height + DEFAULT_LABEL_SIZE.height / 2\n    };\n  }\n};\n\n/**\n * Returns the bounds of an elements label, parsed from the elements DI or\n * generated from its bounds.\n *\n * @param {CmmnElement} semantic\n * @param {djs.model.Base} element\n */\nmodule.exports.getExternalLabelBounds = function(semantic, element) {\n\n  var mid,\n      size,\n      bounds,\n      di = semantic.di || semantic,\n      label = di.label;\n\n  if (label && label.bounds) {\n    bounds = label.bounds;\n\n    size = {\n      width: Math.max(DEFAULT_LABEL_SIZE.width, bounds.width),\n      height: bounds.height\n    };\n\n    mid = {\n      x: bounds.x + bounds.width / 2,\n      y: bounds.y + bounds.height / 2\n    };\n  } else {\n\n    mid = getExternalLabelMid(element);\n\n    size = DEFAULT_LABEL_SIZE;\n  }\n\n  return assign({\n    x: mid.x - size.width / 2,\n    y: mid.y - size.height / 2\n  }, size);\n};\n\nvar hasLabelBounds = module.exports.hasLabelBounds = function(semantic) {\n  return semantic && semantic.di && semantic.di.label && semantic.di.label.bounds;\n};\n\nmodule.exports.getLabelBounds = function(semantic) {\n  if (hasLabelBounds(semantic)) {\n    return semantic.di.label.bounds;\n  }\n};","import {\n  classes as domClasses\n} from 'min-dom';\n\nvar CURSOR_CLS_PATTERN = /^djs-cursor-.*$/;\n\n\nexport function set(mode) {\n  var classes = domClasses(document.body);\n\n  classes.removeMatching(CURSOR_CLS_PATTERN);\n\n  if (mode) {\n    classes.add('djs-cursor-' + mode);\n  }\n}\n\nexport function unset() {\n  set(null);\n}\n\nexport function has(mode) {\n  var classes = domClasses(document.body);\n\n  return classes.has('djs-cursor-' + mode);\n}\n","'use strict';\n\nvar is = require('../../util/ModelUtil').is;\nvar isAny = require('../modeling/util/ModelingUtil').isAny;\n\nvar getBusinessObject = require('../../util/ModelUtil').getBusinessObject;\n\nfunction getLabelAttr(element) {\n  if (is(element, 'cmmn:TextAnnotation')) {\n    return 'text';\n  }\n\n  return 'name';\n}\n\nfunction getSemantic(element) {\n  var bo = getBusinessObject(element);\n\n  if (is(bo, 'cmmndi:CMMNEdge') && bo.cmmnElementRef) {\n    bo = bo.cmmnElementRef;\n  }\n\n  return bo;\n}\n\n/**\n * Check if the given element is of a type which has a reference to a definition.\n * This could be either plan items or discretionary items or case file items.\n *\n * @param {djs.model.Base} element\n *\n * @return {Boolean}\n */\nvar isReferencing = function(element) {\n  return isAny(element, [\n    'cmmn:PlanItem',\n    'cmmn:DiscretionaryItem',\n    'cmmn:CaseFileItem'\n  ]);\n};\n\nfunction hasEditableLabel(element) {\n  return !isAny(element, [\n    'cmmn:Association',\n    'cmmn:Criterion',\n    'cmmndi:CMMNEdge'\n  ]);\n}\n\nvar getLabel = function(element) {\n\n  var semantic = getSemantic(element),\n      attr = getLabelAttr(semantic);\n\n  if (!hasEditableLabel(semantic)) {\n    return;\n  }\n\n  // Get definition as semantic if\n  // * the element has no name property set\n  // * the element type has a reference to a definition\n  if (!semantic[attr] && isReferencing(element)) {\n    semantic = semantic.definitionRef;\n  }\n\n  return semantic[attr] || '';\n};\n\nmodule.exports.getLabel = getLabel;\n\n\nvar setLabel = function(element, text, isExternal, isExclusiveRef) {\n\n  var semantic = getSemantic(element),\n      attr = getLabelAttr(semantic);\n\n  // Get definition as semantic if\n  // * the element has no name property set\n  // * the element type has a reference to a definition\n  // * the element is the only reference to a defition\n  if (!semantic[attr] && isReferencing(element) && isExclusiveRef) {\n    semantic = semantic.definitionRef;\n  }\n\n  semantic[attr] = text;\n\n  // show external label if not empty\n  if (isExternal) {\n    element.hidden = !text;\n  }\n\n  return element;\n};\n\nmodule.exports.setLabel = setLabel;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    isIdValid = require('../../../../Utils').isIdValid,\n    getBusinessObject = require('cmmn-js/lib/util/ModelUtil').getBusinessObject;\n\nmodule.exports = function(element, options) {\n\n  options = options || {};\n\n  var id = options.id,\n      reference = options.reference,\n      label = options.label;\n\n  // Id\n  var idEntry = entryFactory.validationAwareTextField({\n\n    id: id || 'id',\n    label: label || 'Id',\n    modelProperty: 'id',\n    reference: reference,\n\n    get: options.get,\n\n    set: options.set,\n\n    validate: function(element, values) {\n      var idValue = values.id,\n          bo = getBusinessObject(element);\n\n      bo = (reference && reference === '$parent') ? bo.$parent : bo.get(reference) || bo;\n\n      var idError = isIdValid(bo, idValue);\n\n      return idError ? { id: idError } : {};\n    }\n\n  });\n\n  return [ idEntry ];\n\n};\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\n/**\n * Create an entry to modify the name of an an element.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} options\n * @param  {string} options.id the id of the entry\n * @param  {string} options.label the label of the entry\n *\n * @return {Array<Object>} return an array containing\n *                         the entry to modify the name\n */\nmodule.exports = function(element, options) {\n\n  options = options || {};\n\n  var id = options.id || 'name',\n      label = options.label || 'Name',\n      modelProperty = options.modelProperty || 'name',\n      reference = options.reference;\n\n  var nameEntry = entryFactory.textBox({\n    id: id,\n    label: label,\n    modelProperty: modelProperty,\n    reference: reference,\n    get: options.get,\n    set: options.set,\n    validate: options.validate\n  });\n\n  return [ nameEntry ];\n\n};\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar isOnPartConnection = require('../../../../helper/CmmnElementHelper').isOnPartConnection;\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getStandardEvents = ModelUtil.getStandardEvents,\n    getTransitions = ModelUtil.getTransitions;\n\nvar forEach = require('lodash/forEach');\n\n\nmodule.exports = function(element, options) {\n\n\n  function getOptions(element, exclude) {\n\n    var events,\n        options = [];\n\n    exclude = exclude || [];\n    if (typeof exclude === 'string') {\n      exclude = [ exclude ];\n    }\n\n    if (!isOnPartConnection(element)) {\n      events = getTransitions(element);\n    }\n    else {\n      events = getStandardEvents(element);\n    }\n\n    forEach(events, function(e) {\n      if (exclude.indexOf(e) === -1) {\n        options.push({ name: e, value: e });\n      }\n    });\n\n    return options;\n  }\n\n\n  options = options || {};\n\n\n  var id = options.id,\n      label = options.label,\n      modelProperty = options.modelProperty,\n      reference = options.reference,\n      getter = options.get,\n      setter = options.set,\n      exclude = options.exclude,\n      validator = options.validate,\n      disabled = options.disabled,\n      emptyParameter = options.emptyParameter;\n\n\n  var transitionEntry = entryFactory.selectBox({\n\n    id: id || 'transition',\n    label: label || 'Transition',\n    modelProperty: modelProperty || 'transition',\n    reference: reference,\n    selectOptions: getOptions(element, exclude),\n    get: getter || function(element, node, bo) {\n      var res = {};\n      res[modelProperty] = (bo && bo.get(modelProperty)) || '';\n      return res;\n    },\n    set: setter,\n    validate: validator,\n    disabled: disabled,\n    emptyParameter: emptyParameter !== false,\n    hideEntry: options.hideEntry\n\n  });\n\n  return [ transitionEntry ];\n\n};\n","'use strict';\n\nvar cmdHelper = require('./CmdHelper');\n\nvar is = require('cmmn-js/lib/util/ModelUtil').is;\n\nvar ExtensionElementsHelper = {};\n\nvar getExtensionElements = function(bo) {\n  return bo.get('extensionElements');\n};\n\nExtensionElementsHelper.getExtensionElements = function(bo, type) {\n  var extensionElements = getExtensionElements(bo);\n  if (typeof extensionElements !== 'undefined') {\n    var extensionValues = extensionElements.get('values');\n    if (typeof extensionValues !== 'undefined') {\n      var elements = extensionValues.filter(function(value) {\n        return is(value, type);\n      });\n      if (elements.length) {\n        return elements;\n      }\n    }\n  }\n};\n\nExtensionElementsHelper.removeEntry = function(bo, element, entry) {\n  var extensionElements = bo.get('extensionElements');\n\n  if (!extensionElements) {\n    // return an empty command when there is no extensionElements list\n    return {};\n  }\n\n  return cmdHelper.removeElementsFromList(element, extensionElements, 'values', 'extensionElements', [entry]);\n};\n\nmodule.exports = ExtensionElementsHelper;\n","'use strict';\n\nvar escapeHTML = require('../../../../Utils').escapeHTML;\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getBusinessObject = ModelUtil.getBusinessObject,\n    isCasePlanModel = ModelUtil.isCasePlanModel;\n\nvar domQuery = require('min-dom').query,\n    domClosest = require('min-dom').closest,\n    domify = require('min-dom').domify,\n    forEach = require('lodash/forEach');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    utils = require('../../../../Utils');\n\nfunction getSelectBox(node, id) {\n  var currentTab = domClosest(node, 'div.cpp-properties-tab');\n  var query = 'select[name=selectedExtensionElement]' + (id ? '[id=cam-extensionElements-' + id + ']' : '');\n  return domQuery(query, currentTab);\n}\n\nfunction getSelected(node, id) {\n  var selectBox = getSelectBox(node, id);\n  return {\n    value: (selectBox || {}).value,\n    idx: (selectBox || {}).selectedIndex\n  };\n}\n\nfunction generateElementId(prefix) {\n  prefix = prefix + '_';\n  return utils.nextId(prefix);\n}\n\nvar CREATE_EXTENSION_ELEMENT_ACTION = 'create-extension-element',\n    REMOVE_EXTENSION_ELEMENT_ACTION = 'remove-extension-element';\n\nmodule.exports = function(element, cmmnFactory, options) {\n\n  var id = options.id,\n      prefix = options.prefix || 'elem',\n      label = options.label || id,\n      reference = options.reference,\n      idGeneration = (options.idGeneration === false) ? options.idGeneration : true;\n\n  var modelProperty = options.modelProperty || 'id';\n\n  var getElements = options.getExtensionElements;\n\n  var createElement = options.createExtensionElement,\n      canCreate = typeof createElement === 'function';\n\n  var removeElement = options.removeExtensionElement,\n      canRemove = typeof removeElement === 'function';\n\n  var onSelectionChange = options.onSelectionChange;\n\n  var hideElements = options.hideExtensionElements,\n      canBeHidden = typeof hideElements === 'function';\n\n  var setOptionLabelValue = options.setOptionLabelValue;\n\n  var defaultSize = options.size || 5,\n      resizable = options.resizable;\n\n  var selectionChanged = function(element, node, event, scope) {\n    if (typeof onSelectionChange === 'function') {\n      return onSelectionChange(element, node, event, scope);\n    }\n  };\n\n  var createOption = function(value) {\n    return '<option value=\"' + escapeHTML(value) + '\" data-value data-name=\"extensionElementValue\">' + escapeHTML(value) + '</option>';\n  };\n\n  var initSelectionSize = function(selectBox, optionsLength) {\n    if (resizable) {\n      selectBox.size = optionsLength > defaultSize ? optionsLength : defaultSize;\n    }\n  };\n\n  var getBO = function(element, reference) {\n    var bo = getBusinessObject(element);\n\n    if (reference) {\n      bo = bo && bo.get(reference);\n\n      if (!bo &&\n          isCasePlanModel(element) &&\n          reference === 'definitionRef') {\n        bo = getBusinessObject(element);\n      }\n    }\n\n    return bo;\n  };\n\n  return {\n    id: id,\n    html: '<div class=\"cpp-row cpp-element-list\" ' +\n            (canBeHidden ? 'data-show=\"hideElements\"' : '') + '>' +\n            '<label for=\"cam-extensionElements-' + escapeHTML(id) + '\">' + escapeHTML(label) + '</label>' +\n            '<div class=\"cpp-field-wrapper\">' +\n              '<select id=\"cam-extensionElements-' + escapeHTML(id) + '\"' +\n                      'name=\"selectedExtensionElement\" ' +\n                      'size=\"' + escapeHTML(defaultSize) + '\" ' +\n                      'data-list-entry-container ' +\n                      'data-on-change=\"selectElement\">' +\n              '</select>' +\n              (canCreate ? '<button class=\"add\" ' +\n                                   'id=\"cam-extensionElements-create-' + escapeHTML(id) + '\" ' +\n                                   'data-action=\"createElement\">' +\n                             '<span>+</span>' +\n                           '</button>' : '') +\n              (canRemove ? '<button class=\"clear\" ' +\n                                   'id=\"cam-extensionElements-remove-' + escapeHTML(id) + '\" ' +\n                                   'data-action=\"removeElement\" ' +\n                                   'data-disable=\"disableRemove\">' +\n                             '<span>-</span>' +\n                           '</button>' : '') +\n            '</div>' +\n          '</div>',\n\n    get: function(element, node) {\n      var elements = getElements(element, getBO(element, reference));\n\n      var result = [];\n      forEach(elements, function(elem) {\n        result.push({\n          extensionElementValue: elem.get(modelProperty)\n        });\n      });\n\n      var selectBox = getSelectBox(node.parentNode, id);\n      initSelectionSize(selectBox, result.length);\n\n      return result;\n    },\n\n    set: function(element, values, node) {\n      var action = this.__action;\n      delete this.__action;\n\n      var bo = getBO(element, reference);\n      var extensionElements = bo.get('extensionElements');\n\n      if (action.id === CREATE_EXTENSION_ELEMENT_ACTION) {\n        var commands = [];\n        if (!extensionElements) {\n          extensionElements = elementHelper.createElement('cmmn:ExtensionElements', { values: [] }, bo, cmmnFactory);\n          commands.push(cmdHelper.updateProperties(bo, { extensionElements: extensionElements }, element));\n        }\n        commands.push(createElement(element, extensionElements, action.value, bo));\n        return commands;\n\n      }\n      else if (action.id === REMOVE_EXTENSION_ELEMENT_ACTION) {\n        return removeElement(element, extensionElements, action.value, action.idx, bo);\n      }\n\n    },\n\n    createListEntryTemplate: function(value, index, selectBox) {\n      initSelectionSize(selectBox, selectBox.options.length + 1);\n      return createOption(value.extensionElementValue);\n    },\n\n    deselect: function(element, node) {\n      var selectBox = getSelectBox(node, id);\n      selectBox.selectedIndex = -1;\n    },\n\n    getSelected: function(element, node) {\n      return getSelected(node, id);\n    },\n\n    setControlValue: function(element, node, option, property, value, idx) {\n      node.value = value;\n\n      if (!setOptionLabelValue) {\n        node.text = value;\n      }\n      else {\n        var bo = getBO(element, reference);\n        setOptionLabelValue(element, node, option, property, value, idx, bo);\n      }\n    },\n\n    createElement: function(element, node) {\n      // create option template\n      var generatedId;\n      if (idGeneration) {\n        generatedId = generateElementId(prefix);\n      }\n\n      var selectBox = getSelectBox(node, id);\n      var template = domify(createOption(generatedId));\n\n      // add new empty option as last child element\n      selectBox.appendChild(template);\n\n      // select last child element\n      selectBox.lastChild.selected = 'selected';\n      selectionChanged(element, node);\n\n      // update select box size\n      initSelectionSize(selectBox, selectBox.options.length);\n\n      this.__action = {\n        id: CREATE_EXTENSION_ELEMENT_ACTION,\n        value: generatedId\n      };\n\n      return true;\n    },\n\n    removeElement: function(element, node) {\n      var selection = getSelected(node, id);\n\n      var selectBox = getSelectBox(node, id);\n      selectBox.removeChild(selectBox.options[selection.idx]);\n\n      // update select box size\n      initSelectionSize(selectBox, selectBox.options.length);\n\n      this.__action = {\n        id: REMOVE_EXTENSION_ELEMENT_ACTION,\n        value: selection.value,\n        idx: selection.idx\n      };\n\n      return true;\n    },\n\n    hideElements: function(element, entryNode, node, scopeNode) {\n      return !hideElements(element, entryNode, node, scopeNode);\n    },\n\n    disableRemove: function(element, entryNode, node, scopeNode) {\n      return (getSelected(entryNode, id) || {}).idx < 0;\n    },\n\n    selectElement: selectionChanged\n  };\n\n};\n","'use strict';\n\nvar ElementHelper = {};\nmodule.exports = ElementHelper;\n\n/**\n * Creates a new element and set the parent to it\n *\n * @method ElementHelper#createElement\n *\n * @param {String} elementType of the new element\n * @param {Object} properties of the new element in key-value pairs\n * @param {moddle.object} parent of the new element\n * @param {BpmnFactory} factory which creates the new element\n *\n * @returns {djs.model.Base} element which is created\n */\nElementHelper.createElement = function(elementType, properties, parent, factory) {\n  var element = factory.create(elementType, properties);\n  element.$parent = parent;\n\n  return element;\n};\n","'use strict';\n\nvar assign = require('lodash/assign'),\n    forEach = require('lodash/forEach');\n\nvar extensionElementsEntry = require('./ExtensionElements'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar getDefinition = require('cmmn-js/lib/util/ModelUtil').getDefinition,\n    getListenerType = require('../../../../helper/ListenerHelper').getListenerType;\n\nvar noop = function() {};\n\nvar LISTENER_TYPE_LABEL = {\n  class: 'Java Class',\n  expression: 'Expression',\n  delegateExpression: 'Delegate Expression',\n  script: 'Script'\n};\n\n\nmodule.exports = function(element, cmmnFactory, options) {\n\n  function createListener(type, attrs) {\n    return cmmnFactory.create(type, attrs);\n  }\n\n  function getListeners(bo, type) {\n    return extensionElementsHelper.getExtensionElements(bo, type) || [];\n  }\n\n  function getListener(bo, type, idx) {\n    var listeners = getListeners(bo, type);\n    return listeners[idx];\n  }\n\n\n  options = options || {};\n\n  var type = options.type,\n      id = options.id,\n      label = options.label,\n      isApplicable = options.isApplicable || false,\n      initialEvent = options.initialEvent || undefined,\n      entries = [],\n      listenerElementSiblings = [];\n\n\n  var listenerEntry,\n      register = noop,\n      getSelectedListener = noop;\n\n\n  if (isApplicable && isApplicable(element)) {\n\n    listenerEntry = extensionElementsEntry(element, cmmnFactory, {\n\n      id: id,\n      label: label,\n      modelProperty: 'name',\n      reference: 'definitionRef',\n      resizable: true,\n\n      createExtensionElement: function(element, extensionElements, value, bo) {\n        var listener = createListener(type, { event: initialEvent });\n        return cmdHelper.updateSemanticParent(listener, extensionElements, 'values', element);\n      },\n\n      removeExtensionElement: function(element, extensionElements, value, idx, bo) {\n        var listener = getListener(bo, type, idx);\n        return cmdHelper.updateSemanticParent(listener, null, 'values', element);\n      },\n\n      getExtensionElements: function(element) {\n        var definition = getDefinition(element);\n        return definition && getListeners(definition, type);\n      },\n\n      setOptionLabelValue: function(element, node, option, property, value, idx, bo) {\n        var listener = getListener(bo, type, idx),\n            listenerType = getListenerType(listener),\n            event = listener && listener.get('event');\n\n        option.text = (event || '*') + ' : ' + (LISTENER_TYPE_LABEL[listenerType] || '');\n      },\n\n      onSelectionChange: function(element, node, event, scope) {\n        forEach(listenerElementSiblings, function(sibling) {\n          sibling.deselect(element, node);\n        });\n      }\n\n    });\n\n    // add flag that this entry is a listener element\n    assign(listenerEntry, {\n      isListenerElements: true\n    });\n\n\n    register = function(groups) {\n      forEach(groups, function(group) {\n        forEach(group.entries, function(entry) {\n          if (entry.isListenerElements && entry.deselect) {\n            listenerElementSiblings.push(entry);\n          }\n        });\n      });\n    };\n\n    getSelectedListener = function(element, node) {\n      var definition = getDefinition(element),\n          selection = listenerEntry.getSelected(element, node) || { idx: -1 };\n\n      if (selection && selection.idx > -1) {\n        return getListener(definition, type, selection.idx);\n      }\n    };\n\n    entries.push(listenerEntry);\n\n  }\n\n\n  return {\n    entries: entries,\n    register: register,\n    getSelectedListener: getSelectedListener\n  };\n\n};\n","/**\n * Util that provides unique IDs.\n *\n * @class djs.util.IdGenerator\n * @constructor\n * @memberOf djs.util\n *\n * The ids can be customized via a given prefix and contain a random value to avoid collisions.\n *\n * @param {String} prefix a prefix to prepend to generated ids (for better readability)\n */\nexport default function IdGenerator(prefix) {\n\n  this._counter = 0;\n  this._prefix = (prefix ? prefix + '-' : '') + Math.floor(Math.random() * 1000000000) + '-';\n}\n\n/**\n * Returns a next unique ID.\n *\n * @method djs.util.IdGenerator#next\n *\n * @returns {String} the id\n */\nIdGenerator.prototype.next = function() {\n  return this._prefix + (++this._counter);\n};\n","import {\n  isArray,\n  isString,\n  isObject,\n  assign,\n  forEach,\n  find,\n  filter,\n  matchPattern,\n  isDefined\n} from 'min-dash';\n\nimport {\n  domify,\n  classes as domClasses,\n  attr as domAttr,\n  remove as domRemove,\n  clear as domClear\n} from 'min-dom';\n\nimport {\n  getBBox\n} from '../../util/Elements';\n\nimport Ids from '../../util/IdGenerator';\n\n// document wide unique overlay ids\nvar ids = new Ids('ov');\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * A service that allows users to attach overlays to diagram elements.\n *\n * The overlay service will take care of overlay positioning during updates.\n *\n * @example\n *\n * // add a pink badge on the top left of the shape\n * overlays.add(someShape, {\n *   position: {\n *     top: -5,\n *     left: -5\n *   },\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\n * });\n *\n * // or add via shape id\n *\n * overlays.add('some-element-id', {\n *   position: {\n *     top: -5,\n *     left: -5\n *   }\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\n * });\n *\n * // or add with optional type\n *\n * overlays.add(someShape, 'badge', {\n *   position: {\n *     top: -5,\n *     left: -5\n *   }\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\n * });\n *\n *\n * // remove an overlay\n *\n * var id = overlays.add(...);\n * overlays.remove(id);\n *\n *\n * You may configure overlay defaults during tool by providing a `config` module\n * with `overlays.defaults` as an entry:\n *\n * {\n *   overlays: {\n *     defaults: {\n *       show: {\n *         minZoom: 0.7,\n *         maxZoom: 5.0\n *       },\n *       scale: {\n *         min: 1\n *       }\n *     }\n * }\n *\n * @param {Object} config\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {ElementRegistry} elementRegistry\n */\nexport default function Overlays(config, eventBus, canvas, elementRegistry) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._elementRegistry = elementRegistry;\n\n  this._ids = ids;\n\n  this._overlayDefaults = assign({\n    // no show constraints\n    show: null,\n\n    // always scale\n    scale: true\n  }, config && config.defaults);\n\n  /**\n   * Mapping overlayId -> overlay\n   */\n  this._overlays = {};\n\n  /**\n   * Mapping elementId -> overlay container\n   */\n  this._overlayContainers = [];\n\n  // root html element for all overlays\n  this._overlayRoot = createRoot(canvas.getContainer());\n\n  this._init();\n}\n\n\nOverlays.$inject = [\n  'config.overlays',\n  'eventBus',\n  'canvas',\n  'elementRegistry'\n];\n\n\n/**\n * Returns the overlay with the specified id or a list of overlays\n * for an element with a given type.\n *\n * @example\n *\n * // return the single overlay with the given id\n * overlays.get('some-id');\n *\n * // return all overlays for the shape\n * overlays.get({ element: someShape });\n *\n * // return all overlays on shape with type 'badge'\n * overlays.get({ element: someShape, type: 'badge' });\n *\n * // shape can also be specified as id\n * overlays.get({ element: 'element-id', type: 'badge' });\n *\n *\n * @param {Object} search\n * @param {String} [search.id]\n * @param {String|djs.model.Base} [search.element]\n * @param {String} [search.type]\n *\n * @return {Object|Array<Object>} the overlay(s)\n */\nOverlays.prototype.get = function(search) {\n\n  if (isString(search)) {\n    search = { id: search };\n  }\n\n  if (isString(search.element)) {\n    search.element = this._elementRegistry.get(search.element);\n  }\n\n  if (search.element) {\n    var container = this._getOverlayContainer(search.element, true);\n\n    // return a list of overlays when searching by element (+type)\n    if (container) {\n      return search.type ? filter(container.overlays, matchPattern({ type: search.type })) : container.overlays.slice();\n    } else {\n      return [];\n    }\n  } else\n  if (search.type) {\n    return filter(this._overlays, matchPattern({ type: search.type }));\n  } else {\n    // return single element when searching by id\n    return search.id ? this._overlays[search.id] : null;\n  }\n};\n\n/**\n * Adds a HTML overlay to an element.\n *\n * @param {String|djs.model.Base}   element   attach overlay to this shape\n * @param {String}                  [type]    optional type to assign to the overlay\n * @param {Object}                  overlay   the overlay configuration\n *\n * @param {String|DOMElement}       overlay.html                 html element to use as an overlay\n * @param {Object}                  [overlay.show]               show configuration\n * @param {Number}                  [overlay.show.minZoom]       minimal zoom level to show the overlay\n * @param {Number}                  [overlay.show.maxZoom]       maximum zoom level to show the overlay\n * @param {Object}                  overlay.position             where to attach the overlay\n * @param {Number}                  [overlay.position.left]      relative to element bbox left attachment\n * @param {Number}                  [overlay.position.top]       relative to element bbox top attachment\n * @param {Number}                  [overlay.position.bottom]    relative to element bbox bottom attachment\n * @param {Number}                  [overlay.position.right]     relative to element bbox right attachment\n * @param {Boolean|Object}          [overlay.scale=true]         false to preserve the same size regardless of\n *                                                               diagram zoom\n * @param {Number}                  [overlay.scale.min]\n * @param {Number}                  [overlay.scale.max]\n *\n * @return {String}                 id that may be used to reference the overlay for update or removal\n */\nOverlays.prototype.add = function(element, type, overlay) {\n\n  if (isObject(type)) {\n    overlay = type;\n    type = null;\n  }\n\n  if (!element.id) {\n    element = this._elementRegistry.get(element);\n  }\n\n  if (!overlay.position) {\n    throw new Error('must specifiy overlay position');\n  }\n\n  if (!overlay.html) {\n    throw new Error('must specifiy overlay html');\n  }\n\n  if (!element) {\n    throw new Error('invalid element specified');\n  }\n\n  var id = this._ids.next();\n\n  overlay = assign({}, this._overlayDefaults, overlay, {\n    id: id,\n    type: type,\n    element: element,\n    html: overlay.html\n  });\n\n  this._addOverlay(overlay);\n\n  return id;\n};\n\n\n/**\n * Remove an overlay with the given id or all overlays matching the given filter.\n *\n * @see Overlays#get for filter options.\n *\n * @param {String} [id]\n * @param {Object} [filter]\n */\nOverlays.prototype.remove = function(filter) {\n\n  var overlays = this.get(filter) || [];\n\n  if (!isArray(overlays)) {\n    overlays = [ overlays ];\n  }\n\n  var self = this;\n\n  forEach(overlays, function(overlay) {\n\n    var container = self._getOverlayContainer(overlay.element, true);\n\n    if (overlay) {\n      domRemove(overlay.html);\n      domRemove(overlay.htmlContainer);\n\n      delete overlay.htmlContainer;\n      delete overlay.element;\n\n      delete self._overlays[overlay.id];\n    }\n\n    if (container) {\n      var idx = container.overlays.indexOf(overlay);\n      if (idx !== -1) {\n        container.overlays.splice(idx, 1);\n      }\n    }\n  });\n\n};\n\n\nOverlays.prototype.show = function() {\n  setVisible(this._overlayRoot);\n};\n\n\nOverlays.prototype.hide = function() {\n  setVisible(this._overlayRoot, false);\n};\n\nOverlays.prototype.clear = function() {\n  this._overlays = {};\n\n  this._overlayContainers = [];\n\n  domClear(this._overlayRoot);\n};\n\nOverlays.prototype._updateOverlayContainer = function(container) {\n  var element = container.element,\n      html = container.html;\n\n  // update container left,top according to the elements x,y coordinates\n  // this ensures we can attach child elements relative to this container\n\n  var x = element.x,\n      y = element.y;\n\n  if (element.waypoints) {\n    var bbox = getBBox(element);\n    x = bbox.x;\n    y = bbox.y;\n  }\n\n  setPosition(html, x, y);\n\n  domAttr(container.html, 'data-container-id', element.id);\n};\n\n\nOverlays.prototype._updateOverlay = function(overlay) {\n\n  var position = overlay.position,\n      htmlContainer = overlay.htmlContainer,\n      element = overlay.element;\n\n  // update overlay html relative to shape because\n  // it is already positioned on the element\n\n  // update relative\n  var left = position.left,\n      top = position.top;\n\n  if (position.right !== undefined) {\n\n    var width;\n\n    if (element.waypoints) {\n      width = getBBox(element).width;\n    } else {\n      width = element.width;\n    }\n\n    left = position.right * -1 + width;\n  }\n\n  if (position.bottom !== undefined) {\n\n    var height;\n\n    if (element.waypoints) {\n      height = getBBox(element).height;\n    } else {\n      height = element.height;\n    }\n\n    top = position.bottom * -1 + height;\n  }\n\n  setPosition(htmlContainer, left || 0, top || 0);\n};\n\n\nOverlays.prototype._createOverlayContainer = function(element) {\n  var html = domify('<div class=\"djs-overlays\" style=\"position: absolute\" />');\n\n  this._overlayRoot.appendChild(html);\n\n  var container = {\n    html: html,\n    element: element,\n    overlays: []\n  };\n\n  this._updateOverlayContainer(container);\n\n  this._overlayContainers.push(container);\n\n  return container;\n};\n\n\nOverlays.prototype._updateRoot = function(viewbox) {\n  var scale = viewbox.scale || 1;\n\n  var matrix = 'matrix(' +\n  [\n    scale,\n    0,\n    0,\n    scale,\n    -1 * viewbox.x * scale,\n    -1 * viewbox.y * scale\n  ].join(',') +\n  ')';\n\n  setTransform(this._overlayRoot, matrix);\n};\n\n\nOverlays.prototype._getOverlayContainer = function(element, raw) {\n  var container = find(this._overlayContainers, function(c) {\n    return c.element === element;\n  });\n\n\n  if (!container && !raw) {\n    return this._createOverlayContainer(element);\n  }\n\n  return container;\n};\n\n\nOverlays.prototype._addOverlay = function(overlay) {\n\n  var id = overlay.id,\n      element = overlay.element,\n      html = overlay.html,\n      htmlContainer,\n      overlayContainer;\n\n  // unwrap jquery (for those who need it)\n  if (html.get && html.constructor.prototype.jquery) {\n    html = html.get(0);\n  }\n\n  // create proper html elements from\n  // overlay HTML strings\n  if (isString(html)) {\n    html = domify(html);\n  }\n\n  overlayContainer = this._getOverlayContainer(element);\n\n  htmlContainer = domify('<div class=\"djs-overlay\" data-overlay-id=\"' + id + '\" style=\"position: absolute\">');\n\n  htmlContainer.appendChild(html);\n\n  if (overlay.type) {\n    domClasses(htmlContainer).add('djs-overlay-' + overlay.type);\n  }\n\n  overlay.htmlContainer = htmlContainer;\n\n  overlayContainer.overlays.push(overlay);\n  overlayContainer.html.appendChild(htmlContainer);\n\n  this._overlays[id] = overlay;\n\n  this._updateOverlay(overlay);\n  this._updateOverlayVisibilty(overlay, this._canvas.viewbox());\n};\n\n\nOverlays.prototype._updateOverlayVisibilty = function(overlay, viewbox) {\n  var show = overlay.show,\n      minZoom = show && show.minZoom,\n      maxZoom = show && show.maxZoom,\n      htmlContainer = overlay.htmlContainer,\n      visible = true;\n\n  if (show) {\n    if (\n      (isDefined(minZoom) && minZoom > viewbox.scale) ||\n      (isDefined(maxZoom) && maxZoom < viewbox.scale)\n    ) {\n      visible = false;\n    }\n\n    setVisible(htmlContainer, visible);\n  }\n\n  this._updateOverlayScale(overlay, viewbox);\n};\n\n\nOverlays.prototype._updateOverlayScale = function(overlay, viewbox) {\n  var shouldScale = overlay.scale,\n      minScale,\n      maxScale,\n      htmlContainer = overlay.htmlContainer;\n\n  var scale, transform = '';\n\n  if (shouldScale !== true) {\n\n    if (shouldScale === false) {\n      minScale = 1;\n      maxScale = 1;\n    } else {\n      minScale = shouldScale.min;\n      maxScale = shouldScale.max;\n    }\n\n    if (isDefined(minScale) && viewbox.scale < minScale) {\n      scale = (1 / viewbox.scale || 1) * minScale;\n    }\n\n    if (isDefined(maxScale) && viewbox.scale > maxScale) {\n      scale = (1 / viewbox.scale || 1) * maxScale;\n    }\n  }\n\n  if (isDefined(scale)) {\n    transform = 'scale(' + scale + ',' + scale + ')';\n  }\n\n  setTransform(htmlContainer, transform);\n};\n\n\nOverlays.prototype._updateOverlaysVisibilty = function(viewbox) {\n\n  var self = this;\n\n  forEach(this._overlays, function(overlay) {\n    self._updateOverlayVisibilty(overlay, viewbox);\n  });\n};\n\n\nOverlays.prototype._init = function() {\n\n  var eventBus = this._eventBus;\n\n  var self = this;\n\n\n  // scroll/zoom integration\n\n  function updateViewbox(viewbox) {\n    self._updateRoot(viewbox);\n    self._updateOverlaysVisibilty(viewbox);\n\n    self.show();\n  }\n\n  eventBus.on('canvas.viewbox.changing', function(event) {\n    self.hide();\n  });\n\n  eventBus.on('canvas.viewbox.changed', function(event) {\n    updateViewbox(event.viewbox);\n  });\n\n\n  // remove integration\n\n  eventBus.on([ 'shape.remove', 'connection.remove' ], function(e) {\n    var element = e.element;\n    var overlays = self.get({ element: element });\n\n    forEach(overlays, function(o) {\n      self.remove(o.id);\n    });\n\n    var container = self._getOverlayContainer(element);\n\n    if (container) {\n      domRemove(container.html);\n      var i = self._overlayContainers.indexOf(container);\n      if (i !== -1) {\n        self._overlayContainers.splice(i, 1);\n      }\n    }\n  });\n\n\n  // move integration\n\n  eventBus.on('element.changed', LOW_PRIORITY, function(e) {\n    var element = e.element;\n\n    var container = self._getOverlayContainer(element, true);\n\n    if (container) {\n      forEach(container.overlays, function(overlay) {\n        self._updateOverlay(overlay);\n      });\n\n      self._updateOverlayContainer(container);\n    }\n  });\n\n\n  // marker integration, simply add them on the overlays as classes, too.\n\n  eventBus.on('element.marker.update', function(e) {\n    var container = self._getOverlayContainer(e.element, true);\n    if (container) {\n      domClasses(container.html)[e.add ? 'add' : 'remove'](e.marker);\n    }\n  });\n\n\n  // clear overlays with diagram\n\n  eventBus.on('diagram.clear', this.clear, this);\n};\n\n\n\n// helpers /////////////////////////////\n\nfunction createRoot(parentNode) {\n  var root = domify(\n    '<div class=\"djs-overlay-container\" style=\"position: absolute; width: 0; height: 0;\" />'\n  );\n\n  parentNode.insertBefore(root, parentNode.firstChild);\n\n  return root;\n}\n\nfunction setPosition(el, x, y) {\n  assign(el.style, { left: x + 'px', top: y + 'px' });\n}\n\nfunction setVisible(el, visible) {\n  el.style.display = visible === false ? 'none' : '';\n}\n\nfunction setTransform(el, transform) {\n\n  el.style['transform-origin'] = 'top left';\n\n  [ '', '-ms-', '-webkit-' ].forEach(function(prefix) {\n    el.style[prefix + 'transform'] = transform;\n  });\n}","import Overlays from './Overlays';\n\nexport default {\n  __init__: [ 'overlays' ],\n  overlays: [ 'type', Overlays ]\n};","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  query as domQuery\n} from 'min-dom';\n\nimport { isPrimaryButton } from '../../util/Mouse';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  createLine,\n  updateLine\n} from '../../util/RenderUtil';\n\nfunction allowAll(e) { return true; }\n\nvar LOW_PRIORITY = 500;\n\n/**\n * A plugin that provides interaction events for diagram elements.\n *\n * It emits the following events:\n *\n *   * element.hover\n *   * element.out\n *   * element.click\n *   * element.dblclick\n *   * element.mousedown\n *   * element.contextmenu\n *\n * Each event is a tuple { element, gfx, originalEvent }.\n *\n * Canceling the event via Event#preventDefault()\n * prevents the original DOM operation.\n *\n * @param {EventBus} eventBus\n */\nexport default function InteractionEvents(eventBus, elementRegistry, styles) {\n\n  var HIT_STYLE = styles.cls('djs-hit', [ 'no-fill', 'no-border' ], {\n    stroke: 'white',\n    strokeWidth: 15\n  });\n\n  /**\n   * Fire an interaction event.\n   *\n   * @param {String} type local event name, e.g. element.click.\n   * @param {DOMEvent} event native event\n   * @param {djs.model.Base} [element] the diagram element to emit the event on;\n   *                                   defaults to the event target\n   */\n  function fire(type, event, element) {\n\n    if (isIgnored(type, event)) {\n      return;\n    }\n\n    var target, gfx, returnValue;\n\n    if (!element) {\n      target = event.delegateTarget || event.target;\n\n      if (target) {\n        gfx = target;\n        element = elementRegistry.get(gfx);\n      }\n    } else {\n      gfx = elementRegistry.getGraphics(element);\n    }\n\n    if (!gfx || !element) {\n      return;\n    }\n\n    returnValue = eventBus.fire(type, {\n      element: element,\n      gfx: gfx,\n      originalEvent: event\n    });\n\n    if (returnValue === false) {\n      event.stopPropagation();\n      event.preventDefault();\n    }\n  }\n\n  // TODO(nikku): document this\n  var handlers = {};\n\n  function mouseHandler(localEventName) {\n    return handlers[localEventName];\n  }\n\n  function isIgnored(localEventName, event) {\n\n    var filter = ignoredFilters[localEventName] || isPrimaryButton;\n\n    // only react on left mouse button interactions\n    // except for interaction events that are enabled\n    // for secundary mouse button\n    return !filter(event);\n  }\n\n  var bindings = {\n    mouseover: 'element.hover',\n    mouseout: 'element.out',\n    click: 'element.click',\n    dblclick: 'element.dblclick',\n    mousedown: 'element.mousedown',\n    mousemove: 'element.mousemove',\n    mouseup: 'element.mouseup',\n    contextmenu: 'element.contextmenu'\n  };\n\n  var ignoredFilters = {\n    'element.contextmenu': allowAll\n  };\n\n\n  // manual event trigger\n\n  /**\n   * Trigger an interaction event (based on a native dom event)\n   * on the target shape or connection.\n   *\n   * @param {String} eventName the name of the triggered DOM event\n   * @param {MouseEvent} event\n   * @param {djs.model.Base} targetElement\n   */\n  function triggerMouseEvent(eventName, event, targetElement) {\n\n    // i.e. element.mousedown...\n    var localEventName = bindings[eventName];\n\n    if (!localEventName) {\n      throw new Error('unmapped DOM event name <' + eventName + '>');\n    }\n\n    return fire(localEventName, event, targetElement);\n  }\n\n\n  var elementSelector = 'svg, .djs-element';\n\n  // event registration\n\n  function registerEvent(node, event, localEvent, ignoredFilter) {\n\n    var handler = handlers[localEvent] = function(event) {\n      fire(localEvent, event);\n    };\n\n    if (ignoredFilter) {\n      ignoredFilters[localEvent] = ignoredFilter;\n    }\n\n    handler.$delegate = domDelegate.bind(node, elementSelector, event, handler);\n  }\n\n  function unregisterEvent(node, event, localEvent) {\n\n    var handler = mouseHandler(localEvent);\n\n    if (!handler) {\n      return;\n    }\n\n    domDelegate.unbind(node, event, handler.$delegate);\n  }\n\n  function registerEvents(svg) {\n    forEach(bindings, function(val, key) {\n      registerEvent(svg, key, val);\n    });\n  }\n\n  function unregisterEvents(svg) {\n    forEach(bindings, function(val, key) {\n      unregisterEvent(svg, key, val);\n    });\n  }\n\n  eventBus.on('canvas.destroy', function(event) {\n    unregisterEvents(event.svg);\n  });\n\n  eventBus.on('canvas.init', function(event) {\n    registerEvents(event.svg);\n  });\n\n\n  eventBus.on([ 'shape.added', 'connection.added' ], function(event) {\n    var element = event.element,\n        gfx = event.gfx,\n        hit;\n\n    if (element.waypoints) {\n      hit = createLine(element.waypoints);\n    } else {\n      hit = svgCreate('rect');\n      svgAttr(hit, {\n        x: 0,\n        y: 0,\n        width: element.width,\n        height: element.height\n      });\n    }\n\n    svgAttr(hit, HIT_STYLE);\n\n    svgAppend(gfx, hit);\n  });\n\n  // Update djs-hit on change.\n  // A low priortity is necessary, because djs-hit of labels has to be updated\n  // after the label bounds have been updated in the renderer.\n  eventBus.on('shape.changed', LOW_PRIORITY, function(event) {\n\n    var element = event.element,\n        gfx = event.gfx,\n        hit = domQuery('.djs-hit', gfx);\n\n    svgAttr(hit, {\n      width: element.width,\n      height: element.height\n    });\n  });\n\n  eventBus.on('connection.changed', function(event) {\n\n    var element = event.element,\n        gfx = event.gfx,\n        hit = domQuery('.djs-hit', gfx);\n\n    updateLine(hit, element.waypoints);\n  });\n\n\n  // API\n\n  this.fire = fire;\n\n  this.triggerMouseEvent = triggerMouseEvent;\n\n  this.mouseHandler = mouseHandler;\n\n  this.registerEvent = registerEvent;\n  this.unregisterEvent = unregisterEvent;\n}\n\n\nInteractionEvents.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'styles'\n];\n\n\n/**\n * An event indicating that the mouse hovered over an element\n *\n * @event element.hover\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the mouse has left an element\n *\n * @event element.out\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the mouse has clicked an element\n *\n * @event element.click\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the mouse has double clicked an element\n *\n * @event element.dblclick\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the mouse has gone down on an element.\n *\n * @event element.mousedown\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the mouse has gone up on an element.\n *\n * @event element.mouseup\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the context menu action is triggered\n * via mouse or touch controls.\n *\n * @event element.contextmenu\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */","import InteractionEvents from './InteractionEvents';\n\nexport default {\n  __init__: [ 'interactionEvents' ],\n  interactionEvents: [ 'type', InteractionEvents ]\n};","import {\n  isFunction\n} from 'min-dash';\n\nimport {\n  event as domEvent,\n  matches as domMatches\n} from 'min-dom';\n\nimport {\n  hasModifier,\n  isCmd,\n  isKey,\n  isShift\n} from './KeyboardUtil';\n\nvar KEYDOWN_EVENT = 'keyboard.keydown',\n    KEYUP_EVENT = 'keyboard.keyup';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A keyboard abstraction that may be activated and\n * deactivated by users at will, consuming key events\n * and triggering diagram actions.\n *\n * For keys pressed down, keyboard fires `keyboard.keydown` event.\n * The event context contains one field which is `KeyboardEvent` event.\n *\n * The implementation fires the following key events that allow\n * other components to hook into key handling:\n *\n *  - keyboard.bind\n *  - keyboard.unbind\n *  - keyboard.init\n *  - keyboard.destroy\n *\n * All events contain one field which is node.\n *\n * A default binding for the keyboard may be specified via the\n * `keyboard.bindTo` configuration option.\n *\n * @param {Config} config\n * @param {EventBus} eventBus\n */\nexport default function Keyboard(config, eventBus) {\n  var self = this;\n\n  this._config = config || {};\n  this._eventBus = eventBus;\n\n  this._keydownHandler = this._keydownHandler.bind(this);\n  this._keyupHandler = this._keyupHandler.bind(this);\n\n  // properly clean dom registrations\n  eventBus.on('diagram.destroy', function() {\n    self._fire('destroy');\n\n    self.unbind();\n  });\n\n  eventBus.on('diagram.init', function() {\n    self._fire('init');\n  });\n\n  eventBus.on('attach', function() {\n    if (config && config.bindTo) {\n      self.bind(config.bindTo);\n    }\n  });\n\n  eventBus.on('detach', function() {\n    self.unbind();\n  });\n}\n\nKeyboard.$inject = [\n  'config.keyboard',\n  'eventBus'\n];\n\nKeyboard.prototype._keydownHandler = function(event) {\n  this._keyHandler(event, KEYDOWN_EVENT);\n};\n\nKeyboard.prototype._keyupHandler = function(event) {\n  this._keyHandler(event, KEYUP_EVENT);\n};\n\nKeyboard.prototype._keyHandler = function(event, type) {\n  var target = event.target,\n      eventBusResult;\n\n  if (isInput(target)) {\n    return;\n  }\n\n  var context = {\n    keyEvent: event\n  };\n\n  eventBusResult = this._eventBus.fire(type || KEYDOWN_EVENT, context);\n\n  if (eventBusResult) {\n    event.preventDefault();\n  }\n};\n\nKeyboard.prototype.bind = function(node) {\n\n  // make sure that the keyboard is only bound once to the DOM\n  this.unbind();\n\n  this._node = node;\n\n  // bind key events\n  domEvent.bind(node, 'keydown', this._keydownHandler, true);\n  domEvent.bind(node, 'keyup', this._keyupHandler, true);\n\n  this._fire('bind');\n};\n\nKeyboard.prototype.getBinding = function() {\n  return this._node;\n};\n\nKeyboard.prototype.unbind = function() {\n  var node = this._node;\n\n  if (node) {\n    this._fire('unbind');\n\n    // unbind key events\n    domEvent.unbind(node, 'keydown', this._keydownHandler, true);\n    domEvent.unbind(node, 'keyup', this._keyupHandler, true);\n  }\n\n  this._node = null;\n};\n\nKeyboard.prototype._fire = function(event) {\n  this._eventBus.fire('keyboard.' + event, { node: this._node });\n};\n\n/**\n * Add a listener function that is notified with `KeyboardEvent` whenever\n * the keyboard is bound and the user presses a key. If no priority is\n * provided, the default value of 1000 is used.\n *\n * @param {Number} [priority]\n * @param {Function} listener\n * @param {string} type\n */\nKeyboard.prototype.addListener = function(priority, listener, type) {\n  if (isFunction(priority)) {\n    type = listener;\n    listener = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on(type || KEYDOWN_EVENT, priority, listener);\n};\n\nKeyboard.prototype.removeListener = function(listener, type) {\n  this._eventBus.off(type || KEYDOWN_EVENT, listener);\n};\n\nKeyboard.prototype.hasModifier = hasModifier;\nKeyboard.prototype.isCmd = isCmd;\nKeyboard.prototype.isShift = isShift;\nKeyboard.prototype.isKey = isKey;\n\n\n\n// helpers ///////\n\nfunction isInput(target) {\n  return target && (domMatches(target, 'input, textarea') || target.contentEditable === 'true');\n}\n","import Keyboard from './Keyboard';\nimport KeyboardBindings from './KeyboardBindings';\n\nexport default {\n  __init__: [ 'keyboard', 'keyboardBindings' ],\n  keyboard: [ 'type', Keyboard ],\n  keyboardBindings: [ 'type', KeyboardBindings ]\n};\n","import {\r\n  forEach\r\n} from 'min-dash';\r\n\r\nimport {\r\n  append as svgAppend,\r\n  attr as svgAttr,\r\n  classes as svgClasses,\r\n  clone as svgClone,\r\n  create as svgCreate,\r\n  remove as svgRemove\r\n} from 'tiny-svg';\r\n\r\nimport { query as domQuery } from 'min-dom';\r\n\r\nimport { getVisual } from '../../util/GraphicsUtil';\r\n\r\nvar MARKER_TYPES = [\r\n  'marker-start',\r\n  'marker-mid',\r\n  'marker-end'\r\n];\r\n\r\nvar NODES_CAN_HAVE_MARKER = [\r\n  'circle',\r\n  'ellipse',\r\n  'line',\r\n  'path',\r\n  'polygon',\r\n  'polyline',\r\n  'rect'\r\n];\r\n\r\n\r\n/**\r\n * Adds support for previews of moving/resizing elements.\r\n */\r\nexport default function PreviewSupport(elementRegistry, eventBus, canvas, styles) {\r\n  this._elementRegistry = elementRegistry;\r\n  this._canvas = canvas;\r\n  this._styles = styles;\r\n\r\n  this._clonedMarkers = {};\r\n\r\n  var self = this;\r\n\r\n  eventBus.on('drag.cleanup', function() {\r\n    forEach(self._clonedMarkers, function(clonedMarker) {\r\n      svgRemove(clonedMarker);\r\n    });\r\n\r\n    self._clonedMarkers = {};\r\n  });\r\n}\r\n\r\nPreviewSupport.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'canvas',\r\n  'styles'\r\n];\r\n\r\n\r\n/**\r\n * Returns graphics of an element.\r\n *\r\n * @param {djs.model.Base} element\r\n *\r\n * @return {SVGElement}\r\n */\r\nPreviewSupport.prototype.getGfx = function(element) {\r\n  return this._elementRegistry.getGraphics(element);\r\n};\r\n\r\n/**\r\n * Adds a move preview of a given shape to a given svg group.\r\n *\r\n * @param {djs.model.Base} element\r\n * @param {SVGElement} group\r\n *\r\n * @return {SVGElement} dragger\r\n */\r\nPreviewSupport.prototype.addDragger = function(shape, group) {\r\n  var gfx = this.getGfx(shape);\r\n\r\n  var dragger = svgClone(gfx);\r\n  var bbox = gfx.getBoundingClientRect();\r\n\r\n  this._cloneMarkers(getVisual(dragger));\r\n\r\n  svgAttr(dragger, this._styles.cls('djs-dragger', [], {\r\n    x: bbox.top,\r\n    y: bbox.left\r\n  }));\r\n\r\n  svgAppend(group, dragger);\r\n\r\n  return dragger;\r\n};\r\n\r\n/**\r\n * Adds a resize preview of a given shape to a given svg group.\r\n *\r\n * @param {djs.model.Base} element\r\n * @param {SVGElement} group\r\n *\r\n * @return {SVGElement} frame\r\n */\r\nPreviewSupport.prototype.addFrame = function(shape, group) {\r\n\r\n  var frame = svgCreate('rect', {\r\n    class: 'djs-resize-overlay',\r\n    width:  shape.width,\r\n    height: shape.height,\r\n    x: shape.x,\r\n    y: shape.y\r\n  });\r\n\r\n  svgAppend(group, frame);\r\n\r\n  return frame;\r\n};\r\n\r\n/**\r\n * Clone all markers referenced by a node and its child nodes.\r\n *\r\n * @param {SVGElement} gfx\r\n */\r\nPreviewSupport.prototype._cloneMarkers = function(gfx) {\r\n  var self = this;\r\n\r\n  if (gfx.childNodes) {\r\n\r\n    // TODO: use forEach once we drop PhantomJS\r\n    for (var i = 0; i < gfx.childNodes.length; i++) {\r\n\r\n      // recursively clone markers of child nodes\r\n      self._cloneMarkers(gfx.childNodes[ i ]);\r\n    }\r\n  }\r\n\r\n  if (!canHaveMarker(gfx)) {\r\n    return;\r\n  }\r\n\r\n  MARKER_TYPES.forEach(function(markerType) {\r\n    if (svgAttr(gfx, markerType)) {\r\n      var marker = getMarker(gfx, markerType, self._canvas.getContainer());\r\n\r\n      self._cloneMarker(gfx, marker, markerType);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Clone marker referenced by an element.\r\n *\r\n * @param {SVGElement} gfx\r\n * @param {SVGElement} marker\r\n * @param {string} markerType\r\n */\r\nPreviewSupport.prototype._cloneMarker = function(gfx, marker, markerType) {\r\n  var markerId = marker.id;\r\n\r\n  var clonedMarker = this._clonedMarkers[ markerId ];\r\n\r\n  if (!clonedMarker) {\r\n    clonedMarker = svgClone(marker);\r\n\r\n    var clonedMarkerId = markerId + '-clone';\r\n\r\n    clonedMarker.id = clonedMarkerId;\r\n\r\n    svgClasses(clonedMarker)\r\n      .add('djs-dragger')\r\n      .add('djs-dragger-marker');\r\n\r\n    this._clonedMarkers[ markerId ] = clonedMarker;\r\n\r\n    var defs = domQuery('defs', this._canvas._svg);\r\n\r\n    if (!defs) {\r\n      defs = svgCreate('defs');\r\n\r\n      svgAppend(this._canvas._svg, defs);\r\n    }\r\n\r\n    svgAppend(defs, clonedMarker);\r\n  }\r\n\r\n  var reference = idToReference(this._clonedMarkers[ markerId ].id);\r\n\r\n  svgAttr(gfx, markerType, reference);\r\n};\r\n\r\n// helpers //////////\r\n\r\n/**\r\n * Get marker of given type referenced by node.\r\n *\r\n * @param {Node} node\r\n * @param {string} markerType\r\n * @param {Node} [parentNode]\r\n *\r\n * @param {Node}\r\n */\r\nfunction getMarker(node, markerType, parentNode) {\r\n  var id = referenceToId(svgAttr(node, markerType));\r\n\r\n  return domQuery('marker#' + id, parentNode || document);\r\n}\r\n\r\n/**\r\n * Get ID of fragment within current document from its functional IRI reference.\r\n * References may use single or double quotes.\r\n *\r\n * @param {string} reference\r\n *\r\n * @returns {string}\r\n */\r\nfunction referenceToId(reference) {\r\n  return reference.match(/url\\(['\"]?#([^'\"]*)['\"]?\\)/)[1];\r\n}\r\n\r\n/**\r\n * Get functional IRI reference for given ID of fragment within current document.\r\n *\r\n * @param {string} id\r\n *\r\n * @returns {string}\r\n */\r\nfunction idToReference(id) {\r\n  return 'url(#' + id + ')';\r\n}\r\n\r\n/**\r\n * Check wether node type can have marker attributes.\r\n *\r\n * @param {Node} node\r\n *\r\n * @returns {boolean}\r\n */\r\nfunction canHaveMarker(node) {\r\n  return NODES_CAN_HAVE_MARKER.indexOf(node.nodeName) !== -1;\r\n}","import PreviewSupport from './PreviewSupport';\n\nexport default {\n  __init__: [ 'previewSupport' ],\n  previewSupport: [ 'type', PreviewSupport ]\n};\n","/**\n * The code in the <project-logo></project-logo> area\n * must not be changed.\n *\n * @see http://bpmn.io/license for more information.\n */\n'use strict';\n\nvar assign = require('min-dash').assign,\n    omit = require('min-dash').omit,\n    isNumber = require('min-dash').isNumber;\n\nvar inherits = require('inherits');\n\nvar domify = require('min-dom').domify,\n    domQuery = require('min-dom').query,\n    domRemove = require('min-dom').remove;\n\nvar innerSVG = require('tiny-svg').innerSVG;\n\nvar Diagram = require('diagram-js').default,\n    CmmnModdle = require('cmmn-moddle').default;\n\nvar Importer = require('./import/Importer');\n\n\nfunction checkValidationError(err) {\n\n  // check if we can help the user by indicating wrong CMMN 1.1 xml\n  // (in case he or the exporting tool did not get that right)\n\n  var pattern = /unparsable content <([^>]+)> detected([\\s\\S]*)$/;\n  var match = pattern.exec(err.message);\n\n  if (match) {\n    err.message =\n      'unparsable content <' + match[1] + '> detected; ' +\n      'this may indicate an invalid CMMN 1.1 diagram file' + match[2];\n  }\n\n  return err;\n}\n\nvar DEFAULT_OPTIONS = {\n  width: '100%',\n  height: '100%',\n  position: 'relative'\n};\n\n\n/**\n * Ensure the passed argument is a proper unit (defaulting to px)\n */\nfunction ensureUnit(val) {\n  return val + (isNumber(val) ? 'px' : '');\n}\n\n/**\n * A viewer for CMMN 1.1 diagrams.\n *\n * Have a look at {@link NavigatedViewer} or {@link Modeler} for bundles that include\n * additional features.\n *\n *\n * ## Extending the Viewer\n *\n * In order to extend the viewer pass extension modules to bootstrap via the\n * `additionalModules` option. An extension module is an object that exposes\n * named services.\n *\n * The following example depicts the integration of a simple\n * logging component that integrates with interaction events:\n *\n *\n * ```javascript\n *\n * // logging component\n * function InteractionLogger(eventBus) {\n *   eventBus.on('element.hover', function(event) {\n *     console.log()\n *   })\n * }\n *\n * InteractionLogger.$inject = [ 'eventBus' ]; // minification save\n *\n * // extension module\n * var extensionModule = {\n *   __init__: [ 'interactionLogger' ],\n *   interactionLogger: [ 'type', InteractionLogger ]\n * };\n *\n * // extend the viewer\n * var cmmnViewer = new Viewer({ additionalModules: [ extensionModule ] });\n * cmmnViewer.importXML(...);\n * ```\n *\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to attach to\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nfunction Viewer(options) {\n\n  options = assign({}, DEFAULT_OPTIONS, options);\n\n  this._moddle = this._createModdle(options);\n\n  this._container = this._createContainer(options);\n\n  /* <project-logo> */\n\n  addProjectLogo(this._container);\n\n  /* </project-logo> */\n\n  this._init(this._container, this._moddle, options);\n}\n\ninherits(Viewer, Diagram);\n\nmodule.exports = Viewer;\n\n\n/**\n * Parse and render a CMMN 1.1 diagram.\n *\n * Once finished the viewer reports back the result to the\n * provided callback function with (err, warnings).\n *\n * ## Life-Cycle Events\n *\n * During import the viewer will fire life-cycle events:\n *\n *   * import.parse.start (about to read model from xml)\n *   * import.parse.complete (model read; may have worked or not)\n *   * import.render.start (graphical import start)\n *   * import.render.complete (graphical import finished)\n *   * import.done (everything done)\n *\n * You can use these events to hook into the life-cycle.\n *\n * @param {String} xml the CMMN 1.1 xml\n * @param {Function} [done] invoked with (err, warnings=[])\n */\nViewer.prototype.importXML = function(xml, done) {\n\n  // done is optional\n  done = done || function() {};\n\n  var self = this;\n\n  // hook in pre-parse listeners +\n  // allow xml manipulation\n  xml = this._emit('import.parse.start', { xml: xml }) || xml;\n\n  this._moddle.fromXML(xml, 'cmmn:Definitions', function(err, definitions, context) {\n\n    // hook in post parse listeners +\n    // allow definitions manipulation\n    definitions = self._emit('import.parse.complete', {\n      error: err,\n      definitions: definitions,\n      context: context\n    }) || definitions;\n\n    var parseWarnings = context.warnings;\n\n    if (err) {\n      err = checkValidationError(err);\n\n      self._emit('import.done', { error: err, warnings: parseWarnings });\n\n      return done(err, parseWarnings);\n    }\n\n    self.importDefinitions(definitions, function(err, importWarnings) {\n      var allWarnings = [].concat(parseWarnings, importWarnings || []);\n\n      self._emit('import.done', { error: err, warnings: allWarnings });\n\n      done(err, allWarnings);\n    });\n  });\n};\n\n/**\n * Export the currently displayed CMMN 1.1 diagram as\n * a CMMN 1.1 XML document.\n *\n * ## Life-Cycle Events\n *\n * During XML saving the viewer will fire life-cycle events:\n *\n *   * saveXML.start (before serialization)\n *   * saveXML.serialized (after xml generation)\n *   * saveXML.done (everything done)\n *\n * You can use these events to hook into the life-cycle.\n *\n * @param {Object} [options] export options\n * @param {Boolean} [options.format=false] output formated XML\n * @param {Boolean} [options.preamble=true] output preamble\n *\n * @param {Function} done invoked with (err, xml)\n */\nViewer.prototype.saveXML = function(options, done) {\n\n  if (!done) {\n    done = options;\n    options = {};\n  }\n\n  var self = this;\n\n  var definitions = this._definitions;\n\n  if (!definitions) {\n    return done(new Error('no definitions loaded'));\n  }\n\n  // allow to fiddle around with definitions\n  definitions = this._emit('saveXML.start', {\n    definitions: definitions\n  }) || definitions;\n\n  this._moddle.toXML(definitions, options, function(err, xml) {\n\n    try {\n      xml = self._emit('saveXML.serialized', {\n        error: err,\n        xml: xml\n      }) || xml;\n\n      self._emit('saveXML.done', {\n        error: err,\n        xml: xml\n      });\n    } catch (e) {\n      console.error('error in saveXML life-cycle listener', e);\n    }\n\n    done(err, xml);\n  });\n};\n\nViewer.prototype.saveSVG = function(options, done) {\n\n  if (!done) {\n    done = options;\n    options = {};\n  }\n\n  var canvas = this.get('canvas');\n\n  var contentNode = canvas.getDefaultLayer(),\n      defsNode = domQuery('defs', canvas._svg);\n\n  var contents = innerSVG(contentNode),\n      defs = (defsNode && defsNode.outerHTML) || '';\n\n  var bbox = contentNode.getBBox();\n\n  var svg =\n    '<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n' +\n    '<!-- created with cmmn-js / http://bpmn.io -->\\n' +\n    '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n' +\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" ' +\n         'width=\"' + bbox.width + '\" height=\"' + bbox.height + '\" ' +\n         'viewBox=\"' + bbox.x + ' ' + bbox.y + ' ' + bbox.width + ' ' + bbox.height + '\" version=\"1.1\">' +\n      defs + contents +\n    '</svg>';\n\n  done(null, svg);\n};\n\nViewer.prototype.importDefinitions = function(definitions, done) {\n\n  // use try/catch to not swallow synchronous exceptions\n  // that may be raised during model parsing\n  try {\n\n    if (this._definitions) {\n      // clear existing rendered diagram\n      this.clear();\n    }\n\n    // update definitions\n    this._definitions = definitions;\n\n    // perform graphical import\n    Importer.importCmmnDiagram(this, definitions, done);\n  } catch (e) {\n\n    // handle synchronous errors\n    done(e);\n  }\n};\n\nViewer.prototype.attachTo = function(parentNode) {\n\n  if (!parentNode) {\n    throw new Error('parentNode required');\n  }\n\n  // ensure we detach from the\n  // previous, old parent\n  this.detach();\n\n  // unwrap jQuery if provided\n  if (parentNode.get && parentNode.constructor.prototype.jquery) {\n    parentNode = parentNode.get(0);\n  }\n\n  if (typeof parentNode === 'string') {\n    parentNode = domQuery(parentNode);\n  }\n\n  parentNode.appendChild(this._container);\n\n  this._emit('attach', {});\n\n  this.get('canvas').resized();\n};\n\nViewer.prototype.getDefinitions = function() {\n  return this._definitions;\n};\n\nViewer.prototype.detach = function() {\n\n  var container = this._container,\n      parentNode = container.parentNode;\n\n  if (!parentNode) {\n    return;\n  }\n\n  this._emit('detach', {});\n\n  parentNode.removeChild(container);\n};\n\nViewer.prototype.getModules = function() {\n  return this._modules;\n};\n\n/**\n * Destroy the viewer instance and remove all its\n * remainders from the document tree.\n */\nViewer.prototype.destroy = function() {\n\n  // diagram destroy\n  Diagram.prototype.destroy.call(this);\n\n  // dom detach\n  domRemove(this._container);\n};\n\n/**\n * Register an event listener\n *\n * Remove a previously added listener via {@link #off(event, callback)}.\n *\n * @param {String} event\n * @param {Number} [priority]\n * @param {Function} callback\n * @param {Object} [that]\n */\nViewer.prototype.on = function(event, priority, callback, target) {\n  return this.get('eventBus').on(event, priority, callback, target);\n};\n\n/**\n * De-register an event listener\n *\n * @param {String} event\n * @param {Function} callback\n */\nViewer.prototype.off = function(event, callback) {\n  this.get('eventBus').off(event, callback);\n};\n\n\nViewer.prototype._init = function(container, moddle, options) {\n\n  var baseModules = options.modules || this.getModules(),\n      additionalModules = options.additionalModules || [],\n      staticModules = [\n        {\n          cmmnjs: [ 'value', this ],\n          moddle: [ 'value', moddle ]\n        }\n      ];\n\n  var diagramModules = [].concat(staticModules, baseModules, additionalModules);\n\n  var diagramOptions = assign(omit(options, 'additionalModules'), {\n    canvas: assign({}, options.canvas, { container: container }),\n    modules: diagramModules\n  });\n\n  // invoke diagram constructor\n  Diagram.call(this, diagramOptions);\n\n  if (options && options.container) {\n    this.attachTo(options.container);\n  }\n};\n\n/**\n * Emit an event on the underlying {@link EventBus}\n *\n * @param  {String} type\n * @param  {Object} event\n *\n * @return {Object} event processing result (if any)\n */\nViewer.prototype._emit = function(type, event) {\n  return this.get('eventBus').fire(type, event);\n};\n\nViewer.prototype._createContainer = function(options) {\n\n  var container = domify('<div class=\"cjs-container\"></div>');\n\n  assign(container.style, {\n    width: ensureUnit(options.width),\n    height: ensureUnit(options.height),\n    position: options.position\n  });\n\n  return container;\n};\n\nViewer.prototype._createModdle = function(options) {\n  var moddleOptions = assign({}, this._moddleExtensions, options.moddleExtensions);\n\n  return new CmmnModdle(moddleOptions);\n};\n\n\n// modules the viewer is composed of\nViewer.prototype._modules = [\n  require('./core'),\n  require('diagram-js/lib/features/selection').default,\n  require('diagram-js/lib/features/overlays').default\n];\n\n\n/* <project-logo> */\n\nvar PoweredBy = require('./util/PoweredByUtil'),\n    domEvent = require('min-dom').event;\n\n/**\n * Adds the project logo to the diagram container as\n * required by the bpmn.io license.\n *\n * @see http://bpmn.io/license\n *\n * @param {Element} container\n */\nfunction addProjectLogo(container) {\n\n  var linkMarkup =\n    '<a href=\"http://bpmn.io\" ' +\n       'target=\"_blank\" ' +\n       'class=\"bjs-powered-by\" ' +\n       'title=\"Powered by bpmn.io\" ' +\n       'style=\"position: absolute; bottom: 15px; right: 15px; z-index: 100; ' + PoweredBy.LINK_STYLES + '\">' +\n      PoweredBy.BPMNIO_IMG +\n    '</a>';\n\n  var linkElement = domify(linkMarkup);\n\n  container.appendChild(linkElement);\n\n  domEvent.bind(linkElement, 'click', function(event) {\n    PoweredBy.open();\n\n    event.preventDefault();\n  });\n}\n\n/* </project-logo> */\n","var DEFAULT_RENDER_PRIORITY = 1000;\n\n/**\n * The base implementation of shape and connection renderers.\n *\n * @param {EventBus} eventBus\n * @param {Number} [renderPriority=1000]\n */\nexport default function BaseRenderer(eventBus, renderPriority) {\n  var self = this;\n\n  renderPriority = renderPriority || DEFAULT_RENDER_PRIORITY;\n\n  eventBus.on([ 'render.shape', 'render.connection' ], renderPriority, function(evt, context) {\n    var type = evt.type,\n        element = context.element,\n        visuals = context.gfx;\n\n    if (self.canRender(element)) {\n      if (type === 'render.shape') {\n        return self.drawShape(visuals, element);\n      } else {\n        return self.drawConnection(visuals, element);\n      }\n    }\n  });\n\n  eventBus.on([ 'render.getShapePath', 'render.getConnectionPath'], renderPriority, function(evt, element) {\n    if (self.canRender(element)) {\n      if (evt.type === 'render.getShapePath') {\n        return self.getShapePath(element);\n      } else {\n        return self.getConnectionPath(element);\n      }\n    }\n  });\n}\n\n/**\n * Should check whether *this* renderer can render\n * the element/connection.\n *\n * @param {element} element\n *\n * @returns {Boolean}\n */\nBaseRenderer.prototype.canRender = function() {};\n\n/**\n * Provides the shape's snap svg element to be drawn on the `canvas`.\n *\n * @param {djs.Graphics} visuals\n * @param {Shape} shape\n *\n * @returns {Snap.svg} [returns a Snap.svg paper element ]\n */\nBaseRenderer.prototype.drawShape = function() {};\n\n/**\n * Provides the shape's snap svg element to be drawn on the `canvas`.\n *\n * @param {djs.Graphics} visuals\n * @param {Connection} connection\n *\n * @returns {Snap.svg} [returns a Snap.svg paper element ]\n */\nBaseRenderer.prototype.drawConnection = function() {};\n\n/**\n * Gets the SVG path of a shape that represents it's visual bounds.\n *\n * @param {Shape} shape\n *\n * @return {string} svg path\n */\nBaseRenderer.prototype.getShapePath = function() {};\n\n/**\n * Gets the SVG path of a connection that represents it's visual bounds.\n *\n * @param {Connection} connection\n *\n * @return {string} svg path\n */\nBaseRenderer.prototype.getConnectionPath = function() {};\n","import {\n  create\n} from '../model';\n\nimport { assign } from 'min-dash';\n\n/**\n * A factory for diagram-js shapes\n */\nexport default function ElementFactory() {\n  this._uid = 12;\n}\n\n\nElementFactory.prototype.createRoot = function(attrs) {\n  return this.create('root', attrs);\n};\n\nElementFactory.prototype.createLabel = function(attrs) {\n  return this.create('label', attrs);\n};\n\nElementFactory.prototype.createShape = function(attrs) {\n  return this.create('shape', attrs);\n};\n\nElementFactory.prototype.createConnection = function(attrs) {\n  return this.create('connection', attrs);\n};\n\n/**\n * Create a model element with the given type and\n * a number of pre-set attributes.\n *\n * @param  {String} type\n * @param  {Object} attrs\n * @return {djs.model.Base} the newly created model instance\n */\nElementFactory.prototype.create = function(type, attrs) {\n\n  attrs = assign({}, attrs || {});\n\n  if (!attrs.id) {\n    attrs.id = type + '_' + (this._uid++);\n  }\n\n  return create(type, attrs);\n};","'use strict';\n\nmodule.exports.elementToString = function(e) {\n  if (!e) {\n    return '<null>';\n  }\n\n  return '<' + e.$type + (e.id ? ' id=\"' + e.id : '') + '\" />';\n};","import Outline from './Outline';\n\nexport default {\n  __init__: [ 'outline' ],\n  outline: [ 'type', Outline ]\n};","import { getBBox } from '../../util/Elements';\n\nvar LOW_PRIORITY = 500;\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  query as domQuery\n} from 'min-dom';\n\nimport {\n  assign\n} from 'min-dash';\n\n\n/**\n * @class\n *\n * A plugin that adds an outline to shapes and connections that may be activated and styled\n * via CSS classes.\n *\n * @param {EventBus} eventBus\n * @param {Styles} styles\n * @param {ElementRegistry} elementRegistry\n */\nexport default function Outline(eventBus, styles, elementRegistry) {\n\n  this.offset = 6;\n\n  var OUTLINE_STYLE = styles.cls('djs-outline', [ 'no-fill' ]);\n\n  var self = this;\n\n  function createOutline(gfx, bounds) {\n    var outline = svgCreate('rect');\n\n    svgAttr(outline, assign({\n      x: 10,\n      y: 10,\n      width: 100,\n      height: 100\n    }, OUTLINE_STYLE));\n\n    svgAppend(gfx, outline);\n\n    return outline;\n  }\n\n  // A low priortity is necessary, because outlines of labels have to be updated\n  // after the label bounds have been updated in the renderer.\n  eventBus.on([ 'shape.added', 'shape.changed' ], LOW_PRIORITY, function(event) {\n    var element = event.element,\n        gfx = event.gfx;\n\n    var outline = domQuery('.djs-outline', gfx);\n\n    if (!outline) {\n      outline = createOutline(gfx, element);\n    }\n\n    self.updateShapeOutline(outline, element);\n  });\n\n  eventBus.on([ 'connection.added', 'connection.changed' ], function(event) {\n    var element = event.element,\n        gfx = event.gfx;\n\n    var outline = domQuery('.djs-outline', gfx);\n\n    if (!outline) {\n      outline = createOutline(gfx, element);\n    }\n\n    self.updateConnectionOutline(outline, element);\n  });\n}\n\n\n/**\n * Updates the outline of a shape respecting the dimension of the\n * element and an outline offset.\n *\n * @param  {SVGElement} outline\n * @param  {djs.model.Base} element\n */\nOutline.prototype.updateShapeOutline = function(outline, element) {\n\n  svgAttr(outline, {\n    x: -this.offset,\n    y: -this.offset,\n    width: element.width + this.offset * 2,\n    height: element.height + this.offset * 2\n  });\n\n};\n\n\n/**\n * Updates the outline of a connection respecting the bounding box of\n * the connection and an outline offset.\n *\n * @param  {SVGElement} outline\n * @param  {djs.model.Base} element\n */\nOutline.prototype.updateConnectionOutline = function(outline, connection) {\n\n  var bbox = getBBox(connection);\n\n  svgAttr(outline, {\n    x: bbox.x - this.offset,\n    y: bbox.y - this.offset,\n    width: bbox.width + this.offset * 2,\n    height: bbox.height + this.offset * 2\n  });\n\n};\n\n\nOutline.$inject = ['eventBus', 'styles', 'elementRegistry'];","var TRAP_PRIORITY = 5000;\n\n/**\n * Installs a click trap that prevents a ghost click following a dragging operation.\n *\n * @return {Function} a function to immediately remove the installed trap.\n */\nexport function install(eventBus, eventName) {\n\n  eventName = eventName || 'element.click';\n\n  function trap() {\n    return false;\n  }\n\n  eventBus.once(eventName, TRAP_PRIORITY, trap);\n\n  return function() {\n    eventBus.off(eventName, trap);\n  };\n}","import {\n  isCmd,\n  isKey,\n  isShift\n} from './KeyboardUtil';\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * Adds default keyboard bindings.\n *\n * This does not pull in any features will bind only actions that\n * have previously been registered against the editorActions component.\n *\n * @param {EventBus} eventBus\n * @param {Keyboard} keyboard\n */\nexport default function KeyboardBindings(eventBus, keyboard) {\n\n  var self = this;\n\n  eventBus.on('editorActions.init', LOW_PRIORITY, function(event) {\n\n    var editorActions = event.editorActions;\n\n    self.registerBindings(keyboard, editorActions);\n  });\n}\n\nKeyboardBindings.$inject = [\n  'eventBus',\n  'keyboard'\n];\n\n\n/**\n * Register available keyboard bindings.\n *\n * @param {Keyboard} keyboard\n * @param {EditorActions} editorActions\n */\nKeyboardBindings.prototype.registerBindings = function(keyboard, editorActions) {\n\n  /**\n   * Add keyboard binding if respective editor action\n   * is registered.\n   *\n   * @param {String} action name\n   * @param {Function} fn that implements the key binding\n   */\n  function addListener(action, fn) {\n\n    if (editorActions.isRegistered(action)) {\n      keyboard.addListener(fn);\n    }\n  }\n\n\n  // undo\n  // (CTRL|CMD) + Z\n  addListener('undo', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isCmd(event) && !isShift(event) && isKey(['z', 'Z'], event)) {\n      editorActions.trigger('undo');\n\n      return true;\n    }\n  });\n\n  // redo\n  // CTRL + Y\n  // CMD + SHIFT + Z\n  addListener('redo', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isCmd(event) && (isKey(['y', 'Y'], event) || (isKey(['z', 'Z'], event) && isShift(event)))) {\n      editorActions.trigger('redo');\n\n      return true;\n    }\n  });\n\n  // copy\n  // CTRL/CMD + C\n  addListener('copy', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isCmd(event) && isKey(['c', 'C'], event)) {\n      editorActions.trigger('copy');\n\n      return true;\n    }\n  });\n\n  // paste\n  // CTRL/CMD + V\n  addListener('paste', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isCmd(event) && isKey(['v', 'V'], event)) {\n      editorActions.trigger('paste');\n\n      return true;\n    }\n  });\n\n  // zoom in one step\n  // CTRL/CMD + +\n  addListener('stepZoom', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isKey([ '+', 'Add' ], event) && isCmd(event)) {\n      editorActions.trigger('stepZoom', { value: 1 });\n\n      return true;\n    }\n  });\n\n  // zoom out one step\n  // CTRL + -\n  addListener('stepZoom', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isKey([ '-', 'Subtract' ], event) && isCmd(event)) {\n      editorActions.trigger('stepZoom', { value: -1 });\n\n      return true;\n    }\n  });\n\n  // zoom to the default level\n  // CTRL + 0\n  addListener('zoom', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isKey('0', event) && isCmd(event)) {\n      editorActions.trigger('zoom', { value: 1 });\n\n      return true;\n    }\n  });\n\n  // delete selected element\n  // DEL\n  addListener('removeSelection', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isKey([ 'Delete', 'Del' ], event)) {\n      editorActions.trigger('removeSelection');\n\n      return true;\n    }\n  });\n};","'use strict';\n\n/**\n * This file contains portions that got extraced from Snap.svg (licensed Apache-2.0).\n *\n * @see https://github.com/adobe-webplatform/Snap.svg/blob/master/src/path.js\n */\n\n/* eslint no-fallthrough: \"off\" */\n\nvar has = 'hasOwnProperty',\n    p2s = /,?([a-z]),?/gi,\n    toFloat = parseFloat,\n    math = Math,\n    PI = math.PI,\n    mmin = math.min,\n    mmax = math.max,\n    pow = math.pow,\n    abs = math.abs,\n    pathCommand = /([a-z])[\\s,]*((-?\\d*\\.?\\d*(?:e[-+]?\\d+)?[\\s]*,?[\\s]*)+)/ig,\n    pathValues = /(-?\\d*\\.?\\d*(?:e[-+]?\\\\d+)?)[\\s]*,?[\\s]*/ig;\n\nfunction is(o, type) {\n  type = String.prototype.toLowerCase.call(type);\n\n  if (type == 'finite') {\n    return isFinite(o);\n  }\n\n  if (type == 'array' && (o instanceof Array || Array.isArray && Array.isArray(o))) {\n    return true;\n  }\n\n  return (type == 'null' && o === null) ||\n         (type == typeof o && o !== null) ||\n         (type == 'object' && o === Object(o)) ||\n         Object.prototype.toString.call(o).slice(8, -1).toLowerCase() == type;\n}\n\nfunction clone(obj) {\n\n  if (typeof obj == 'function' || Object(obj) !== obj) {\n    return obj;\n  }\n\n  var res = new obj.constructor;\n\n  for (var key in obj) if (obj[has](key)) {\n    res[key] = clone(obj[key]);\n  }\n\n  return res;\n}\n\nfunction repush(array, item) {\n  for (var i = 0, ii = array.length; i < ii; i++) if (array[i] === item) {\n    return array.push(array.splice(i, 1)[0]);\n  }\n}\n\nfunction cacher(f, scope, postprocessor) {\n\n  function newf() {\n\n    var arg = Array.prototype.slice.call(arguments, 0),\n        args = arg.join('\\u2400'),\n        cache = newf.cache = newf.cache || {},\n        count = newf.count = newf.count || [];\n\n    if (cache[has](args)) {\n      repush(count, args);\n      return postprocessor ? postprocessor(cache[args]) : cache[args];\n    }\n\n    count.length >= 1e3 && delete cache[count.shift()];\n    count.push(args);\n    cache[args] = f.apply(scope, arg);\n\n    return postprocessor ? postprocessor(cache[args]) : cache[args];\n  }\n  return newf;\n}\n\nfunction parsePathString(pathString) {\n\n  if (!pathString) {\n    return null;\n  }\n\n  var pth = paths(pathString);\n\n  if (pth.arr) {\n    return clone(pth.arr);\n  }\n\n  var paramCounts = { a: 7, c: 6, o: 2, h: 1, l: 2, m: 2, r: 4, q: 4, s: 4, t: 2, v: 1, u: 3, z: 0 },\n      data = [];\n\n  if (is(pathString, 'array') && is(pathString[0], 'array')) { // rough assumption\n    data = clone(pathString);\n  }\n\n  if (!data.length) {\n\n    String(pathString).replace(pathCommand, function(a, b, c) {\n      var params = [],\n          name = b.toLowerCase();\n\n      c.replace(pathValues, function(a, b) {\n        b && params.push(+b);\n      });\n\n      if (name == 'm' && params.length > 2) {\n        data.push([b].concat(params.splice(0, 2)));\n        name = 'l';\n        b = b == 'm' ? 'l' : 'L';\n      }\n\n      if (name == 'o' && params.length == 1) {\n        data.push([b, params[0]]);\n      }\n\n      if (name == 'r') {\n        data.push([b].concat(params));\n      } else while (params.length >= paramCounts[name]) {\n        data.push([b].concat(params.splice(0, paramCounts[name])));\n        if (!paramCounts[name]) {\n          break;\n        }\n      }\n    });\n  }\n\n  data.toString = paths.toString;\n  pth.arr = clone(data);\n\n  return data;\n}\n\nfunction paths(ps) {\n  var p = paths.ps = paths.ps || {};\n\n  if (p[ps]) {\n    p[ps].sleep = 100;\n  } else {\n    p[ps] = {\n      sleep: 100\n    };\n  }\n\n  setTimeout(function() {\n    for (var key in p) if (p[has](key) && key != ps) {\n      p[key].sleep--;\n      !p[key].sleep && delete p[key];\n    }\n  });\n\n  return p[ps];\n}\n\nfunction box(x, y, width, height) {\n  if (x == null) {\n    x = y = width = height = 0;\n  }\n\n  if (y == null) {\n    y = x.y;\n    width = x.width;\n    height = x.height;\n    x = x.x;\n  }\n\n  return {\n    x: x,\n    y: y,\n    width: width,\n    w: width,\n    height: height,\n    h: height,\n    x2: x + width,\n    y2: y + height,\n    cx: x + width / 2,\n    cy: y + height / 2,\n    r1: math.min(width, height) / 2,\n    r2: math.max(width, height) / 2,\n    r0: math.sqrt(width * width + height * height) / 2,\n    path: rectPath(x, y, width, height),\n    vb: [x, y, width, height].join(' ')\n  };\n}\n\nfunction pathToString() {\n  return this.join(',').replace(p2s, '$1');\n}\n\nfunction pathClone(pathArray) {\n  var res = clone(pathArray);\n  res.toString = pathToString;\n  return res;\n}\n\nfunction findDotsAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t) {\n  var t1 = 1 - t,\n      t13 = pow(t1, 3),\n      t12 = pow(t1, 2),\n      t2 = t * t,\n      t3 = t2 * t,\n      x = t13 * p1x + t12 * 3 * t * c1x + t1 * 3 * t * t * c2x + t3 * p2x,\n      y = t13 * p1y + t12 * 3 * t * c1y + t1 * 3 * t * t * c2y + t3 * p2y,\n      mx = p1x + 2 * t * (c1x - p1x) + t2 * (c2x - 2 * c1x + p1x),\n      my = p1y + 2 * t * (c1y - p1y) + t2 * (c2y - 2 * c1y + p1y),\n      nx = c1x + 2 * t * (c2x - c1x) + t2 * (p2x - 2 * c2x + c1x),\n      ny = c1y + 2 * t * (c2y - c1y) + t2 * (p2y - 2 * c2y + c1y),\n      ax = t1 * p1x + t * c1x,\n      ay = t1 * p1y + t * c1y,\n      cx = t1 * c2x + t * p2x,\n      cy = t1 * c2y + t * p2y,\n      alpha = (90 - math.atan2(mx - nx, my - ny) * 180 / PI);\n\n  return {\n    x: x,\n    y: y,\n    m: { x: mx, y: my },\n    n: { x: nx, y: ny },\n    start: { x: ax, y: ay },\n    end: { x: cx, y: cy },\n    alpha: alpha\n  };\n}\n\nfunction bezierBBox(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y) {\n\n  if (!is(p1x, 'array')) {\n    p1x = [p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y];\n  }\n\n  var bbox = curveBBox.apply(null, p1x);\n\n  return box(\n    bbox.min.x,\n    bbox.min.y,\n    bbox.max.x - bbox.min.x,\n    bbox.max.y - bbox.min.y\n  );\n}\n\nfunction isPointInsideBBox(bbox, x, y) {\n  return x >= bbox.x &&\n    x <= bbox.x + bbox.width &&\n    y >= bbox.y &&\n    y <= bbox.y + bbox.height;\n}\n\nfunction isBBoxIntersect(bbox1, bbox2) {\n  bbox1 = box(bbox1);\n  bbox2 = box(bbox2);\n  return isPointInsideBBox(bbox2, bbox1.x, bbox1.y)\n    || isPointInsideBBox(bbox2, bbox1.x2, bbox1.y)\n    || isPointInsideBBox(bbox2, bbox1.x, bbox1.y2)\n    || isPointInsideBBox(bbox2, bbox1.x2, bbox1.y2)\n    || isPointInsideBBox(bbox1, bbox2.x, bbox2.y)\n    || isPointInsideBBox(bbox1, bbox2.x2, bbox2.y)\n    || isPointInsideBBox(bbox1, bbox2.x, bbox2.y2)\n    || isPointInsideBBox(bbox1, bbox2.x2, bbox2.y2)\n    || (bbox1.x < bbox2.x2 && bbox1.x > bbox2.x\n        || bbox2.x < bbox1.x2 && bbox2.x > bbox1.x)\n    && (bbox1.y < bbox2.y2 && bbox1.y > bbox2.y\n        || bbox2.y < bbox1.y2 && bbox2.y > bbox1.y);\n}\n\nfunction base3(t, p1, p2, p3, p4) {\n  var t1 = -3 * p1 + 9 * p2 - 9 * p3 + 3 * p4,\n      t2 = t * t1 + 6 * p1 - 12 * p2 + 6 * p3;\n  return t * t2 - 3 * p1 + 3 * p2;\n}\n\nfunction bezlen(x1, y1, x2, y2, x3, y3, x4, y4, z) {\n\n  if (z == null) {\n    z = 1;\n  }\n\n  z = z > 1 ? 1 : z < 0 ? 0 : z;\n\n  var z2 = z / 2,\n      n = 12,\n      Tvalues = [-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],\n      Cvalues = [0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],\n      sum = 0;\n\n  for (var i = 0; i < n; i++) {\n    var ct = z2 * Tvalues[i] + z2,\n        xbase = base3(ct, x1, x2, x3, x4),\n        ybase = base3(ct, y1, y2, y3, y4),\n        comb = xbase * xbase + ybase * ybase;\n\n    sum += Cvalues[i] * math.sqrt(comb);\n  }\n\n  return z2 * sum;\n}\n\n\nfunction intersectLines(x1, y1, x2, y2, x3, y3, x4, y4) {\n\n  if (\n    mmax(x1, x2) < mmin(x3, x4) ||\n      mmin(x1, x2) > mmax(x3, x4) ||\n      mmax(y1, y2) < mmin(y3, y4) ||\n      mmin(y1, y2) > mmax(y3, y4)\n  ) {\n    return;\n  }\n\n  var nx = (x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\n      ny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\n      denominator = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n\n  if (!denominator) {\n    return;\n  }\n\n  var px = nx / denominator,\n      py = ny / denominator,\n      px2 = +px.toFixed(2),\n      py2 = +py.toFixed(2);\n\n  if (\n    px2 < +mmin(x1, x2).toFixed(2) ||\n      px2 > +mmax(x1, x2).toFixed(2) ||\n      px2 < +mmin(x3, x4).toFixed(2) ||\n      px2 > +mmax(x3, x4).toFixed(2) ||\n      py2 < +mmin(y1, y2).toFixed(2) ||\n      py2 > +mmax(y1, y2).toFixed(2) ||\n      py2 < +mmin(y3, y4).toFixed(2) ||\n      py2 > +mmax(y3, y4).toFixed(2)\n  ) {\n    return;\n  }\n\n  return { x: px, y: py };\n}\n\nfunction findBezierIntersections(bez1, bez2, justCount) {\n  var bbox1 = bezierBBox(bez1),\n      bbox2 = bezierBBox(bez2);\n\n  if (!isBBoxIntersect(bbox1, bbox2)) {\n    return justCount ? 0 : [];\n  }\n\n  var l1 = bezlen.apply(0, bez1),\n      l2 = bezlen.apply(0, bez2),\n      n1 = ~~(l1 / 5),\n      n2 = ~~(l2 / 5),\n      dots1 = [],\n      dots2 = [],\n      xy = {},\n      res = justCount ? 0 : [];\n\n  for (var i = 0; i < n1 + 1; i++) {\n    var p = findDotsAtSegment.apply(0, bez1.concat(i / n1));\n    dots1.push({ x: p.x, y: p.y, t: i / n1 });\n  }\n\n  for (i = 0; i < n2 + 1; i++) {\n    p = findDotsAtSegment.apply(0, bez2.concat(i / n2));\n    dots2.push({ x: p.x, y: p.y, t: i / n2 });\n  }\n\n  for (i = 0; i < n1; i++) {\n\n    for (var j = 0; j < n2; j++) {\n      var di = dots1[i],\n          di1 = dots1[i + 1],\n          dj = dots2[j],\n          dj1 = dots2[j + 1],\n          ci = abs(di1.x - di.x) < .01 ? 'y' : 'x',\n          cj = abs(dj1.x - dj.x) < .01 ? 'y' : 'x',\n          is = intersectLines(di.x, di.y, di1.x, di1.y, dj.x, dj.y, dj1.x, dj1.y);\n\n      if (is) {\n\n        if (xy[is.x.toFixed(0)] == is.y.toFixed(0)) {\n          continue;\n        }\n\n        xy[is.x.toFixed(0)] = is.y.toFixed(0);\n\n        var t1 = di.t + abs((is[ci] - di[ci]) / (di1[ci] - di[ci])) * (di1.t - di.t),\n            t2 = dj.t + abs((is[cj] - dj[cj]) / (dj1[cj] - dj[cj])) * (dj1.t - dj.t);\n\n        if (t1 >= 0 && t1 <= 1 && t2 >= 0 && t2 <= 1) {\n\n          if (justCount) {\n            res++;\n          } else {\n            res.push({\n              x: is.x,\n              y: is.y,\n              t1: t1,\n              t2: t2\n            });\n          }\n        }\n      }\n    }\n  }\n\n  return res;\n}\n\n\n/**\n * Find or counts the intersections between two SVG paths.\n *\n * Returns a number in counting mode and a list of intersections otherwise.\n *\n * A single intersection entry contains the intersection coordinates (x, y)\n * as well as additional information regarding the intersecting segments\n * on each path (segment1, segment2) and the relative location of the\n * intersection on these segments (t1, t2).\n *\n * The path may be an SVG path string or a list of path components\n * such as `[ [ 'M', 0, 10 ], [ 'L', 20, 0 ] ]`.\n *\n * @example\n *\n * var intersections = findPathIntersections(\n *   'M0,0L100,100',\n *   [ [ 'M', 0, 100 ], [ 'L', 100, 0 ] ]\n * );\n *\n * // intersections = [\n * //   { x: 50, y: 50, segment1: 1, segment2: 1, t1: 0.5, t2: 0.5 }\n * //\n *\n * @param {String|Array<PathDef>} path1\n * @param {String|Array<PathDef>} path2\n * @param {Boolean} [justCount=false]\n *\n * @return {Array<Intersection>|Number}\n */\nfunction findPathIntersections(path1, path2, justCount) {\n  path1 = pathToCurve(path1);\n  path2 = pathToCurve(path2);\n\n  var x1, y1, x2, y2, x1m, y1m, x2m, y2m, bez1, bez2,\n      res = justCount ? 0 : [];\n\n  for (var i = 0, ii = path1.length; i < ii; i++) {\n    var pi = path1[i];\n\n    if (pi[0] == 'M') {\n      x1 = x1m = pi[1];\n      y1 = y1m = pi[2];\n    } else {\n\n      if (pi[0] == 'C') {\n        bez1 = [x1, y1].concat(pi.slice(1));\n        x1 = bez1[6];\n        y1 = bez1[7];\n      } else {\n        bez1 = [x1, y1, x1, y1, x1m, y1m, x1m, y1m];\n        x1 = x1m;\n        y1 = y1m;\n      }\n\n      for (var j = 0, jj = path2.length; j < jj; j++) {\n        var pj = path2[j];\n\n        if (pj[0] == 'M') {\n          x2 = x2m = pj[1];\n          y2 = y2m = pj[2];\n        } else {\n\n          if (pj[0] == 'C') {\n            bez2 = [x2, y2].concat(pj.slice(1));\n            x2 = bez2[6];\n            y2 = bez2[7];\n          } else {\n            bez2 = [x2, y2, x2, y2, x2m, y2m, x2m, y2m];\n            x2 = x2m;\n            y2 = y2m;\n          }\n\n          var intr = findBezierIntersections(bez1, bez2, justCount);\n\n          if (justCount) {\n            res += intr;\n          } else {\n\n            for (var k = 0, kk = intr.length; k < kk; k++) {\n              intr[k].segment1 = i;\n              intr[k].segment2 = j;\n              intr[k].bez1 = bez1;\n              intr[k].bez2 = bez2;\n            }\n\n            res = res.concat(intr);\n          }\n        }\n      }\n    }\n  }\n\n  return res;\n}\n\n\nfunction rectPath(x, y, w, h, r) {\n  if (r) {\n    return [\n      ['M', +x + (+r), y],\n      ['l', w - r * 2, 0],\n      ['a', r, r, 0, 0, 1, r, r],\n      ['l', 0, h - r * 2],\n      ['a', r, r, 0, 0, 1, -r, r],\n      ['l', r * 2 - w, 0],\n      ['a', r, r, 0, 0, 1, -r, -r],\n      ['l', 0, r * 2 - h],\n      ['a', r, r, 0, 0, 1, r, -r],\n      ['z']\n    ];\n  }\n\n  var res = [['M', x, y], ['l', w, 0], ['l', 0, h], ['l', -w, 0], ['z']];\n  res.toString = pathToString;\n\n  return res;\n}\n\nfunction ellipsePath(x, y, rx, ry, a) {\n  if (a == null && ry == null) {\n    ry = rx;\n  }\n\n  x = +x;\n  y = +y;\n  rx = +rx;\n  ry = +ry;\n\n  if (a != null) {\n    var rad = Math.PI / 180,\n        x1 = x + rx * Math.cos(-ry * rad),\n        x2 = x + rx * Math.cos(-a * rad),\n        y1 = y + rx * Math.sin(-ry * rad),\n        y2 = y + rx * Math.sin(-a * rad),\n        res = [['M', x1, y1], ['A', rx, rx, 0, +(a - ry > 180), 0, x2, y2]];\n  } else {\n    res = [\n      ['M', x, y],\n      ['m', 0, -ry],\n      ['a', rx, ry, 0, 1, 1, 0, 2 * ry],\n      ['a', rx, ry, 0, 1, 1, 0, -2 * ry],\n      ['z']\n    ];\n  }\n\n  res.toString = pathToString;\n\n  return res;\n}\n\n\nfunction pathToAbsolute(pathArray) {\n  var pth = paths(pathArray);\n\n  if (pth.abs) {\n    return pathClone(pth.abs);\n  }\n\n  if (!is(pathArray, 'array') || !is(pathArray && pathArray[0], 'array')) { // rough assumption\n    pathArray = parsePathString(pathArray);\n  }\n\n  if (!pathArray || !pathArray.length) {\n    return [['M', 0, 0]];\n  }\n\n  var res = [],\n      x = 0,\n      y = 0,\n      mx = 0,\n      my = 0,\n      start = 0,\n      pa0;\n\n  if (pathArray[0][0] == 'M') {\n    x = +pathArray[0][1];\n    y = +pathArray[0][2];\n    mx = x;\n    my = y;\n    start++;\n    res[0] = ['M', x, y];\n  }\n\n  var crz = pathArray.length == 3 &&\n      pathArray[0][0] == 'M' &&\n      pathArray[1][0].toUpperCase() == 'R' &&\n      pathArray[2][0].toUpperCase() == 'Z';\n\n  for (var r, pa, i = start, ii = pathArray.length; i < ii; i++) {\n    res.push(r = []);\n    pa = pathArray[i];\n    pa0 = pa[0];\n\n    if (pa0 != pa0.toUpperCase()) {\n      r[0] = pa0.toUpperCase();\n\n      switch (r[0]) {\n      case 'A':\n        r[1] = pa[1];\n        r[2] = pa[2];\n        r[3] = pa[3];\n        r[4] = pa[4];\n        r[5] = pa[5];\n        r[6] = +pa[6] + x;\n        r[7] = +pa[7] + y;\n        break;\n      case 'V':\n        r[1] = +pa[1] + y;\n        break;\n      case 'H':\n        r[1] = +pa[1] + x;\n        break;\n      case 'R':\n        var dots = [x, y].concat(pa.slice(1));\n\n        for (var j = 2, jj = dots.length; j < jj; j++) {\n          dots[j] = +dots[j] + x;\n          dots[++j] = +dots[j] + y;\n        }\n\n        res.pop();\n        res = res.concat(catmulRomToBezier(dots, crz));\n        break;\n      case 'O':\n        res.pop();\n        dots = ellipsePath(x, y, pa[1], pa[2]);\n        dots.push(dots[0]);\n        res = res.concat(dots);\n        break;\n      case 'U':\n        res.pop();\n        res = res.concat(ellipsePath(x, y, pa[1], pa[2], pa[3]));\n        r = ['U'].concat(res[res.length - 1].slice(-2));\n        break;\n      case 'M':\n        mx = +pa[1] + x;\n        my = +pa[2] + y;\n      default:\n\n        for (j = 1, jj = pa.length; j < jj; j++) {\n          r[j] = +pa[j] + ((j % 2) ? x : y);\n        }\n      }\n    } else if (pa0 == 'R') {\n      dots = [x, y].concat(pa.slice(1));\n      res.pop();\n      res = res.concat(catmulRomToBezier(dots, crz));\n      r = ['R'].concat(pa.slice(-2));\n    } else if (pa0 == 'O') {\n      res.pop();\n      dots = ellipsePath(x, y, pa[1], pa[2]);\n      dots.push(dots[0]);\n      res = res.concat(dots);\n    } else if (pa0 == 'U') {\n      res.pop();\n      res = res.concat(ellipsePath(x, y, pa[1], pa[2], pa[3]));\n      r = ['U'].concat(res[res.length - 1].slice(-2));\n    } else {\n\n      for (var k = 0, kk = pa.length; k < kk; k++) {\n        r[k] = pa[k];\n      }\n    }\n    pa0 = pa0.toUpperCase();\n\n    if (pa0 != 'O') {\n      switch (r[0]) {\n      case 'Z':\n        x = +mx;\n        y = +my;\n        break;\n      case 'H':\n        x = r[1];\n        break;\n      case 'V':\n        y = r[1];\n        break;\n      case 'M':\n        mx = r[r.length - 2];\n        my = r[r.length - 1];\n      default:\n        x = r[r.length - 2];\n        y = r[r.length - 1];\n      }\n    }\n  }\n\n  res.toString = pathToString;\n  pth.abs = pathClone(res);\n\n  return res;\n}\n\nfunction lineToCurve(x1, y1, x2, y2) {\n  return [\n    x1, y1, x2,\n    y2, x2, y2\n  ];\n}\n\nfunction qubicToCurve(x1, y1, ax, ay, x2, y2) {\n  var _13 = 1 / 3,\n      _23 = 2 / 3;\n\n  return [\n    _13 * x1 + _23 * ax,\n    _13 * y1 + _23 * ay,\n    _13 * x2 + _23 * ax,\n    _13 * y2 + _23 * ay,\n    x2,\n    y2\n  ];\n}\n\nfunction arcToCurve(x1, y1, rx, ry, angle, large_arc_flag, sweep_flag, x2, y2, recursive) {\n\n  // for more information of where this math came from visit:\n  // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n  var _120 = PI * 120 / 180,\n      rad = PI / 180 * (+angle || 0),\n      res = [],\n      xy,\n      rotate = cacher(function(x, y, rad) {\n        var X = x * math.cos(rad) - y * math.sin(rad),\n            Y = x * math.sin(rad) + y * math.cos(rad);\n\n        return { x: X, y: Y };\n      });\n\n  if (!recursive) {\n    xy = rotate(x1, y1, -rad);\n    x1 = xy.x;\n    y1 = xy.y;\n    xy = rotate(x2, y2, -rad);\n    x2 = xy.x;\n    y2 = xy.y;\n\n    var x = (x1 - x2) / 2,\n        y = (y1 - y2) / 2;\n\n    var h = (x * x) / (rx * rx) + (y * y) / (ry * ry);\n\n    if (h > 1) {\n      h = math.sqrt(h);\n      rx = h * rx;\n      ry = h * ry;\n    }\n\n    var rx2 = rx * rx,\n        ry2 = ry * ry,\n        k = (large_arc_flag == sweep_flag ? -1 : 1) *\n            math.sqrt(abs((rx2 * ry2 - rx2 * y * y - ry2 * x * x) / (rx2 * y * y + ry2 * x * x))),\n        cx = k * rx * y / ry + (x1 + x2) / 2,\n        cy = k * -ry * x / rx + (y1 + y2) / 2,\n        f1 = math.asin(((y1 - cy) / ry).toFixed(9)),\n        f2 = math.asin(((y2 - cy) / ry).toFixed(9));\n\n    f1 = x1 < cx ? PI - f1 : f1;\n    f2 = x2 < cx ? PI - f2 : f2;\n    f1 < 0 && (f1 = PI * 2 + f1);\n    f2 < 0 && (f2 = PI * 2 + f2);\n\n    if (sweep_flag && f1 > f2) {\n      f1 = f1 - PI * 2;\n    }\n    if (!sweep_flag && f2 > f1) {\n      f2 = f2 - PI * 2;\n    }\n  } else {\n    f1 = recursive[0];\n    f2 = recursive[1];\n    cx = recursive[2];\n    cy = recursive[3];\n  }\n\n  var df = f2 - f1;\n\n  if (abs(df) > _120) {\n    var f2old = f2,\n        x2old = x2,\n        y2old = y2;\n\n    f2 = f1 + _120 * (sweep_flag && f2 > f1 ? 1 : -1);\n    x2 = cx + rx * math.cos(f2);\n    y2 = cy + ry * math.sin(f2);\n    res = arcToCurve(x2, y2, rx, ry, angle, 0, sweep_flag, x2old, y2old, [f2, f2old, cx, cy]);\n  }\n\n  df = f2 - f1;\n\n  var c1 = math.cos(f1),\n      s1 = math.sin(f1),\n      c2 = math.cos(f2),\n      s2 = math.sin(f2),\n      t = math.tan(df / 4),\n      hx = 4 / 3 * rx * t,\n      hy = 4 / 3 * ry * t,\n      m1 = [x1, y1],\n      m2 = [x1 + hx * s1, y1 - hy * c1],\n      m3 = [x2 + hx * s2, y2 - hy * c2],\n      m4 = [x2, y2];\n\n  m2[0] = 2 * m1[0] - m2[0];\n  m2[1] = 2 * m1[1] - m2[1];\n\n  if (recursive) {\n    return [m2, m3, m4].concat(res);\n  } else {\n    res = [m2, m3, m4].concat(res).join().split(',');\n    var newres = [];\n\n    for (var i = 0, ii = res.length; i < ii; i++) {\n      newres[i] = i % 2 ? rotate(res[i - 1], res[i], rad).y : rotate(res[i], res[i + 1], rad).x;\n    }\n\n    return newres;\n  }\n}\n\n// http://schepers.cc/getting-to-the-point\nfunction catmulRomToBezier(crp, z) {\n  var d = [];\n\n  for (var i = 0, iLen = crp.length; iLen - 2 * !z > i; i += 2) {\n    var p = [\n      { x: +crp[i - 2], y: +crp[i - 1] },\n      { x: +crp[i], y: +crp[i + 1] },\n      { x: +crp[i + 2], y: +crp[i + 3] },\n      { x: +crp[i + 4], y: +crp[i + 5] }\n    ];\n\n    if (z) {\n\n      if (!i) {\n        p[0] = { x: +crp[iLen - 2], y: +crp[iLen - 1] };\n      } else if (iLen - 4 == i) {\n        p[3] = { x: +crp[0], y: +crp[1] };\n      } else if (iLen - 2 == i) {\n        p[2] = { x: +crp[0], y: +crp[1] };\n        p[3] = { x: +crp[2], y: +crp[3] };\n      }\n\n    } else {\n\n      if (iLen - 4 == i) {\n        p[3] = p[2];\n      } else if (!i) {\n        p[0] = { x: +crp[i], y: +crp[i + 1] };\n      }\n\n    }\n\n    d.push(['C',\n      (-p[0].x + 6 * p[1].x + p[2].x) / 6,\n      (-p[0].y + 6 * p[1].y + p[2].y) / 6,\n      (p[1].x + 6 * p[2].x - p[3].x) / 6,\n      (p[1].y + 6*p[2].y - p[3].y) / 6,\n      p[2].x,\n      p[2].y\n    ]);\n  }\n\n  return d;\n}\n\n// Returns bounding box of cubic bezier curve.\n// Source: http://blog.hackers-cafe.net/2009/06/how-to-calculate-bezier-curves-bounding.html\n// Original version: NISHIO Hirokazu\n// Modifications: https://github.com/timo22345\nfunction curveBBox(x0, y0, x1, y1, x2, y2, x3, y3) {\n  var tvalues = [],\n      bounds = [[], []],\n      a, b, c, t, t1, t2, b2ac, sqrtb2ac;\n\n  for (var i = 0; i < 2; ++i) {\n\n    if (i == 0) {\n      b = 6 * x0 - 12 * x1 + 6 * x2;\n      a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\n      c = 3 * x1 - 3 * x0;\n    } else {\n      b = 6 * y0 - 12 * y1 + 6 * y2;\n      a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\n      c = 3 * y1 - 3 * y0;\n    }\n\n    if (abs(a) < 1e-12) {\n\n      if (abs(b) < 1e-12) {\n        continue;\n      }\n\n      t = -c / b;\n\n      if (0 < t && t < 1) {\n        tvalues.push(t);\n      }\n\n      continue;\n    }\n\n    b2ac = b * b - 4 * c * a;\n    sqrtb2ac = math.sqrt(b2ac);\n\n    if (b2ac < 0) {\n      continue;\n    }\n\n    t1 = (-b + sqrtb2ac) / (2 * a);\n\n    if (0 < t1 && t1 < 1) {\n      tvalues.push(t1);\n    }\n\n    t2 = (-b - sqrtb2ac) / (2 * a);\n\n    if (0 < t2 && t2 < 1) {\n      tvalues.push(t2);\n    }\n  }\n\n  var j = tvalues.length,\n      jlen = j,\n      mt;\n\n  while (j--) {\n    t = tvalues[j];\n    mt = 1 - t;\n    bounds[0][j] = (mt * mt * mt * x0) + (3 * mt * mt * t * x1) + (3 * mt * t * t * x2) + (t * t * t * x3);\n    bounds[1][j] = (mt * mt * mt * y0) + (3 * mt * mt * t * y1) + (3 * mt * t * t * y2) + (t * t * t * y3);\n  }\n\n  bounds[0][jlen] = x0;\n  bounds[1][jlen] = y0;\n  bounds[0][jlen + 1] = x3;\n  bounds[1][jlen + 1] = y3;\n  bounds[0].length = bounds[1].length = jlen + 2;\n\n  return {\n    min: { x: mmin.apply(0, bounds[0]), y: mmin.apply(0, bounds[1]) },\n    max: { x: mmax.apply(0, bounds[0]), y: mmax.apply(0, bounds[1]) }\n  };\n}\n\nfunction pathToCurve(path, path2) {\n  var pth = !path2 && paths(path);\n\n  if (!path2 && pth.curve) {\n    return pathClone(pth.curve);\n  }\n\n  var p = pathToAbsolute(path),\n      p2 = path2 && pathToAbsolute(path2),\n      attrs = { x: 0, y: 0, bx: 0, by: 0, X: 0, Y: 0, qx: null, qy: null },\n      attrs2 = { x: 0, y: 0, bx: 0, by: 0, X: 0, Y: 0, qx: null, qy: null },\n      processPath = function(path, d, pcom) {\n        var nx, ny;\n\n        if (!path) {\n          return ['C', d.x, d.y, d.x, d.y, d.x, d.y];\n        }\n\n        !(path[0] in { T: 1, Q: 1 }) && (d.qx = d.qy = null);\n\n        switch (path[0]) {\n        case 'M':\n          d.X = path[1];\n          d.Y = path[2];\n          break;\n        case 'A':\n          path = ['C'].concat(arcToCurve.apply(0, [d.x, d.y].concat(path.slice(1))));\n          break;\n        case 'S':\n          if (pcom == 'C' || pcom == 'S') {\n            // In 'S' case we have to take into account, if the previous command is C/S.\n            nx = d.x * 2 - d.bx;\n            // And reflect the previous\n            ny = d.y * 2 - d.by;\n            // command's control point relative to the current point.\n          }\n          else {\n            // or some else or nothing\n            nx = d.x;\n            ny = d.y;\n          }\n          path = ['C', nx, ny].concat(path.slice(1));\n          break;\n        case 'T':\n          if (pcom == 'Q' || pcom == 'T') {\n            // In 'T' case we have to take into account, if the previous command is Q/T.\n            d.qx = d.x * 2 - d.qx;\n            // And make a reflection similar\n            d.qy = d.y * 2 - d.qy;\n            // to case 'S'.\n          }\n          else {\n            // or something else or nothing\n            d.qx = d.x;\n            d.qy = d.y;\n          }\n          path = ['C'].concat(qubicToCurve(d.x, d.y, d.qx, d.qy, path[1], path[2]));\n          break;\n        case 'Q':\n          d.qx = path[1];\n          d.qy = path[2];\n          path = ['C'].concat(qubicToCurve(d.x, d.y, path[1], path[2], path[3], path[4]));\n          break;\n        case 'L':\n          path = ['C'].concat(lineToCurve(d.x, d.y, path[1], path[2]));\n          break;\n        case 'H':\n          path = ['C'].concat(lineToCurve(d.x, d.y, path[1], d.y));\n          break;\n        case 'V':\n          path = ['C'].concat(lineToCurve(d.x, d.y, d.x, path[1]));\n          break;\n        case 'Z':\n          path = ['C'].concat(lineToCurve(d.x, d.y, d.X, d.Y));\n          break;\n        }\n\n        return path;\n      },\n\n      fixArc = function(pp, i) {\n\n        if (pp[i].length > 7) {\n          pp[i].shift();\n          var pi = pp[i];\n\n          while (pi.length) {\n            pcoms1[i] = 'A'; // if created multiple C:s, their original seg is saved\n            p2 && (pcoms2[i] = 'A'); // the same as above\n            pp.splice(i++, 0, ['C'].concat(pi.splice(0, 6)));\n          }\n\n          pp.splice(i, 1);\n          ii = mmax(p.length, p2 && p2.length || 0);\n        }\n      },\n\n      fixM = function(path1, path2, a1, a2, i) {\n\n        if (path1 && path2 && path1[i][0] == 'M' && path2[i][0] != 'M') {\n          path2.splice(i, 0, ['M', a2.x, a2.y]);\n          a1.bx = 0;\n          a1.by = 0;\n          a1.x = path1[i][1];\n          a1.y = path1[i][2];\n          ii = mmax(p.length, p2 && p2.length || 0);\n        }\n      },\n\n      pcoms1 = [], // path commands of original path p\n      pcoms2 = [], // path commands of original path p2\n      pfirst = '', // temporary holder for original path command\n      pcom = ''; // holder for previous path command of original path\n\n  for (var i = 0, ii = mmax(p.length, p2 && p2.length || 0); i < ii; i++) {\n    p[i] && (pfirst = p[i][0]); // save current path command\n\n    if (pfirst != 'C') // C is not saved yet, because it may be result of conversion\n    {\n      pcoms1[i] = pfirst; // Save current path command\n      i && (pcom = pcoms1[i - 1]); // Get previous path command pcom\n    }\n    p[i] = processPath(p[i], attrs, pcom); // Previous path command is inputted to processPath\n\n    if (pcoms1[i] != 'A' && pfirst == 'C') pcoms1[i] = 'C'; // A is the only command\n    // which may produce multiple C:s\n    // so we have to make sure that C is also C in original path\n\n    fixArc(p, i); // fixArc adds also the right amount of A:s to pcoms1\n\n    if (p2) { // the same procedures is done to p2\n      p2[i] && (pfirst = p2[i][0]);\n\n      if (pfirst != 'C') {\n        pcoms2[i] = pfirst;\n        i && (pcom = pcoms2[i - 1]);\n      }\n\n      p2[i] = processPath(p2[i], attrs2, pcom);\n\n      if (pcoms2[i] != 'A' && pfirst == 'C') {\n        pcoms2[i] = 'C';\n      }\n\n      fixArc(p2, i);\n    }\n\n    fixM(p, p2, attrs, attrs2, i);\n    fixM(p2, p, attrs2, attrs, i);\n\n    var seg = p[i],\n        seg2 = p2 && p2[i],\n        seglen = seg.length,\n        seg2len = p2 && seg2.length;\n\n    attrs.x = seg[seglen - 2];\n    attrs.y = seg[seglen - 1];\n    attrs.bx = toFloat(seg[seglen - 4]) || attrs.x;\n    attrs.by = toFloat(seg[seglen - 3]) || attrs.y;\n    attrs2.bx = p2 && (toFloat(seg2[seg2len - 4]) || attrs2.x);\n    attrs2.by = p2 && (toFloat(seg2[seg2len - 3]) || attrs2.y);\n    attrs2.x = p2 && seg2[seg2len - 2];\n    attrs2.y = p2 && seg2[seg2len - 1];\n  }\n\n  if (!p2) {\n    pth.curve = pathClone(p);\n  }\n\n  return p2 ? [p, p2] : p;\n}\n\nmodule.exports = findPathIntersections;","export {\n  default as escapeCSS\n} from 'css.escape';\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\nexport function escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n","import {\n  filter,\n  isNumber\n} from 'min-dash';\n\nvar max = Math.max,\n    min = Math.min;\n\nvar DEFAULT_CHILD_BOX_PADDING = 20;\n\nimport {\n  getBBox\n} from '../../util/Elements';\n\nimport {\n  asTRBL,\n  asBounds\n} from '../../layout/LayoutUtil';\n\n\n/**\n * Substract a TRBL from another\n *\n * @param  {TRBL} trblA\n * @param  {TRBL} trblB\n *\n * @return {TRBL}\n */\nexport function substractTRBL(trblA, trblB) {\n  return {\n    top: trblA.top - trblB.top,\n    right: trblA.right - trblB.right,\n    bottom: trblA.bottom - trblB.bottom,\n    left: trblA.left - trblB.left\n  };\n}\n\n/**\n * Resize the given bounds by the specified delta from a given anchor point.\n *\n * @param {Bounds} bounds the bounding box that should be resized\n * @param {String} direction in which the element is resized (nw, ne, se, sw)\n * @param {Point} delta of the resize operation\n *\n * @return {Bounds} resized bounding box\n */\nexport function resizeBounds(bounds, direction, delta) {\n\n  var dx = delta.x,\n      dy = delta.y;\n\n  switch (direction) {\n\n  case 'nw':\n    return {\n      x: bounds.x + dx,\n      y: bounds.y + dy,\n      width: bounds.width - dx,\n      height: bounds.height - dy\n    };\n\n  case 'sw':\n    return {\n      x: bounds.x + dx,\n      y: bounds.y,\n      width: bounds.width - dx,\n      height: bounds.height + dy\n    };\n\n  case 'ne':\n    return {\n      x: bounds.x,\n      y: bounds.y + dy,\n      width: bounds.width + dx,\n      height: bounds.height - dy\n    };\n\n  case 'se':\n    return {\n      x: bounds.x,\n      y: bounds.y,\n      width: bounds.width + dx,\n      height: bounds.height + dy\n    };\n\n  default:\n    throw new Error('unrecognized direction: ' + direction);\n  }\n}\n\n\n/**\n * Resize the given bounds by applying the passed\n * { top, right, bottom, left } delta.\n *\n * @param {Bounds} bounds\n * @param {TRBL} trblResize\n *\n * @return {Bounds}\n */\nexport function resizeTRBL(bounds, resize) {\n  return {\n    x: bounds.x + (resize.left || 0),\n    y: bounds.y + (resize.top || 0),\n    width: bounds.width - (resize.left || 0) + (resize.right || 0),\n    height: bounds.height - (resize.top || 0) + (resize.bottom || 0)\n  };\n}\n\n\nexport function reattachPoint(bounds, newBounds, point) {\n\n  var sx = bounds.width / newBounds.width,\n      sy = bounds.height / newBounds.height;\n\n  return {\n    x: Math.round((newBounds.x + newBounds.width / 2)) - Math.floor(((bounds.x + bounds.width / 2) - point.x) / sx),\n    y: Math.round((newBounds.y + newBounds.height / 2)) - Math.floor(((bounds.y + bounds.height / 2) - point.y) / sy)\n  };\n}\n\n\nfunction applyConstraints(attr, trbl, resizeConstraints) {\n\n  var value = trbl[attr],\n      minValue = resizeConstraints.min && resizeConstraints.min[attr],\n      maxValue = resizeConstraints.max && resizeConstraints.max[attr];\n\n  if (isNumber(minValue)) {\n    value = (/top|left/.test(attr) ? min : max)(value, minValue);\n  }\n\n  if (isNumber(maxValue)) {\n    value = (/top|left/.test(attr) ? max : min)(value, maxValue);\n  }\n\n  return value;\n}\n\nexport function ensureConstraints(currentBounds, resizeConstraints) {\n\n  if (!resizeConstraints) {\n    return currentBounds;\n  }\n\n  var currentTrbl = asTRBL(currentBounds);\n\n  return asBounds({\n    top: applyConstraints('top', currentTrbl, resizeConstraints),\n    right: applyConstraints('right', currentTrbl, resizeConstraints),\n    bottom: applyConstraints('bottom', currentTrbl, resizeConstraints),\n    left: applyConstraints('left', currentTrbl, resizeConstraints)\n  });\n}\n\n\nexport function getMinResizeBounds(direction, currentBounds, minDimensions, childrenBounds) {\n\n  var currentBox = asTRBL(currentBounds);\n\n  var minBox = {\n    top: /n/.test(direction) ? currentBox.bottom - minDimensions.height : currentBox.top,\n    left: /w/.test(direction) ? currentBox.right - minDimensions.width : currentBox.left,\n    bottom: /s/.test(direction) ? currentBox.top + minDimensions.height : currentBox.bottom,\n    right: /e/.test(direction) ? currentBox.left + minDimensions.width : currentBox.right\n  };\n\n  var childrenBox = childrenBounds ? asTRBL(childrenBounds) : minBox;\n\n  var combinedBox = {\n    top: min(minBox.top, childrenBox.top),\n    left: min(minBox.left, childrenBox.left),\n    bottom: max(minBox.bottom, childrenBox.bottom),\n    right: max(minBox.right, childrenBox.right)\n  };\n\n  return asBounds(combinedBox);\n}\n\nfunction asPadding(mayBePadding, defaultValue) {\n  if (typeof mayBePadding !== 'undefined') {\n    return mayBePadding;\n  } else {\n    return DEFAULT_CHILD_BOX_PADDING;\n  }\n}\n\nexport function addPadding(bbox, padding) {\n  var left, right, top, bottom;\n\n  if (typeof padding === 'object') {\n    left = asPadding(padding.left);\n    right = asPadding(padding.right);\n    top = asPadding(padding.top);\n    bottom = asPadding(padding.bottom);\n  } else {\n    left = right = top = bottom = asPadding(padding);\n  }\n\n  return {\n    x: bbox.x - left,\n    y: bbox.y - top,\n    width: bbox.width + left + right,\n    height: bbox.height + top + bottom\n  };\n}\n\n\n/**\n * Is the given element part of the resize\n * targets min boundary box?\n *\n * This is the default implementation which excludes\n * connections and labels.\n *\n * @param {djs.model.Base} element\n */\nfunction isBBoxChild(element) {\n\n  // exclude connections\n  if (element.waypoints) {\n    return false;\n  }\n\n  // exclude labels\n  if (element.type === 'label') {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Return children bounding computed from a shapes children\n * or a list of prefiltered children.\n *\n * @param  {djs.model.Shape|Array<djs.model.Shape>} shapeOrChildren\n * @param  {Number|Object} padding\n *\n * @return {Bounds}\n */\nexport function computeChildrenBBox(shapeOrChildren, padding) {\n\n  var elements;\n\n  // compute based on shape\n  if (shapeOrChildren.length === undefined) {\n    // grab all the children that are part of the\n    // parents children box\n    elements = filter(shapeOrChildren.children, isBBoxChild);\n\n  } else {\n    elements = shapeOrChildren;\n  }\n\n  if (elements.length) {\n    return addPadding(getBBox(elements), padding);\n  }\n}\n","import inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n/**\n * A basic provider that may be extended to implement modeling rules.\n *\n * Extensions should implement the init method to actually add their custom\n * modeling checks. Checks may be added via the #addRule(action, fn) method.\n *\n * @param {EventBus} eventBus\n */\nexport default function RuleProvider(eventBus) {\n  CommandInterceptor.call(this, eventBus);\n\n  this.init();\n}\n\nRuleProvider.$inject = [ 'eventBus' ];\n\ninherits(RuleProvider, CommandInterceptor);\n\n\n/**\n * Adds a modeling rule for the given action, implemented through\n * a callback function.\n *\n * The function will receive the modeling specific action context\n * to perform its check. It must return `false` to disallow the\n * action from happening or `true` to allow the action.\n *\n * A rule provider may pass over the evaluation to lower priority\n * rules by returning return nothing (or <code>undefined</code>).\n *\n * @example\n *\n * ResizableRules.prototype.init = function() {\n *\n *   \\/**\n *    * Return `true`, `false` or nothing to denote\n *    * _allowed_, _not allowed_ and _continue evaluating_.\n *    *\\/\n *   this.addRule('shape.resize', function(context) {\n *\n *     var shape = context.shape;\n *\n *     if (!context.newBounds) {\n *       // check general resizability\n *       if (!shape.resizable) {\n *         return false;\n *       }\n *\n *       // not returning anything (read: undefined)\n *       // will continue the evaluation of other rules\n *       // (with lower priority)\n *       return;\n *     } else {\n *       // element must have minimum size of 10*10 points\n *       return context.newBounds.width > 10 && context.newBounds.height > 10;\n *     }\n *   });\n * };\n *\n * @param {String|Array<String>} actions the identifier for the modeling action to check\n * @param {Number} [priority] the priority at which this rule is being applied\n * @param {Function} fn the callback function that performs the actual check\n */\nRuleProvider.prototype.addRule = function(actions, priority, fn) {\n\n  var self = this;\n\n  if (typeof actions === 'string') {\n    actions = [ actions ];\n  }\n\n  actions.forEach(function(action) {\n\n    self.canExecute(action, priority, function(context, action, event) {\n      return fn(context);\n    }, true);\n  });\n};\n\n/**\n * Implement this method to add new rules during provider initialization.\n */\nRuleProvider.prototype.init = function() {};","import {\n  forEach,\n  isArray\n} from 'min-dash';\n\nvar NOT_REGISTERED_ERROR = 'is not a registered action',\n    IS_REGISTERED_ERROR = 'is already registered';\n\n\n/**\n * An interface that provides access to modeling actions by decoupling\n * the one who requests the action to be triggered and the trigger itself.\n *\n * It's possible to add new actions by registering them with registerAction\n * and likewise unregister existing ones with unregisterAction.\n *\n *\n * ## Life-Cycle and configuration\n *\n * The editor actions will wait for diagram initialization before\n * registering default actions _and_ firing an `editorActions.init` event.\n *\n * Interested parties may listen to the `editorActions.init` event with\n * low priority to check, which actions got registered. Other components\n * may use the event to register their own actions via `registerAction`.\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function EditorActions(eventBus, injector) {\n\n  // initialize actions\n  this._actions = {};\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n\n    // all diagram modules got loaded; check which ones\n    // are available and register the respective default actions\n    self._registerDefaultActions(injector);\n\n    // ask interested parties to register available editor\n    // actions on diagram initialization\n    eventBus.fire('editorActions.init', {\n      editorActions: self\n    });\n  });\n\n}\n\nEditorActions.$inject = [\n  'eventBus',\n  'injector'\n];\n\n/**\n * Register default actions.\n *\n * @param {Injector} injector\n */\nEditorActions.prototype._registerDefaultActions = function(injector) {\n\n  // (1) retrieve optional components to integrate with\n\n  var commandStack = injector.get('commandStack', false);\n  var modeling = injector.get('modeling', false);\n  var selection = injector.get('selection', false);\n  var zoomScroll = injector.get('zoomScroll', false);\n  var copyPaste = injector.get('copyPaste', false);\n  var canvas = injector.get('canvas', false);\n  var rules = injector.get('rules', false);\n  var mouseTracking = injector.get('mouseTracking', false);\n  var keyboardMove = injector.get('keyboardMove', false);\n  var keyboardMoveSelection = injector.get('keyboardMoveSelection', false);\n\n  // (2) check components and register actions\n\n  if (commandStack) {\n    this.register('undo', function() {\n      commandStack.undo();\n    });\n\n    this.register('redo', function() {\n      commandStack.redo();\n    });\n  }\n\n  if (copyPaste && selection) {\n    this.register('copy', function() {\n      var selectedElements = selection.get();\n\n      copyPaste.copy(selectedElements);\n    });\n  }\n\n  if (mouseTracking && copyPaste) {\n    this.register('paste', function() {\n      var context = mouseTracking.getHoverContext();\n\n      copyPaste.paste(context);\n    });\n  }\n\n  if (zoomScroll) {\n    this.register('stepZoom', function(opts) {\n      zoomScroll.stepZoom(opts.value);\n    });\n  }\n\n  if (canvas) {\n    this.register('zoom', function(opts) {\n      canvas.zoom(opts.value);\n    });\n  }\n\n  if (modeling && selection && rules) {\n    this.register('removeSelection', function() {\n\n      var selectedElements = selection.get();\n\n      if (!selectedElements.length) {\n        return;\n      }\n\n      var allowed = rules.allowed('elements.delete', { elements: selectedElements }),\n          removableElements;\n\n      if (allowed === false) {\n        return;\n      }\n      else if (isArray(allowed)) {\n        removableElements = allowed;\n      }\n      else {\n        removableElements = selectedElements;\n      }\n\n      if (removableElements.length) {\n        modeling.removeElements(removableElements.slice());\n      }\n    });\n  }\n\n  if (keyboardMove) {\n    this.register('moveCanvas', function(opts) {\n      keyboardMove.moveCanvas(opts);\n    });\n  }\n\n  if (keyboardMoveSelection) {\n    this.register('moveSelection', function(opts) {\n      keyboardMoveSelection.moveSelection(opts.direction, opts.accelerated);\n    });\n  }\n\n};\n\n\n/**\n * Triggers a registered action\n *\n * @param  {String} action\n * @param  {Object} opts\n *\n * @return {Unknown} Returns what the registered listener returns\n */\nEditorActions.prototype.trigger = function(action, opts) {\n  if (!this._actions[action]) {\n    throw error(action, NOT_REGISTERED_ERROR);\n  }\n\n  return this._actions[action](opts);\n};\n\n\n/**\n * Registers a collections of actions.\n * The key of the object will be the name of the action.\n *\n * @example\n * \n * var actions = {\n *   spaceTool: function() {\n *     spaceTool.activateSelection();\n *   },\n *   lassoTool: function() {\n *     lassoTool.activateSelection();\n *   }\n * ];\n *\n * editorActions.register(actions);\n *\n * editorActions.isRegistered('spaceTool'); // true\n * \n *\n * @param  {Object} actions\n */\nEditorActions.prototype.register = function(actions, listener) {\n  var self = this;\n\n  if (typeof actions === 'string') {\n    return this._registerAction(actions, listener);\n  }\n\n  forEach(actions, function(listener, action) {\n    self._registerAction(action, listener);\n  });\n};\n\n/**\n * Registers a listener to an action key\n *\n * @param  {String} action\n * @param  {Function} listener\n */\nEditorActions.prototype._registerAction = function(action, listener) {\n  if (this.isRegistered(action)) {\n    throw error(action, IS_REGISTERED_ERROR);\n  }\n\n  this._actions[action] = listener;\n};\n\n/**\n * Unregister an existing action\n *\n * @param {String} action\n */\nEditorActions.prototype.unregister = function(action) {\n  if (!this.isRegistered(action)) {\n    throw error(action, NOT_REGISTERED_ERROR);\n  }\n\n  this._actions[action] = undefined;\n};\n\n/**\n * Returns the number of actions that are currently registered\n *\n * @return {Number}\n */\nEditorActions.prototype.getActions = function() {\n  return Object.keys(this._actions);\n};\n\n/**\n * Checks wether the given action is registered\n *\n * @param {String} action\n *\n * @return {Boolean}\n */\nEditorActions.prototype.isRegistered = function(action) {\n  return !!this._actions[action];\n};\n\n\nfunction error(action, message) {\n  return new Error(action + ' ' + message);\n}\n","'use strict';\n\nvar getOrientation = require('diagram-js/lib/layout/LayoutUtil').getOrientation;\n\nvar is = require('../../util/ModelUtil').is,\n    getDefinition = require('../../util/ModelUtil').getDefinition;\n\n\n/**\n * Get orientation of the given position rectangle in relation to the\n * given target rectangle. When the position is near a corner (respecting\n * the given offet) the string 'corner' is returned.\n *\n * A padding (positive or negative) may be passed to influence\n * horizontal / vertical orientation and intersection.\n *\n * @param {Bounds} position\n * @param {Bounds} target\n * @param {Point|Number} padding\n * @param {Number} offset\n */\nfunction getCornerlessOrientation(position, target, padding, offset) {\n\n  // don't snap to top left corner\n  if (position.x - offset < target.x &&\n      position.y - offset < target.y) {\n    return 'corner';\n  }\n\n  // don't snap to top right corner\n  if (position.x + offset > target.x + target.width &&\n      position.y - offset < target.y) {\n    return 'corner';\n  }\n\n  // don't snap to bottom left corner\n  if (position.x - offset < target.x &&\n      position.y + offset > target.y + target.height) {\n    return 'corner';\n  }\n\n  // don't snap to bottom right corner\n  if (position.x + offset > target.x + target.width &&\n      position.y + offset > target.y + target.height) {\n    return 'corner';\n  }\n\n  return getOrientation(position, target, padding);\n}\n\n\nfunction getCriterionAttachment(position, target) {\n\n  var orientation;\n\n  var definition = getDefinition(target);\n\n  if (is(target, 'cmmn:PlanItem') && is(definition, 'cmmn:Stage')) {\n    orientation = getCornerlessOrientation(position, target, -15, 20);\n\n  } else\n  if (is(definition, 'cmmn:Milestone')) {\n    orientation = getCornerlessOrientation(position, target, -3, 7);\n\n  } else {\n    orientation = getOrientation(position, target, -15);\n  }\n\n  if (orientation !== 'intersect') {\n    return orientation;\n  } else {\n    return null;\n  }\n}\n\nmodule.exports.getCriterionAttachment = getCriterionAttachment;","import {\n  roundPoint\n} from '../layout/LayoutUtil';\n\nimport {\n  center,\n  delta\n} from './PositionUtil';\n\n\n/**\n * Calculates the absolute point relative to the new element's position\n *\n * @param {point} point [absolute]\n * @param {bounds} oldBounds\n * @param {bounds} newBounds\n *\n * @return {point} point [absolute]\n */\nexport function getNewAttachPoint(point, oldBounds, newBounds) {\n  var oldCenter = center(oldBounds),\n      newCenter = center(newBounds),\n      oldDelta = delta(point, oldCenter);\n\n  var newDelta = {\n    x: oldDelta.x * (newBounds.width / oldBounds.width),\n    y: oldDelta.y * (newBounds.height / oldBounds.height)\n  };\n\n  return roundPoint({\n    x: newCenter.x + newDelta.x,\n    y: newCenter.y + newDelta.y\n  });\n}\n\n\n/**\n * Calculates the shape's delta relative to a new position\n * of a certain element's bounds\n *\n * @param {djs.model.Shape} point [absolute]\n * @param {bounds} oldBounds\n * @param {bounds} newBounds\n *\n * @return {delta} delta\n */\nexport function getNewAttachShapeDelta(shape, oldBounds, newBounds) {\n  var shapeCenter = center(shape),\n      oldCenter = center(oldBounds),\n      newCenter = center(newBounds),\n      shapeDelta = delta(shape, shapeCenter),\n      oldCenterDelta = delta(shapeCenter, oldCenter);\n\n  var newCenterDelta = {\n    x: oldCenterDelta.x * (newBounds.width / oldBounds.width),\n    y: oldCenterDelta.y * (newBounds.height / oldBounds.height)\n  };\n\n  var newShapeCenter = {\n    x: newCenter.x + newCenterDelta.x,\n    y: newCenter.y + newCenterDelta.y\n  };\n\n  return roundPoint({\n    x: newShapeCenter.x + shapeDelta.x - shape.x,\n    y: newShapeCenter.y + shapeDelta.y - shape.y\n  });\n}","import { some } from 'min-dash';\n\n\n/**\n * A handler that implements reversible appending of shapes\n * to a source shape.\n *\n * @param {canvas} Canvas\n * @param {elementFactory} ElementFactory\n * @param {modeling} Modeling\n */\nexport default function AppendShapeHandler(modeling) {\n  this._modeling = modeling;\n}\n\nAppendShapeHandler.$inject = [ 'modeling' ];\n\n\n// api //////////////////////\n\n\n/**\n * Creates a new shape\n *\n * @param {Object} context\n * @param {ElementDescriptor} context.shape the new shape\n * @param {ElementDescriptor} context.source the source object\n * @param {ElementDescriptor} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nAppendShapeHandler.prototype.preExecute = function(context) {\n\n  var source = context.source;\n\n  if (!source) {\n    throw new Error('source required');\n  }\n\n  var target = context.target || source.parent,\n      shape = context.shape;\n\n  shape = context.shape =\n    this._modeling.createShape(\n      shape,\n      context.position,\n      target, { attach: context.attach });\n\n  context.shape = shape;\n};\n\nAppendShapeHandler.prototype.postExecute = function(context) {\n  var parent = context.connectionParent || context.shape.parent;\n\n  if (!existsConnection(context.source, context.shape)) {\n\n    // create connection\n    this._modeling.connect(context.source, context.shape, context.connection, parent);\n  }\n};\n\n\nfunction existsConnection(source, target) {\n  return some(source.outgoing, function(c) {\n    return c.target === target;\n  });\n}","import { forEach } from 'min-dash';\n\n\n/**\n * A handler that implements reversible replacing of shapes.\n * Internally the old shape will be removed and the new shape will be added.\n *\n *\n * @class\n * @constructor\n *\n * @param {canvas} Canvas\n */\nexport default function ReplaceShapeHandler(modeling, rules) {\n  this._modeling = modeling;\n  this._rules = rules;\n}\n\nReplaceShapeHandler.$inject = [ 'modeling', 'rules' ];\n\n\n// api //////////////////////\n\n\n/**\n * Replaces a shape with an replacement Element.\n *\n * The newData object should contain type, x, y.\n *\n * If possible also the incoming/outgoing connection\n * will be restored.\n *\n * @param {Object} context\n */\nReplaceShapeHandler.prototype.preExecute = function(context) {\n\n  var self = this,\n      modeling = this._modeling,\n      rules = this._rules;\n\n  var oldShape = context.oldShape,\n      newData = context.newData,\n      hints = context.hints,\n      newShape;\n\n  function canReconnect(type, source, target, connection) {\n    return rules.allowed(type, {\n      source: source,\n      target: target,\n      connection: connection\n    });\n  }\n\n\n  // (1) place a new shape at the given position\n\n  var position = {\n    x: newData.x,\n    y: newData.y\n  };\n\n  newShape = context.newShape =\n    context.newShape ||\n    self.createShape(newData, position, oldShape.parent, hints);\n\n\n  // (2) update the host\n\n  if (oldShape.host) {\n    modeling.updateAttachment(newShape, oldShape.host);\n  }\n\n\n  // (3) adopt all children from the old shape\n\n  var children;\n\n  if (hints.moveChildren !== false) {\n    children = oldShape.children.slice();\n\n    modeling.moveElements(children, { x: 0, y: 0 }, newShape);\n  }\n\n  // (4) reconnect connections to the new shape (where allowed)\n\n  var incoming = oldShape.incoming.slice(),\n      outgoing = oldShape.outgoing.slice();\n\n  forEach(incoming, function(connection) {\n    var waypoints = connection.waypoints,\n        docking = waypoints[waypoints.length - 1],\n        source = connection.source,\n        allowed = canReconnect('connection.reconnectEnd', source, newShape, connection);\n\n    if (allowed) {\n      self.reconnectEnd(connection, newShape, docking, { layoutConnection: hints.layoutConnection });\n    }\n  });\n\n  forEach(outgoing, function(connection) {\n    var waypoints = connection.waypoints,\n        docking = waypoints[0],\n        target = connection.target,\n        allowed = canReconnect('connection.reconnectStart', newShape, target, connection);\n\n    if (allowed) {\n      self.reconnectStart(connection, newShape, docking, { layoutConnection: hints.layoutConnection });\n    }\n\n  });\n};\n\n\nReplaceShapeHandler.prototype.postExecute = function(context) {\n  var modeling = this._modeling;\n\n  var oldShape = context.oldShape,\n      newShape = context.newShape,\n      layoutConnection = context.hints.layoutConnection;\n\n  // do not layout if explicitly excluded\n  if (layoutConnection !== false) {\n    forEach(newShape.incoming, function(c) {\n      modeling.layoutConnection(c, { endChanged: true });\n    });\n\n    forEach(newShape.outgoing, function(c) {\n      modeling.layoutConnection(c, { startChanged: true });\n    });\n  }\n\n  modeling.removeShape(oldShape);\n};\n\n\nReplaceShapeHandler.prototype.execute = function(context) {};\n\nReplaceShapeHandler.prototype.revert = function(context) {};\n\n\nReplaceShapeHandler.prototype.createShape = function(shape, position, target, hints) {\n  return this._modeling.createShape(shape, position, target, hints);\n};\n\n\nReplaceShapeHandler.prototype.reconnectStart = function(connection, newSource, dockingPoint, hints) {\n  this._modeling.reconnectStart(connection, newSource, dockingPoint, hints);\n};\n\n\nReplaceShapeHandler.prototype.reconnectEnd = function(connection, newTarget, dockingPoint, hints) {\n  this._modeling.reconnectEnd(connection, newTarget, dockingPoint, hints);\n};\n","/**\n * Get Resize direction given axis + offset\n *\n * @param {String} axis (x|y)\n * @param {Number} offset\n *\n * @return {String} (e|w|n|s)\n */\nexport function getDirection(axis, offset) {\n\n  if (axis === 'x') {\n    if (offset > 0) {\n      return 'e';\n    }\n\n    if (offset < 0) {\n      return 'w';\n    }\n  }\n\n  if (axis === 'y') {\n    if (offset > 0) {\n      return 's';\n    }\n\n    if (offset < 0) {\n      return 'n';\n    }\n  }\n\n  return null;\n}\n\n\n/**\n * Resize the given bounds by the specified delta from a given anchor point.\n *\n * @param {Bounds} bounds the bounding box that should be resized\n * @param {String} direction in which the element is resized (n, s, e, w)\n * @param {Point} delta of the resize operation\n *\n * @return {Bounds} resized bounding box\n */\nexport function resizeBounds(bounds, direction, delta) {\n\n  var dx = delta.x,\n      dy = delta.y;\n\n  switch (direction) {\n\n  case 'n':\n    return {\n      x: bounds.x,\n      y: bounds.y + dy,\n      width: bounds.width,\n      height: bounds.height - dy\n    };\n\n  case 's':\n    return {\n      x: bounds.x,\n      y: bounds.y,\n      width: bounds.width,\n      height: bounds.height + dy\n    };\n\n  case 'w':\n    return {\n      x: bounds.x + dx,\n      y: bounds.y,\n      width: bounds.width - dx,\n      height: bounds.height\n    };\n\n  case 'e':\n    return {\n      x: bounds.x,\n      y: bounds.y,\n      width: bounds.width + dx,\n      height: bounds.height\n    };\n\n  default:\n    throw new Error('unrecognized direction: ' + direction);\n  }\n}","import { isArray } from 'min-dash';\n\n\n/**\n * Reconnect connection handler\n */\nexport default function ReconnectConnectionHandler(modeling) {\n  this._modeling = modeling;\n}\n\nReconnectConnectionHandler.$inject = [ 'modeling' ];\n\nReconnectConnectionHandler.prototype.execute = function(context) {\n\n  var newSource = context.newSource,\n      newTarget = context.newTarget,\n      connection = context.connection,\n      dockingOrPoints = context.dockingOrPoints;\n\n  if (!newSource && !newTarget) {\n    throw new Error('newSource or newTarget are required');\n  }\n\n  if (newSource && newTarget) {\n    throw new Error('must specify either newSource or newTarget');\n  }\n\n  if (isArray(dockingOrPoints)) {\n    context.oldWaypoints = connection.waypoints;\n    connection.waypoints = dockingOrPoints;\n  }\n\n  if (newSource) {\n    context.oldSource = connection.source;\n    connection.source = newSource;\n  }\n\n  if (newTarget) {\n    context.oldTarget = connection.target;\n    connection.target = newTarget;\n  }\n\n  return connection;\n};\n\nReconnectConnectionHandler.prototype.postExecute = function(context) {\n  var connection = context.connection,\n      dockingOrPoints = context.dockingOrPoints,\n      newSource = context.newSource,\n      movedEnd = newSource ? 'connectionStart' : 'connectionEnd',\n      newWaypoint,\n      hints = context.hints,\n      layoutHints = {};\n\n  if (hints.layoutConnection === false) {\n    return;\n  }\n\n  if (isArray(dockingOrPoints)) {\n    newWaypoint = newSource ? dockingOrPoints[0] : dockingOrPoints[dockingOrPoints.length - 1];\n  } else {\n    newWaypoint = dockingOrPoints;\n  }\n\n  layoutHints[movedEnd] = getDocking(newWaypoint);\n\n  this._modeling.layoutConnection(connection, layoutHints);\n};\n\nReconnectConnectionHandler.prototype.revert = function(context) {\n\n  var oldSource = context.oldSource,\n      oldTarget = context.oldTarget,\n      oldWaypoints = context.oldWaypoints,\n      connection = context.connection;\n\n  if (oldSource) {\n    connection.source = oldSource;\n  }\n\n  if (oldTarget) {\n    connection.target = oldTarget;\n  }\n\n  if (oldWaypoints) {\n    connection.waypoints = oldWaypoints;\n  }\n\n  return connection;\n};\n\n\n\n// helper ///////////////\n\nfunction getDocking(point) {\n  return point.original || point;\n}","import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  getChildren,\r\n  isSnapped,\r\n  mid\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  forEach,\r\n  isNumber\r\n} from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during create and move.\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function CreateMoveSnapping(eventBus, snapping) {\r\n  var self = this;\r\n\r\n  eventBus.on([\r\n    'create.start',\r\n    'shape.move.start'\r\n  ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.move',\r\n    'create.end',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        snapContext = context.snapContext,\r\n        target = context.target;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event) || !target) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(target);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, target);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.cleanup',\r\n    'shape.move.cleanup'\r\n  ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nCreateMoveSnapping.$inject = [\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nCreateMoveSnapping.prototype.initSnap = function(event) {\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var shapeMid = mid(shape, event),\r\n      shapeTopLeft = {\r\n        x: shapeMid.x - shape.width / 2,\r\n        y: shapeMid.y - shape.height / 2\r\n      },\r\n      shapeBottomRight = {\r\n        x: shapeMid.x + shape.width / 2,\r\n        y: shapeMid.y + shape.height / 2\r\n      };\r\n\r\n  snapContext.setSnapOrigin('mid', {\r\n    x: shapeMid.x - event.x,\r\n    y: shapeMid.y - event.y\r\n  });\r\n\r\n  // snap labels to mid only\r\n  if (isLabel(shape)) {\r\n    return snapContext;\r\n  }\r\n\r\n  snapContext.setSnapOrigin('top-left', {\r\n    x: shapeTopLeft.x - event.x,\r\n    y: shapeTopLeft.y - event.y\r\n  });\r\n\r\n  snapContext.setSnapOrigin('bottom-right', {\r\n    x: shapeBottomRight.x - event.x,\r\n    y: shapeBottomRight.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nCreateMoveSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n\r\n    // handle labels\r\n    if (isLabel(snapTarget)) {\r\n\r\n      if (isLabel(shape)) {\r\n        snapPoints.add('mid', mid(snapTarget));\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    // handle connections\r\n    if (isConnection(snapTarget)) {\r\n\r\n      // ignore single segment connections\r\n      if (snapTarget.waypoints.length < 3) {\r\n        return;\r\n      }\r\n\r\n      // ignore first and last waypoint\r\n      var waypoints = snapTarget.waypoints.slice(1, -1);\r\n\r\n      forEach(waypoints, function(waypoint) {\r\n        snapPoints.add('mid', waypoint);\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    // handle shapes\r\n    snapPoints.add('mid', mid(snapTarget));\r\n  });\r\n\r\n  if (!isNumber(shape.x) || !isNumber(shape.y)) {\r\n    return snapPoints;\r\n  }\r\n\r\n  snapPoints.add('mid', mid(shape));\r\n\r\n  return snapPoints;\r\n};\r\n\r\nCreateMoveSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isHidden(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isLabel(element) {\r\n  return !!element.labelTarget;\r\n}","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  snapTo\n} from './SnapUtil';\n\n\n/**\n * A snap context, containing the (possibly incomplete)\n * mappings of drop targets (to identify the snapping)\n * to computed snap points.\n */\nexport default function SnapContext() {\n\n  /**\n   * Map<String, SnapPoints> mapping drop targets to\n   * a list of possible snappings.\n   *\n   * @type {Object}\n   */\n  this._targets = {};\n\n  /**\n   * Map<String, Point> initial positioning of element\n   * regarding various snap directions.\n   *\n   * @type {Object}\n   */\n  this._snapOrigins = {};\n\n  /**\n   * List of snap locations\n   *\n   * @type {Array<String>}\n   */\n  this._snapLocations = [];\n\n  /**\n   * Map<String, Array<Point>> of default snapping locations\n   *\n   * @type {Object}\n   */\n  this._defaultSnaps = {};\n}\n\n\nSnapContext.prototype.getSnapOrigin = function(snapLocation) {\n  return this._snapOrigins[snapLocation];\n};\n\n\nSnapContext.prototype.setSnapOrigin = function(snapLocation, initialValue) {\n  this._snapOrigins[snapLocation] = initialValue;\n\n  if (this._snapLocations.indexOf(snapLocation) === -1) {\n    this._snapLocations.push(snapLocation);\n  }\n};\n\n\nSnapContext.prototype.addDefaultSnap = function(type, point) {\n\n  var snapValues = this._defaultSnaps[type];\n\n  if (!snapValues) {\n    snapValues = this._defaultSnaps[type] = [];\n  }\n\n  snapValues.push(point);\n};\n\n/**\n * Return a number of initialized snaps, i.e. snap locations such as\n * top-left, mid, bottom-right and so forth.\n *\n * @return {Array<String>} snapLocations\n */\nSnapContext.prototype.getSnapLocations = function() {\n  return this._snapLocations;\n};\n\n/**\n * Set the snap locations for this context.\n *\n * The order of locations determines precedence.\n *\n * @param {Array<String>} snapLocations\n */\nSnapContext.prototype.setSnapLocations = function(snapLocations) {\n  this._snapLocations = snapLocations;\n};\n\n/**\n * Get snap points for a given target\n *\n * @param {Element|String} target\n */\nSnapContext.prototype.pointsForTarget = function(target) {\n\n  var targetId = target.id || target;\n\n  var snapPoints = this._targets[targetId];\n\n  if (!snapPoints) {\n    snapPoints = this._targets[targetId] = new SnapPoints();\n    snapPoints.initDefaults(this._defaultSnaps);\n  }\n\n  return snapPoints;\n};\n\n\n/**\n * Creates the snap points and initializes them with the\n * given default values.\n *\n * @param {Object<String, Array<Point>>} [defaultPoints]\n */\nexport function SnapPoints(defaultSnaps) {\n\n  /**\n   * Map<String, Map<(x|y), Array<Number>>> mapping snap locations,\n   * i.e. top-left, bottom-right, center to actual snap values.\n   *\n   * @type {Object}\n   */\n  this._snapValues = {};\n}\n\nSnapPoints.prototype.add = function(snapLocation, point) {\n\n  var snapValues = this._snapValues[snapLocation];\n\n  if (!snapValues) {\n    snapValues = this._snapValues[snapLocation] = { x: [], y: [] };\n  }\n\n  if (snapValues.x.indexOf(point.x) === -1) {\n    snapValues.x.push(point.x);\n  }\n\n  if (snapValues.y.indexOf(point.y) === -1) {\n    snapValues.y.push(point.y);\n  }\n};\n\n\nSnapPoints.prototype.snap = function(point, snapLocation, axis, tolerance) {\n  var snappingValues = this._snapValues[snapLocation];\n\n  return snappingValues && snapTo(point[axis], snappingValues[axis], tolerance);\n};\n\n/**\n * Initialize a number of default snapping points.\n *\n * @param  {Object} defaultSnaps\n */\nSnapPoints.prototype.initDefaults = function(defaultSnaps) {\n\n  var self = this;\n\n  forEach(defaultSnaps || {}, function(snapPoints, snapLocation) {\n    forEach(snapPoints, function(point) {\n      self.add(snapLocation, point);\n    });\n  });\n};","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar domQuery = require('min-dom').query;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar textField = function(options, defaultParameters) {\n\n  // Default action for the button next to the input-field\n  var defaultButtonAction = function(element, inputNode) {\n    var input = domQuery('input[name=\"' + options.modelProperty + '\"]', inputNode);\n    input.value = '';\n\n    return true;\n  };\n\n  // default method to determine if the button should be visible\n  var defaultButtonShow = function(element, inputNode) {\n    var input = domQuery('input[name=\"' + options.modelProperty + '\"]', inputNode);\n\n    return input.value !== '';\n  };\n\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      dataValueLabel = options.dataValueLabel,\n      buttonLabel = (options.buttonLabel || 'X'),\n      actionName = (typeof options.buttonAction != 'undefined') ? options.buttonAction.name : 'clear',\n      actionMethod = (typeof options.buttonAction != 'undefined') ? options.buttonAction.method : defaultButtonAction,\n      showName = (typeof options.buttonShow != 'undefined') ? options.buttonShow.name : 'canClear',\n      showMethod = (typeof options.buttonShow != 'undefined') ? options.buttonShow.method : defaultButtonShow,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      description = options.description;\n\n  resource.html =\n    '<label for=\"camunda-' + resource.id + '\" ' +\n      (canBeDisabled ? 'data-show=\"isDisabled\" ' : '') +\n      (dataValueLabel ? 'data-value=\"' + escapeHTML(dataValueLabel) + '\"' : '') + '>'+ escapeHTML(label) +'</label>' +\n    '<div class=\"cpp-field-wrapper\" ' +\n      (canBeDisabled ? 'data-show=\"isDisabled\"' : '') +\n      '>' +\n      '<input id=\"camunda-' + escapeHTML(resource.id) + '\" type=\"text\" name=\"' + escapeHTML(options.modelProperty) + '\" ' +\n        ' />' +\n      '<button class=\"' + escapeHTML(actionName) + '\" data-action=\"' + escapeHTML(actionName) +\n        '\" data-show=\"' + escapeHTML(showName) + '\" ' +\n        (canBeDisabled ? 'data-disabled=\"isDisabled\"' : '') + '>' +\n        '<span>' + escapeHTML(buttonLabel) + '</span>' +\n      '</button>' +\n    '</div>';\n\n  // add description below text input entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource[actionName] = actionMethod;\n  resource[showName] = showMethod;\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return !options.disabled.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['cpp-textfield'];\n\n  return resource;\n};\n\nmodule.exports = textField;\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar CmmnElementHelper = require('../../../../helper/CmmnElementHelper'),\n    isCMMNDiagram = CmmnElementHelper.isCMMNDiagram;\n\n\nmodule.exports = function(element, cmmnFactory, options) {\n\n  options = options || {};\n\n  var containment = 'documentation';\n\n  function getDocumentations(bo) {\n    return bo.get(containment);\n  }\n\n  function getDocumentation(bo) {\n    var documentations = getDocumentations(bo);\n    return documentations.length > 0 ? documentations[0] : undefined;\n  }\n\n  // Documentation\n  var entry = entryFactory.textBox({\n\n    id: options.id || 'documentation',\n    label: options.label || 'Documentation',\n    modelProperty: 'documentation',\n    reference: options.reference,\n\n    get: function(element, node, bo) {\n\n      var documentation,\n          text;\n\n      if (isCMMNDiagram(bo)) {\n        text = bo.documentation;\n      }\n      else {\n        documentation = getDocumentation(bo);\n        text = documentation && documentation.text;\n      }\n\n      return {\n        documentation: text\n      };\n\n    },\n\n    set: function(element, values, node, bo) {\n\n      var isRoot = isCMMNDiagram(bo),\n          documentation = !isRoot && getDocumentation(bo),\n          text = values.documentation || undefined,\n          value = {};\n\n      value[isRoot ? 'documentation' : 'text'] = text;\n\n      if (isRoot) {\n        return cmdHelper.updateProperties(bo, value, element);\n      }\n\n      if (documentation && !text) {\n\n        var cmds = [];\n\n        forEach(getDocumentations(bo), function(doc) {\n          cmds.push(cmdHelper.updateSemanticParent(doc, null, containment, element));\n        });\n\n        return cmds;\n      }\n\n      if (!documentation && text) {\n        documentation = cmmnFactory.create('cmmn:Documentation', value);\n        return cmdHelper.updateSemanticParent(documentation, bo, containment, element);\n      }\n\n      return cmdHelper.updateProperties(documentation, value, element);\n    }\n\n  });\n\n  return [ entry ];\n\n};\n\n","'use strict';\n\nvar cmdHelper = require('../../../../helper/CmdHelper'),\n    entryFactory = require('../../../../factory/EntryFactory');\n\nvar noop = function() {};\nvar noopEmptyList = function() { return []; };\n\nmodule.exports = function(element, cmmnFactory, options) {\n\n  options = options || {};\n\n  var id = options.id,\n      label = options.label,\n      reference = options.reference,\n      modelProperty = options.modelProperty || 'body',\n      getCondition = options.getCondition || noop,\n      createdCondition = options.createdCondition || noopEmptyList,\n      removedCondition = options.removedCondition || noopEmptyList;\n\n\n  var conditionEntry = entryFactory.textField({\n\n    id: id || 'condition',\n    label: label || 'Condition',\n    modelProperty: modelProperty,\n    reference: reference,\n\n    get: function(element, node, bo) {\n\n      var condition = getCondition(element, node, bo),\n          value = {};\n\n      value[modelProperty] = (condition && condition.get('body')) || undefined;\n\n      return value;\n\n    },\n\n    set: function(element, values, node, bo) {\n\n      var condition = getCondition(element, node, bo),\n          body = values[modelProperty] || undefined,\n          value = { body : body },\n          cmds = [];\n\n      if (body) {\n\n        if (!condition) {\n          condition = cmmnFactory.create('cmmn:Expression', value);\n          cmds.push(createdCondition(condition, element, node, bo));\n        }\n        else {\n          cmds.push(cmdHelper.updateProperties(condition, value, element));\n        }\n\n      }\n      else {\n\n        if (condition) {\n          cmds.push(\n            cmdHelper.updateProperties(condition, value, element),\n            cmdHelper.updateSemanticParent(condition, null, null, element),\n            removedCondition(condition, element, node, bo)\n          );\n        }\n\n      }\n\n      return cmds;\n\n    },\n\n    validate: options.validate,\n    disabled: options.disabled\n\n  });\n\n  return [ conditionEntry ];\n\n};\n","'use strict';\n\nfunction getListenerType(listener) {\n  var cls = listener && listener.get('class'),\n      expression = listener && listener.get('expression'),\n      delegateExpression = listener && listener.get('delegateExpression'),\n      script = listener && listener.get('script');\n\n  if (cls !== undefined) {\n    return 'class';\n  }\n\n  if (expression !== undefined) {\n    return 'expression';\n  }\n\n  if (delegateExpression !== undefined) {\n    return 'delegateExpression';\n  }\n\n  if (script !== undefined) {\n    return 'script';\n  }\n\n  return 'class';\n}\n\nmodule.exports.getListenerType = getListenerType;","module.exports = __webpack_public_path__ + \"static/media/cmmn.b3c27689.eot\";","/**\n * Get the logarithm of x with base 10\n * @param  {Integer} value\n */\nexport function log10(x) {\n  return Math.log(x) / Math.log(10);\n}\n\nexport { delta as substract } from './PositionUtil';\n","import {\n  log10\n} from '../../util/Math';\n\n/**\n * Get step size for given range and number of steps.\n *\n * @param {Object} range\n * @param {number} range.min\n * @param {number} range.max\n */\nexport function getStepSize(range, steps) {\n\n  var minLinearRange = log10(range.min),\n      maxLinearRange = log10(range.max);\n\n  var absoluteLinearRange = Math.abs(minLinearRange) + Math.abs(maxLinearRange);\n\n  return absoluteLinearRange / steps;\n}\n\nexport function cap(range, scale) {\n  return Math.max(range.min, Math.min(range.max, scale));\n}\n","import {\n  event as domEvent,\n  closest as domClosest\n} from 'min-dom';\n\nimport {\n  getStepSize,\n  cap\n} from './ZoomUtil';\n\nimport {\n  log10\n} from '../../util/Math';\n\nimport {\n  bind\n} from 'min-dash';\n\nvar sign = Math.sign || function(n) {\n  return n >= 0 ? 1 : -1;\n};\n\nvar RANGE = { min: 0.2, max: 4 },\n    NUM_STEPS = 10;\n\nvar DELTA_THRESHOLD = 0.1;\n\nvar DEFAULT_SCALE = 0.75;\n\n/**\n * An implementation of zooming and scrolling within the\n * {@link Canvas} via the mouse wheel.\n *\n * Mouse wheel zooming / scrolling may be disabled using\n * the {@link toggle(enabled)} method.\n *\n * @param {Object} [config]\n * @param {Boolean} [config.enabled=true] default enabled state\n * @param {Number} [config.scale=.75] scroll sensivity\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function ZoomScroll(config, eventBus, canvas) {\n\n  config = config || {};\n\n  this._enabled = false;\n\n  this._canvas = canvas;\n  this._container = canvas._container;\n\n  this._handleWheel = bind(this._handleWheel, this);\n\n  this._totalDelta = 0;\n  this._scale = config.scale || DEFAULT_SCALE;\n\n  var self = this;\n\n  eventBus.on('canvas.init', function(e) {\n    self._init(config.enabled !== false);\n  });\n}\n\nZoomScroll.$inject = [\n  'config.zoomScroll',\n  'eventBus',\n  'canvas'\n];\n\nZoomScroll.prototype.scroll = function scroll(delta) {\n  this._canvas.scroll(delta);\n};\n\n\nZoomScroll.prototype.reset = function reset() {\n  this._canvas.zoom('fit-viewport');\n};\n\n/**\n * Zoom depending on delta.\n *\n * @param {number} delta\n * @param {Object} position\n */\nZoomScroll.prototype.zoom = function zoom(delta, position) {\n\n  // zoom with half the step size of stepZoom\n  var stepSize = getStepSize(RANGE, NUM_STEPS * 2);\n\n  // add until threshold reached\n  this._totalDelta += delta;\n\n  if (Math.abs(this._totalDelta) > DELTA_THRESHOLD) {\n    this._zoom(delta, position, stepSize);\n\n    // reset\n    this._totalDelta = 0;\n  }\n};\n\n\nZoomScroll.prototype._handleWheel = function handleWheel(event) {\n  // event is already handled by '.djs-scrollable'\n  if (domClosest(event.target, '.djs-scrollable', true)) {\n    return;\n  }\n\n  var element = this._container;\n\n  event.preventDefault();\n\n  // pinch to zoom is mapped to wheel + ctrlKey = true\n  // in modern browsers (!)\n\n  var isZoom = event.ctrlKey;\n\n  var isHorizontalScroll = event.shiftKey;\n\n  var factor = -1 * this._scale,\n      delta;\n\n  if (isZoom) {\n    factor *= event.deltaMode === 0 ? 0.020 : 0.32;\n  } else {\n    factor *= event.deltaMode === 0 ? 1.0 : 16.0;\n  }\n\n  if (isZoom) {\n    var elementRect = element.getBoundingClientRect();\n\n    var offset = {\n      x: event.clientX - elementRect.left,\n      y: event.clientY - elementRect.top\n    };\n\n    delta = (\n      Math.sqrt(\n        Math.pow(event.deltaY, 2) +\n        Math.pow(event.deltaX, 2)\n      ) * sign(event.deltaY) * factor\n    );\n\n    // zoom in relative to diagram {x,y} coordinates\n    this.zoom(delta, offset);\n  } else {\n\n    if (isHorizontalScroll) {\n      delta = {\n        dx: factor * event.deltaY,\n        dy: 0\n      };\n    } else {\n      delta = {\n        dx: factor * event.deltaX,\n        dy: factor * event.deltaY\n      };\n    }\n\n    this.scroll(delta);\n  }\n};\n\n/**\n * Zoom with fixed step size.\n *\n * @param {number} delta - Zoom delta (1 for zooming in, -1 for out).\n * @param {Object} position\n */\nZoomScroll.prototype.stepZoom = function stepZoom(delta, position) {\n\n  var stepSize = getStepSize(RANGE, NUM_STEPS);\n\n  this._zoom(delta, position, stepSize);\n};\n\n\n/**\n * Zoom in/out given a step size.\n *\n * @param {number} delta\n * @param {Object} position\n * @param {number} stepSize\n */\nZoomScroll.prototype._zoom = function(delta, position, stepSize) {\n  var canvas = this._canvas;\n\n  var direction = delta > 0 ? 1 : -1;\n\n  var currentLinearZoomLevel = log10(canvas.zoom());\n\n  // snap to a proximate zoom step\n  var newLinearZoomLevel = Math.round(currentLinearZoomLevel / stepSize) * stepSize;\n\n  // increase or decrease one zoom step in the given direction\n  newLinearZoomLevel += stepSize * direction;\n\n  // calculate the absolute logarithmic zoom level based on the linear zoom level\n  // (e.g. 2 for an absolute x2 zoom)\n  var newLogZoomLevel = Math.pow(10, newLinearZoomLevel);\n\n  canvas.zoom(cap(RANGE, newLogZoomLevel), position);\n};\n\n\n/**\n * Toggle the zoom scroll ability via mouse wheel.\n *\n * @param  {Boolean} [newEnabled] new enabled state\n */\nZoomScroll.prototype.toggle = function toggle(newEnabled) {\n\n  var element = this._container;\n  var handleWheel = this._handleWheel;\n\n  var oldEnabled = this._enabled;\n\n  if (typeof newEnabled === 'undefined') {\n    newEnabled = !oldEnabled;\n  }\n\n  // only react on actual changes\n  if (oldEnabled !== newEnabled) {\n\n    // add or remove wheel listener based on\n    // changed enabled state\n    domEvent[newEnabled ? 'bind' : 'unbind'](element, 'wheel', handleWheel, false);\n  }\n\n  this._enabled = newEnabled;\n\n  return newEnabled;\n};\n\n\nZoomScroll.prototype._init = function(newEnabled) {\n  this.toggle(newEnabled);\n};\n","import ZoomScroll from './ZoomScroll';\n\nexport default {\n  __init__: [ 'zoomScroll' ],\n  zoomScroll: [ 'type', ZoomScroll ]\n};","import {\n  assign,\n  filter,\n  groupBy,\n  isObject\n} from 'min-dash';\n\nvar LOW_PRIORITY = 500,\n    MEDIUM_PRIORITY = 1250,\n    HIGH_PRIORITY = 1500;\n\nimport { getOriginal as getOriginalEvent } from '../../util/Event';\n\nvar round = Math.round;\n\nfunction mid(element) {\n  return {\n    x: element.x + round(element.width / 2),\n    y: element.y + round(element.height / 2)\n  };\n}\n\n/**\n * A plugin that makes shapes draggable / droppable.\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Modeling} modeling\n * @param {Selection} selection\n * @param {Rules} rules\n */\nexport default function MoveEvents(\n    eventBus, dragging, modeling,\n    selection, rules) {\n\n  // rules\n\n  function canMove(shapes, delta, position, target) {\n\n    return rules.allowed('elements.move', {\n      shapes: shapes,\n      delta: delta,\n      position: position,\n      target: target\n    });\n  }\n\n\n  // move events\n\n  // assign a high priority to this handler to setup the environment\n  // others may hook up later, e.g. at default priority and modify\n  // the move environment.\n  //\n  // This sets up the context with\n  //\n  // * shape: the primary shape being moved\n  // * shapes: a list of shapes to be moved\n  // * validatedShapes: a list of shapes that are being checked\n  //                    against the rules before and during move\n  //\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(event) {\n\n    var context = event.context,\n        shape = event.shape,\n        shapes = selection.get().slice();\n\n    // move only single shape if the dragged element\n    // is not part of the current selection\n    if (shapes.indexOf(shape) === -1) {\n      shapes = [ shape ];\n    }\n\n    // ensure we remove nested elements in the collection\n    // and add attachers for a proper dragger\n    shapes = removeNested(shapes);\n\n    // attach shapes to drag context\n    assign(context, {\n      shapes: shapes,\n      validatedShapes: shapes,\n      shape: shape\n    });\n  });\n\n\n  // assign a high priority to this handler to setup the environment\n  // others may hook up later, e.g. at default priority and modify\n  // the move environment\n  //\n  eventBus.on('shape.move.start', MEDIUM_PRIORITY, function(event) {\n\n    var context = event.context,\n        validatedShapes = context.validatedShapes,\n        canExecute;\n\n    canExecute = context.canExecute = canMove(validatedShapes);\n\n    // check if we can move the elements\n    if (!canExecute) {\n      return false;\n    }\n  });\n\n  // assign a low priority to this handler\n  // to let others modify the move event before we update\n  // the context\n  //\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        validatedShapes = context.validatedShapes,\n        hover = event.hover,\n        delta = { x: event.dx, y: event.dy },\n        position = { x: event.x, y: event.y },\n        canExecute;\n\n    // check if we can move the elements\n    canExecute = canMove(validatedShapes, delta, position, hover);\n\n    context.delta = delta;\n    context.canExecute = canExecute;\n\n    // simply ignore move over\n    if (canExecute === null) {\n      context.target = null;\n\n      return;\n    }\n\n    context.target = hover;\n  });\n\n  eventBus.on('shape.move.end', function(event) {\n\n    var context = event.context;\n\n    var delta = context.delta,\n        canExecute = context.canExecute,\n        isAttach = canExecute === 'attach',\n        shapes = context.shapes;\n\n    if (canExecute === false) {\n      return false;\n    }\n\n    // ensure we have actual pixel values deltas\n    // (important when zoom level was > 1 during move)\n    delta.x = round(delta.x);\n    delta.y = round(delta.y);\n\n    if (delta.x === 0 && delta.y === 0) {\n\n      // didn't move\n      return;\n    }\n\n    modeling.moveElements(shapes, delta, context.target, {\n      primaryShape: context.shape,\n      attach: isAttach\n    });\n  });\n\n\n  // move activation\n\n  eventBus.on('element.mousedown', function(event) {\n\n    var originalEvent = getOriginalEvent(event);\n\n    if (!originalEvent) {\n      throw new Error('must supply DOM mousedown event');\n    }\n\n    return start(originalEvent, event.element);\n  });\n\n  /**\n   * Start move.\n   *\n   * @param {MouseEvent} event\n   * @param {djs.model.Shape} shape\n   * @param {boolean} [activate]\n   * @param {Object} [context]\n   */\n  function start(event, element, activate, context) {\n    if (isObject(activate)) {\n      context = activate;\n      activate = false;\n    }\n\n    // do not move connections or the root element\n    if (element.waypoints || !element.parent) {\n      return;\n    }\n\n    var referencePoint = mid(element);\n\n    dragging.init(event, referencePoint, 'shape.move', {\n      cursor: 'grabbing',\n      autoActivate: activate,\n      data: {\n        shape: element,\n        context: context || {}\n      }\n    });\n\n    // we've handled the event\n    return true;\n  }\n\n  // API\n\n  this.start = start;\n}\n\nMoveEvents.$inject = [\n  'eventBus',\n  'dragging',\n  'modeling',\n  'selection',\n  'rules'\n];\n\n\n/**\n * Return a filtered list of elements that do not contain\n * those nested into others.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeNested(elements) {\n\n  var ids = groupBy(elements, 'id');\n\n  return filter(elements, function(element) {\n    while ((element = element.parent)) {\n\n      // parent in selection\n      if (ids[element.id]) {\n        return false;\n      }\n    }\n\n    return true;\n  });\n}\n","import {\n  flatten,\n  forEach,\n  filter,\n  find,\n  groupBy,\n  map,\n  matchPattern,\n  size\n} from 'min-dash';\n\nimport {\n  selfAndAllChildren\n} from '../../util/Elements';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport { translate } from '../../util/SvgTransformUtil';\n\nvar LOW_PRIORITY = 499;\n\nvar MARKER_DRAGGING = 'djs-dragging',\n    MARKER_OK = 'drop-ok',\n    MARKER_NOT_OK = 'drop-not-ok',\n    MARKER_NEW_PARENT = 'new-parent',\n    MARKER_ATTACH = 'attach-ok';\n\n\n/**\n * Provides previews for moving shapes when moving.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Canvas} canvas\n * @param {Styles} styles\n */\nexport default function MovePreview(\n    eventBus, canvas, styles, previewSupport) {\n\n  function getVisualDragShapes(shapes) {\n    var elements = getAllDraggedElements(shapes);\n\n    var filteredElements = removeEdges(elements);\n\n    return filteredElements;\n  }\n\n  function getAllDraggedElements(shapes) {\n    var allShapes = selfAndAllChildren(shapes, true);\n\n    var allConnections = map(allShapes, function(shape) {\n      return (shape.incoming || []).concat(shape.outgoing || []);\n    });\n\n    return flatten(allShapes.concat(allConnections));\n  }\n\n  /**\n   * Sets drop marker on an element.\n   */\n  function setMarker(element, marker) {\n\n    [ MARKER_ATTACH, MARKER_OK, MARKER_NOT_OK, MARKER_NEW_PARENT ].forEach(function(m) {\n\n      if (m === marker) {\n        canvas.addMarker(element, m);\n      } else {\n        canvas.removeMarker(element, m);\n      }\n    });\n  }\n\n  /**\n   * Make an element draggable.\n   *\n   * @param {Object} context\n   * @param {djs.model.Base} element\n   * @param {Boolean} addMarker\n   */\n  function makeDraggable(context, element, addMarker) {\n\n    previewSupport.addDragger(element, context.dragGroup);\n\n    if (addMarker) {\n      canvas.addMarker(element, MARKER_DRAGGING);\n    }\n\n    if (context.allDraggedElements) {\n      context.allDraggedElements.push(element);\n    } else {\n      context.allDraggedElements = [ element ];\n    }\n  }\n\n  // assign a low priority to this handler\n  // to let others modify the move context before\n  // we draw things\n  eventBus.on('shape.move.start', LOW_PRIORITY, function(event) {\n    var context = event.context,\n        dragShapes = context.shapes,\n        allDraggedElements = context.allDraggedElements;\n\n    var visuallyDraggedShapes = getVisualDragShapes(dragShapes);\n\n    if (!context.dragGroup) {\n      var dragGroup = svgCreate('g');\n\n      svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\n\n      var defaultLayer = canvas.getDefaultLayer();\n\n      svgAppend(defaultLayer, dragGroup);\n\n      context.dragGroup = dragGroup;\n    }\n\n    // add previews\n    visuallyDraggedShapes.forEach(function(shape) {\n      previewSupport.addDragger(shape, context.dragGroup);\n    });\n\n    // cache all dragged elements / gfx\n    // so that we can quickly undo their state changes later\n    if (!allDraggedElements) {\n      allDraggedElements = getAllDraggedElements(dragShapes);\n    } else {\n      allDraggedElements = flatten([\n        allDraggedElements,\n        getAllDraggedElements(dragShapes)\n      ]);\n    }\n\n    // add dragging marker\n    forEach(allDraggedElements, function(e) {\n      canvas.addMarker(e, MARKER_DRAGGING);\n    });\n\n    context.allDraggedElements = allDraggedElements;\n\n    // determine, if any of the dragged elements have different parents\n    context.differentParents = haveDifferentParents(dragShapes);\n  });\n\n  // update previews\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        dragGroup = context.dragGroup,\n        target = context.target,\n        parent = context.shape.parent,\n        canExecute = context.canExecute;\n\n    if (target) {\n      if (canExecute === 'attach') {\n        setMarker(target, MARKER_ATTACH);\n      } else if (context.canExecute && target && target.id !== parent.id) {\n        setMarker(target, MARKER_NEW_PARENT);\n      } else {\n        setMarker(target, context.canExecute ? MARKER_OK : MARKER_NOT_OK);\n      }\n    }\n\n    translate(dragGroup, event.dx, event.dy);\n  });\n\n  eventBus.on([ 'shape.move.out', 'shape.move.cleanup' ], function(event) {\n    var context = event.context,\n        target = context.target;\n\n    if (target) {\n      setMarker(target, null);\n    }\n  });\n\n  // remove previews\n  eventBus.on('shape.move.cleanup', function(event) {\n\n    var context = event.context,\n        allDraggedElements = context.allDraggedElements,\n        dragGroup = context.dragGroup;\n\n\n    // remove dragging marker\n    forEach(allDraggedElements, function(e) {\n      canvas.removeMarker(e, MARKER_DRAGGING);\n    });\n\n    if (dragGroup) {\n      svgRemove(dragGroup);\n    }\n  });\n\n\n  // API //////////////////////\n\n  /**\n   * Make an element draggable.\n   *\n   * @param {Object} context\n   * @param {djs.model.Base} element\n   * @param {Boolean} addMarker\n   */\n  this.makeDraggable = makeDraggable;\n}\n\nMovePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'styles',\n  'previewSupport'\n];\n\n\n// helpers //////////////////////\n\n/**\n * returns elements minus all connections\n * where source or target is not elements\n */\nfunction removeEdges(elements) {\n\n  var filteredElements = filter(elements, function(element) {\n\n    if (!isConnection(element)) {\n      return true;\n    } else {\n\n      return (\n        find(elements, matchPattern({ id: element.source.id })) &&\n        find(elements, matchPattern({ id: element.target.id }))\n      );\n    }\n  });\n\n  return filteredElements;\n}\n\nfunction haveDifferentParents(elements) {\n  return size(groupBy(elements, function(e) { return e.parent && e.parent.id; })) !== 1;\n}\n\n/**\n * Checks if an element is a connection.\n */\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import InteractionEventsModule from '../interaction-events';\nimport SelectionModule from '../selection';\nimport OutlineModule from '../outline';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\n\nimport Move from './Move';\nimport MovePreview from './MovePreview';\n\nexport default {\n  __depends__: [\n    InteractionEventsModule,\n    SelectionModule,\n    OutlineModule,\n    RulesModule,\n    DraggingModule,\n    PreviewSupportModule\n  ],\n  __init__: [\n    'move',\n    'movePreview'\n  ],\n  move: [ 'type', Move ],\n  movePreview: [ 'type', MovePreview ]\n};\n","import {\n  getMid\n} from '../../layout/LayoutUtil';\n\n\nexport default function Connect(eventBus, dragging, modeling, rules) {\n\n  // rules\n\n  function canConnect(source, target) {\n    return rules.allowed('connection.create', {\n      source: source,\n      target: target\n    });\n  }\n\n\n  // event handlers\n\n  eventBus.on('connect.hover', function(event) {\n    var context = event.context,\n        source = context.source,\n        hover = event.hover,\n        canExecute;\n\n    canExecute = context.canExecute = canConnect(source, hover);\n\n    // simply ignore hover\n    if (canExecute === null) {\n      return;\n    }\n\n    context.target = hover;\n  });\n\n  eventBus.on([ 'connect.out', 'connect.cleanup' ], function(event) {\n    var context = event.context;\n\n    context.target = null;\n    context.canExecute = false;\n  });\n\n  eventBus.on('connect.end', function(event) {\n\n    var context = event.context,\n        source = context.source,\n        sourcePosition = context.sourcePosition,\n        target = context.target,\n        targetPosition = {\n          x: event.x,\n          y: event.y\n        },\n        canExecute = context.canExecute || canConnect(source, target);\n\n    if (!canExecute) {\n      return false;\n    }\n\n    var attrs = null,\n        hints = {\n          connectionStart: sourcePosition,\n          connectionEnd: targetPosition\n        };\n\n    if (typeof canExecute === 'object') {\n      attrs = canExecute;\n    }\n\n    modeling.connect(source, target, attrs, hints);\n  });\n\n\n  // API\n\n  /**\n   * Start connect operation.\n   *\n   * @param {DOMEvent} event\n   * @param {djs.model.Base} source\n   * @param {Point} [sourcePosition]\n   * @param {Boolean} [autoActivate=false]\n   */\n  this.start = function(event, source, sourcePosition, autoActivate) {\n\n    if (typeof sourcePosition !== 'object') {\n      autoActivate = sourcePosition;\n      sourcePosition = getMid(source);\n    }\n\n    dragging.init(event, 'connect', {\n      autoActivate: autoActivate,\n      data: {\n        shape: source,\n        context: {\n          source: source,\n          sourcePosition: sourcePosition\n        }\n      }\n    });\n  };\n}\n\nConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'modeling',\n  'rules'\n];\n","var HIGH_PRIORITY = 1100,\n    LOW_PRIORITY = 900;\n\nvar MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n/**\n * Shows connection preview during connect.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function ConnectPreview(injector, eventBus, canvas) {\n  var connectionPreview = injector.get('connectionPreview', false);\n\n  eventBus.on('connect.move', function(event) {\n    var context = event.context,\n        source = context.source,\n        target = context.target,\n        canConnect = context.canExecute;\n\n    var endPosition = {\n      x: event.x,\n      y: event.y\n    };\n\n\n    if (connectionPreview) {\n      connectionPreview.drawPreview(context, canConnect, {\n        source: source,\n        target: target,\n        connectionEnd: endPosition\n      });\n    }\n  });\n\n  eventBus.on('connect.hover', LOW_PRIORITY, function(event) {\n    var context = event.context,\n        hover = event.hover,\n        canExecute = context.canExecute;\n\n    // ignore hover\n    if (canExecute === null) {\n      return;\n    }\n\n    canvas.addMarker(hover, canExecute ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n  eventBus.on([ 'connect.out', 'connect.cleanup' ], HIGH_PRIORITY, function(event) {\n    var context = event.context;\n\n    // remove marker before target is removed from context\n    if (context.target) {\n      canvas.removeMarker(context.target, context.canExecute ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n  eventBus.on('connect.cleanup', function(event) {\n    if (connectionPreview) {\n      connectionPreview.cleanUp(event.context);\n    }\n  });\n}\n\nConnectPreview.$inject = [\n  'injector',\n  'eventBus',\n  'canvas'\n];\n","import SelectionModule from '../selection';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\n\nimport Connect from './Connect';\nimport ConnectPreview from './ConnectPreview';\n\nexport default {\n  __depends__: [\n    SelectionModule,\n    RulesModule,\n    DraggingModule\n  ],\n  __init__: [\n    'connectPreview'\n  ],\n  connect: [ 'type', Connect ],\n  connectPreview: [ 'type', ConnectPreview ]\n};\n","import {\n  set as cursorSet,\n  unset as cursorUnset\n} from '../../util/Cursor';\n\nimport {\n  install as installClickTrap\n} from '../../util/ClickTrap';\n\nimport {\n  delta as deltaPos\n} from '../../util/PositionUtil';\n\nimport {\n  event as domEvent,\n  closest as domClosest\n} from 'min-dom';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\n\nvar THRESHOLD = 15;\n\n\n/**\n * Move the canvas via mouse.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function MoveCanvas(eventBus, canvas) {\n\n  var context;\n\n\n  // listen for move on element mouse down;\n  // allow others to hook into the event before us though\n  // (dragging / element moving will do this)\n  eventBus.on('element.mousedown', 500, function(e) {\n    return handleStart(e.originalEvent);\n  });\n\n\n  function handleMove(event) {\n\n    var start = context.start,\n        position = toPoint(event),\n        delta = deltaPos(position, start);\n\n    if (!context.dragging && length(delta) > THRESHOLD) {\n      context.dragging = true;\n\n      installClickTrap(eventBus);\n\n      cursorSet('grab');\n    }\n\n    if (context.dragging) {\n\n      var lastPosition = context.last || context.start;\n\n      delta = deltaPos(position, lastPosition);\n\n      canvas.scroll({\n        dx: delta.x,\n        dy: delta.y\n      });\n\n      context.last = position;\n    }\n\n    // prevent select\n    event.preventDefault();\n  }\n\n\n  function handleEnd(event) {\n    domEvent.unbind(document, 'mousemove', handleMove);\n    domEvent.unbind(document, 'mouseup', handleEnd);\n\n    context = null;\n\n    cursorUnset();\n  }\n\n  function handleStart(event) {\n    // event is already handled by '.djs-draggable'\n    if (domClosest(event.target, '.djs-draggable')) {\n      return;\n    }\n\n\n    // reject non-left left mouse button or modifier key\n    if (event.button || event.ctrlKey || event.shiftKey || event.altKey) {\n      return;\n    }\n\n    context = {\n      start: toPoint(event)\n    };\n\n    domEvent.bind(document, 'mousemove', handleMove);\n    domEvent.bind(document, 'mouseup', handleEnd);\n\n    // we've handled the event\n    return true;\n  }\n}\n\n\nMoveCanvas.$inject = [\n  'eventBus',\n  'canvas'\n];\n\n\n\n// helpers ///////\n\nfunction length(point) {\n  return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n}\n","import MoveCanvas from './MoveCanvas';\n\nexport default {\n  __init__: [ 'moveCanvas' ],\n  moveCanvas: [ 'type', MoveCanvas ]\n};","var LOW_PRIORITY = 750;\n\nvar MARKER_OK = 'drop-ok',\n    MARKER_NOT_OK = 'drop-not-ok',\n    MARKER_ATTACH = 'attach-ok',\n    MARKER_NEW_PARENT = 'new-parent';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport { assign } from 'min-dash';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\nimport { Shape } from '../../model';\n\n\n/**\n * Adds the ability to create new shapes via drag and drop.\n *\n * Create must be activated via {@link Create#start}. From that\n * point on, create will invoke `shape.create` and `shape.attach`\n * rules to query whether or not creation or attachment on a certain\n * position is allowed.\n *\n * If create or attach is allowed and a source is given, Create it\n * will invoke `connection.create` rules to query whether a connection\n * can be drawn between source and new shape. During rule evaluation\n * the target is not attached yet, however\n *\n *   hints = { targetParent, targetAttach }\n *\n * are passed to the evaluating rules.\n *\n *\n * ## Rule Return Values\n *\n * Return values interpreted from  `shape.create`:\n *\n *   * `true`: create is allowed\n *   * `false`: create is disallowed\n *   * `null`: create is not allowed but should be ignored visually\n *\n * Return values interpreted from `shape.attach`:\n *\n *   * `true`: attach is allowed\n *   * `Any`: attach is allowed with the constraints\n *   * `false`: attach is disallowed\n *\n * Return values interpreted from `connection.create`:\n *\n *   * `true`: connection can be created\n *   * `Any`: connection with the given attributes can be created\n *   * `false`: connection can't be created\n *\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Rules} rules\n * @param {Modeling} modeling\n * @param {Canvas} canvas\n * @param {Styles} styles\n * @param {GraphicsFactory} graphicsFactory\n */\nexport default function Create(\n    eventBus, dragging, rules, modeling,\n    canvas, styles, graphicsFactory) {\n\n  // rules\n\n  function canCreate(shape, target, source, position) {\n\n    if (!target) {\n      return false;\n    }\n\n    var ctx = {\n      source: source,\n      shape: shape,\n      target: target,\n      position: position\n    };\n\n    var create,\n        attach,\n        connect;\n\n    attach = rules.allowed('shape.attach', ctx);\n\n    if (!attach) {\n      create = rules.allowed('shape.create', ctx);\n    }\n\n    if (create || attach) {\n\n      connect = source && rules.allowed('connection.create', {\n        source: source,\n        target: shape,\n        hints: {\n          targetParent: target,\n          targetAttach: attach\n        }\n      });\n\n      return {\n        attach: attach,\n        connect: connect\n      };\n    }\n\n    // allow to ignore visually\n    if (create === null || attach === null) {\n      return null;\n    }\n\n    return false;\n  }\n\n\n  /** set drop marker on an element */\n  function setMarker(element, marker) {\n\n    [ MARKER_ATTACH, MARKER_OK, MARKER_NOT_OK, MARKER_NEW_PARENT ].forEach(function(m) {\n\n      if (m === marker) {\n        canvas.addMarker(element, m);\n      } else {\n        canvas.removeMarker(element, m);\n      }\n    });\n  }\n\n\n  // visual helpers\n\n  function createVisual(shape) {\n    var group, preview, visual;\n\n    group = svgCreate('g');\n    svgAttr(group, styles.cls('djs-drag-group', [ 'no-events' ]));\n\n    svgAppend(canvas.getDefaultLayer(), group);\n\n    preview = svgCreate('g');\n    svgClasses(preview).add('djs-dragger');\n\n    svgAppend(group, preview);\n\n    translate(preview, shape.width / -2, shape.height / -2);\n\n    var visualGroup = svgCreate('g');\n    svgClasses(visualGroup).add('djs-visual');\n\n    svgAppend(preview, visualGroup);\n\n    visual = visualGroup;\n\n    // hijack renderer to draw preview\n    graphicsFactory.drawShape(visual, shape);\n\n    return group;\n  }\n\n\n  // event handlers\n\n  eventBus.on('create.move', function(event) {\n    var context = event.context,\n        hover = event.hover,\n        shape = context.shape,\n        source = context.source,\n        canExecute;\n\n    ensureConstraints(event);\n\n    var position = {\n      x: event.x,\n      y: event.y\n    };\n\n    canExecute = context.canExecute = hover && canCreate(shape, hover, source, position);\n\n    // ignore hover visually if canExecute is null\n    if (hover && canExecute !== null) {\n      context.target = hover;\n\n      if (canExecute && canExecute.attach) {\n        setMarker(hover, MARKER_ATTACH);\n      } else {\n        setMarker(hover, canExecute ? MARKER_NEW_PARENT : MARKER_NOT_OK);\n      }\n    }\n  });\n\n  eventBus.on('create.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        shape = context.shape,\n        visual = context.visual;\n\n    // lazy init drag visual once we received the first real\n    // drag move event (this allows us to get the proper canvas local coordinates)\n    if (!visual) {\n      visual = context.visual = createVisual(shape);\n    }\n\n    translate(visual, event.x, event.y);\n  });\n\n\n  eventBus.on([ 'create.end', 'create.out', 'create.cleanup' ], function(event) {\n    var context = event.context,\n        target = context.target;\n\n    if (target) {\n      setMarker(target, null);\n    }\n  });\n\n  eventBus.on('create.end', function(event) {\n    var context = event.context,\n        source = context.source,\n        hints = context.hints,\n        shape = context.shape,\n        target = context.target,\n        canExecute = context.canExecute,\n        attach = canExecute && canExecute.attach,\n        connect = canExecute && canExecute.connect;\n\n    if (canExecute === false || !target) {\n      return false;\n    }\n\n    ensureConstraints(event);\n\n    var position = {\n      x: event.x,\n      y: event.y\n    };\n\n    if (connect) {\n      // invoke append if connect is set via rules\n      shape = modeling.appendShape(source, shape, position, target, {\n        attach: attach,\n        connection: connect === true ? {} : connect\n      });\n    } else {\n      // invoke create, if connect is not set\n      shape = modeling.createShape(shape, position, target, assign(\n        {},\n        hints, {\n          attach: attach\n        }\n      ));\n    }\n\n    // make sure we provide the actual attached\n    // shape with the context so that selection and\n    // other components can use it right after the create\n    // operation ends\n    context.shape = shape;\n  });\n\n\n  eventBus.on('create.cleanup', function(event) {\n    var context = event.context;\n\n    if (context.visual) {\n      svgRemove(context.visual);\n    }\n  });\n\n  // API\n\n  this.start = function(event, shape, sourceOrContext) {\n    var context;\n\n    if (!sourceOrContext || sourceOrContext instanceof Shape) {\n      context = {\n        hints: {},\n        shape: shape,\n        source: sourceOrContext\n      };\n    } else {\n      context = assign({\n        hints: {},\n        shape: shape\n      }, sourceOrContext);\n    }\n\n    dragging.init(event, 'create', {\n      cursor: 'grabbing',\n      autoActivate: true,\n      data: {\n        shape: shape,\n        context: context\n      }\n    });\n  };\n}\n\nCreate.$inject = [\n  'eventBus',\n  'dragging',\n  'rules',\n  'modeling',\n  'canvas',\n  'styles',\n  'graphicsFactory'\n];\n\n// helpers //////////\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      createConstraints = context.createConstraints;\n\n  if (!createConstraints) {\n    return;\n  }\n\n  if (createConstraints.left) {\n    event.x = Math.max(event.x, createConstraints.left);\n  }\n\n  if (createConstraints.right) {\n    event.x = Math.min(event.x, createConstraints.right);\n  }\n\n  if (createConstraints.top) {\n    event.y = Math.max(event.y, createConstraints.top);\n  }\n\n  if (createConstraints.bottom) {\n    event.y = Math.min(event.y, createConstraints.bottom);\n  }\n}","import DraggingModule from '../dragging';\nimport SelectionModule from '../selection';\nimport RulesModule from '../rules';\n\nimport Create from './Create';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    SelectionModule,\n    RulesModule\n  ],\n  create: [ 'type', Create ]\n};\n","import {\n  uniqueBy,\n  isArray\n} from 'min-dash';\n\n\n/**\n * A service that offers un- and redoable execution of commands.\n *\n * The command stack is responsible for executing modeling actions\n * in a un- and redoable manner. To do this it delegates the actual\n * command execution to {@link CommandHandler}s.\n *\n * Command handlers provide {@link CommandHandler#execute(ctx)} and\n * {@link CommandHandler#revert(ctx)} methods to un- and redo a command\n * identified by a command context.\n *\n *\n * ## Life-Cycle events\n *\n * In the process the command stack fires a number of life-cycle events\n * that other components to participate in the command execution.\n *\n *    * preExecute\n *    * preExecuted\n *    * execute\n *    * executed\n *    * postExecute\n *    * postExecuted\n *    * revert\n *    * reverted\n *\n * A special event is used for validating, whether a command can be\n * performed prior to its execution.\n *\n *    * canExecute\n *\n * Each of the events is fired as `commandStack.{eventName}` and\n * `commandStack.{commandName}.{eventName}`, respectively. This gives\n * components fine grained control on where to hook into.\n *\n * The event object fired transports `command`, the name of the\n * command and `context`, the command context.\n *\n *\n * ## Creating Command Handlers\n *\n * Command handlers should provide the {@link CommandHandler#execute(ctx)}\n * and {@link CommandHandler#revert(ctx)} methods to implement\n * redoing and undoing of a command.\n *\n * A command handler _must_ ensure undo is performed properly in order\n * not to break the undo chain. It must also return the shapes that\n * got changed during the `execute` and `revert` operations.\n *\n * Command handlers may execute other modeling operations (and thus\n * commands) in their `preExecute` and `postExecute` phases. The command\n * stack will properly group all commands together into a logical unit\n * that may be re- and undone atomically.\n *\n * Command handlers must not execute other commands from within their\n * core implementation (`execute`, `revert`).\n *\n *\n * ## Change Tracking\n *\n * During the execution of the CommandStack it will keep track of all\n * elements that have been touched during the command's execution.\n *\n * At the end of the CommandStack execution it will notify interested\n * components via an 'elements.changed' event with all the dirty\n * elements.\n *\n * The event can be picked up by components that are interested in the fact\n * that elements have been changed. One use case for this is updating\n * their graphical representation after moving / resizing or deletion.\n *\n * @see CommandHandler\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function CommandStack(eventBus, injector) {\n\n  /**\n   * A map of all registered command handlers.\n   *\n   * @type {Object}\n   */\n  this._handlerMap = {};\n\n  /**\n   * A stack containing all re/undoable actions on the diagram\n   *\n   * @type {Array<Object>}\n   */\n  this._stack = [];\n\n  /**\n   * The current index on the stack\n   *\n   * @type {Number}\n   */\n  this._stackIdx = -1;\n\n  /**\n   * Current active commandStack execution\n   *\n   * @type {Object}\n   */\n  this._currentExecution = {\n    actions: [],\n    dirty: []\n  };\n\n\n  this._injector = injector;\n  this._eventBus = eventBus;\n\n  this._uid = 1;\n\n  eventBus.on([\n    'diagram.destroy',\n    'diagram.clear'\n  ], function() {\n    this.clear(false);\n  }, this);\n}\n\nCommandStack.$inject = [ 'eventBus', 'injector' ];\n\n\n/**\n * Execute a command\n *\n * @param {String} command the command to execute\n * @param {Object} context the environment to execute the command in\n */\nCommandStack.prototype.execute = function(command, context) {\n  if (!command) {\n    throw new Error('command required');\n  }\n\n  var action = { command: command, context: context };\n\n  this._pushAction(action);\n  this._internalExecute(action);\n  this._popAction(action);\n};\n\n\n/**\n * Ask whether a given command can be executed.\n *\n * Implementors may hook into the mechanism on two ways:\n *\n *   * in event listeners:\n *\n *     Users may prevent the execution via an event listener.\n *     It must prevent the default action for `commandStack.(<command>.)canExecute` events.\n *\n *   * in command handlers:\n *\n *     If the method {@link CommandHandler#canExecute} is implemented in a handler\n *     it will be called to figure out whether the execution is allowed.\n *\n * @param  {String} command the command to execute\n * @param  {Object} context the environment to execute the command in\n *\n * @return {Boolean} true if the command can be executed\n */\nCommandStack.prototype.canExecute = function(command, context) {\n\n  var action = { command: command, context: context };\n\n  var handler = this._getHandler(command);\n\n  var result = this._fire(command, 'canExecute', action);\n\n  // handler#canExecute will only be called if no listener\n  // decided on a result already\n  if (result === undefined) {\n    if (!handler) {\n      return false;\n    }\n\n    if (handler.canExecute) {\n      result = handler.canExecute(context);\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Clear the command stack, erasing all undo / redo history\n */\nCommandStack.prototype.clear = function(emit) {\n  this._stack.length = 0;\n  this._stackIdx = -1;\n\n  if (emit !== false) {\n    this._fire('changed');\n  }\n};\n\n\n/**\n * Undo last command(s)\n */\nCommandStack.prototype.undo = function() {\n  var action = this._getUndoAction(),\n      next;\n\n  if (action) {\n    this._pushAction(action);\n\n    while (action) {\n      this._internalUndo(action);\n      next = this._getUndoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Redo last command(s)\n */\nCommandStack.prototype.redo = function() {\n  var action = this._getRedoAction(),\n      next;\n\n  if (action) {\n    this._pushAction(action);\n\n    while (action) {\n      this._internalExecute(action, true);\n      next = this._getRedoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Register a handler instance with the command stack\n *\n * @param {String} command\n * @param {CommandHandler} handler\n */\nCommandStack.prototype.register = function(command, handler) {\n  this._setHandler(command, handler);\n};\n\n\n/**\n * Register a handler type with the command stack\n * by instantiating it and injecting its dependencies.\n *\n * @param {String} command\n * @param {Function} a constructor for a {@link CommandHandler}\n */\nCommandStack.prototype.registerHandler = function(command, handlerCls) {\n\n  if (!command || !handlerCls) {\n    throw new Error('command and handlerCls must be defined');\n  }\n\n  var handler = this._injector.instantiate(handlerCls);\n  this.register(command, handler);\n};\n\nCommandStack.prototype.canUndo = function() {\n  return !!this._getUndoAction();\n};\n\nCommandStack.prototype.canRedo = function() {\n  return !!this._getRedoAction();\n};\n\n// stack access  //////////////////////\n\nCommandStack.prototype._getRedoAction = function() {\n  return this._stack[this._stackIdx + 1];\n};\n\n\nCommandStack.prototype._getUndoAction = function() {\n  return this._stack[this._stackIdx];\n};\n\n\n// internal functionality //////////////////////\n\nCommandStack.prototype._internalUndo = function(action) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n    self._fire(command, 'revert', action);\n\n    if (handler.revert) {\n      self._markDirty(handler.revert(context));\n    }\n\n    self._revertedAction(action);\n\n    self._fire(command, 'reverted', action);\n  });\n};\n\n\nCommandStack.prototype._fire = function(command, qualifier, event) {\n  if (arguments.length < 3) {\n    event = qualifier;\n    qualifier = null;\n  }\n\n  var names = qualifier ? [ command + '.' + qualifier, qualifier ] : [ command ],\n      i, name, result;\n\n  event = this._eventBus.createEvent(event);\n\n  for (i = 0; (name = names[i]); i++) {\n    result = this._eventBus.fire('commandStack.' + name, event);\n\n    if (event.cancelBubble) {\n      break;\n    }\n  }\n\n  return result;\n};\n\nCommandStack.prototype._createId = function() {\n  return this._uid++;\n};\n\nCommandStack.prototype._atomicDo = function(fn) {\n\n  var execution = this._currentExecution;\n\n  execution.atomic = true;\n\n  try {\n    fn();\n  } finally {\n    execution.atomic = false;\n  }\n};\n\nCommandStack.prototype._internalExecute = function(action, redo) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  if (!handler) {\n    throw new Error('no command handler registered for <' + command + '>');\n  }\n\n  this._pushAction(action);\n\n  if (!redo) {\n    this._fire(command, 'preExecute', action);\n\n    if (handler.preExecute) {\n      handler.preExecute(context);\n    }\n\n    this._fire(command, 'preExecuted', action);\n  }\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n\n    self._fire(command, 'execute', action);\n\n    if (handler.execute) {\n      // actual execute + mark return results as dirty\n      self._markDirty(handler.execute(context));\n    }\n\n    // log to stack\n    self._executedAction(action, redo);\n\n    self._fire(command, 'executed', action);\n  });\n\n  if (!redo) {\n    this._fire(command, 'postExecute', action);\n\n    if (handler.postExecute) {\n      handler.postExecute(context);\n    }\n\n    this._fire(command, 'postExecuted', action);\n  }\n\n  this._popAction(action);\n};\n\n\nCommandStack.prototype._pushAction = function(action) {\n\n  var execution = this._currentExecution,\n      actions = execution.actions;\n\n  var baseAction = actions[0];\n\n  if (execution.atomic) {\n    throw new Error('illegal invocation in <execute> or <revert> phase (action: ' + action.command + ')');\n  }\n\n  if (!action.id) {\n    action.id = (baseAction && baseAction.id) || this._createId();\n  }\n\n  actions.push(action);\n};\n\n\nCommandStack.prototype._popAction = function() {\n  var execution = this._currentExecution,\n      actions = execution.actions,\n      dirty = execution.dirty;\n\n  actions.pop();\n\n  if (!actions.length) {\n    this._eventBus.fire('elements.changed', { elements: uniqueBy('id', dirty) });\n\n    dirty.length = 0;\n\n    this._fire('changed');\n  }\n};\n\n\nCommandStack.prototype._markDirty = function(elements) {\n  var execution = this._currentExecution;\n\n  if (!elements) {\n    return;\n  }\n\n  elements = isArray(elements) ? elements : [ elements ];\n\n  execution.dirty = execution.dirty.concat(elements);\n};\n\n\nCommandStack.prototype._executedAction = function(action, redo) {\n  var stackIdx = ++this._stackIdx;\n\n  if (!redo) {\n    this._stack.splice(stackIdx, this._stack.length, action);\n  }\n};\n\n\nCommandStack.prototype._revertedAction = function(action) {\n  this._stackIdx--;\n};\n\n\nCommandStack.prototype._getHandler = function(command) {\n  return this._handlerMap[command];\n};\n\nCommandStack.prototype._setHandler = function(command, handler) {\n  if (!command || !handler) {\n    throw new Error('command and handler required');\n  }\n\n  if (this._handlerMap[command]) {\n    throw new Error('overriding handler for command <' + command + '>');\n  }\n\n  this._handlerMap[command] = handler;\n};\n","import CommandStack from './CommandStack';\n\nexport default {\n  commandStack: [ 'type', CommandStack ]\n};\n","import {\n  getType as getElementType\n} from '../../util/Elements';\n\n/**\n * Adds change support to the diagram, including\n *\n * <ul>\n *   <li>redrawing shapes and connections on change</li>\n * </ul>\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {ElementRegistry} elementRegistry\n * @param {GraphicsFactory} graphicsFactory\n */\nexport default function ChangeSupport(\n    eventBus, canvas, elementRegistry,\n    graphicsFactory) {\n\n\n  // redraw shapes / connections on change\n\n  eventBus.on('element.changed', function(event) {\n\n    var element = event.element;\n\n    // element might have been deleted and replaced by new element with same ID\n    // thus check for parent of element except for root element\n    if (element.parent || element === canvas.getRootElement()) {\n      event.gfx = elementRegistry.getGraphics(element);\n    }\n\n    // shape + gfx may have been deleted\n    if (!event.gfx) {\n      return;\n    }\n\n    eventBus.fire(getElementType(element) + '.changed', event);\n  });\n\n  eventBus.on('elements.changed', function(event) {\n\n    var elements = event.elements;\n\n    elements.forEach(function(e) {\n      eventBus.fire('element.changed', { element: e });\n    });\n\n    graphicsFactory.updateContainments(elements);\n  });\n\n  eventBus.on('shape.changed', function(event) {\n    graphicsFactory.update('shape', event.element, event.gfx);\n  });\n\n  eventBus.on('connection.changed', function(event) {\n    graphicsFactory.update('connection', event.element, event.gfx);\n  });\n}\n\nChangeSupport.$inject = [\n  'eventBus',\n  'canvas',\n  'elementRegistry',\n  'graphicsFactory'\n];","import ChangeSupport from './ChangeSupport';\n\nexport default {\n  __init__: [ 'changeSupport'],\n  changeSupport: [ 'type', ChangeSupport ]\n};","'use strict';\n\nvar inherits = require('inherits');\n\nvar Ids = require('ids');\n\nvar Viewer = require('./Viewer');\n\nvar NavigatedViewer = require('./NavigatedViewer');\n\nvar initialDiagram = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' +\n  '<cmmn:definitions xmlns:dc=\"http://www.omg.org/spec/CMMN/20151109/DC\" ' +\n                    'xmlns:di=\"http://www.omg.org/spec/CMMN/20151109/DI\" ' +\n                    'xmlns:cmmndi=\"http://www.omg.org/spec/CMMN/20151109/CMMNDI\" ' +\n                    'xmlns:cmmn=\"http://www.omg.org/spec/CMMN/20151109/MODEL\" ' +\n                    'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" id=\"Test\" ' +\n                    'targetNamespace=\"http://bpmn.io/schema/cmmn\">' +\n    '<cmmn:case id=\"Case_1\">' +\n      '<cmmn:casePlanModel id=\"CasePlanModel_1\" name=\"A CasePlanModel\">' +\n        '<cmmn:planItem id=\"PlanItem_1\" definitionRef=\"Task_1\" />' +\n        '<cmmn:task id=\"Task_1\" />' +\n      '</cmmn:casePlanModel>' +\n    '</cmmn:case>' +\n    '<cmmndi:CMMNDI>' +\n      '<cmmndi:CMMNDiagram id=\"CMMNDiagram_1\">' +\n        '<cmmndi:Size width=\"500\" height=\"500\" />' +\n        '<cmmndi:CMMNShape id=\"DI_CasePlanModel_1\" cmmnElementRef=\"CasePlanModel_1\">' +\n          '<dc:Bounds x=\"114\" y=\"63\" width=\"534\" height=\"389\" />' +\n          '<cmmndi:CMMNLabel />' +\n        '</cmmndi:CMMNShape>' +\n        '<cmmndi:CMMNShape id=\"PlanItem_1_di\" cmmnElementRef=\"PlanItem_1\">' +\n          '<dc:Bounds x=\"150\" y=\"96\" width=\"100\" height=\"80\" />' +\n          '<cmmndi:CMMNLabel />' +\n        '</cmmndi:CMMNShape>' +\n      '</cmmndi:CMMNDiagram>' +\n    '</cmmndi:CMMNDI>' +\n  '</cmmn:definitions>';\n\n/**\n * A modeler for CMMN 1.1 diagrams.\n *\n * Have a look at {@link NavigatedViewer} or {@link Modeler} for bundles that include\n * additional features.\n\n *\n * ## Extending the Modeler\n *\n * In order to extend the viewer pass extension modules to bootstrap via the\n * `additionalModules` option. An extension module is an object that exposes\n * named services.\n *\n * The following example depicts the integration of a simple\n * logging component that integrates with interaction events:\n *\n *\n * ```javascript\n *\n * // logging component\n * function InteractionLogger(eventBus) {\n *   eventBus.on('element.hover', function(event) {\n *     console.log()\n *   })\n * }\n *\n * InteractionLogger.$inject = [ 'eventBus' ]; // minification save\n *\n * // extension module\n * var extensionModule = {\n *   __init__: [ 'interactionLogger' ],\n *   interactionLogger: [ 'type', InteractionLogger ]\n * };\n *\n * // extend the viewer\n * var cmmnModeler = new Modeler({ additionalModules: [ extensionModule ] });\n * cmmnModeler.importXML(...);\n * ```\n *\n *\n * ## Customizing / Replacing Components\n *\n * You can replace individual diagram components by redefining them in override modules.\n * This works for all components, including those defined in the core.\n *\n * Pass in override modules via the `options.additionalModules` flag like this:\n *\n * ```javascript\n * function CustomContextPadProvider(contextPad) {\n *\n *   contextPad.registerProvider(this);\n *\n *   this.getContextPadEntries = function(element) {\n *     // no entries, effectively disable the context pad\n *     return {};\n *   };\n * }\n *\n * CustomContextPadProvider.$inject = [ 'contextPad' ];\n *\n * var overrideModule = {\n *   contextPadProvider: [ 'type', CustomContextPadProvider ]\n * };\n *\n * var cmmnModeler = new Modeler({ additionalModules: [ overrideModule ]});\n * ```\n *\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to attach to\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nfunction Modeler(options) {\n  Viewer.call(this, options);\n\n  // hook ID collection into the modeler\n  this.on('import.parse.complete', function(event) {\n    if (!event.error) {\n      this._collectIds(event.definitions, event.context);\n    }\n  }, this);\n\n  this.on('diagram.destroy', function() {\n    this.get('moddle').ids.clear();\n  }, this);\n}\n\ninherits(Modeler, Viewer);\n\nmodule.exports = Modeler;\n\nmodule.exports.Viewer = Viewer;\n\nmodule.exports.NavigatedViewer = NavigatedViewer;\n\n/**\n * Create a new diagram to start modeling.\n *\n * @param {Function} [done]\n */\nModeler.prototype.createDiagram = function(done) {\n  return this.importXML(initialDiagram, done);\n};\n\n/**\n * Create a moddle instance, attaching ids to it.\n *\n * @param {Object} options\n */\nModeler.prototype._createModdle = function(options) {\n  var moddle = Viewer.prototype._createModdle.call(this, options);\n\n  // attach ids to moddle to be able to track\n  // and validated ids in the CMMN 1.1 XML document\n  // tree\n  moddle.ids = new Ids([ 32, 36, 1 ]);\n\n  return moddle;\n};\n\n/**\n * Collect ids processed during parsing of the\n * definitions object.\n *\n * @param {ModdleElement} definitions\n * @param {Context} context\n */\nModeler.prototype._collectIds = function(definitions, context) {\n\n  var moddle = definitions.$model,\n      ids = moddle.ids,\n      id;\n\n  // remove references from previous import\n  ids.clear();\n\n  for (id in context.elementsById) {\n    ids.claim(id, context.elementsById[id]);\n  }\n};\n\n\nModeler.prototype._interactionModules = [\n  // non-modeling components\n  require('diagram-js/lib/features/auto-scroll').default,\n  require('diagram-js/lib/navigation/keyboard-move').default,\n  require('diagram-js/lib/navigation/movecanvas').default,\n  require('diagram-js/lib/navigation/zoomscroll').default,\n  require('./features/outline')\n];\n\nModeler.prototype._modelingModules = [\n  // modeling components\n  require('diagram-js/lib/features/bendpoints').default,\n  require('diagram-js/lib/features/keyboard-move-selection').default,\n  require('diagram-js/lib/features/move').default,\n  require('diagram-js/lib/features/resize').default,\n  require('diagram-js/lib/features/connection-preview').default,\n  require('./features/auto-resize'),\n  require('./features/context-pad'),\n  require('./features/editor-actions'),\n  require('./features/keyboard'),\n  require('./features/label-editing'),\n  require('./features/modeling'),\n  require('./features/palette'),\n  require('./features/snapping'),\n  require('./features/search'),\n  require('./features/replace-preview')\n];\n\n\n// modules the modeler is composed of\n//\n// - viewer modules\n// - interaction modules\n// - modeling modules\n\nModeler.prototype._modules = [].concat(\n  Modeler.prototype._modules,\n  Modeler.prototype._interactionModules,\n  Modeler.prototype._modelingModules);","'use strict';\n\nvar hat = require('hat');\n\n\n/**\n * Create a new id generator / cache instance.\n *\n * You may optionally provide a seed that is used internally.\n *\n * @param {Seed} seed\n */\nfunction Ids(seed) {\n\n  if (!(this instanceof Ids)) {\n    return new Ids(seed);\n  }\n\n  seed = seed || [ 128, 36, 1 ];\n  this._seed = seed.length ? hat.rack(seed[0], seed[1], seed[2]) : seed;\n}\n\nmodule.exports = Ids;\n\n/**\n * Generate a next id.\n *\n * @param {Object} [element] element to bind the id to\n *\n * @return {String} id\n */\nIds.prototype.next = function(element) {\n  return this._seed(element || true);\n};\n\n/**\n * Generate a next id with a given prefix.\n *\n * @param {Object} [element] element to bind the id to\n *\n * @return {String} id\n */\nIds.prototype.nextPrefixed = function(prefix, element) {\n  var id;\n\n  do {\n    id = prefix + this.next(true);\n  } while (this.assigned(id));\n\n  // claim {prefix}{random}\n  this.claim(id, element);\n\n  // return\n  return id;\n};\n\n/**\n * Manually claim an existing id.\n *\n * @param {String} id\n * @param {String} [element] element the id is claimed by\n */\nIds.prototype.claim = function(id, element) {\n  this._seed.set(id, element || true);\n};\n\n/**\n * Returns true if the given id has already been assigned.\n *\n * @param  {String} id\n * @return {Boolean}\n */\nIds.prototype.assigned = function(id) {\n  return this._seed.get(id) || false;\n};\n\n/**\n * Unclaim an id.\n *\n * @param  {String} id the id to unclaim\n */\nIds.prototype.unclaim = function(id) {\n  delete this._seed.hats[id];\n};\n\n\n/**\n * Clear all claimed ids.\n */\nIds.prototype.clear = function() {\n\n  var hats = this._seed.hats,\n      id;\n\n  for (id in hats) {\n    this.unclaim(id);\n  }\n};","'use strict';\n\nvar CmmnTreeWalker = require('./CmmnTreeWalker');\n\n\n/**\n * Import the definitions into a diagram.\n *\n * Errors and warnings are reported through the specified callback.\n *\n * @param  {Diagram} diagram\n * @param  {ModdleElement} definitions\n * @param  {Function} done the callback, invoked with (err, [ warning ]) once the import is done\n */\nfunction importCmmnDiagram(diagram, definitions, done) {\n\n  var importer = diagram.get('cmmnImporter'),\n      eventBus = diagram.get('eventBus'),\n      itemRegistry = diagram.get('itemRegistry');\n\n  var error,\n      warnings = [];\n\n  /**\n   * Walk the diagram semantically, importing (=drawing)\n   * all elements you encounter.\n   *\n   * @param {ModdleElement} definitions\n   */\n  function render(definitions) {\n\n    var visitor = {\n\n      root: function(element) {\n        return importer.root(element);\n      },\n\n      element: function(element, parentShape) {\n        return importer.add(element, parentShape);\n      },\n\n      error: function(message, context) {\n        warnings.push({ message: message, context: context });\n      },\n\n      addItem: function(item) {\n        itemRegistry.add(item);\n      }\n    };\n\n    var walker = new CmmnTreeWalker(visitor);\n\n    // import\n    walker.handleDefinitions(definitions);\n  }\n\n  eventBus.fire('import.render.start', { definitions: definitions });\n\n  try {\n    render(definitions);\n  } catch (e) {\n    error = e;\n  }\n\n  eventBus.fire('import.render.complete', {\n    error: error,\n    warnings: warnings\n  });\n\n  done(error, warnings);\n}\n\nmodule.exports.importCmmnDiagram = importCmmnDiagram;","'use strict';\n\nvar forEach = require('min-dash').forEach,\n    filter = require('min-dash').filter;\n\nvar Refs = require('object-refs');\n\nvar elementToString = require('./Util').elementToString;\nvar is = require('../util/ModelUtil').is;\n\nvar Collections = require('diagram-js/lib/util/Collections');\n\nvar diRefs = new Refs({ name: 'cmmnElement', enumerable: true }, { name: 'di' });\n\n\nfunction CmmnTreeWalker(handler) {\n\n  // list of elements to handle deferred to ensure\n  // prerequisites are drawn\n  var deferred = [];\n\n  // list of CMMNEdges which cmmnElementRef is equals null:\n  // - it is a connection which does not have a representation\n  //   in case plan model\n  // - it is a connection between a human (plan item) task and a\n  //   discretionary item\n  var connections = [];\n\n  var discretionaryConnections = {};\n\n  // list of cases to draw\n  var cases = [];\n\n  var handledDiscretionaryItems = {};\n\n  // list of elements (textAnnotations and caseFileItems)\n  var elementsWithoutParent = [];\n\n  var associations = [];\n\n  // Helpers /////////////////\n\n  function isDiscretionaryItemHandled(item) {\n    return !!handledDiscretionaryItems[item.id];\n  }\n\n  function handledDiscretionaryItem(item) {\n    handledDiscretionaryItems[item.id] = item;\n  }\n\n  /**\n   * Returns the surrounding 'cmmn:Case' element\n   *\n   * @param {ModdleElement} element\n   *\n   * @return {ModdleElement} the surrounding case\n   */\n  function getCase(element) {\n    while (element && !is(element, 'cmmn:Case')) {\n      element = element.$parent;\n    }\n    return element;\n  }\n\n  function visit(element, ctx) {\n    // call handler\n    return handler.element(element, ctx);\n  }\n\n  function visitRoot(element, diagram) {\n    return handler.root(element, diagram);\n  }\n\n  function visitIfDi(element, ctx) {\n    try {\n      handler.addItem(element);\n      return element.di && visit(element, ctx);\n    } catch (e) {\n      logError(e.message, { element: element, error: e });\n\n      console.error('failed to import ' + elementToString(element));\n      console.error(e);\n    }\n  }\n\n  function logError(message, context) {\n    handler.error(message, context);\n  }\n\n\n  function contextual(fn, ctx) {\n    return function(e) {\n      fn(e, ctx);\n    };\n  }\n\n  // DI handling /////////////////\n\n  function registerDi(di) {\n\n    var cmmnElement = di.cmmnElementRef;\n\n    if (cmmnElement && !is(di, 'cmmndi:CMMNEdge')) {\n\n      if (cmmnElement.di) {\n        logError('multiple DI elements defined for ' + elementToString(cmmnElement), { element: cmmnElement });\n      }\n      else {\n\n        var _case = getCase(cmmnElement);\n        if (_case && cases.indexOf(_case) === -1) {\n          // add _case to the list of cases\n          // that should be drawn\n          cases.push(_case);\n        }\n\n        if (is(cmmnElement, 'cmmn:TextAnnotation') || is(cmmnElement, 'cmmn:CaseFileItem')) {\n          elementsWithoutParent.push(cmmnElement);\n        }\n\n        diRefs.bind(cmmnElement, 'di');\n        cmmnElement.di = di;\n      }\n\n    }\n    else if (is(di, 'cmmndi:CMMNEdge')) {\n      var shouldHandle = true;\n\n      if (!isReferencingTarget(di)) {\n        shouldHandle = false;\n        logError('no target referenced in ' + elementToString(di), { element: di });\n      }\n\n      if (!isReferencingSource(di)) {\n        shouldHandle = false;\n        logError('no source referenced in ' + elementToString(di), { element: di });\n      }\n\n      if (shouldHandle) {\n\n        if (is(cmmnElement, 'cmmn:Association')) {\n          associations.push(di);\n        }\n        else if (!cmmnElement) {\n          var source = di.sourceCMMNElementRef;\n          discretionaryConnections[source.id] = discretionaryConnections[source.id] || [];\n          discretionaryConnections[source.id].push(di);\n        }\n        else {\n          connections.push(function(ctx) {\n            handleConnection(di, ctx);\n          });\n        }\n      }\n\n    }\n    else {\n      logError('no cmmnElement referenced in ' + elementToString(di), { element: di });\n    }\n  }\n\n  function isReferencingTarget(edge) {\n    if (is(edge.cmmnElementRef, 'cmmn:Association')) {\n      return !!edge.cmmnElementRef.targetRef;\n    }\n\n    return !!edge.targetCMMNElementRef;\n  }\n\n  function isReferencingSource(edge) {\n    if (is(edge.cmmnElementRef, 'cmmn:OnPart')) {\n      return !!(edge.cmmnElementRef.exitCriterionRef || edge.cmmnElementRef.sourceRef);\n    }\n\n    if (is(edge.cmmnElementRef, 'cmmn:Association')) {\n      return !!edge.cmmnElementRef.sourceRef;\n    }\n\n    return !!edge.sourceCMMNElementRef;\n  }\n\n  function handleConnection(connection, context) {\n    visit(connection, context);\n  }\n\n  function handleDiagram(diagram) {\n    handleDiagramElements(diagram.diagramElements);\n  }\n\n  function handleDiagramElements(diagramElements) {\n    forEach(diagramElements, handleDiagramElement);\n  }\n\n  function handleDiagramElement(diagramElement) {\n    registerDi(diagramElement);\n  }\n\n  // Semantic handling /////////////////\n\n  function handleDefinitions(definitions, diagram) {\n    // make sure we walk the correct cmmnElement\n\n    var cmmndi = definitions.CMMNDI;\n\n    // no di -> nothing to import\n    if (!cmmndi) {\n      return;\n    }\n\n    var diagrams = cmmndi.diagrams;\n\n    if (diagram && diagrams.indexOf(diagram) === -1) {\n      throw new Error('diagram not part of cmmn:Definitions');\n    }\n\n    if (!diagram && diagrams && diagrams.length) {\n      diagram = diagrams[0];\n    }\n\n    // handle only the first diagram and ignore others\n    handleDiagram(diagram);\n\n    var context = visitRoot(diagram, diagram);\n\n    handleCases(cases, context);\n\n    forEach(elementsWithoutParent, contextual(handleElementWithoutParent));\n    forEach(associations, contextual(handleAssociation));\n  }\n\n  function handleCases(cases, context) {\n    forEach(cases, function(_case) {\n      handleCase(_case, context);\n\n      // clear collections for the next iteration\n      deferred = [];\n      connections = [];\n    });\n  }\n\n  function handleCase(_case, context) {\n    var casePlanModel = _case.casePlanModel;\n\n    var casePlanModelContext;\n    if (casePlanModel) {\n      casePlanModelContext = handleCasePlanModel(casePlanModel, context);\n    }\n\n    handleDeferred(deferred);\n\n    forEach(connections, function(d) { d(casePlanModelContext); });\n\n  }\n\n  function handleCasePlanModel(casePlanModel, context) {\n    var newCtx = visitIfDi(casePlanModel, context);\n\n    forEach(casePlanModel.exitCriteria, contextual(handleCriterion, newCtx));\n\n    handlePlanFragment(casePlanModel, newCtx);\n    handleElementsWithoutParent(casePlanModel, newCtx);\n\n    return newCtx;\n  }\n\n  function handleDeferred(deferred) {\n    forEach(deferred, function(d) { d(); });\n  }\n\n  function handlePlanFragment(planFragment, context) {\n    handlePlanItems(planFragment.planItems, context);\n\n    if (is(planFragment, 'cmmn:Stage')) {\n      handleStage(planFragment, context);\n    }\n  }\n\n  function handleStage(stage, context) {\n    handlePlanningTable(stage.planningTable, context);\n  }\n\n  function handlePlanningTable(planningTable, context) {\n    if (planningTable) {\n      forEach(planningTable.tableItems, function(tableItem) {\n        if (is(tableItem, 'cmmn:DiscretionaryItem')) {\n          handleDiscretionaryItem(tableItem, context);\n        }\n        else if (is(tableItem, 'cmmn:PlanningTable')) {\n          handlePlanningTable(tableItem, context);\n        }\n      });\n    }\n  }\n\n  function handleDiscretionaryItem(discretionayItem, context) {\n    if (isDiscretionaryItemHandled(discretionayItem)) {\n      return;\n    }\n\n    handledDiscretionaryItem(discretionayItem);\n    handleItem(discretionayItem, context);\n  }\n\n  function handlePlanItems(planItems, context) {\n    forEach(planItems, contextual(handleItem, context));\n  }\n\n  function handleItem(item, context) {\n    var newCtx = visitIfDi(item, context);\n\n    forEach(item.exitCriteria, contextual(handleCriterion, context));\n    forEach(item.entryCriteria, contextual(handleCriterion, context));\n\n    var definitionRef = item.definitionRef;\n    if (is(definitionRef, 'cmmn:PlanFragment')) {\n      handlePlanFragment(definitionRef, newCtx);\n      handleElementsWithoutParent(item, newCtx);\n    }\n    else if (is(definitionRef, 'cmmn:HumanTask')) {\n      handlePlanningTable(definitionRef.planningTable, context);\n\n      var edges = discretionaryConnections[item.id];\n      forEach(edges, contextual(handleDiscretionaryConnection, context));\n      delete discretionaryConnections[item.id];\n\n    }\n  }\n\n  function handleCriterion(criterion, context) {\n    deferred.unshift(function() {\n      visitIfDi(criterion, context);\n    });\n  }\n\n  function handleElementsWithoutParent(container, context) {\n\n    if (container.di && container.di.bounds) {\n      var elements = getEnclosedElements(elementsWithoutParent, container);\n\n      forEach(elements, function(e) {\n        Collections.remove(elementsWithoutParent, e);\n        handleElementWithoutParent(e, context);\n      });\n    }\n\n  }\n\n  function handleElementWithoutParent(element, context) {\n    if (is(element, 'cmmn:TextAnnotation')) {\n      handleTextAnnotation(element, context);\n    }\n    else if (is(element, 'cmmn:CaseFileItem')) {\n      handleCaseFileItem(element, context);\n    }\n  }\n\n  function handleCaseFileItem(caseFileItem, context) {\n    visitIfDi(caseFileItem, context);\n  }\n\n  function handleTextAnnotation(annotation, context) {\n    visitIfDi(annotation, context);\n  }\n\n  function handleAssociation(association, context) {\n    visit(association, context);\n  }\n\n  function handleDiscretionaryConnection(connection, context) {\n    deferred.push(function() {\n      visit(connection, context);\n    });\n  }\n\n  function getEnclosedElements(elements, container) {\n    var bounds = container.di.bounds;\n    return filter(elements, function(e) {\n      return e.di.bounds.x > bounds.x &&\n             e.di.bounds.x < (bounds.x + bounds.width) &&\n             e.di.bounds.y > bounds.y &&\n             e.di.bounds.y < (bounds.y + bounds.height);\n    });\n  }\n\n  // API /////////////////\n\n  return {\n    handleDefinitions: handleDefinitions\n  };\n}\n\nmodule.exports = CmmnTreeWalker;","module.exports = {\n  __depends__: [\n    require('../draw'),\n    require('../import')\n  ],\n  itemRegistry: [ 'type', require('./ItemRegistry') ]\n};","module.exports = {\n  __init__: [ 'cmmnRenderer' ],\n  cmmnRenderer: [ 'type', require('./CmmnRenderer') ],\n  pathMap: [ 'type', require('./PathMap') ]\n};","'use strict';\n\nvar inherits = require('inherits'),\n    isArray = require('min-dash').isArray,\n    isObject = require('min-dash').isObject,\n    assign = require('min-dash').assign;\n\nvar BaseRenderer = require('diagram-js/lib/draw/BaseRenderer').default,\n    TextUtil = require('diagram-js/lib/util/Text').default,\n    DiUtil = require('../util/DiUtil'),\n    ModelUtil = require('../util/ModelUtil');\n\nvar isStandardEventVisible = DiUtil.isStandardEventVisible;\nvar isPlanningTableCollapsed = DiUtil.isPlanningTableCollapsed;\nvar isCollapsed = DiUtil.isCollapsed;\n\nvar isCasePlanModel = ModelUtil.isCasePlanModel;\nvar getBusinessObject = ModelUtil.getBusinessObject;\nvar getDefinition = ModelUtil.getDefinition;\nvar isRequired = ModelUtil.isRequired;\nvar isRepeatable = ModelUtil.isRepeatable;\nvar isManualActivation = ModelUtil.isManualActivation;\nvar isAutoComplete = ModelUtil.isAutoComplete;\nvar hasPlanningTable = ModelUtil.hasPlanningTable;\nvar getName = ModelUtil.getName;\nvar is = ModelUtil.is;\nvar getStandardEvent = ModelUtil.getStandardEvent;\n\nvar domQuery = require('min-dom').query;\n\nvar svgAppend = require('tiny-svg').append,\n    svgAttr = require('tiny-svg').attr,\n    svgClasses = require('tiny-svg').classes,\n    svgCreate = require('tiny-svg').create;\n\nvar translate = require('diagram-js/lib/util/SvgTransformUtil').translate;\n\nvar createLine = require('diagram-js/lib/util/RenderUtil').createLine;\n\n\nfunction CmmnRenderer(eventBus, styles, pathMap) {\n\n  BaseRenderer.call(this, eventBus);\n\n  var TASK_BORDER_RADIUS = 10;\n  var MILESTONE_BORDER_RADIUS = 24;\n  var STAGE_EDGE_OFFSET = 20;\n\n  var LABEL_STYLE = {\n    fontFamily: 'Arial, sans-serif',\n    fontSize: '12px'\n  };\n\n  var textUtil = new TextUtil({\n    style: LABEL_STYLE,\n    size: { width: 100 }\n  });\n\n  var markers = {};\n\n  function addMarker(id, element) {\n    markers[id] = element;\n  }\n\n  function marker(id) {\n    return markers[id];\n  }\n\n  function initMarkers(svg) {\n\n    function createMarker(id, options) {\n      var attrs = assign({\n        fill: 'black',\n        strokeWidth: 1,\n        strokeLinecap: 'round',\n        strokeDasharray: 'none'\n      }, options.attrs);\n\n      var ref = options.ref || { x: 0, y: 0 };\n\n      var scale = options.scale || 1;\n\n      // fix for safari / chrome / firefox bug not correctly\n      // resetting stroke dash array\n      if (attrs.strokeDasharray === 'none') {\n        attrs.strokeDasharray = [10000, 1];\n      }\n\n      var marker = svgCreate('marker');\n\n      svgAttr(options.element, attrs);\n\n      svgAppend(marker, options.element);\n\n      svgAttr(marker, {\n        id: id,\n        viewBox: '0 0 20 20',\n        refX: ref.x,\n        refY: ref.y,\n        markerWidth: 20 * scale,\n        markerHeight: 20 * scale,\n        orient: 'auto'\n      });\n\n      var defs = domQuery('defs', svg);\n\n      if (!defs) {\n        defs = svgCreate('defs');\n\n        svgAppend(svg, defs);\n      }\n\n      svgAppend(defs, marker);\n\n      return addMarker(id, marker);\n    }\n\n    var associationStart = svgCreate('path');\n    svgAttr(associationStart, { d: 'M 11 5 L 1 10 L 11 15' });\n\n    createMarker('association-start', {\n      element: associationStart,\n      attrs: {\n        fill: 'none',\n        stroke: 'black',\n        strokeWidth: 1.5\n      },\n      ref: { x: 1, y: 10 },\n      scale: 0.5\n    });\n\n    var associationEnd = svgCreate('path');\n    svgAttr(associationEnd, { d: 'M 1 5 L 11 10 L 1 15' });\n\n    createMarker('association-end', {\n      element: associationEnd,\n      attrs: {\n        fill: 'none',\n        stroke: 'black',\n        strokeWidth: 1.5\n      },\n      ref: { x: 12, y: 10 },\n      scale: 0.5\n    });\n\n  }\n\n  // draw shape //////////////////////////////////////////////////////////////\n\n  function computeStyle(custom, traits, defaultStyles) {\n    if (!isArray(traits)) {\n      defaultStyles = traits;\n      traits = [];\n    }\n\n    return styles.style(traits || [], assign(defaultStyles, custom || {}));\n  }\n\n  function drawCircle(parentGfx, width, height, offset, attrs) {\n\n    if (isObject(offset)) {\n      attrs = offset;\n      offset = 0;\n    }\n\n    offset = offset || 0;\n\n    attrs = computeStyle(attrs, {\n      stroke: 'black',\n      strokeWidth: 2,\n      fill: 'white'\n    });\n\n    var cx = width / 2,\n        cy = height / 2;\n\n    var circle = svgCreate('circle');\n    svgAttr(circle, {\n      cx: cx,\n      cy: cy,\n      r: Math.round((width + height) / 4 - offset)\n    });\n    svgAttr(circle, attrs);\n\n    svgAppend(parentGfx, circle);\n\n    return circle;\n  }\n\n  function drawRect(parentGfx, width, height, r, offset, attrs) {\n\n    if (isObject(offset)) {\n      attrs = offset;\n      offset = 0;\n    }\n\n    offset = offset || 0;\n\n    attrs = computeStyle(attrs, {\n      stroke: 'black',\n      strokeWidth: 2,\n      fill: 'white'\n    });\n\n    var rect = svgCreate('rect');\n    svgAttr(rect, {\n      x: offset,\n      y: offset,\n      width: width - offset * 2,\n      height: height - offset * 2,\n      rx: r,\n      ry: r\n    });\n    svgAttr(rect, attrs);\n\n    svgAppend(parentGfx, rect);\n\n    return rect;\n  }\n\n  function drawDiamond(parentGfx, width, height, attrs) {\n\n    var x_2 = width / 2;\n    var y_2 = height / 2;\n\n    var points = [\n      { x: x_2, y: 0 },\n      { x: width, y: y_2 },\n      { x: x_2, y: height },\n      { x: 0, y: y_2 }\n    ];\n\n    var pointsString = points.map(function(point) {\n      return point.x + ',' + point.y;\n    }).join(' ');\n\n    attrs = computeStyle(attrs, {\n      stroke: 'black',\n      strokeWidth: 2,\n      fill: 'white'\n    });\n\n    var polygon = svgCreate('polygon');\n    svgAttr(polygon, {\n      points: pointsString\n    });\n    svgAttr(polygon, attrs);\n\n    svgAppend(parentGfx, polygon);\n\n    return polygon;\n  }\n\n  function drawPath(parentGfx, d, attrs) {\n\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\n      strokeWidth: 2,\n      stroke: 'black'\n    });\n\n    var path = svgCreate('path');\n    svgAttr(path, { d: d });\n    svgAttr(path, attrs);\n\n    svgAppend(parentGfx, path);\n\n    return path;\n  }\n\n  function drawOctagon(parentGfx, width, height, offset, attrs) {\n    offset = offset || 20;\n\n    var x1 = offset;\n    var y1 = height;\n\n    var x2 = 0;\n    var y2 = height - offset;\n\n    var x3 = 0;\n    var y3 = offset;\n\n    var x4 = offset;\n    var y4 = 0;\n\n    var x5 = width - offset;\n    var y5 = 0;\n\n    var x6 = width;\n    var y6 = offset;\n\n    var x7 = width;\n    var y7 = height - offset;\n\n    var x8 = width - offset;\n    var y8 = height;\n\n    var points = [\n      { x: x1, y: y1 },\n      { x: x2, y: y2 },\n      { x: x3, y: y3 },\n      { x: x4, y: y4 },\n      { x: x5, y: y5 },\n      { x: x6, y: y6 },\n      { x: x7, y: y7 },\n      { x: x8, y: y8 }\n    ];\n\n    attrs = attrs || {};\n    attrs.fill = 'white';\n    attrs.stroke = 'black';\n    attrs.strokeWidth = 2;\n\n    return drawPolygon(parentGfx, points, attrs);\n  }\n\n  function drawPolygon(parentGfx, points, attrs) {\n    var pointsString = points.map(function(point) {\n      return point.x + ',' + point.y;\n    }).join(' ');\n\n    var polygon = svgCreate('polygon');\n\n    svgAttr(polygon, {\n      points: pointsString\n    });\n    svgAttr(polygon, attrs);\n\n    svgAppend(parentGfx, polygon);\n\n    return polygon;\n  }\n\n  // draw connection ////////////////////////////////////////////\n\n  function drawLine(parentGfx, waypoints, attrs) {\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\n      stroke: 'black',\n      strokeWidth: 2,\n      fill: 'none'\n    });\n\n    var line = createLine(waypoints, attrs);\n\n    svgAppend(parentGfx, line);\n\n    return line;\n  }\n\n  function createPathFromConnection(connection) {\n    var waypoints = connection.waypoints;\n\n    var pathData = 'm  ' + waypoints[0].x + ',' + waypoints[0].y;\n    for (var i = 1; i < waypoints.length; i++) {\n      pathData += 'L' + waypoints[i].x + ',' + waypoints[i].y + ' ';\n    }\n    return pathData;\n  }\n\n  // render label //////////////////////////////////////////////\n\n  function renderLabel(parentGfx, label, options) {\n    var text = textUtil.createText(label || '', options);\n    svgClasses(text).add('djs-label');\n    svgAppend(parentGfx, text);\n\n    return text;\n  }\n\n  function renderEmbeddedLabel(p, element, align) {\n    var name = getName(element);\n    return renderLabel(p, name, {\n      box: element,\n      align: align,\n      padding: 5\n    });\n  }\n\n  function renderExpandedStageLabel(p, element, align) {\n    var name = getName(element);\n    var textbox = renderLabel(p, name, { box: element, align: align, padding: 5 });\n\n    // reset the position of the text box\n    translate(textbox, STAGE_EDGE_OFFSET, 0);\n\n    return textbox;\n  }\n\n  function renderCasePlanModelLabel(p, element) {\n    var bo = getBusinessObject(element);\n\n    // default maximum textbox dimensions\n    var height = 18;\n    var width = (element.width / 2) - 60;\n\n    var label = bo.name;\n\n    // create text box\n    var textBox = renderLabel(p, label, {\n      box: { height: height, width: width },\n      align: 'left-top'\n    });\n\n    var minWidth = 60,\n        padding = 40,\n        textBoxWidth = textBox.getBBox().width;\n\n    // set polygon width based on actual textbox size\n    var polygonWidth = textBoxWidth + padding;\n\n    if (textBoxWidth < minWidth) {\n      polygonWidth = minWidth + padding;\n    }\n\n    var polygonPoints = [\n      { x: 10, y: 0 },\n      { x: 20, y: -height },\n      { x: polygonWidth, y: -height },\n      { x: polygonWidth + 10, y: 0 }\n    ];\n\n    // The pointer-events attribute is needed to allow clicks on the polygon\n    // which otherwise would be prevented by the parent node ('djs-visual').\n    var polygon = drawPolygon(p, polygonPoints, {\n      fill: 'white',\n      stroke: 'black',\n      strokeWidth: 2,\n      fillOpacity: 0.95,\n      'pointer-events': 'all'\n    });\n\n    // make sure the textbox is visually on top of the polygon\n    textBox.parentNode.insertBefore(polygon, textBox);\n\n    // reset the position of the text box\n    translate(textBox, 25, -height + 5);\n\n    return textBox;\n  }\n\n  function renderExternalLabel(parentGfx, element) {\n    var name = getName(element),\n        hide = false;\n\n    var standardEvent = getStandardEvent(element);\n\n    if (standardEvent) {\n\n      var standardEventVisible = isStandardEventVisible(element);\n      standardEvent = '[' + standardEvent + ']';\n\n      if (!name) {\n        name = standardEvent;\n        element.hidden = hide = !standardEventVisible;\n      }\n      else {\n        if (standardEventVisible) {\n          name = name + ' ' + standardEvent;\n        }\n      }\n\n    }\n\n    var box = {\n      width: 90,\n      height: 30,\n      x: element.width / 2 + element.x,\n      y: element.height / 2 + element.y\n    };\n\n    element.hidden = element.labelTarget.hidden || hide || !name;\n\n    return renderLabel(parentGfx, name, { box: box, style: { fontSize: '11px' } });\n  }\n\n  // render elements //////////////////////////////////////////\n\n  function renderer(type) {\n    return handlers[type];\n  }\n\n  var handlers = {\n    'cmmn:PlanItem': function(p, element) {\n      var definition = getDefinition(element);\n      return renderer(definition.$type)(p, element);\n    },\n\n    'cmmn:DiscretionaryItem': function(p, element) {\n      var definition = getDefinition(element);\n\n      var attrs = {\n        strokeDasharray: '10, 12'\n      };\n\n      if (is(definition, 'cmmn:Task')) {\n        assign(attrs, {\n          strokeDasharray: '12, 12.4',\n          strokeDashoffset: 13.6\n        });\n      }\n\n      return renderer(definition.$type)(p, element, attrs);\n    },\n\n    // STAGE\n    'cmmn:Stage': function(p, element, attrs) {\n\n      attrs = assign({ fillOpacity: 0.95 }, attrs);\n\n      var rect;\n      if (isCasePlanModel(element)) {\n        return handlers['cmmn:CasePlanModel'](p, element);\n      }\n\n      rect = drawOctagon(p, element.width, element.height, STAGE_EDGE_OFFSET, attrs);\n\n      if (!isCollapsed(element)) {\n        renderExpandedStageLabel(p, element, 'left-top');\n      }\n      else {\n        renderEmbeddedLabel(p, element, 'center-middle');\n      }\n\n      attachPlanningTableMarker(p, element);\n      attachStageMarkers(p, element);\n      return rect;\n    },\n\n    // STAGE\n    'cmmn:PlanFragment': function(p, element, attrs) {\n\n      var rect = drawRect(p, element.width, element.height, TASK_BORDER_RADIUS, {\n        strokeDasharray: '10, 12',\n        fillOpacity: 0.95\n      });\n\n      renderEmbeddedLabel(p, element, isCollapsed(element) ? 'center-middle' : 'left-top');\n\n      attachStageMarkers(p, element);\n      return rect;\n    },\n\n    'cmmn:CasePlanModel': function(p, element) {\n      var rect = drawRect(p, element.width, element.height, 0, {\n        fillOpacity: 0.95\n      });\n      renderCasePlanModelLabel(p, element);\n      attachPlanningTableMarker(p, element);\n      attachCasePlanModelMarkers(p, element);\n      return rect;\n    },\n\n    // MILESTONE\n    'cmmn:Milestone': function(p, element, attrs) {\n      var rect = drawRect(p, element.width, element.height, MILESTONE_BORDER_RADIUS, attrs);\n      renderEmbeddedLabel(p, element, 'center-middle');\n      attachTaskMarkers(p, element);\n      return rect;\n    },\n\n    // EVENT LISTENER\n    'cmmn:EventListener': function(p, element, attrs) {\n      var outerCircle = drawCircle(p, element.width, element.height, attrs);\n\n      attrs = attrs || {};\n      attrs.strokeWidth = 2;\n\n      drawCircle(p, element.width, element.height, 0.1 * element.height, attrs);\n      return outerCircle;\n    },\n\n    'cmmn:TimerEventListener': function(p, element, attrs) {\n      var circle = renderer('cmmn:EventListener')(p, element, attrs);\n\n      var pathData = pathMap.getScaledPath('EVENT_TIMER_WH', {\n        xScaleFactor: 0.75,\n        yScaleFactor: 0.75,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.5,\n          my: 0.5\n        }\n      });\n\n      drawPath(p, pathData, {\n        strokeWidth: 2,\n        strokeLinecap: 'square'\n      });\n\n      for (var i = 0;i < 12;i++) {\n\n        var linePathData = pathMap.getScaledPath('EVENT_TIMER_LINE', {\n          xScaleFactor: 0.75,\n          yScaleFactor: 0.75,\n          containerWidth: element.width,\n          containerHeight: element.height,\n          position: {\n            mx: 0.5,\n            my: 0.5\n          }\n        });\n\n        var width = element.width / 2;\n        var height = element.height / 2;\n\n        drawPath(p, linePathData, {\n          strokeWidth: 1,\n          strokeLinecap: 'square',\n          transform: 'rotate(' + (i * 30) + ',' + height + ',' + width + ')'\n        });\n      }\n\n\n      return circle;\n    },\n\n    'cmmn:UserEventListener': function(p, element, attrs) {\n      var circle = renderer('cmmn:EventListener')(p, element, attrs);\n\n      // TODO: The user event decorator has to be\n      // scaled correctly!\n      var x = 20;\n      var y = 15;\n\n      var pathData = pathMap.getScaledPath('TASK_TYPE_USER_1', {\n        abspos: {\n          x: x,\n          y: y\n        }\n      });\n\n      /* user path */ drawPath(p, pathData, {\n        strokeWidth: 0.5,\n        fill: 'none'\n      });\n\n      var pathData2 = pathMap.getScaledPath('TASK_TYPE_USER_2', {\n        abspos: {\n          x: x,\n          y: y\n        }\n      });\n\n      /* user2 path */ drawPath(p, pathData2, {\n        strokeWidth: 0.5,\n        fill: 'none'\n      });\n\n      var pathData3 = pathMap.getScaledPath('TASK_TYPE_USER_3', {\n        abspos: {\n          x: x,\n          y: y\n        }\n      });\n\n      /* user3 path */ drawPath(p, pathData3, {\n        strokeWidth: 0.5,\n        fill: 'black'\n      });\n\n      return circle;\n    },\n\n    // TASK\n    'cmmn:Task': function(p, element, attrs) {\n      var rect = drawRect(p, element.width, element.height, TASK_BORDER_RADIUS, attrs);\n      renderEmbeddedLabel(p, element, 'center-middle');\n      attachTaskMarkers(p, element);\n      return rect;\n    },\n\n    'cmmn:HumanTask': function(p, element, attrs) {\n      var task = renderer('cmmn:Task')(p, element, attrs);\n\n      var bo = element.businessObject;\n      var definition = bo.definitionRef;\n\n      if (definition.isBlocking) {\n        var x = 15;\n        var y = 12;\n\n        var pathData1 = pathMap.getScaledPath('TASK_TYPE_USER_1', {\n          abspos: {\n            x: x,\n            y: y\n          }\n        });\n\n        /* user path */ drawPath(p, pathData1, {\n          strokeWidth: 0.5,\n          fill: 'none'\n        });\n\n        var pathData2 = pathMap.getScaledPath('TASK_TYPE_USER_2', {\n          abspos: {\n            x: x,\n            y: y\n          }\n        });\n\n        /* user2 path */ drawPath(p, pathData2, {\n          strokeWidth: 0.5,\n          fill: 'none'\n        });\n\n        var pathData3 = pathMap.getScaledPath('TASK_TYPE_USER_3', {\n          abspos: {\n            x: x,\n            y: y\n          }\n        });\n\n        /* user3 path */ drawPath(p, pathData3, {\n          strokeWidth: 0.5,\n          fill: 'black'\n        });\n      }\n\n      else {\n        var pathData = pathMap.getScaledPath('TASK_TYPE_MANUAL', {\n          abspos: {\n            x: 17,\n            y: 15\n          }\n        });\n\n        /* manual path */ drawPath(p, pathData, {\n          strokeWidth: 1.25,\n          fill: 'white',\n          stroke: 'black'\n        });\n      }\n\n      attachPlanningTableMarker(p, element);\n\n      return task;\n    },\n\n    'cmmn:CaseTask': function(p, element, attrs) {\n      var task = renderer('cmmn:Task')(p, element, attrs);\n\n      var pathData = pathMap.getScaledPath('TASK_TYPE_FOLDER', {\n        abspos: {\n          x: 7,\n          y: 7\n        }\n      });\n\n      /* manual path */ drawPath(p, pathData, {\n        strokeWidth: 1.25,\n        fill: 'white',\n        stroke: 'black'\n      });\n\n      return task;\n    },\n\n    'cmmn:ProcessTask': function(p, element, attrs) {\n      var task = renderer('cmmn:Task')(p, element, attrs);\n\n      var pathData = pathMap.getScaledPath('TASK_TYPE_CHEVRON', {\n        abspos: {\n          x: 5,\n          y: 5\n        }\n      });\n\n      /* manual path */ drawPath(p, pathData, {\n        strokeWidth: 1.25,\n        fill: 'white',\n        stroke: 'black'\n      });\n\n      return task;\n    },\n\n    'cmmn:DecisionTask': function(p, element, attrs) {\n      var task = renderer('cmmn:Task')(p, element, attrs);\n\n      var headerPathData = pathMap.getScaledPath('TASK_TYPE_BUSINESS_RULE_HEADER', {\n        abspos: {\n          x: 8,\n          y: 8\n        }\n      });\n\n      drawPath(p, headerPathData, {\n        strokeWidth: 1,\n        fill: '000'\n      });\n\n      var headerData = pathMap.getScaledPath('TASK_TYPE_BUSINESS_RULE_MAIN', {\n        abspos: {\n          x: 8,\n          y: 8\n        }\n      });\n\n      drawPath(p, headerData, {\n        strokeWidth: 1\n      });\n\n      return task;\n    },\n\n    'cmmn:CaseFileItem': function(p, element, attrs) {\n      var pathData = pathMap.getScaledPath('DATA_OBJECT_PATH', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.474,\n          my: 0.296\n        }\n      });\n\n      return drawPath(p, pathData, { fill: 'white' });\n    },\n\n    // ARTIFACTS\n    'cmmn:TextAnnotation': function(p, element) {\n      var style = {\n        'fill': 'none',\n        'stroke': 'none'\n      };\n      var textElement = drawRect(p, element.width, element.height, 0, 0, style);\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.0,\n          my: 0.0\n        }\n      });\n      drawPath(p, textPathData);\n\n      var text = getBusinessObject(element).text || '';\n      renderLabel(p, text, { box: element, align: 'left-middle', padding: 5 });\n\n      return textElement;\n    },\n\n    'cmmn:Association': function(p, element, attrs) {\n\n      var semantic = getBusinessObject(element);\n\n      attrs = assign({\n        strokeDasharray: '0.5, 5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round'\n      }, attrs || {});\n\n      if (semantic.associationDirection === 'One' ||\n          semantic.associationDirection === 'Both') {\n        attrs.markerEnd = marker('association-end');\n      }\n\n      if (semantic.associationDirection === 'Both') {\n        attrs.markerStart = marker('association-start');\n      }\n\n      return drawLine(p, element.waypoints, attrs);\n    },\n\n    // MARKERS\n    'StageMarker': function(p, element) {\n      var markerRect = drawRect(p, 14, 14, 0, {\n        strokeWidth: 1,\n        stroke: 'black'\n      });\n\n      translate(markerRect, element.width / 2 - 7, element.height - 17);\n\n      var path = isCollapsed(element) ? 'MARKER_STAGE_COLLAPSED' : 'MARKER_STAGE_EXPANDED';\n\n      var stagePath = pathMap.getScaledPath(path, {\n        xScaleFactor: 1.5,\n        yScaleFactor: 1.5,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 - 7) / element.width,\n          my: (element.height - 17) / element.height\n        }\n      });\n\n      drawPath(p, stagePath);\n    },\n\n    'RequiredMarker': function(p, element, position) {\n      var path = pathMap.getScaledPath('MARKER_REQUIRED', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: ((element.width / 2 + position) / element.width),\n          my: (element.height - 17) / element.height\n        }\n      });\n\n      drawPath(p, path, { strokeWidth: 3 });\n    },\n\n    'AutoCompleteMarker': function(p, element, position) {\n      var markerRect = drawRect(p, 11, 14, 0, {\n        strokeWidth: 1,\n        stroke: 'black',\n        fill: 'black'\n      });\n\n      translate(markerRect, element.width / 2 + position + 2, element.height - 17);\n    },\n\n    'ManualActivationMarker': function(p, element, position) {\n      var path = pathMap.getScaledPath('MARKER_MANUAL_ACTIVATION', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: ((element.width / 2 + position) / element.width),\n          my: (element.height - 17) / element.height\n        }\n      });\n\n      drawPath(p, path, { strokeWidth: 1 });\n    },\n\n    'RepetitionMarker': function(p, element, position) {\n      var path = pathMap.getScaledPath('MARKER_REPEATABLE', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: ((element.width / 2 + position) / element.width),\n          my: (element.height - 17) / element.height\n        }\n      });\n\n      drawPath(p, path);\n    },\n\n    'PlanningTableMarker': function(p, element, position) {\n      var planningTableRect = drawRect(p, 30, 24, 0, {\n        strokeWidth: 1.5,\n        stroke: 'black'\n      });\n\n      translate(planningTableRect, element.width / 2 - 15, -17);\n\n      var isCollapsed = isPlanningTableCollapsed(element);\n\n      var marker = isCollapsed ? 'MARKER_PLANNING_TABLE_COLLAPSED' : 'MARKER_PLANNING_TABLE_EXPANDED';\n\n      var stagePath = pathMap.getScaledPath(marker, {\n        xScaleFactor: 1.5,\n        yScaleFactor: 1.5,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 - 15) / element.width,\n          my: (-17) / element.height\n        }\n      });\n\n      drawPath(p, stagePath, {\n        strokeWidth: 1.5\n      });\n    },\n\n    'cmmn:OnPart': function(p, element) {\n      var pathData = createPathFromConnection(element);\n\n      var path = drawPath(p, pathData, {\n        strokeDasharray: '10, 5, 2, 5, 2, 5',\n        strokeWidth: 1.5\n      });\n\n      return path;\n    },\n    'cmmn:PlanItemOnPart': function(p, element) {\n      return renderer('cmmn:OnPart')(p, element);\n    },\n    'cmmn:CaseFileItemOnPart': function(p, element) {\n      return renderer('cmmn:OnPart')(p, element);\n    },\n    'cmmn:EntryCriterion': function(p, element) {\n      return drawDiamond(p, element.width, element.height, {\n        fill: 'white'\n      });\n    },\n    'cmmn:ExitCriterion': function(p, element) {\n      return drawDiamond(p, element.width, element.height, {\n        fill: 'black'\n      });\n    },\n\n    'cmmndi:CMMNEdge': function(p, element) {\n\n      var bo = getBusinessObject(element);\n\n      if (bo.cmmnElementRef) {\n        return renderer(bo.cmmnElementRef.$type)(p, element);\n      }\n\n      var pathData = createPathFromConnection(element);\n\n      var path = drawPath(p, pathData, {\n        strokeDasharray: '3, 5',\n        strokeWidth: 1\n      });\n\n      return path;\n    },\n\n    'label': function(parentGfx, element) {\n      // Update external label size and bounds during rendering when\n      // we have the actual rendered bounds anyway.\n\n      var textElement = renderExternalLabel(parentGfx, element);\n\n      var textBBox;\n\n      try {\n        textBBox = textElement.getBBox();\n      } catch (e) {\n        textBBox = { width: 0, height: 0, x: 0 };\n      }\n\n      // update element.x so that the layouted text is still\n      // center alligned (newX = oldMidX - newWidth / 2)\n      element.x = Math.ceil(element.x + element.width / 2) - Math.ceil((textBBox.width / 2));\n\n      // take element width, height from actual bounds\n      element.width = Math.ceil(textBBox.width);\n      element.height = Math.ceil(textBBox.height);\n\n      // compensate bounding box x\n      svgAttr(textElement, {\n        transform: 'translate(' + (-1 * textBBox.x) + ',0)'\n      });\n\n      return textElement;\n    }\n  };\n\n  // attach markers /////////////////////////\n\n  function attachTaskMarkers(p, element) {\n    var obj = getBusinessObject(element);\n    var padding = 6;\n\n    var markers = [];\n\n    if (isRequired(obj)) {\n      markers.push({ marker: 'RequiredMarker', width: 1 });\n    }\n\n    if (isManualActivation(obj)) {\n      markers.push({ marker: 'ManualActivationMarker', width: 14 });\n    }\n\n    if (isRepeatable(obj)) {\n      markers.push({ marker: 'RepetitionMarker', width: 14 });\n    }\n\n    if (markers.length) {\n\n      if (markers.length === 1) {\n        // align marker in the middle of the element\n        drawMarker(markers[0].marker, p, element, (markers[0].width / 2) * (-1));\n      }\n\n      else if (markers.length === 2) {\n        /* align marker:\n         *\n         *      |             |\n         *      +-------------+\n         *             ^\n         *             |\n         *         +-+   +-+\n         *         |0|   |1| <-- markers\n         *         +-+   +-+\n         * (leftMarker)  (rightMarker)\n         */\n        drawMarker(markers[0].marker, p, element, (markers[0].width * (-1)) - (padding /2));\n        drawMarker(markers[1].marker, p, element, padding / 2);\n      }\n\n      else if (markers.length === 3) {\n        /* align marker:\n         *\n         *      |             |\n         *      +-------------+\n         *             ^\n         *             |\n         *      +-+   +-+   +-+\n         *      |0|   |1|   |2| <-- markers\n         *      +-+   +-+   +-+\n         */\n\n        /* 1 */ drawMarker(markers[1].marker, p, element, markers[1].width / 2 * (-1));\n        /* 0 */ drawMarker(markers[0].marker, p, element, (markers[1].width / 2 * (-1)) - padding - markers[0].width);\n        /* 2 */ drawMarker(markers[2].marker, p, element, (markers[1].width / 2) + padding);\n      }\n    }\n  }\n\n  function attachCasePlanModelMarkers(p, element) {\n    var obj = getBusinessObject(element);\n\n    if (isAutoComplete(obj)) {\n      drawMarker('AutoCompleteMarker', p, element, -7);\n    }\n  }\n\n  function attachStageMarkers(p, element, stage) {\n    var obj = getBusinessObject(element);\n    var padding = 6;\n\n    drawMarker('StageMarker', p, element, -7);\n\n    var leftMarkers = [];\n\n    if (isRequired(obj)) {\n      leftMarkers.push({ marker: 'RequiredMarker', width: 1 });\n    }\n\n    if (isAutoComplete(obj)) {\n      leftMarkers.push({ marker: 'AutoCompleteMarker', width: 14 });\n    }\n\n    if (leftMarkers.length) {\n\n      if (leftMarkers.length === 1) {\n        drawMarker(leftMarkers[0].marker, p, element, (leftMarkers[0].width * (-1) - 7 - padding));\n      }\n\n      else if (leftMarkers.length === 2) {\n        drawMarker(\n          leftMarkers[0].marker,\n          p,\n          element,\n          ((leftMarkers[1].width * (-1)) - 7 - padding) - (leftMarkers[0].width * (-1)) - padding\n        );\n\n        drawMarker(leftMarkers[1].marker, p, element, (leftMarkers[1].width * (-1)) - 7 - padding);\n      }\n\n    }\n\n    var rightMarkers = [];\n\n    if (isManualActivation(obj)) {\n      rightMarkers.push({ marker: 'ManualActivationMarker', width: 14 });\n    }\n\n    if (isRepeatable(obj)) {\n      rightMarkers.push({ marker: 'RepetitionMarker', width: 14 });\n    }\n\n    if (rightMarkers.length) {\n\n      if (rightMarkers.length === 1) {\n        drawMarker(rightMarkers[0].marker, p, element, 7 + padding);\n      }\n\n      else if (rightMarkers.length === 2) {\n        drawMarker(rightMarkers[0].marker, p, element, 7 + padding);\n        drawMarker(rightMarkers[1].marker, p, element, 7 + padding + rightMarkers[0].width + padding);\n      }\n\n    }\n  }\n\n  function attachPlanningTableMarker(p, element) {\n    if (hasPlanningTable(element)) {\n      drawMarker('PlanningTableMarker', p, element);\n    }\n  }\n\n  function drawMarker(marker, parent, element, position) {\n    renderer(marker)(parent, element, position);\n  }\n\n  // draw shape and connection ////////////////////////////////////\n\n  function drawShape(parent, element) {\n    var h = handlers[element.type];\n\n    /* jshint -W040 */\n    if (!h) {\n      return BaseRenderer.prototype.drawShape.apply(this, [ parent, element ]);\n    } else {\n      return h(parent, element);\n    }\n  }\n\n  function drawConnection(parent, element) {\n    var type = element.type;\n    var h = handlers[type];\n\n    /* jshint -W040 */\n    if (!h) {\n      return BaseRenderer.prototype.drawConnection.apply(this, [ parent, element ]);\n    } else {\n      return h(parent, element);\n    }\n  }\n\n  this.canRender = function(element) {\n    return is(element, 'cmmn:CMMNElement') || is(element, 'cmmndi:CMMNEdge');\n  };\n\n  this.drawShape = drawShape;\n  this.drawConnection = drawConnection;\n\n  // hook onto canvas init event to initialize\n  // connection start/end markers on svg\n  eventBus.on('canvas.init', function(event) {\n    initMarkers(event.svg);\n  });\n\n}\n\ninherits(CmmnRenderer, BaseRenderer);\n\nCmmnRenderer.$inject = [ 'eventBus', 'styles', 'pathMap' ];\n\nmodule.exports = CmmnRenderer;\n","import {\n  isObject,\n  assign,\n  forEach,\n  reduce\n} from 'min-dash';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nvar DEFAULT_BOX_PADDING = 0;\n\nvar DEFAULT_LABEL_SIZE = {\n  width: 150,\n  height: 50\n};\n\n\nfunction parseAlign(align) {\n\n  var parts = align.split('-');\n\n  return {\n    horizontal: parts[0] || 'center',\n    vertical: parts[1] || 'top'\n  };\n}\n\nfunction parsePadding(padding) {\n\n  if (isObject(padding)) {\n    return assign({ top: 0, left: 0, right: 0, bottom: 0 }, padding);\n  } else {\n    return {\n      top: padding,\n      left: padding,\n      right: padding,\n      bottom: padding\n    };\n  }\n}\n\nfunction getTextBBox(text, fakeText) {\n\n  fakeText.textContent = text;\n\n  var textBBox;\n\n  try {\n    var bbox,\n        emptyLine = text === '';\n\n    // add dummy text, when line is empty to\n    // determine correct height\n    fakeText.textContent = emptyLine ? 'dummy' : text;\n\n    textBBox = fakeText.getBBox();\n\n    // take text rendering related horizontal\n    // padding into account\n    bbox = {\n      width: textBBox.width + textBBox.x * 2,\n      height: textBBox.height\n    };\n\n    if (emptyLine) {\n      // correct width\n      bbox.width = 0;\n    }\n\n    return bbox;\n  } catch (e) {\n    return { width: 0, height: 0 };\n  }\n}\n\n\n/**\n * Layout the next line and return the layouted element.\n *\n * Alters the lines passed.\n *\n * @param  {Array<String>} lines\n * @return {Object} the line descriptor, an object { width, height, text }\n */\nfunction layoutNext(lines, maxWidth, fakeText) {\n\n  var originalLine = lines.shift(),\n      fitLine = originalLine;\n\n  var textBBox;\n\n  for (;;) {\n    textBBox = getTextBBox(fitLine, fakeText);\n\n    textBBox.width = fitLine ? textBBox.width : 0;\n\n    // try to fit\n    if (fitLine === ' ' || fitLine === '' || textBBox.width < Math.round(maxWidth) || fitLine.length < 2) {\n      return fit(lines, fitLine, originalLine, textBBox);\n    }\n\n    fitLine = shortenLine(fitLine, textBBox.width, maxWidth);\n  }\n}\n\nfunction fit(lines, fitLine, originalLine, textBBox) {\n  if (fitLine.length < originalLine.length) {\n    var remainder = originalLine.slice(fitLine.length).trim();\n\n    lines.unshift(remainder);\n  }\n\n  return {\n    width: textBBox.width,\n    height: textBBox.height,\n    text: fitLine\n  };\n}\n\n\n/**\n * Shortens a line based on spacing and hyphens.\n * Returns the shortened result on success.\n *\n * @param  {String} line\n * @param  {Number} maxLength the maximum characters of the string\n * @return {String} the shortened string\n */\nfunction semanticShorten(line, maxLength) {\n  var parts = line.split(/(\\s|-)/g),\n      part,\n      shortenedParts = [],\n      length = 0;\n\n  // try to shorten via spaces + hyphens\n  if (parts.length > 1) {\n    while ((part = parts.shift())) {\n      if (part.length + length < maxLength) {\n        shortenedParts.push(part);\n        length += part.length;\n      } else {\n        // remove previous part, too if hyphen does not fit anymore\n        if (part === '-') {\n          shortenedParts.pop();\n        }\n\n        break;\n      }\n    }\n  }\n\n  return shortenedParts.join('');\n}\n\n\nfunction shortenLine(line, width, maxWidth) {\n  var length = Math.max(line.length * (maxWidth / width), 1);\n\n  // try to shorten semantically (i.e. based on spaces and hyphens)\n  var shortenedLine = semanticShorten(line, length);\n\n  if (!shortenedLine) {\n\n    // force shorten by cutting the long word\n    shortenedLine = line.slice(0, Math.max(Math.round(length - 1), 1));\n  }\n\n  return shortenedLine;\n}\n\n\nfunction getHelperSvg() {\n  var helperSvg = document.getElementById('helper-svg');\n\n  if (!helperSvg) {\n    helperSvg = svgCreate('svg');\n\n    svgAttr(helperSvg, {\n      id: 'helper-svg',\n      width: 0,\n      height: 0,\n      style: 'visibility: hidden; position: fixed'\n    });\n\n    document.body.appendChild(helperSvg);\n  }\n\n  return helperSvg;\n}\n\n\n/**\n * Creates a new label utility\n *\n * @param {Object} config\n * @param {Dimensions} config.size\n * @param {Number} config.padding\n * @param {Object} config.style\n * @param {String} config.align\n */\nexport default function Text(config) {\n\n  this._config = assign({}, {\n    size: DEFAULT_LABEL_SIZE,\n    padding: DEFAULT_BOX_PADDING,\n    style: {},\n    align: 'center-top'\n  }, config || {});\n}\n\n/**\n * Returns the layouted text as an SVG element.\n *\n * @param {String} text\n * @param {Object} options\n *\n * @return {SVGElement}\n */\nText.prototype.createText = function(text, options) {\n  return this.layoutText(text, options).element;\n};\n\n/**\n * Returns a labels layouted dimensions.\n *\n * @param {String} text to layout\n * @param {Object} options\n *\n * @return {Dimensions}\n */\nText.prototype.getDimensions = function(text, options) {\n  return this.layoutText(text, options).dimensions;\n};\n\n/**\n * Creates and returns a label and its bounding box.\n *\n * @method Text#createText\n *\n * @param {String} text the text to render on the label\n * @param {Object} options\n * @param {String} options.align how to align in the bounding box.\n *                               Any of { 'center-middle', 'center-top' },\n *                               defaults to 'center-top'.\n * @param {String} options.style style to be applied to the text\n * @param {boolean} options.fitBox indicates if box will be recalculated to\n *                                 fit text\n *\n * @return {Object} { element, dimensions }\n */\nText.prototype.layoutText = function(text, options) {\n  var box = assign({}, this._config.size, options.box),\n      style = assign({}, this._config.style, options.style),\n      align = parseAlign(options.align || this._config.align),\n      padding = parsePadding(options.padding !== undefined ? options.padding : this._config.padding),\n      fitBox = options.fitBox || false;\n\n  var lineHeight = getLineHeight(style);\n\n  var lines = text.split(/\\r?\\n/g),\n      layouted = [];\n\n  var maxWidth = box.width - padding.left - padding.right;\n\n  // ensure correct rendering by attaching helper text node to invisible SVG\n  var helperText = svgCreate('text');\n  svgAttr(helperText, { x: 0, y: 0 });\n  svgAttr(helperText, style);\n\n  var helperSvg = getHelperSvg();\n\n  svgAppend(helperSvg, helperText);\n\n  while (lines.length) {\n    layouted.push(layoutNext(lines, maxWidth, helperText));\n  }\n\n  if (align.vertical === 'middle') {\n    padding.top = padding.bottom = 0;\n  }\n\n  var totalHeight = reduce(layouted, function(sum, line, idx) {\n    return sum + (lineHeight || line.height);\n  }, 0) + padding.top + padding.bottom;\n\n  var maxLineWidth = reduce(layouted, function(sum, line, idx) {\n    return line.width > sum ? line.width : sum;\n  }, 0);\n\n  // the y position of the next line\n  var y = padding.top;\n\n  if (align.vertical === 'middle') {\n    y += (box.height - totalHeight) / 2;\n  }\n\n  // magic number initial offset\n  y -= (lineHeight || layouted[0].height) / 4;\n\n\n  var textElement = svgCreate('text');\n\n  svgAttr(textElement, style);\n\n  // layout each line taking into account that parent\n  // shape might resize to fit text size\n  forEach(layouted, function(line) {\n\n    var x;\n\n    y += (lineHeight || line.height);\n\n    switch (align.horizontal) {\n    case 'left':\n      x = padding.left;\n      break;\n\n    case 'right':\n      x = ((fitBox ? maxLineWidth : maxWidth)\n        - padding.right - line.width);\n      break;\n\n    default:\n      // aka center\n      x = Math.max((((fitBox ? maxLineWidth : maxWidth)\n        - line.width) / 2 + padding.left), 0);\n    }\n\n    var tspan = svgCreate('tspan');\n    svgAttr(tspan, { x: x, y: y });\n\n    tspan.textContent = line.text;\n\n    svgAppend(textElement, tspan);\n  });\n\n  svgRemove(helperText);\n\n  var dimensions = {\n    width: maxLineWidth,\n    height: totalHeight\n  };\n\n  return {\n    dimensions: dimensions,\n    element: textElement\n  };\n};\n\n\nfunction getLineHeight(style) {\n  if ('fontSize' in style && 'lineHeight' in style) {\n    return style.lineHeight * parseInt(style.fontSize, 10);\n  }\n}","'use strict';\n\n/**\n * Map containing SVG paths needed by CmmnRenderer.\n */\n\nfunction PathMap() {\n\n  var PATH_USER_TYPE_1 = 'm {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 ' +\n                         '-4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 ' +\n                         '0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 ' +\n                         'h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 z' +\n                         'm -8,6 l 0,5.5 m 11,0 l 0,-5';\n\n  var PATH_USER_TYPE_2 = 'm {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 ' +\n                         '-2.66499998,0 -4.822,-1.981 -4.822,-4.4310005';\n\n  var PATH_USER_TYPE_3 = 'm {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 ' +\n                         '4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 ' +\n                         '-4.20799998,3.36699999 -4.20699998,4.34799999 z';\n\n  /**\n   * Contains a map of path elements\n   *\n   * <h1>Path definition</h1>\n   * A parameterized path is defined like this:\n   * <pre>\n   * 'EVENT_TIMER_WH': {\n   *   d: 'M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ',\n   *   height: 17.5,\n   *   width:  17.5,\n   *   heightElements: [2.5, 7.5],\n   *   widthElements: [2.5, 7.5]\n   * }\n   * </pre>\n   * <p>It's important to specify a correct <b>height and width</b> for the path as the scaling\n   * is based on the ratio between the specified height and width in this object and the\n   * height and width that is set as scale target (Note x,y coordinates will be scaled with\n   * individual ratios).</p>\n   * <p>The '<b>heightElements</b>' and '<b>widthElements</b>' array must contain the values that will be scaled.\n   * The scaling is based on the computed ratios.\n   * Coordinates on the y axis should be in the <b>heightElement</b>'s array, they will be scaled using\n   * the computed ratio coefficient.\n   * In the parameterized path the scaled values can be accessed through the 'e' object in {} brackets.\n   *   <ul>\n   *    <li>The values for the y axis can be accessed in the path string using {e.y0}, {e.y1}, ....</li>\n   *    <li>The values for the x axis can be accessed in the path string using {e.x0}, {e.x1}, ....</li>\n   *   </ul>\n   *   The numbers x0, x1 respectively y0, y1, ... map to the corresponding array index.\n   * </p>\n   */\n  this.pathMap = {\n\n    // TASK DECORATOR\n\n    'TASK_TYPE_FOLDER': {\n      d: 'm {mx},{my} l18,0 l0,12 l-18,0 l0,-12 m 2,0 l3,-4 l5,0 l3,4'\n    },\n    'TASK_TYPE_CHEVRON': {\n      d: 'm {mx},{my} l15,0 l6,6 l-6,6 l-15,0 l6,-6 l-6,-6'\n    },\n    'TASK_TYPE_USER_1': {\n      d: PATH_USER_TYPE_1\n    },\n    'TASK_TYPE_USER_2': {\n      d: PATH_USER_TYPE_2\n    },\n    'TASK_TYPE_USER_3': {\n      d: PATH_USER_TYPE_3\n    },\n    'TASK_TYPE_MANUAL': {\n      d: 'm {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 ' +\n        '-0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 ' +\n        '0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 ' +\n        '-1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 ' +\n        '0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 ' +\n        '-10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 ' +\n        '2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 ' +\n        '-0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 ' +\n        '-1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 ' +\n        '-0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 ' +\n        '0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 ' +\n        '-5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z'\n    },\n\n    'TASK_TYPE_BUSINESS_RULE_HEADER': {\n      d: 'm {mx},{my} 0,4 20,0 0,-4 z'\n    },\n    'TASK_TYPE_BUSINESS_RULE_MAIN': {\n      d: 'm {mx},{my} 0,12 20,0 0,-12 z' +\n        'm 0,8 l 20,0 ' +\n        'm -13,-4 l 0,8'\n    },\n\n    // EVENT LISTENER DECORATOR\n\n    'EVENT_TIMER_WH': {\n      d: 'M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ',\n      height: 36,\n      width:  36,\n      heightElements: [10, 2],\n      widthElements: [3, 7]\n    },\n    'EVENT_TIMER_LINE': {\n      d:  'M {mx},{my} ' +\n          'm {e.x0},{e.y0} l -{e.x1},{e.y1} ',\n      height: 36,\n      width:  36,\n      heightElements: [10, 3],\n      widthElements: [0, 0]\n    },\n\n    'EVENT_USER_1': {\n      d: PATH_USER_TYPE_1,\n      height: 36,\n      width:  36,\n      heightElements: [],\n      widthElements: []\n\n    },\n    'EVENT_USER_2': {\n      d: PATH_USER_TYPE_2,\n      height: 36,\n      width:  36,\n      heightElements: [],\n      widthElements: []\n    },\n    'EVENT_USER_3': {\n      d: PATH_USER_TYPE_3,\n      height: 36,\n      width:  36,\n      heightElements: [],\n      widthElements: []\n    },\n\n    // MARKERS\n\n    'MARKER_STAGE_EXPANDED': {\n      d: 'm{mx},{my} m 2,7 l 10,0',\n      height: 10,\n      width: 10,\n      heightElements: [],\n      widthElements: []\n    },\n    'MARKER_STAGE_COLLAPSED': {\n      d: 'm{mx},{my} m 2,7 l 10,0 m -5,-5 l 0,10',\n      height: 10,\n      width: 10,\n      heightElements: [],\n      widthElements: []\n    },\n    'MARKER_REQUIRED': {\n      d: 'm{mx},{my} l 0,9 m 0,2 l0,3',\n      height: 14,\n      width: 3,\n      heightElements: [],\n      widthElements: []\n    },\n\n    'MARKER_MANUAL_ACTIVATION': {\n      d: 'm{mx}, {my} l 14,7 l -14,7 l 0,-14 z',\n      height: 14,\n      width: 14,\n      heightElements: [],\n      widthElements: []\n    },\n\n    'MARKER_REPEATABLE': {\n      d: 'm{mx},{my} m 3,0 l 0,14 m 6,-14 l 0,14 m -10,-10 l 14,0 m -14,6 l 14,0',\n      height: 14,\n      width: 14,\n      heightElements: [],\n      widthElements: []\n    },\n\n    'MARKER_PLANNING_TABLE_EXPANDED': {\n      d: 'm{mx},{my} m 0,12 l 30,0 m -20,-12 l 0, 24 m 10, -24 l 0, 24 m -10, -6 l 10,0',\n      height: 24,\n      width: 30,\n      heightElements: [],\n      widthElements: []\n    },\n    'MARKER_PLANNING_TABLE_COLLAPSED': {\n      d: 'm{mx},{my} m 0,12 l 30,0 m -20,-12 l 0, 24 m 10, -24 l 0, 24 m -10, -6 l 10,0 m -5, -6 l 0,12',\n      height: 10,\n      width: 10,\n      heightElements: [],\n      widthElements: []\n    },\n\n    'DATA_OBJECT_PATH': {\n      d:'m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0',\n      height: 61,\n      width:  51,\n      heightElements: [10, 50, 60],\n      widthElements: [10, 40, 50, 60]\n    },\n\n    'TEXT_ANNOTATION': {\n      d: 'm {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0',\n      height: 30,\n      width: 10,\n      heightElements: [30],\n      widthElements: [10]\n    }\n  };\n\n  this.getRawPath = function getRawPath(pathId) {\n    return this.pathMap[pathId].d;\n  };\n\n  /**\n   * Scales the path to the given height and width.\n   * <h1>Use case</h1>\n   * <p>Use case is to scale the content of elements (event) based\n   * on the element bounding box's size.\n   * </p>\n   * <h1>Why not transform</h1>\n   * <p>Scaling a path with transform() will also scale the stroke and IE does not support\n   * the option 'non-scaling-stroke' to prevent this.\n   * Also there are use cases where only some parts of a path should be\n   * scaled.</p>\n   *\n   * @param {String} pathId The ID of the path.\n   * @param {Object} param <p>\n   *   Example param object scales the path to 60% size of the container (data.width, data.height).\n   *   <pre>\n   *   {\n   *     xScaleFactor: 0.6,\n   *     yScaleFactor:0.6,\n   *     containerWidth: data.width,\n   *     containerHeight: data.height,\n   *     position: {\n   *       mx: 0.46,\n   *       my: 0.2,\n   *     }\n   *   }\n   *   </pre>\n   *   <ul>\n   *    <li>targetpathwidth = xScaleFactor * containerWidth</li>\n   *    <li>targetpathheight = yScaleFactor * containerHeight</li>\n   *    <li>Position is used to set the starting coordinate of the path. M is computed:\n    *    <ul>\n    *      <li>position.x * containerWidth</li>\n    *      <li>position.y * containerHeight</li>\n    *    </ul>\n    *    Center of the container <pre> position: {\n   *       mx: 0.5,\n   *       my: 0.5,\n   *     }</pre>\n   *     Upper left corner of the container\n   *     <pre> position: {\n   *       mx: 0.0,\n   *       my: 0.0,\n   *     }</pre>\n   *    </li>\n   *   </ul>\n   * </p>\n   *\n   */\n  this.getScaledPath = function getScaledPath(pathId, param) {\n    var rawPath = this.pathMap[pathId];\n\n    // positioning\n    // compute the start point of the path\n    var mx, my;\n\n    if (param.abspos) {\n      mx = param.abspos.x;\n      my = param.abspos.y;\n    } else {\n      mx = param.containerWidth * param.position.mx;\n      my = param.containerHeight * param.position.my;\n    }\n\n    var coordinates = {}; // map for the scaled coordinates\n    if (param.position) {\n\n      // path\n      var heightRatio = (param.containerHeight / rawPath.height) * param.yScaleFactor;\n      var widthRatio = (param.containerWidth / rawPath.width) * param.xScaleFactor;\n\n\n      // Apply height ratio\n      for (var heightIndex = 0; heightIndex < rawPath.heightElements.length; heightIndex++) {\n        coordinates['y' + heightIndex] = rawPath.heightElements[heightIndex] * heightRatio;\n      }\n\n      // Apply width ratio\n      for (var widthIndex = 0; widthIndex < rawPath.widthElements.length; widthIndex++) {\n        coordinates['x' + widthIndex] = rawPath.widthElements[widthIndex] * widthRatio;\n      }\n    }\n\n    // Apply value to raw path\n    var path = format(\n      rawPath.d, {\n        mx: mx,\n        my: my,\n        e: coordinates\n      }\n    );\n    return path;\n  };\n}\n\nmodule.exports = PathMap;\n\n// helpers /////////////////\n\n// copied from https://github.com/adobe-webplatform/Snap.svg/blob/master/src/svg.js\nvar tokenRegex = /\\{([^}]+)\\}/g,\n    objNotationRegex = /(?:(?:^|\\.)(.+?)(?=\\[|\\.|$|\\()|\\[('|\")(.+?)\\2\\])(\\(\\))?/g; // matches .xxxxx or [\"xxxxx\"] to run over object properties\n\nfunction replacer(all, key, obj) {\n  var res = obj;\n  key.replace(objNotationRegex, function(all, name, quote, quotedName, isFunc) {\n    name = name || quotedName;\n    if (res) {\n      if (name in res) {\n        res = res[name];\n      }\n      typeof res == 'function' && isFunc && (res = res());\n    }\n  });\n  res = (res == null || res == obj ? all : res) + '';\n\n  return res;\n}\n\nfunction format(str, obj) {\n  return String(str).replace(tokenRegex, function(all, key) {\n    return replacer(all, key, obj);\n  });\n}\n","module.exports = {\n  cmmnImporter: [ 'type', require('./CmmnImporter') ]\n};","'use strict';\n\nvar assign = require('min-dash').assign,\n    map = require('min-dash').map;\n\nvar LabelUtil = require('../util/LabelUtil');\n\nvar is = require('../util/ModelUtil').is;\n\nvar hasExternalLabel = LabelUtil.hasExternalLabel,\n    getExternalLabelBounds = LabelUtil.getExternalLabelBounds,\n    isCollapsed = require('../util/DiUtil').isCollapsed,\n    elementToString = require('./Util').elementToString;\n\n\nfunction elementData(semantic, attrs) {\n  return assign({\n    id: semantic.id,\n    type: semantic.$type,\n    businessObject: semantic\n  }, attrs);\n}\n\nfunction collectWaypoints(waypoints) {\n  return map(waypoints, function(p) {\n    return { x: p.x, y: p.y };\n  });\n}\n\nfunction notYetDrawn(semantic, refSemantic, property) {\n  return new Error(\n    'element ' + elementToString(refSemantic) + ' referenced by ' +\n      elementToString(semantic) + '#' + property + ' not yet drawn');\n}\n\n/**\n * An importer that adds cmmn elements to the canvas\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {ElementFactory} elementFactory\n * @param {ElementRegistry} elementRegistry\n */\nfunction CmmnImporter(eventBus, canvas, elementFactory, elementRegistry) {\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n\n  this._elementFactory = elementFactory;\n  this._elementRegistry = elementRegistry;\n}\n\nCmmnImporter.$inject = [ 'eventBus', 'canvas', 'elementFactory', 'elementRegistry' ];\n\nmodule.exports = CmmnImporter;\n\n\n/**\n * Set the diagram as root element\n */\nCmmnImporter.prototype.root = function(diagram) {\n  var element = this._elementFactory.createRoot(elementData(diagram));\n\n  this._canvas.setRootElement(element);\n\n  return element;\n};\n\n\n/**\n * Add cmmn element (semantic) to the canvas onto the\n * specified parent shape.\n */\nCmmnImporter.prototype.add = function(semantic, parentElement) {\n\n  var di = semantic.di,\n      element,\n      hidden;\n\n  // SHAPE\n  if (di && is(di, 'cmmndi:CMMNShape') && !this._getElement(semantic)) {\n\n    var collapsed = isCollapsed(semantic);\n\n    hidden = parentElement && (parentElement.hidden || parentElement.collapsed);\n\n    var bounds = semantic.di.bounds;\n\n    element = this._elementFactory.createShape(elementData(semantic, {\n      collapsed: collapsed,\n      hidden: hidden,\n      x: Math.round(bounds.x),\n      y: Math.round(bounds.y),\n      width: Math.round(bounds.width),\n      height: Math.round(bounds.height)\n    }));\n\n    if (is(semantic, 'cmmn:Criterion')) {\n      this._attachCriterion(semantic, element);\n    }\n\n    this._canvas.addShape(element, parentElement);\n  }\n\n  // CONNECTION\n  else if ((di && is(di, 'cmmndi:CMMNEdge')) || is(semantic, 'cmmndi:CMMNEdge')) {\n\n    var source = this._getSource(semantic),\n        target = this._getTarget(semantic);\n\n    hidden = (parentElement && (parentElement.hidden || parentElement.collapsed)) ||\n                 (source && source.hidden) ||\n                 (target && target.hidden) ;\n\n    var waypoint = (semantic.di || {}).waypoint || semantic.waypoint;\n\n    element = this._elementFactory.createConnection(elementData(semantic, {\n      hidden: hidden,\n      source: source,\n      target: target,\n      waypoints: collectWaypoints(waypoint)\n    }));\n\n    this._canvas.addConnection(element, parentElement);\n  } else {\n    throw new Error('unknown di ' + elementToString(di) + ' for element ' + elementToString(semantic));\n  }\n\n  // (optional) LABEL\n  if (hasExternalLabel(semantic)) {\n    this.addLabel(semantic, element);\n  }\n\n  this._eventBus.fire('cmmnElement.added', { element: element });\n\n  return element;\n};\n\n\n/**\n * Attach the criterion element to the given host\n *\n * @param {ModdleElement} criterionSemantic\n * @param {djs.model.Base} criterionElement\n */\nCmmnImporter.prototype._attachCriterion = function(criterionSemantic, criterionElement) {\n  var hostSemantic = criterionSemantic.$parent;\n\n  if (!hostSemantic) {\n    throw new Error('missing ' + elementToString(criterionSemantic) + '$parent');\n  }\n\n  var host = this._elementRegistry.get(hostSemantic.id),\n      attachers = host && host.attachers;\n\n  if (!host) {\n    throw notYetDrawn(criterionSemantic, hostSemantic, 'criterion');\n  }\n\n  // wire element.host <> host.attachers\n  criterionElement.host = host;\n\n  if (!attachers) {\n    host.attachers = attachers = [];\n  }\n\n  if (attachers.indexOf(criterionElement) === -1) {\n    attachers.push(criterionElement);\n  }\n};\n\n\n/**\n * add label for an element\n */\nCmmnImporter.prototype.addLabel = function(semantic, element) {\n  var bounds = getExternalLabelBounds(semantic, element);\n\n  var label = this._elementFactory.createLabel(elementData(semantic, {\n    id: semantic.id + '_label',\n    labelTarget: element,\n    type: 'label',\n    hidden: element.hidden,\n    x: Math.round(bounds.x),\n    y: Math.round(bounds.y),\n    width: Math.round(bounds.width),\n    height: Math.round(bounds.height)\n  }));\n\n  return this._canvas.addShape(label, element.parent);\n};\n\nCmmnImporter.prototype._getSource = function(semantic) {\n  var cmmnElement = semantic.cmmnElementRef;\n\n  if (cmmnElement) {\n\n    if (is(cmmnElement, 'cmmn:OnPart')) {\n\n      if (cmmnElement.exitCriterionRef) {\n        return this._getEnd(cmmnElement, 'exitCriterionRef');\n      }\n\n      return this._getEnd(cmmnElement, 'sourceRef');\n\n    }\n\n    if (is(cmmnElement, 'cmmn:Association')) {\n      return this._getEnd(cmmnElement, 'sourceRef');\n    }\n\n  }\n\n  if (is(semantic, 'cmmndi:CMMNEdge')) {\n    return this._getEnd(semantic, 'sourceCMMNElementRef');\n  }\n\n};\n\nCmmnImporter.prototype._getTarget = function(semantic) {\n  var cmmnElement = semantic.cmmnElementRef;\n\n  if (cmmnElement) {\n\n    if (is(cmmnElement, 'cmmn:Association')) {\n      return this._getEnd(cmmnElement, 'targetRef');\n    }\n\n  }\n\n  return this._getEnd(semantic, 'targetCMMNElementRef');\n};\n\nCmmnImporter.prototype._getEnd = function(semantic, side) {\n  var refSemantic = semantic[side];\n  var element = refSemantic && this._getElement(refSemantic);\n\n  if (element) {\n    return element;\n  }\n\n  if (refSemantic) {\n    throw notYetDrawn(semantic, refSemantic, side);\n  } else {\n    throw new Error(elementToString(semantic) + '#' + side + 'Ref not specified');\n  }\n\n};\n\nCmmnImporter.prototype._getElement = function(semantic) {\n  return this._elementRegistry.get(semantic.id);\n};","'use strict';\n\nvar ModelUtil = require('../util/ModelUtil'),\n    getDefinition = ModelUtil.getDefinition,\n    getSentry = ModelUtil.getSentry;\n\nvar isAny = require('../features/modeling/util/ModelingUtil').isAny;\n\nvar forEach = require('min-dash').forEach,\n    isArray = require('min-dash').isArray;\n\n\n/**\n * @class\n *\n * A registry that keeps track of all items in the model.\n */\nfunction ItemRegistry(elementRegistry, eventBus) {\n  this._items = {};\n  this._referencedBy = {};\n\n  this._elementRegistry = elementRegistry;\n  this._eventBus = eventBus;\n\n  this._init();\n}\n\nItemRegistry.$inject = [ 'elementRegistry', 'eventBus' ];\n\nmodule.exports = ItemRegistry;\n\n\nItemRegistry.prototype._init = function(config) {\n\n  var eventBus = this._eventBus;\n\n  eventBus.on('diagram.destroy', 500, this._clear, this);\n  eventBus.on('diagram.clear', 500, this._clear, this);\n};\n\nItemRegistry.prototype._clear = function() {\n  this._items = {};\n  this._referencedBy = {};\n};\n\n/**\n * Register a given item.\n *\n * @param {ModdleElement} item\n */\nItemRegistry.prototype.add = function(item) {\n\n  var items = this._items,\n      id = item.id,\n      definitions = this._referencedBy,\n      definition = getReference(item),\n      definitionId = definition && definition.id;\n\n  items[id] = item;\n\n  if (definition) {\n    definitions[definitionId] = definitions[definitionId] || [];\n\n    if (definitions[definitionId].indexOf(item) === -1) {\n      definitions[definitionId].push(item);\n    }\n\n  }\n\n};\n\n\n/**\n * Removes an item from the registry.\n *\n * @param {ModdleElement} item\n */\nItemRegistry.prototype.remove = function(item) {\n\n  var items = this._items,\n      id = item.id,\n      definitions = this._referencedBy,\n      definition = getReference(item),\n      definitionId = definition && definition.id;\n\n  delete items[id];\n\n  if (definition) {\n\n    var referencingItems = definitions[definitionId] || [],\n        idx = referencingItems.indexOf(item);\n\n    if (idx !== -1) {\n      referencingItems.splice(idx, 1);\n    }\n\n    if (!referencingItems.length) {\n      delete definitions[definitionId];\n    }\n\n  }\n\n};\n\n\n/**\n * Update the registration with the new id.\n *\n * @param {ModdleElement} item\n * @param {String} newId\n */\nItemRegistry.prototype.updateId = function(element, newId) {\n\n  var items,\n      item;\n\n  if (typeof element === 'string') {\n    element = this.get(element);\n  }\n\n  if (isDefinition(element)) {\n    items = this._referencedBy;\n  }\n  else {\n    items = this._items;\n  }\n\n  if (element) {\n\n    item = items[element.id];\n\n    delete items[element.id];\n\n    items[newId] = item;\n\n  }\n\n};\n\n\n/**\n * Update the registration.\n *\n * @param {ModdleElement} item\n * @param {ModdleElement} newReference\n */\nItemRegistry.prototype.updateReference = function(item, newReference) {\n\n  var definitions = this._referencedBy,\n      oldDefinition = getReference(item),\n      oldDefinitionId = oldDefinition && oldDefinition.id;\n\n  if (oldDefinition) {\n\n    var referencingItems = definitions[oldDefinitionId] || [],\n        idx = referencingItems.indexOf(item);\n\n    if (idx !== -1) {\n      referencingItems.splice(idx, 1);\n    }\n\n    if (!referencingItems.length) {\n      delete definitions[oldDefinitionId];\n    }\n\n  }\n\n  if (newReference) {\n\n    var newReferenceId = newReference.id;\n    if (newReferenceId) {\n\n      definitions[newReferenceId] = definitions[newReferenceId] || [];\n\n      if (definitions[newReferenceId].indexOf(item) === -1) {\n        definitions[newReferenceId].push(item);\n      }\n\n    }\n\n  }\n\n};\n\n\n/**\n * Return the item for a given id.\n *\n * @param {String} id for selecting the item\n *\n * @return {ModdleElement}\n */\nItemRegistry.prototype.get = function(id) {\n  return this._items[id];\n};\n\n\n/**\n * Return all items that match a given filter function.\n *\n * @param {Function} fn\n *\n * @return {Array<ModdleElement>}\n */\nItemRegistry.prototype.filter = function(fn) {\n\n  var filtered = [];\n\n  this.forEach(function(element, definition) {\n    if (fn(element, definition)) {\n      filtered.push(element);\n    }\n  });\n\n  return filtered;\n\n};\n\n\n/**\n * Return all items.\n *\n * @return {Array<ModdleElement>}\n */\nItemRegistry.prototype.getAll = function() {\n  return this.filter(function(e) { return e; });\n};\n\n\n/**\n * Iterate over all items.\n *\n * @param {Function} fn\n */\nItemRegistry.prototype.forEach = function(fn) {\n\n  var items = this._items;\n\n  forEach(items, function(item) {\n    return fn(item, getReference(item));\n  });\n\n};\n\n\n/**\n * Return for given definition all referenced items.\n *\n * @param {String|ModdleElement} filter\n */\nItemRegistry.prototype.getReferences = function(filter) {\n  var id = filter.id || filter;\n  return (this._referencedBy[id] || []).slice();\n};\n\n\n/**\n * Return for a given item id the shape element.\n *\n * @param {String|ModdleElement} filter\n */\nItemRegistry.prototype.getShape = function(filter) {\n  var id = filter.id || filter;\n  return this._elementRegistry && this._elementRegistry.get(id);\n};\n\n\n/**\n * Return for a given filter all shapes.\n *\n * @param {Array<String>|String|ModdleElement} filter\n */\nItemRegistry.prototype.getShapes = function(filter) {\n\n  var shapes = [],\n      self = this;\n\n  function add(shape) {\n    shape && shapes.push(shape);\n  }\n\n  if (isArray(filter)) {\n\n    forEach(filter, function(f) {\n      add(self.getShape(f));\n    });\n\n  }\n  else if (isDefinition(filter)) {\n\n    var referencedBy = self.getReferences(filter);\n    forEach(referencedBy, function(reference) {\n      add(self.getShape(reference));\n    });\n\n  }\n  else {\n    add(self.getShape(filter));\n  }\n\n  return shapes;\n\n};\n\n\nfunction getReference(item) {\n  return getDefinition(item) || getSentry(item);\n}\n\nfunction isDefinition(item) {\n  return isAny(item, [\n    'cmmn:PlanItemDefinition',\n    'cmmn:Sentry',\n    'cmmn:CaseFileItemDefinition'\n  ]);\n}","/**\n * This file must not be changed or exchanged.\n *\n * @see http://bpmn.io/license for more information.\n */\n\n'use strict';\n\nvar domify = require('min-dom').domify;\n\nvar domDelegate = require('min-dom').delegate;\n\n\n// inlined ../../resources/logo.svg\nvar BPMNIO_LOGO_SVG = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14.02 5.57\" width=\"53\" height=\"21\" style=\"vertical-align:middle\"><path fill=\"currentColor\" d=\"M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z\"/><path fill=\"currentColor\" d=\"M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z\"/></svg>';\n\nvar BPMNIO_IMG = BPMNIO_LOGO_SVG;\n\nfunction css(attrs) {\n  return attrs.join(';');\n}\n\nvar LINK_STYLES = css([\n  'color: #404040'\n]);\n\nvar LIGHTBOX_STYLES = css([\n  'z-index: 1001',\n  'position: fixed',\n  'top: 0',\n  'left: 0',\n  'right: 0',\n  'bottom: 0'\n]);\n\nvar BACKDROP_STYLES = css([\n  'width: 100%',\n  'height: 100%',\n  'background: rgba(40,40,40,0.2)'\n]);\n\nvar NOTICE_STYLES = css([\n  'position: absolute',\n  'left: 50%',\n  'top: 40%',\n  'transform: translate(-50%)',\n  'width: 260px',\n  'padding: 10px',\n  'background: white',\n  'box-shadow: 0 1px 4px rgba(0,0,0,0.3)',\n  'font-family: Helvetica, Arial, sans-serif',\n  'font-size: 14px',\n  'display: flex',\n  'line-height: 1.3'\n]);\n\nvar LIGHTBOX_MARKUP =\n  '<div class=\"bjs-powered-by-lightbox\" style=\"' + LIGHTBOX_STYLES + '\">' +\n    '<div class=\"backdrop\" style=\"' + BACKDROP_STYLES + '\"></div>' +\n    '<div class=\"notice\" style=\"' + NOTICE_STYLES + '\">' +\n      '<a href=\"https://bpmn.io\" target=\"_blank\" rel=\"noopener\" style=\"margin: 15px 20px 15px 10px; align-self: center;' + LINK_STYLES + '\">' +\n        BPMNIO_IMG +\n      '</a>' +\n      '<span>' +\n        'Web-based tooling for BPMN, DMN and CMMN diagrams ' +\n        'powered by <a href=\"https://bpmn.io\" target=\"_blank\" rel=\"noopener\">bpmn.io</a>.' +\n      '</span>' +\n    '</div>' +\n  '</div>';\n\n\nvar lightbox;\n\nfunction open() {\n\n  if (!lightbox) {\n    lightbox = domify(LIGHTBOX_MARKUP);\n\n    domDelegate.bind(lightbox, '.backdrop', 'click', function(event) {\n      document.body.removeChild(lightbox);\n    });\n  }\n\n  document.body.appendChild(lightbox);\n}\n\nmodule.exports.open = open;\n\nmodule.exports.BPMNIO_IMG = BPMNIO_IMG;\n\nmodule.exports.LINK_STYLES = LINK_STYLES;","'use strict';\n\nvar inherits = require('inherits');\n\nvar Viewer = require('./Viewer');\n\n\n/**\n * A viewer that includes mouse navigation facilities\n *\n * @param {Object} options\n */\nfunction NavigatedViewer(options) {\n  Viewer.call(this, options);\n}\n\ninherits(NavigatedViewer, Viewer);\n\nmodule.exports = NavigatedViewer;\n\nNavigatedViewer.prototype._navigationModules = [\n  require('diagram-js/lib/navigation/zoomscroll').default,\n  require('diagram-js/lib/navigation/movecanvas').default\n];\n\nNavigatedViewer.prototype._modules = [].concat(\n  NavigatedViewer.prototype._modules,\n  NavigatedViewer.prototype._navigationModules);","'use strict';\n\nmodule.exports = {\n  __init__: [ 'outline' ],\n  outline: [ 'type', require('./Outline') ]\n};\n","'use strict';\n\nvar BaseOutline = require('diagram-js/lib/features/outline/Outline').default;\n\nvar inherits = require('inherits');\n\nvar isCasePlanModel = require('../../util/ModelUtil').isCasePlanModel;\n\nvar svgAttr = require('tiny-svg').attr;\n\n\n/**\n * This is a subclass of the Outline module from diagram-js.\n * It defines outlines which differ from the element size basis.\n *\n * @param {EventBus} eventBus\n * @param {Styles} styles\n * @param {ElementRegistry} elementRegistry\n */\nfunction Outline(eventBus, styles, elementRegistry) {\n  BaseOutline.call(this, eventBus, styles, elementRegistry);\n}\n\ninherits(Outline, BaseOutline);\n\nOutline.$inject = [ 'eventBus', 'styles', 'elementRegistry' ];\n\nOutline.prototype.baseUpdateShapeOutline = BaseOutline.prototype.updateShapeOutline;\n\nOutline.prototype.updateShapeOutline = function(outline, element) {\n\n  if (!isCasePlanModel(element)) {\n\n    this.baseUpdateShapeOutline(outline, element);\n  } else {\n\n    // update outlines for casePlanModels\n    svgAttr(outline, {\n      x: -this.offset,\n      y: -this.offset - 18,\n      width: element.width + this.offset * 2,\n      height: element.height + 18 + this.offset * 2\n    });\n  }\n};\n\nmodule.exports = Outline;\n","module.exports = {\n  __init__: [ 'cmmnAutoResizeProvider' ],\n  __depends__: [\n    require('diagram-js/lib/features/auto-resize').default\n  ],\n  cmmnAutoResizeProvider: [ 'type', require('./CmmnAutoResizeProvider') ]\n};\n","'use strict';\n\nvar is = require('../../util/ModelUtil').is,\n    getDefinition = require('../../util/ModelUtil').getDefinition;\n\nvar inherits = require('inherits');\n\nvar forEach = require('min-dash').forEach;\n\nvar AutoResizeProvider = require('diagram-js/lib/features/auto-resize/AutoResizeProvider').default;\n\n/**\n * This module provides a CMMN specific check if an element\n * can be resized.\n */\nfunction CmmnAutoResizeProvider(eventBus) {\n  AutoResizeProvider.call(this, eventBus);\n}\n\ninherits(CmmnAutoResizeProvider, AutoResizeProvider);\n\nCmmnAutoResizeProvider.$inject = [ 'eventBus' ];\n\nmodule.exports = CmmnAutoResizeProvider;\n\n/**\n * Check if the given shape can be expanded\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {djs.model.Shape} target\n *\n * @return {boolean}\n */\nCmmnAutoResizeProvider.prototype.canResize = function(elements, target) {\n\n  if (!is(target, 'cmmn:CMMNElement')) {\n    return;\n  }\n\n  var criterionsOnly = true;\n\n  forEach(elements, function(element) {\n    if (!is(element, 'cmmn:Criterion')) {\n      criterionsOnly = false;\n      return;\n    }\n  });\n\n  // prevent auto expand if the selected elements are exclusively criterions\n  if (criterionsOnly) {\n    return;\n  }\n\n  var definition = getDefinition(target);\n\n  return is(definition, 'cmmn:PlanFragment');\n};\n","import RuleProvider from '../rules/RuleProvider';\n\nimport inherits from 'inherits';\n\n/**\n * This is a base rule provider for the element.autoResize rule.\n */\nexport default function AutoResizeProvider(eventBus) {\n\n  RuleProvider.call(this, eventBus);\n\n  var self = this;\n\n  this.addRule('element.autoResize', function(context) {\n    return self.canResize(context.elements, context.target);\n  });\n}\n\nAutoResizeProvider.$inject = [ 'eventBus' ];\n\ninherits(AutoResizeProvider, RuleProvider);\n\n/**\n * Needs to be implemented by sub classes to allow actual auto resize\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {djs.model.Shape} target\n *\n * @return {Boolean}\n */\nAutoResizeProvider.prototype.canResize = function(elements, target) {\n  return false;\n};","module.exports = {\n  __depends__: [\n    require('diagram-js/lib/features/connect').default,\n    require('diagram-js/lib/features/context-pad').default,\n    require('diagram-js/lib/features/create').default,\n    require('diagram-js/lib/features/selection').default,\n    require('../popup-menu')\n  ],\n  __init__: [ 'contextPadProvider' ],\n  contextPadProvider: [ 'type', require('./ContextPadProvider') ]\n};","module.exports = {\n  __init__: [ 'replaceMenuProvider' ],\n  replaceMenuProvider: [ 'type', require('./ReplaceMenuProvider') ]\n};","'use strict';\n\nvar forEach = require('min-dash').forEach,\n    filter = require('min-dash').filter;\n\nvar replaceOptions = require('../replace/ReplaceOptions');\n\nvar isItemCapable = require('../modeling/util/PlanItemDefinitionUtil').isItemCapable;\n\nvar isAny = require('../modeling/util/ModelingUtil').isAny;\n\nvar ModelUtil = require('../../util/ModelUtil'),\n    getBusinessObject = ModelUtil.getBusinessObject,\n    getDefinition = ModelUtil.getDefinition,\n    isCasePlanModel = ModelUtil.isCasePlanModel,\n    isRequired = ModelUtil.isRequired,\n    isRepeatable = ModelUtil.isRepeatable,\n    isManualActivation = ModelUtil.isManualActivation,\n    is = ModelUtil.is;\n\nvar isCollapsed = require('../../util/DiUtil').isCollapsed;\n\n\n/**\n * Returns true, if an element is from a different type.\n * discretionary / non discretionary\n *\n * @param {djs.model.Base} element\n * @param {Object} entry\n *\n * @return {Boolean}\n */\nfunction isDifferentType(element, entry) {\n\n  var businessObject = getBusinessObject(element);\n\n  return businessObject.$type !== entry.target.type;\n}\n\n\n/**\n * Returns true if the definition type is different.\n * e.g. process task / human task\n *\n * @param {djs.model.Base} element\n * @param {Object} entry\n *\n * @return {Boolean}\n */\nfunction isDifferentDefinitionType(element, entry) {\n\n  return getDefinition(element).$type !== entry.target.definitionType;\n}\n\n\nfunction canReplaceElementByTarget(element, target) {\n\n  var type = target.type,\n      definitionType = target.definitionType,\n      parent = element.parent,\n      definition = getDefinition(element);\n\n  if (isPlanItem(element)) {\n    if (type === 'cmmn:DiscretionaryItem' && !isStage(parent)) {\n      return false;\n    }\n  }\n\n  if (definitionType === 'cmmn:HumanTask') {\n\n    if (isPlanFragment(element) && !target.isBlocking) {\n      return false;\n    }\n\n    if (isTask(element) && definition.isBlocking !== target.isBlocking) {\n      return false;\n    }\n\n  }\n\n  return true;\n\n}\n\n\n/**\n * This module is an element agnostic replace menu provider for the popup menu.\n */\nfunction ReplaceMenuProvider(popupMenu, cmmnReplace, cmmnFactory, modeling, rules) {\n\n  this._popupMenu = popupMenu;\n  this._cmmnReplace = cmmnReplace;\n  this._cmmnFactory = cmmnFactory;\n  this._modeling = modeling;\n  this._rules = rules;\n\n  this.register();\n}\n\nReplaceMenuProvider.$inject = [ 'popupMenu', 'cmmnReplace', 'cmmnFactory', 'modeling', 'rules' ];\n\n\n/**\n * Register replace menu provider in the popup menu\n */\nReplaceMenuProvider.prototype.register = function() {\n  this._popupMenu.registerProvider('cmmn-replace', this);\n};\n\n\n/**\n * Get all entries from replaceOptions for the given element and apply filters\n * on them. Get for example only elements, which are different from the current one.\n *\n * @param {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu entry items\n */\nReplaceMenuProvider.prototype.getEntries = function(element) {\n\n  var rules = this._rules;\n\n  var entries,\n      definition = getDefinition(element);\n\n\n  if (!rules.allowed('shape.replace', { element: element })) {\n    return [];\n  }\n\n\n  if (isItemCapable(element)) {\n\n    if (isTask(element)) {\n\n      entries = filter(replaceOptions.TASK, function(entry) {\n\n        var target = entry.target;\n\n        if (canReplaceElementByTarget(element, target)) {\n\n          // ^ === XOR\n          // returns true if and only of EITHER the type OR the definition type is different\n          return isDifferentType(element, entry) ^ isDifferentDefinitionType(element, entry);\n        }\n      });\n\n      return this._createEntries(element, entries);\n    }\n\n    if (isPlanFragment(element)) {\n\n      if (!isCollapsed(element)) {\n\n        entries = filter(replaceOptions.PLAN_FRAGMENT_EXPANDED, function(entry) {\n\n          var target = entry.target;\n\n          if (canReplaceElementByTarget(element, target)) {\n\n            // returns true if the type or the definition type is different (or both)\n            return isDifferentType(element, entry) || isDifferentDefinitionType(element, entry);\n          }\n        });\n\n        return this._createEntries(element, entries);\n      }\n\n      if (isCollapsed(element)) {\n\n        entries = filter(replaceOptions.TASK, function(entry) {\n\n          var target = entry.target,\n              definitionType = target.definitionType;\n\n          if (!canReplaceElementByTarget(element, target)) {\n            return false;\n          }\n\n          if (definitionType === definition.$type && !target.isCollapsed) {\n            return true;\n          }\n\n          // ^ === XOR\n          // returns true if and only of EITHER the type OR the definition type is different\n          return isDifferentType(element, entry) ^ isDifferentDefinitionType(element, entry);\n\n        });\n\n        return this._createEntries(element, entries);\n\n      }\n\n    }\n\n    if (isEventListener(element)) {\n\n      entries = filter(replaceOptions.EVENT_LISTENER, function(entry) {\n        return isDifferentDefinitionType(element, entry);\n      });\n\n      return this._createEntries(element, entries);\n    }\n\n  }\n\n\n  if (isCriterion(element)) {\n\n    entries = filter(replaceOptions.CRITERION, function(entry) {\n      return isDifferentType(element, entry);\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  return [];\n\n};\n\n\nReplaceMenuProvider.prototype.getHeaderEntries = function(element) {\n\n  var headerEntries = [];\n\n  if (isTask(element)) {\n    headerEntries = headerEntries.concat(this._getBlockingEntry(element));\n  }\n\n  if (isStage(element)) {\n    headerEntries = headerEntries.concat(this._getAutoCompleteEntry(element));\n  }\n\n  if (ensureSupportRules(element)) {\n    headerEntries = headerEntries.concat(this._getRuleEntries(element));\n  }\n\n  return headerEntries;\n\n};\n\n/**\n * Creates an array of menu entry objects for a given element and filters the replaceOptions\n * according to a filter function.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} replaceOptions\n *\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._createEntries = function(element, replaceOptions) {\n  var menuEntries = [];\n\n  var self = this;\n\n  forEach(replaceOptions, function(definition) {\n    var entry = self._createMenuEntry(definition, element);\n\n    menuEntries.push(entry);\n  });\n\n  return menuEntries;\n};\n\n\n/**\n * Creates and returns a single menu entry item.\n *\n * @param  {Object} definition a single replace options definition object\n * @param  {djs.model.Base} element\n * @param  {Function} [action] an action callback function which gets called when\n *                             the menu entry is being triggered.\n *\n * @return {Object} menu entry item\n */\nReplaceMenuProvider.prototype._createMenuEntry = function(definition, element, action) {\n\n  var replaceElement = this._cmmnReplace.replaceElement;\n\n  var replaceAction = function() {\n    return replaceElement(element, definition.target);\n  };\n\n  action = action || replaceAction;\n\n  var menuEntry = {\n    label: definition.label,\n    className: definition.className,\n    id: definition.actionName,\n    action: action\n  };\n\n  return menuEntry;\n};\n\n\nReplaceMenuProvider.prototype._getBlockingEntry = function(element) {\n\n  var self = this;\n\n  var definition = getDefinition(element);\n\n  function toggleBlockingEntry(event, entry) {\n    var blocking = !entry.active;\n    self._modeling.updateControls(element, { isBlocking: blocking });\n  }\n\n  var isBlocking = definition.isBlocking;\n  var entries = [\n    {\n      id: 'toggle-is-blocking',\n      className: 'cmmn-icon-blocking',\n      title: 'Blocking',\n      active: isBlocking,\n      action: toggleBlockingEntry\n    }\n  ];\n\n  return entries;\n};\n\n\nReplaceMenuProvider.prototype._getAutoCompleteEntry = function(element) {\n\n  var self = this;\n\n  var definition = getDefinition(element);\n\n  function toggleAutoCompleteEntry(event, entry) {\n    var autoComplete = !entry.active;\n    self._modeling.updateControls(element, { autoComplete: autoComplete });\n  }\n\n  var isAutoComplete = definition.autoComplete;\n  var entries = [\n    {\n      id: 'toggle-auto-complete',\n      className: 'cmmn-icon-auto-complete-marker',\n      title: 'Auto Complete',\n      active: isAutoComplete,\n      action: toggleAutoCompleteEntry\n    }\n  ];\n\n  return entries;\n};\n\n\nReplaceMenuProvider.prototype._getRuleEntries = function(element) {\n\n  var self = this;\n\n  function toggleControlEntry(control, type) {\n\n    return function(event, entry) {\n\n      var value = {};\n\n      if (entry.active) {\n        value[control] = undefined;\n      }\n      else {\n        value[control] = self._cmmnFactory.create(type);\n      }\n\n      self._modeling.updateControls(element, value);\n    };\n\n  }\n\n  var repeatable = isRepeatable(element),\n      required = isRequired(element),\n      manualActivation = isManualActivation(element);\n\n  var entries = [\n    {\n      id: 'toggle-required-rule',\n      className: 'cmmn-icon-required-marker',\n      title: 'Required Rule',\n      active: required,\n      action: toggleControlEntry('requiredRule', 'cmmn:RequiredRule')\n    }\n  ];\n\n  if (!isMilestone(element)) {\n\n    entries.push({\n      id: 'toggle-manual-activation-rule',\n      className: 'cmmn-icon-manual-activation-marker',\n      title: 'Manual Activation Rule',\n      active: manualActivation,\n      action: toggleControlEntry('manualActivationRule', 'cmmn:ManualActivationRule')\n    });\n\n  }\n\n  entries.push({\n    id: 'toggle-repetition-rule',\n    className: 'cmmn-icon-repetition-marker',\n    title: 'Repetition Rule',\n    active: repeatable,\n    action: toggleControlEntry('repetitionRule', 'cmmn:RepetitionRule')\n  });\n\n  return entries;\n};\n\nmodule.exports = ReplaceMenuProvider;\n\n\nfunction ensureSupportRules(element) {\n\n  var definition = getDefinition(element);\n\n  return !isCasePlanModel(element) && isAny(definition, [\n    'cmmn:Stage',\n    'cmmn:Milestone',\n    'cmmn:Task'\n  ]);\n}\n\nfunction isPlanFragment(element) {\n  return is(getDefinition(element), 'cmmn:PlanFragment');\n}\n\nfunction isStage(element) {\n  return is(getDefinition(element), 'cmmn:Stage');\n}\n\nfunction isEventListener(element) {\n  return is(getDefinition(element), 'cmmn:EventListener');\n}\n\nfunction isMilestone(element) {\n  return is(getDefinition(element), 'cmmn:Milestone');\n}\n\nfunction isTask(element) {\n  return is(getDefinition(element), 'cmmn:Task');\n}\n\nfunction isCriterion(element) {\n  return is(element, 'cmmn:Criterion');\n}\n\nfunction isPlanItem(element) {\n  return is(element, 'cmmn:PlanItem');\n}\n","'use strict';\n\n\nmodule.exports.TASK = [\n  {\n    label: 'Task',\n    actionName: 'replace-with-task-plan-item',\n    className: 'cmmn-icon-task-none',\n    target: {\n      definitionType: 'cmmn:Task',\n      type: 'cmmn:PlanItem'\n    }\n  },\n  {\n    label: 'Human Task',\n    actionName: 'replace-with-blocking-human-task-plan-item',\n    className: 'cmmn-icon-human-blocking-task',\n    target: {\n      definitionType: 'cmmn:HumanTask',\n      type: 'cmmn:PlanItem',\n      isBlocking: true\n    }\n  },\n  {\n    label: 'Human Task',\n    actionName: 'replace-with-non-blocking-human-task-plan-item',\n    className: 'cmmn-icon-human-non-blocking-task',\n    target: {\n      definitionType: 'cmmn:HumanTask',\n      type: 'cmmn:PlanItem',\n      isBlocking: false\n    }\n  },\n  {\n    label: 'Decision Task',\n    actionName: 'replace-with-decision-task-plan-item',\n    className: 'cmmn-icon-decision-task',\n    target: {\n      definitionType: 'cmmn:DecisionTask',\n      type: 'cmmn:PlanItem'\n    }\n  },\n  {\n    label: 'Process Task',\n    actionName: 'replace-with-process-task-plan-item',\n    className: 'cmmn-icon-process-task',\n    target: {\n      definitionType: 'cmmn:ProcessTask',\n      type: 'cmmn:PlanItem'\n    }\n  },\n  {\n    label: 'Case Task',\n    actionName: 'replace-with-case-task-plan-item',\n    className: 'cmmn-icon-case-task',\n    target: {\n      definitionType: 'cmmn:CaseTask',\n      type: 'cmmn:PlanItem'\n    }\n  },\n  {\n    label: 'Stage (collapsed)',\n    actionName: 'replace-with-collapsed-stage-plan-item',\n    className: 'cmmn-icon-stage-collapsed',\n    target: {\n      definitionType: 'cmmn:Stage',\n      type: 'cmmn:PlanItem',\n      isCollapsed: true\n    }\n  },\n  {\n    label: 'Stage (expanded)',\n    actionName: 'replace-with-expanded-stage-plan-item',\n    className: 'cmmn-icon-stage-expanded',\n    target: {\n      definitionType: 'cmmn:Stage',\n      type: 'cmmn:PlanItem',\n      isCollapsed: false\n    }\n  },\n  {\n    label: 'Discretionary Task',\n    actionName: 'replace-with-task-discretionary-item',\n    className: 'cmmn-icon-task-discretionary',\n    target: {\n      definitionType: 'cmmn:Task',\n      type: 'cmmn:DiscretionaryItem'\n    }\n  },\n  {\n    label: 'Discretionary Human Task',\n    actionName: 'replace-with-blocking-human-task-discretionary-item',\n    className: 'cmmn-icon-human-blocking-task-discretionary',\n    target: {\n      definitionType: 'cmmn:HumanTask',\n      type: 'cmmn:DiscretionaryItem',\n      isBlocking: true\n    }\n  },\n  {\n    label: 'Discretionary Human Task',\n    actionName: 'replace-with-non-blocking-human-task-discretionary-item',\n    className: 'cmmn-icon-human-non-blocking-task-discretionary',\n    target: {\n      definitionType: 'cmmn:HumanTask',\n      type: 'cmmn:DiscretionaryItem',\n      isBlocking: false\n    }\n  },\n  {\n    label: 'Discretionary Decision Task',\n    actionName: 'replace-with-decision-task-discretionary-item',\n    className: 'cmmn-icon-decision-task-discretionary',\n    target: {\n      definitionType: 'cmmn:DecisionTask',\n      type: 'cmmn:DiscretionaryItem'\n    }\n  },\n  {\n    label: 'Discretionary Process Task',\n    actionName: 'replace-with-process-task-discretionary-item',\n    className: 'cmmn-icon-process-task-discretionary',\n    target: {\n      definitionType: 'cmmn:ProcessTask',\n      type: 'cmmn:DiscretionaryItem'\n    }\n  },\n  {\n    label: 'Discretionary Case Task',\n    actionName: 'replace-with-case-task-discretionary-item',\n    className: 'cmmn-icon-case-task-discretionary',\n    target: {\n      definitionType: 'cmmn:CaseTask',\n      type: 'cmmn:DiscretionaryItem'\n    }\n  },\n  {\n    label: 'Discretionary Stage (collapsed)',\n    actionName: 'replace-with-collapsed-stage-discretionary-item',\n    className: 'cmmn-icon-stage-collapsed-discretionary',\n    target: {\n      definitionType: 'cmmn:Stage',\n      type: 'cmmn:DiscretionaryItem',\n      isCollapsed: true\n    }\n  },\n  {\n    label: 'Discretionary Stage (expanded)',\n    actionName: 'replace-with-expanded-stage-discretionary-item',\n    className: 'cmmn-icon-stage-expanded-discretionary',\n    target: {\n      definitionType: 'cmmn:Stage',\n      type: 'cmmn:DiscretionaryItem',\n      isCollapsed: false\n    }\n  }\n];\n\n\nmodule.exports.PLAN_FRAGMENT_EXPANDED = [\n  {\n    label: 'Stage',\n    actionName: 'replace-with-stage-plan-item',\n    className: 'cmmn-icon-stage-expanded',\n    target: {\n      definitionType: 'cmmn:Stage',\n      type: 'cmmn:PlanItem',\n      isCollapsed: false\n    }\n  },\n  {\n    label: 'Discretionary Stage',\n    actionName: 'replace-with-stage-discretionary-item',\n    className: 'cmmn-icon-stage-expanded-discretionary',\n    target: {\n      definitionType: 'cmmn:Stage',\n      type: 'cmmn:DiscretionaryItem',\n      isCollapsed: false\n    }\n  },\n  {\n    label: 'Discretionary Plan Fragment',\n    actionName: 'replace-with-plan-fragment-discretionary-item',\n    className: 'cmmn-icon-plan-fragment-expanded-discretionary',\n    target: {\n      definitionType: 'cmmn:PlanFragment',\n      type: 'cmmn:DiscretionaryItem',\n      isCollapsed: false\n    }\n  }\n];\n\nmodule.exports.EVENT_LISTENER = [\n  {\n    label: 'Event Listener',\n    actionName: 'replace-with-event-listener-plan-item',\n    className: 'cmmn-icon-event-listener',\n    target: {\n      definitionType: 'cmmn:EventListener',\n      type: 'cmmn:PlanItem'\n    }\n  },\n  {\n    label: 'Timer Event Listener',\n    actionName: 'replace-with-timer-event-listener-plan-item',\n    className: 'cmmn-icon-timer-event-listener',\n    target: {\n      definitionType: 'cmmn:TimerEventListener',\n      type: 'cmmn:PlanItem'\n    }\n  },\n  {\n    label: 'User Event Listener',\n    actionName: 'replace-with-user-event-listener-plan-item',\n    className: 'cmmn-icon-user-event-listener',\n    target: {\n      definitionType: 'cmmn:UserEventListener',\n      type: 'cmmn:PlanItem'\n    }\n  }\n];\n\n\nmodule.exports.CRITERION = [\n  {\n    label: 'Entry Criterion',\n    actionName: 'replace-with-entry-criterion',\n    className: 'cmmn-icon-entry-criterion',\n    target: {\n      type: 'cmmn:EntryCriterion'\n    }\n  },\n  {\n    label: 'Exit Criterion',\n    actionName: 'replace-with-exit-criterion',\n    className: 'cmmn-icon-exit-criterion',\n    target: {\n      type: 'cmmn:ExitCriterion'\n    }\n  }\n];","'use strict';\n\nvar assign = require('min-dash').assign,\n    isArray = require('min-dash').isArray;\n\nvar isAny = require('../modeling/util/ModelingUtil').isAny;\n\nvar ModelUtil = require('../../util/ModelUtil'),\n    is = ModelUtil.is,\n    getDefinition = ModelUtil.getDefinition;\n\n/**\n * A provider for CMMN 1.1 elements context pad\n */\nfunction ContextPadProvider(\n    contextPad,\n    connect,\n    create,\n    elementFactory,\n    modeling,\n    rules,\n    popupMenu,\n    canvas\n) {\n\n  contextPad.registerProvider(this);\n\n  this._contextPad = contextPad;\n  this._connect = connect;\n  this._create = create;\n  this._elementFactory = elementFactory;\n  this._modeling = modeling;\n  this._rules = rules;\n  this._popupMenu = popupMenu;\n  this._canvas = canvas;\n}\n\nContextPadProvider.$inject = [\n  'contextPad',\n  'connect',\n  'create',\n  'elementFactory',\n  'modeling',\n  'rules',\n  'popupMenu',\n  'canvas'\n];\n\nmodule.exports = ContextPadProvider;\n\n\nContextPadProvider.prototype.getContextPadEntries = function(element) {\n\n  var contextPad = this._contextPad,\n      connect = this._connect,\n      create = this._create,\n      elementFactory = this._elementFactory,\n      modeling = this._modeling,\n      canvas = this._canvas,\n      rules = this._rules,\n      popupMenu = this._popupMenu;\n\n  var actions = {};\n\n  if (element.type === 'label') {\n    return actions;\n  }\n\n\n  function removeElement(e) {\n    modeling.removeElements([ element ]);\n  }\n\n  function getReplaceMenuPosition(element) {\n\n    var Y_OFFSET = 5;\n\n    var diagramContainer = canvas.getContainer(),\n        pad = contextPad.getPad(element).html;\n\n    var diagramRect = diagramContainer.getBoundingClientRect(),\n        padRect = pad.getBoundingClientRect();\n\n    var top = padRect.top - diagramRect.top;\n    var left = padRect.left - diagramRect.left;\n\n    var pos = {\n      x: left,\n      y: top + padRect.height + Y_OFFSET\n    };\n\n    return pos;\n  }\n\n  function startConnect(event, element, autoActivate) {\n    connect.start(event, element, autoActivate);\n  }\n\n\n  function appendCriterionAction(className, title, options) {\n\n    function appendListener(event, element) {\n      var shape = elementFactory.createCriterionShape('cmmn:EntryCriterion');\n      create.start(event, shape, element);\n    }\n\n    return appendAction('cmmn:EntryCriterion', className, title, options, appendListener);\n  }\n\n  function appendDiscretionaryItemAction(className, title, options) {\n\n    function appendListener(event, element) {\n      var shape = elementFactory.createDiscretionaryItemShape('cmmn:Task');\n      create.start(event, shape, element);\n    }\n\n    return appendAction('cmmn:DiscretionaryItem', className, title, options, appendListener);\n  }\n\n  function appendAction(type, className, title, options, listener) {\n\n    if (typeof title !== 'string') {\n      options = title;\n      title = 'Append ' + type.replace(/^cmmn:/, '');\n    }\n\n    function appendListener(event, element) {\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n      create.start(event, shape, element);\n    }\n\n    return {\n      group: 'model',\n      className: className,\n      title: title,\n      action: {\n        dragstart: listener || appendListener,\n        click: listener || appendListener\n      }\n    };\n  }\n\n\n  if (isAny(element, [ 'cmmn:PlanItem', 'cmmn:CaseFileItem' ])) {\n    assign(actions, {\n      'append.entryCriterion': appendCriterionAction('cmmn-icon-entry-criterion', 'Append Criterion')\n    });\n  }\n\n  if (isBlockingHumanTask(element)) {\n    assign(actions, {\n      'append.discretionaryItem': appendDiscretionaryItemAction(\n        'cmmn-icon-task-discretionary',\n        'Append DiscretionaryItem'\n      )\n    });\n  }\n\n\n  if (!popupMenu.isEmpty(element, 'cmmn-replace')) {\n\n    // Replace menu entry\n    assign(actions, {\n      'replace': {\n        group: 'edit',\n        className: 'cmmn-icon-screw-wrench',\n        title: 'Change type',\n        action: {\n          click: function(event, element) {\n\n            var position = assign(getReplaceMenuPosition(element), {\n              cursor: { x: event.x, y: event.y }\n            });\n\n            popupMenu.open(element, 'cmmn-replace', position);\n          }\n        }\n      }\n    });\n  }\n\n\n  if (!isAny(element, [ 'cmmndi:CMMNEdge', 'cmmn:TextAnnotation' ])) {\n    assign(actions, {\n      'append.text-annotation': appendAction('cmmn:TextAnnotation', 'cmmn-icon-text-annotation')\n    });\n  }\n\n\n  if (isAny(element, [\n    'cmmn:PlanItem',\n    'cmmn:DiscretionaryItem',\n    'cmmn:CaseFileItem',\n    'cmmn:Criterion'\n  ])) {\n\n    assign(actions, {\n\n      'connect': {\n        group: 'connect',\n        className: 'cmmn-icon-connection',\n        title: 'Connect using Discretionary/OnPart or Association',\n        action: {\n          click: startConnect,\n          dragstart: startConnect\n        }\n      }\n    });\n  }\n\n\n  // delete element entry, only show if allowed by rules\n  var deleteAllowed = rules.allowed('elements.delete', { elements: [ element ] });\n\n  if (isArray(deleteAllowed)) {\n    // was the element returned as a deletion candidate?\n    deleteAllowed = deleteAllowed[0] === element;\n  }\n\n  if (deleteAllowed) {\n    assign(actions, {\n      'delete': {\n        group: 'edit',\n        className: 'cmmn-icon-trash',\n        title: 'Remove',\n        action: {\n          click: removeElement\n        }\n      }\n    });\n  }\n\n  return actions;\n};\n\n\nfunction isBlockingHumanTask(element) {\n  var definition = getDefinition(element);\n  return is(definition, 'cmmn:HumanTask') && definition.isBlocking;\n}","var EditorActionsModule = require('diagram-js/lib/features/editor-actions').default;\n\nvar CmmnEditorActions = require('./CmmnEditorActions');\n\nmodule.exports = {\n  __depends__: [\n    EditorActionsModule\n  ],\n  editorActions: [ 'type', CmmnEditorActions ]\n};\n","import EditorActions from './EditorActions';\n\nexport default {\n  __init__: [ 'editorActions' ],\n  editorActions: [ 'type', EditorActions ]\n};\n","var inherits = require('inherits');\n\nvar EditorActions = require('diagram-js/lib/features/editor-actions/EditorActions').default;\n\n\n/**\n * Registers and executes CMMN specific editor actions.\n *\n * @param {Injector} injector\n */\nfunction CmmnEditorActions(injector) {\n  injector.invoke(EditorActions, this);\n}\n\ninherits(CmmnEditorActions, EditorActions);\n\nCmmnEditorActions.$inject = [\n  'injector'\n];\n\nmodule.exports = CmmnEditorActions;\n\n\n/**\n * Register default actions.\n *\n * @param {Injector} injector\n */\nCmmnEditorActions.prototype._registerDefaultActions = function(injector) {\n\n  // (0) invoke super method\n\n  EditorActions.prototype._registerDefaultActions.call(this, injector);\n\n  // (1) retrieve optional components to integrate with\n\n  var canvas = injector.get('canvas', false);\n  var elementRegistry = injector.get('elementRegistry', false);\n  var selection = injector.get('selection', false);\n  var spaceTool = injector.get('spaceTool', false);\n  var lassoTool = injector.get('lassoTool', false);\n  var handTool = injector.get('handTool', false);\n  var globalConnect = injector.get('globalConnect', false);\n  var directEditing = injector.get('directEditing', false);\n  var searchPad = injector.get('searchPad', false);\n\n  // (2) check components and register actions\n\n  if (canvas && elementRegistry && selection) {\n    this._registerAction('selectElements', function() {\n      // select all elements except for the invisible\n      // root element\n      var rootElement = canvas.getRootElement();\n\n      var elements = elementRegistry.filter(function(element) {\n        return element !== rootElement;\n      });\n\n      selection.select(elements);\n\n      return elements;\n    });\n  }\n\n  if (spaceTool) {\n    this._registerAction('spaceTool', function() {\n      spaceTool.toggle();\n    });\n  }\n\n  if (lassoTool) {\n    this._registerAction('lassoTool', function() {\n      lassoTool.toggle();\n    });\n  }\n\n  if (handTool) {\n    this._registerAction('handTool', function() {\n      handTool.toggle();\n    });\n  }\n\n  if (globalConnect) {\n    this._registerAction('globalConnectTool', function() {\n      globalConnect.toggle();\n    });\n  }\n\n  if (selection && directEditing) {\n    this._registerAction('directEditing', function() {\n      var currentSelection = selection.get();\n\n      if (currentSelection.length) {\n        directEditing.activate(currentSelection[0]);\n      }\n    });\n  }\n\n  if (searchPad) {\n    this._registerAction('find', function() {\n      searchPad.toggle();\n    });\n  }\n\n};","module.exports = {\n  __depends__: [\n    require('diagram-js/lib/features/keyboard').default\n  ],\n  __init__: [ 'keyboardBindings' ],\n  keyboardBindings: [ 'type', require('./CmmnKeyboardBindings') ]\n};\n","var inherits = require('inherits');\n\nvar KeyboardBindings = require('diagram-js/lib/features/keyboard/KeyboardBindings').default;\n\n\n/**\n * CMMN specific keyboard bindings.\n *\n * @param {Injector} injector\n */\nfunction CmmnKeyboardBindings(injector) {\n  injector.invoke(KeyboardBindings, this);\n}\n\ninherits(CmmnKeyboardBindings, KeyboardBindings);\n\nCmmnKeyboardBindings.$inject = [\n  'injector'\n];\n\nmodule.exports = CmmnKeyboardBindings;\n\n/**\n * Register available keyboard bindings.\n *\n * @param {Keyboard} keyboard\n * @param {EditorActions} editorActions\n */\nCmmnKeyboardBindings.prototype.registerBindings = function(keyboard, editorActions) {\n\n  // inherit default bindings\n  KeyboardBindings.prototype.registerBindings.call(this, keyboard, editorActions);\n\n  /**\n   * Add keyboard binding if respective editor action\n   * is registered.\n   *\n   * @param {String} action name\n   * @param {Function} fn that implements the key binding\n   */\n  function addListener(action, fn) {\n\n    if (editorActions.isRegistered(action)) {\n      keyboard.addListener(fn);\n    }\n  }\n\n  // select all elements\n  // CTRL + A\n  addListener('selectElements', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.isKey(['a', 'A'], event) && keyboard.isCmd(event)) {\n      editorActions.trigger('selectElements');\n\n      return true;\n    }\n  });\n\n  // search labels\n  // CTRL + F\n  addListener('find', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.isKey(['f', 'F'], event) && keyboard.isCmd(event)) {\n      editorActions.trigger('find');\n\n      return true;\n    }\n  });\n\n  // activate space tool\n  // S\n  addListener('spaceTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['s', 'S'], event)) {\n      editorActions.trigger('spaceTool');\n\n      return true;\n    }\n  });\n\n  // activate lasso tool\n  // L\n  addListener('lassoTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['l', 'L'], event)) {\n      editorActions.trigger('lassoTool');\n\n      return true;\n    }\n  });\n\n  // activate hand tool\n  // H\n  addListener('handTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['h', 'H'], event)) {\n      editorActions.trigger('handTool');\n\n      return true;\n    }\n  });\n\n  // activate global connect tool\n  // C\n  addListener('globalConnectTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['c', 'C'], event)) {\n      editorActions.trigger('globalConnectTool');\n\n      return true;\n    }\n  });\n\n  // activate direct editing\n  // E\n  addListener('directEditing', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['e', 'E'], event)) {\n      editorActions.trigger('directEditing');\n\n      return true;\n    }\n  });\n\n};","module.exports = {\n  __depends__: [\n    require('diagram-js/lib/command').default,\n    require('diagram-js/lib/features/change-support').default,\n    require('diagram-js-direct-editing').default\n  ],\n  __init__: [ 'labelEditingProvider' ],\n  labelEditingProvider: [ 'type', require('./LabelEditingProvider') ]\n};\n","'use strict';\n\nvar UpdateLabelHandler = require('./cmd/UpdateLabelHandler');\n\nvar LabelUtil = require('./LabelUtil');\n\nvar isCasePlanModel = require('../../util/ModelUtil').isCasePlanModel,\n    is = require('../../util/ModelUtil').is,\n    getDefinition = require('../../util/ModelUtil').getDefinition;\n\nvar assign = require('min-dash').assign;\n\nvar LINE_HEIGHT = 14,\n    PADDING = 6;\n\nfunction LabelEditingProvider(eventBus, canvas, directEditing, commandStack) {\n\n  this._canvas = canvas;\n  this._commandStack = commandStack;\n\n  directEditing.registerProvider(this);\n\n  commandStack.registerHandler('element.updateLabel', UpdateLabelHandler);\n\n  // listen to dblclick on non-root elements\n  eventBus.on('element.dblclick', function(event) {\n    directEditing.activate(event.element);\n  });\n\n  // complete on followup canvas operation\n  eventBus.on([ 'element.mousedown', 'drag.init', 'canvas.viewbox.changed' ], function(event) {\n    directEditing.complete();\n  });\n\n  // cancel on command stack changes\n  eventBus.on([ 'commandStack.changed' ], function() {\n    directEditing.cancel();\n  });\n\n  eventBus.on('create.end', 500, function(event) {\n\n    var element = event.shape,\n        canExecute = event.context.canExecute,\n        isTouch = event.isTouch;\n\n    // TODO(nikku): we need to find a way to support the\n    // direct editing on mobile devices; right now this will\n    // break for desworkflowediting on mobile devices\n    // as it breaks the user interaction workflow\n\n    // TODO(nre): we should temporarily focus the edited element\n    // here and release the focused viewport after the direct edit\n    // operation is finished\n    if (isTouch) {\n      return;\n    }\n\n    if (!canExecute) {\n      return;\n    }\n\n    directEditing.activate(element);\n  });\n\n}\n\nLabelEditingProvider.$inject = [\n  'eventBus',\n  'canvas',\n  'directEditing',\n  'commandStack'\n];\n\nmodule.exports = LabelEditingProvider;\n\n\n/**\n * Activate direct editing.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object with properties bounds (position and size) and text\n */\nLabelEditingProvider.prototype.activate = function(element) {\n\n  var text = LabelUtil.getLabel(element);\n\n  if (text === undefined) {\n    return;\n  }\n\n  // don't activate for root element\n  if (!element.parent) {\n    return;\n  }\n\n  var target = element.label || element;\n\n  var props = this.getEditingBBox(element);\n\n  var definition = getDefinition(element);\n\n  var options = {};\n\n  if (is(definition, 'cmmn:Task') || is(definition, 'cmmn:Milestone')) {\n    options.centerVertically = true;\n  }\n\n  if (is(element, 'cmmn:TextAnnotation')) {\n    options.autoResize = true;\n    options.resizable = true;\n  }\n\n  // external labels for event listener, case file items and connections\n  if (target.labelTarget) {\n    options.autoResize = true;\n  }\n\n  return assign({ text: text, options: options }, props);\n};\n\n\n/**\n * Get the editing bounding box based on the element's size and position\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object containing information about position and size (fixed or minimum and/or maximum)\n */\nLabelEditingProvider.prototype.getEditingBBox = function(element, maxBounds) {\n\n  var canvas = this._canvas;\n\n  var definition = getDefinition(element);\n\n  var target = element.label || element;\n\n  var bbox = this._canvas.getAbsoluteBBox(target);\n\n  var mid = {\n    x: bbox.x + bbox.width / 2,\n    y: bbox.y + bbox.height / 2\n  };\n\n  // default position\n  var bounds = { x: bbox.x, y: bbox.y };\n\n  var style = {};\n\n  var zoom = canvas.zoom();\n\n  // internal labels for case plan models\n  if (isCasePlanModel(element)) {\n    bounds.height = 50;\n    bounds.width = 200;\n    bounds.y -= 30;\n\n    style.textAlign = 'left';\n  }\n\n  // internal labels for stages and plan fragments (excluding case plan models)\n  if (is(definition, 'cmmn:PlanFragment') && !isCasePlanModel(element)) {\n    bounds.width = element.width;\n    bounds.maxHeight = 3 * LINE_HEIGHT + PADDING; // maximum 3 lines\n    bounds.y += 5;\n\n    style.textAlign = 'left';\n  }\n\n  // internal labels for tasks\n  if (is(definition, 'cmmn:Task') || is(definition, 'cmmn:Milestone')) {\n\n    // fixed size for internal labels:\n    // on high zoom levels: text box size === bbox size\n    // on low zoom levels: text box size === bbox size at 100% zoom\n    // This ensures minimum bounds at low zoom levels\n    if (zoom > 1) {\n      bounds.width = bbox.width;\n      bounds.height = bbox.height;\n    } else {\n      bounds.width = bbox.width / zoom;\n      bounds.height = bbox.height / zoom;\n    }\n\n    // centering overlapping text box size at low zoom levels\n    if (zoom < 1) {\n      bounds.x = bbox.x - (bounds.width / 2 - bbox.width / 2);\n      bounds.y = bbox.y - (bounds.height / 2 - bbox.height / 2);\n    }\n  }\n\n  if (is(element, 'cmmn:TextAnnotation')) {\n    bounds.width = bbox.width;\n    bounds.height = bbox.height;\n    bounds.minWidth = 30 * zoom;\n    bounds.minHeight = 10 * zoom;\n\n    style.textAlign = 'left';\n  }\n\n  // external labels for event listener, case file items and connections\n  if (target.labelTarget) {\n\n    bounds.width = 150;\n    bounds.minHeight = LINE_HEIGHT + PADDING; // 1 line\n    bounds.x = mid.x - bounds.width / 2;\n  }\n\n  return {\n    bounds: bounds,\n    style: style\n  };\n};\n\n\nLabelEditingProvider.prototype.update = function(element, newLabel) {\n  this._commandStack.execute('element.updateLabel', {\n    element: element,\n    newLabel: newLabel\n  });\n};\n","'use strict';\n\nvar LabelUtil = require('../LabelUtil');\n\nvar getDefinition = require('../../../util/ModelUtil').getDefinition;\n\n/**\n * A handler that updates the text of a CMMN element.\n */\nfunction UpdateLabelHandler(itemRegistry) {\n\n  /**\n   * Set the label and return the changed elements.\n   *\n   * Element parameter can be label itself or connection (i.e. sequence flow).\n   *\n   * @param {djs.model.Base} element\n   * @param {String} text\n   */\n  function setText(element, text) {\n\n    // external label if present\n    var label = element.label || element;\n\n    var labelTarget = element.labelTarget || element;\n\n    LabelUtil.setLabel(label, text, labelTarget !== label, isExclusiveRef(element));\n\n    return [ label, labelTarget ];\n  }\n\n  /**\n   * Return a function which checks if the element is the only reference to a definition\n   *\n   * @param  {djs.model.Base} element\n   *\n   * @return {Function}\n   */\n  function isExclusiveRef(element) {\n    var definition = getDefinition(element);\n    return definition ? itemRegistry.getReferences(definition).length === 1 : true;\n  }\n\n\n  function execute(ctx) {\n    ctx.oldLabel = LabelUtil.getLabel(ctx.element);\n    return setText(ctx.element, ctx.newLabel);\n  }\n\n  function revert(ctx) {\n    return setText(ctx.element, ctx.oldLabel);\n  }\n\n  // API\n\n  this.execute = execute;\n  this.revert = revert;\n}\n\n\nUpdateLabelHandler.$inject = [ 'itemRegistry' ];\n\nmodule.exports = UpdateLabelHandler;\n","module.exports = {\n  __init__: [ 'modeling', 'cmmnUpdater' ],\n  __depends__: [\n    require('./behavior'),\n    require('../ordering'),\n    require('../replace'),\n    require('../rules'),\n    require('diagram-js/lib/command').default,\n    require('diagram-js/lib/features/selection').default,\n    require('diagram-js/lib/features/label-support').default,\n    require('diagram-js/lib/features/attach-support').default,\n    require('diagram-js/lib/features/change-support').default\n  ],\n  cmmnFactory: [ 'type', require('./CmmnFactory') ],\n  cmmnUpdater: [ 'type', require('./CmmnUpdater') ],\n  elementFactory: [ 'type', require('./ElementFactory') ],\n  modeling: [ 'type', require('./Modeling') ],\n  layouter: [ 'type', require('./CmmnLayouter') ],\n  connectionDocking: [ 'type', require('diagram-js/lib/layout/CroppingConnectionDocking').default ]\n};\n","module.exports = {\n  __init__: [\n    'attachCriterionBehavior',\n    'caseFileItemUpdater',\n    'labelBehavior',\n    'planItemDefinitionUpdater',\n    'planningTableUpdater',\n    'replaceConnectionBehavior',\n    'replaceElementBehavior',\n    'resizeCasePlanModelBehavior',\n    'sentryUpdater',\n    'unclaimIdBehavior'\n  ],\n  attachCriterionBehavior: [ 'type', require('./AttachCriterionBehavior') ],\n  caseFileItemUpdater: [ 'type', require('./CaseFileItemUpdater') ],\n  labelBehavior: [ 'type', require('./LabelBehavior') ],\n  planItemDefinitionUpdater: [ 'type', require('./PlanItemDefinitionUpdater') ],\n  planningTableUpdater: [ 'type', require('./PlanningTableUpdater') ],\n  replaceConnectionBehavior: [ 'type', require('./ReplaceConnectionBehavior') ],\n  replaceElementBehavior: [ 'type', require('./ReplaceElementBehavior') ],\n  resizeCasePlanModelBehavior: [ 'type', require('./ResizeCasePlanModelBehavior') ],\n  sentryUpdater: [ 'type', require('./SentryUpdater') ],\n  unclaimIdBehavior: [ 'type', require('./UnclaimIdBehavior') ]\n};\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\nvar ModelUtil = require('../../../util/ModelUtil'),\n    is = ModelUtil.is,\n    isCasePlanModel = ModelUtil.isCasePlanModel;\n\n/*\n * If a criterion is (re-)attached to a case plan model,\n * then the (visual) parent must be the case plan model itself,\n * and not the root element.\n */\nfunction AttachCriterionBehavior(eventBus) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this.preExecute([ 'shape.create', 'elements.move' ], function(context) {\n\n    var shape = context.shape,\n        shapes = context.shapes,\n        parent = context.parent || context.newParent,\n        host = context.host || context.newHost;\n\n    if (!parent) {\n      return;\n    }\n\n    if (!host || !isCasePlanModel(host)) {\n      return;\n    }\n\n    if (shapes && shapes.length > 1) {\n      return;\n    }\n\n    shape = shape || shapes[0];\n\n    if (!is(shape, 'cmmn:Criterion')) {\n      return;\n    }\n\n    context.parent = context.parent && host;\n    context.newParent = context.newParent && host;\n\n  }, true);\n\n\n\n}\n\nAttachCriterionBehavior.$inject = [ 'eventBus' ];\n\ninherits(AttachCriterionBehavior, CommandInterceptor);\n\nmodule.exports = AttachCriterionBehavior;\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\nvar forEach = require('min-dash').forEach;\nvar filter = require('min-dash').filter;\nvar reduce = require('min-dash').reduce;\n\nvar ModelUtil = require('../../../util/ModelUtil'),\n    getDefinition = ModelUtil.getDefinition,\n    getBusinessObject = ModelUtil.getBusinessObject,\n    is = ModelUtil.is;\n\nvar ModelingUtil = require('../util/ModelingUtil'),\n    getCase = ModelingUtil.getCase,\n    getParent = ModelingUtil.getParent,\n    isSameCase = ModelingUtil.isSameCase,\n    isLabel = ModelingUtil.isLabel;\n\n\nfunction CaseFileItemUpdater(\n    eventBus,\n    itemRegistry,\n    cmmnFactory,\n    modeling\n) {\n\n  this._cmmnFactory = cmmnFactory;\n  this._modeling = modeling;\n\n  CommandInterceptor.call(this, eventBus);\n\n  var containment = 'caseFileItems';\n\n\n  this.preExecuted('shape.create', function(context) {\n\n    var shape = context.shape,\n        parent = context.parent,\n        parentBusinessObject = getBusinessObject(parent),\n        definitions,\n        caseFileItemDefinition,\n        caseFileModel;\n\n\n    if (!isCaseFileItem(shape)) {\n      return;\n    }\n\n    caseFileItemDefinition = getDefinition(shape);\n\n    if (caseFileItemDefinition) {\n      definitions = getDefinitions(parentBusinessObject);\n      modeling.updateSemanticParent(caseFileItemDefinition, definitions, 'caseFileItemDefinitions');\n    }\n\n    caseFileModel = createCaseFileModel(parent);\n\n    modeling.updateSemanticParent(shape, caseFileModel, containment);\n\n  }, true);\n\n\n\n\n  this.preExecuted('elements.move', function(context) {\n\n    var newParent = context.newParent,\n        hints = context.hints,\n        oldParent = hints && hints.primaryShape && hints.primaryShape.parent,\n        closure = context.closure || {},\n        shapes = closure.allShapes,\n        caseFileModel;\n\n\n    if (!newParent || oldParent === newParent) {\n      return;\n    }\n\n\n    shapes = filter(shapes, function(shape) {\n      return isCaseFileItem(shape) && !isLabel(shape) && !isSameCase(shape.parent, newParent);\n    });\n\n    if (shapes && shapes.length) {\n\n      caseFileModel = createCaseFileModel(newParent);\n\n      shapes = toMap(shapes);\n\n      forEach(shapes, function(shape) {\n\n        var caseFileItem = getBusinessObject(shape),\n            oldCaseFileModel = getParentCaseFile(caseFileItem),\n            oldSemanticParent = getParent(caseFileItem);\n\n        if (isCaseFileModel(oldSemanticParent)) {\n\n          modeling.updateSemanticParent(shape, caseFileModel, containment);\n\n        }\n        else {\n\n          var parentCaseFileItem = getParent(caseFileItem, 'cmmn:CaseFileItem');\n          if (!shapes[parentCaseFileItem.id]) {\n            modeling.updateSemanticParent(shape, caseFileModel, containment);\n          }\n\n        }\n\n        var source = caseFileItem.sourceRef;\n        if (source && !shapes[source.id]) {\n          clearSourceRef(caseFileItem);\n        }\n\n        clearTargetRefs(caseFileItem, function(target) {\n          return !shapes[target.id];\n        });\n\n\n        moveChildren(caseFileItem, oldCaseFileModel, function(child) {\n          return !shapes[child.id];\n        });\n\n        clearCaseFileItemContainer(oldSemanticParent);\n\n      });\n\n    }\n\n  }, true);\n\n\n  this.postExecuted('shape.delete', function(context) {\n\n    var shape = context.shape,\n        bo = getBusinessObject(shape),\n        caseFileItemDefinition;\n\n    if (!isCaseFileItem(shape) || isLabel(shape)) {\n      return;\n    }\n\n    var oldSemanticParent = getParent(bo),\n        caseFileModel = getParentCaseFile(bo);\n\n    modeling.updateSemanticParent(shape, null, containment);\n\n    clearSourceRef(shape);\n    clearTargetRefs(shape);\n    moveChildren(bo, caseFileModel);\n\n    clearCaseFileItemContainer(oldSemanticParent);\n\n    if (isExlusiveRef(shape)) {\n      caseFileItemDefinition = getDefinition(shape);\n      modeling.updateSemanticParent(caseFileItemDefinition, null, 'caseFileItemDefinitions');\n    }\n\n  }, true);\n\n\n\n  function createCaseFileModel(element) {\n    var _case = getCase(element),\n        caseFileModel = _case.caseFileModel;\n\n    if (!caseFileModel) {\n      caseFileModel = cmmnFactory.createCaseFileModel(_case);\n      modeling.updateProperties(_case, { caseFileModel: caseFileModel });\n    }\n\n    return caseFileModel;\n  }\n\n\n  function clearCaseFileItemContainer(container) {\n    var items = container && container.get(containment);\n\n    if (items && !items.length) {\n\n      var prop = 'caseFileModel',\n          parent = container.$parent;\n\n      if (!isCaseFileModel(container)) {\n        prop = 'children';\n      }\n\n      var update = {};\n      update[prop] = undefined;\n\n      modeling.updateProperties(parent, update);\n      modeling.updateSemanticParent(container);\n    }\n\n  }\n\n\n  function clearSourceRef(target) {\n    target = getBusinessObject(target);\n\n    var source = target.sourceRef;\n\n    if (source) {\n      clearTargetRefs(source, function(elem) {\n        return target === elem;\n      });\n\n      modeling.updateProperties(target, { sourceRef: undefined });\n    }\n\n  }\n\n\n  function clearTargetRefs(source, canRemoveFilter) {\n    source = getBusinessObject(source);\n\n    var targets = source && source.get('targetRefs'),\n        copy;\n\n    if (targets && targets.length) {\n\n      copy = targets.slice();\n\n      forEach(targets, function(target) {\n\n        var canRemove = !canRemoveFilter || canRemoveFilter(target);\n\n        if (canRemove) {\n\n          if (target.sourceRef === source) {\n            modeling.updateProperties(target, { sourceRef: undefined });\n          }\n\n          var idx = copy.indexOf(target);\n          if (idx !== -1) {\n            copy.splice(idx, 1);\n          }\n\n        }\n\n      });\n\n      if (targets.length !== copy.length) {\n        modeling.updateProperties(source, { targetRefs: copy });\n      }\n\n    }\n\n  }\n\n\n  function moveChildren(caseFileItem, newParent, canMoveFilter) {\n    caseFileItem = getBusinessObject(caseFileItem);\n\n    var childrenElement = caseFileItem.children,\n        children = childrenElement && childrenElement.get(containment);\n\n    if (children && children.length) {\n\n      forEach(children, function(child) {\n\n        var canMove = !canMoveFilter || canMoveFilter(child);\n\n        if (canMove) {\n          modeling.updateSemanticParent(child, newParent, containment);\n        }\n\n      });\n\n      clearCaseFileItemContainer(childrenElement);\n\n    }\n\n  }\n\n\n  function isExlusiveRef(element) {\n    var definition = getDefinition(element);\n    return definition && itemRegistry.getReferences(definition).length === 1;\n  }\n\n}\n\nCaseFileItemUpdater.$inject = [\n  'eventBus',\n  'itemRegistry',\n  'cmmnFactory',\n  'modeling'\n];\n\ninherits(CaseFileItemUpdater, CommandInterceptor);\n\nmodule.exports = CaseFileItemUpdater;\n\n\nfunction getDefinitions(element) {\n  return getParent(element, 'cmmn:Definitions');\n}\n\n\nfunction isCaseFileItem(element) {\n  return is(element, 'cmmn:CaseFileItem');\n}\n\n\nfunction isCaseFileModel(element) {\n  return is(element, 'cmmn:CaseFile');\n}\n\n\nfunction toMap(elements) {\n  return reduce(elements, function(result, value) {\n    result[value.id] = value;\n    return result;\n  }, {});\n}\n\n\nfunction getParentCaseFile(element) {\n  return getParent(getBusinessObject(element), 'cmmn:CaseFile');\n}","'use strict';\n\nvar assign = require('min-dash').assign,\n    inherits = require('inherits');\n\nvar LabelUtil = require('../../../util/LabelUtil'),\n    ModelUtil = require('../../../util/ModelUtil'),\n    DiUtil = require('../../../util/DiUtil'),\n    ModelingUtil = require('../util/ModelingUtil');\n\nvar getBusinessObject = ModelUtil.getBusinessObject,\n    getName = ModelUtil.getName;\n\nvar hasExternalLabel = LabelUtil.hasExternalLabel,\n    getExternalLabelMid = LabelUtil.getExternalLabelMid;\n\nvar isStandardEventVisible = DiUtil.isStandardEventVisible;\n\nvar isAny = ModelingUtil.isAny;\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\n\n/**\n * A component that makes sure that external labels are added\n * together with respective elements and properly updated (DI wise)\n * during move.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {cmmnFactory} cmmnFactory\n */\nfunction LabelBehavior(eventBus, modeling, cmmnFactory) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  // create external labels on shape creation\n\n  this.postExecuted([ 'shape.create', 'connection.create' ], 200, function(e) {\n    var context = e.context;\n\n    var element = context.shape || context.connection,\n        businessObject = element.businessObject;\n\n    var position;\n\n    if (hasExternalLabel(businessObject)) {\n      position = getExternalLabelMid(element);\n\n      modeling.createLabel(element, position, {\n        id: businessObject.id + '_label',\n        hidden: !getName(element) && !isStandardEventVisible(businessObject),\n        businessObject: businessObject\n      });\n    }\n  });\n\n\n  // update label position on waypoints change if still hidden\n  this.postExecute([ 'connection.updateWaypoints' ], function(e) {\n    var context = e.context,\n        connection = context.connection,\n        label = connection.label;\n\n    if (!label) {\n      return;\n    }\n\n    if (label.hidden) {\n      var position = getExternalLabelMid(connection);\n\n      var delta = {\n        x: position.x - label.x - label.width / 2,\n        y: position.y - label.y - label.height / 2\n      };\n\n      modeling.moveShape(label, delta);\n    }\n  });\n\n\n  this.postExecute([ 'shape.replace' ], function(e) {\n    var context = e.context,\n        newShape = context.newShape,\n        oldShape = context.oldShape;\n\n    var businessObject = getBusinessObject(newShape);\n\n    if (businessObject && hasExternalLabel(businessObject)) {\n      newShape.label.x = oldShape.label.x;\n      newShape.label.y = oldShape.label.y;\n    }\n  });\n\n\n  // update di information on label creation\n  this.executed([ 'label.create' ], function(e) {\n\n    var element = e.context.shape,\n        businessObject,\n        di;\n\n    // we want to trigger on real labels only\n    if (!element.labelTarget) {\n      return;\n    }\n\n    // we want to trigger on CMMN elements only\n    if (!isAny(element.labelTarget || element, [ 'cmmn:CMMNElement', 'cmmndi:CMMNDiagramElement' ])) {\n      return;\n    }\n\n    businessObject = element.businessObject,\n    di = businessObject.di || businessObject;\n\n\n    if (!di.label) {\n      di.label = cmmnFactory.createDiLabel();\n    }\n\n    if (!di.label.bounds) {\n      di.label.bounds = cmmnFactory.createDiBounds();\n    }\n\n    assign(di.label.bounds, {\n      x: element.x,\n      y: element.y,\n      width: element.width,\n      height: element.height\n    });\n  });\n\n}\n\ninherits(LabelBehavior, CommandInterceptor);\n\nLabelBehavior.$inject = [ 'eventBus', 'modeling', 'cmmnFactory' ];\n\nmodule.exports = LabelBehavior;\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar forEach = require('min-dash').forEach,\n    unionBy = require('min-dash').unionBy,\n    filter = require('min-dash').filter;\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\nvar ModelUtil = require('../../../util/ModelUtil'),\n    is = ModelUtil.is,\n    getDefinition = ModelUtil.getDefinition,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar ModelingUtil = require('../util/ModelingUtil'),\n    getParents = ModelingUtil.getParents,\n    getParent = ModelingUtil.getParent,\n    getCase = ModelingUtil.getCase,\n    isLabel = ModelingUtil.isLabel;\n\nvar PlanItemDefinitionUtil = require('../util/PlanItemDefinitionUtil'),\n    getAllDiscretionaryItems = PlanItemDefinitionUtil.getAllDiscretionaryItems,\n    getDirectItemCapables = PlanItemDefinitionUtil.getDirectItemCapables,\n    isItemCapable = PlanItemDefinitionUtil.isItemCapable,\n    isHumanTask = PlanItemDefinitionUtil.isHumanTask;\n\nvar LOW_PRIORITY = 400;\n\n/**\n * A handler responsible for updating the parent relation of a plan item definition\n * to the underlying CMMN 1.1 XML once changes on the diagram happen.\n */\nfunction PlanItemDefinitionUpdater(\n    eventBus,\n    modeling,\n    cmmnReplace,\n    itemRegistry\n) {\n\n  this._modeling = modeling;\n  this._cmmnReplace = cmmnReplace;\n  this._itemRegistry = itemRegistry;\n\n  var self = this;\n\n  CommandInterceptor.call(this, eventBus);\n\n  var containment = 'planItemDefinitions';\n\n\n  // CREATION //////////////////////////////////////////////////////////\n\n  this.postExecuted('shape.create', function(context) {\n\n    var shape = context.shape;\n\n    if (!isItemCapable(shape)) {\n      return;\n    }\n\n    var item = getBusinessObject(shape),\n        definition = getDefinition(item),\n        parent = getParentStage(item);\n\n    if (!getParent(definition)) {\n      modeling.updateSemanticParent(definition, parent, containment);\n    }\n\n  }, true);\n\n\n  this.postExecuted('shape.replace', function(context) {\n\n    var newShape = context.newShape;\n\n    if (!isItemCapable(newShape)) {\n      return;\n    }\n\n    self.updatePlanItemDefinitions([ newShape ]);\n\n  }, true);\n\n\n  // DELETION //////////////////////////////////////////////////////////\n\n  this.postExecuted('shape.delete', function(context) {\n\n    var shape = context.shape,\n        definition,\n        update = {};\n\n    if (!isItemCapable(shape) || isLabel(shape)) {\n      return;\n    }\n\n    definition = getDefinition(shape);\n    update[definition.id] = definition;\n    self.deletePlanItemDefinitions(update);\n\n  }, true);\n\n\n  this.preExecuted('shape.delete', function(context) {\n\n    var shape = context.shape,\n        definition = getDefinition(shape);\n\n    if (!isHumanTask(definition) || definition.$parent) {\n      return;\n    }\n\n    // get remaining discretionary items\n    context.discretionaryItems = context.discretionaryItems || getAllDiscretionaryItems(definition);\n\n  }, true);\n\n\n  this.postExecuted('shape.delete', LOW_PRIORITY, function(context) {\n\n    var discretionaryItems = context.discretionaryItems,\n        shapes = [];\n\n    forEach(discretionaryItems, function(item) {\n      var shapeItem = itemRegistry.getShape(item.id);\n\n      if (shapeItem) {\n        shapes.push(shapeItem);\n      }\n\n    });\n\n    if (shapes && shapes.length) {\n      self.updatePlanItemDefinitions(shapes);\n    }\n\n  }, true);\n\n\n  // MOVING //////////////////////////////////////////////////////////////\n\n  this.preExecuted('elements.move', function(context) {\n\n    var allShapes = context.closure.allShapes,\n        newParent = context.newParent,\n        hints = context.hints,\n        oldParent = hints && hints.primaryShape && hints.primaryShape.parent,\n        replacements = {},\n        shapes, // array of moved item capables\n        movedItemCapables = {}, // grouped by definition\n        newTargetCase;\n\n    if (!newParent || oldParent === newParent) {\n      return;\n    }\n\n    newTargetCase = getCase(newParent);\n\n    shapes = filter(allShapes, function(shape) {\n\n      if (isItemCapable(shape) && !isLabel(shape) && getCase(shape) !== newTargetCase) {\n\n        var definition = getDefinition(shape);\n        movedItemCapables[definition.id] = movedItemCapables[definition.id] || [];\n        movedItemCapables[definition.id].push(shape);\n\n        return true;\n      }\n\n      return false;\n    });\n\n\n    forEach(shapes, function(shape) {\n\n      var definition = getDefinition(shape),\n          referencedBy,\n          movedShapes,\n          newDefinition;\n\n      if (replacements[definition.id]) {\n        newDefinition = replacements[definition.id];\n      }\n\n      else {\n\n        referencedBy = itemRegistry.getReferences(definition.id);\n        movedShapes = movedItemCapables[definition.id];\n\n        if (referencedBy.length > movedShapes.length) {\n          newDefinition = replacements[definition.id] = cmmnReplace.replacePlanItemDefinition(definition);\n        }\n\n      }\n\n      if (newDefinition && newDefinition !== definition) {\n        modeling.updateProperties(shape, {\n          definitionRef: newDefinition\n        });\n      }\n\n    });\n\n    // remember replacement of definitions\n    context.definitionReplacements = replacements;\n\n  }, true);\n\n\n  this.postExecuted('elements.move', LOW_PRIORITY, function(context) {\n\n    var shapes = context.shapes,\n        newParent = context.newParent,\n        oldParent = (context.hints && context.hints.oldParent);\n\n    if (!newParent || oldParent === newParent) {\n      return;\n    }\n\n    shapes = filter(shapes, function(shape) {\n      return isItemCapable(shape) && !isLabel(shape);\n    });\n\n    if (shapes && shapes.length) {\n      self.updatePlanItemDefinitions(shapes);\n    }\n\n  }, true);\n\n\n  // CONNECTIONS //////////////////////////////////////////////////////////////\n\n  this.postExecuted([\n    'connection.create',\n    'connection.delete',\n    'connection.reconnectEnd',\n    'connection.reconnectStart'\n  ], LOW_PRIORITY, function(context) {\n\n    var connection = context.connection,\n        source = context.newSource || context.source || connection.source,\n        target = context.newTarget || context.target || connection.target,\n        shapes = [];\n\n    if (!isDiscretionaryConnection(connection, source, target)) {\n      return;\n    }\n\n    if (connection.target) {\n      shapes.push(connection.target);\n    }\n\n    if (!connection.target && context.target) {\n      shapes.push(context.target);\n    }\n\n    if (context.oldTarget) {\n      shapes.push(context.oldTarget);\n    }\n\n    if (shapes && shapes.length) {\n      self.updatePlanItemDefinitions(shapes);\n    }\n\n  }, true);\n\n\n  // API ////////////////////////////////////////////////////////\n\n  /**\n   * Deletes the given plan item definitions.\n   *\n   * A plan item definition is deleted when it is not\n   * referenced by a plan item or a discretionary item.\n   *\n   * @param {Array<ModdleElement>} definitions to delete\n   */\n  this.deletePlanItemDefinitions = function(definitions) {\n    var references;\n\n    forEach(definitions, function(definition) {\n      references = itemRegistry.getReferences(definition);\n      if (!references.length) {\n        modeling.updateSemanticParent(definition, null, containment);\n      }\n    });\n  };\n\n\n\n  /**\n   * Rearrange the plan item definitions of the given shapes.\n   *\n   * @param {Array<djs.model.Base>} shapes\n   */\n  this.updatePlanItemDefinitions = function(shapes) {\n\n    handleEachItemCapable(shapes, function(shape) {\n\n      var item = getBusinessObject(shape),\n          definition = getDefinition(item),\n          references = itemRegistry.getReferences(definition),\n          sharedParent = getSharedParent(references);\n\n      if (!sharedParent) {\n        sharedParent = getCasePlanModel(item);\n      }\n\n      if (sharedParent && sharedParent !== definition.$parent) {\n        modeling.updateSemanticParent(definition, sharedParent, containment);\n      }\n\n      var itemCapables = getDirectItemCapables(definition),\n          children = [];\n\n      if (is(definition, 'cmmn:PlanFragment') && shape.children && shape.children.length) {\n        forEach(shape.children, function(child) {\n          var bo = getBusinessObject(child);\n          if (isItemCapable(bo) && !isLabel(bo) && itemCapables.indexOf(bo) === -1) {\n            children.push(bo);\n          }\n        });\n\n      }\n\n      return unionBy('id', itemCapables, children);\n\n    });\n\n  };\n\n\n  // UTILITIES ///////////////////////////////////////////////////////////////\n\n\n  function handleEachItemCapable(elements, fn) {\n\n    var handledElements = {};\n\n    function handled(element) {\n      handledElements[element.id] = element;\n    }\n\n    function isHandled(element) {\n      return !!handledElements[element.id];\n    }\n\n    function eachElement(elements, isRoot) {\n      forEach(elements, function(element) {\n\n        if (!isHandled(element)) {\n          handled(element);\n\n          element = itemRegistry.getShape(element.id) || element;\n          var children = fn(element);\n\n          if (children && children.length) {\n            eachElement(children);\n          }\n        }\n\n        if (isRoot) {\n          handledElements = {};\n        }\n\n      });\n    }\n\n    eachElement(elements, true);\n  }\n\n}\n\nPlanItemDefinitionUpdater.$inject = [\n  'eventBus',\n  'modeling',\n  'cmmnReplace',\n  'itemRegistry'\n];\n\ninherits(PlanItemDefinitionUpdater, CommandInterceptor);\n\nmodule.exports = PlanItemDefinitionUpdater;\n\n\n/**\n * Utilities\n */\n\nfunction getSharedParent(elements) {\n\n  var sharedParent,\n      first;\n\n  if (elements.length) {\n\n    first = elements.splice(0, 1)[0];\n\n    if (!elements.length) {\n      sharedParent = getParentStage(first);\n    }\n    else {\n      var candidates = getParentStages(first);\n      forEach(elements, function(e) {\n        candidates = intersection(candidates, getParentStages(e));\n      });\n\n      sharedParent = candidates[0];\n    }\n\n  }\n\n  return sharedParent;\n\n}\n\n\nfunction getParentStage(element) {\n  element = getBusinessObject(element);\n  return getParent(element, 'cmmn:Stage');\n}\n\n\nfunction getParentStages(element) {\n  element = getBusinessObject(element);\n  return getParents(element, 'cmmn:Stage');\n}\n\n\nfunction getCasePlanModel(element) {\n  var _case = getParent(element, 'cmmn:Case');\n  return _case && _case.casePlanModel;\n}\n\n\nfunction isDiscretionaryConnection(connection, source, target) {\n  return !connection.businessObject.cmmnElementRef;\n}\n\n\n// helpers /////////////////\n\nfunction intersection(a, b) {\n\n  return filter(a, function(e) {\n    return b.indexOf(e) !== -1;\n  });\n}","'use strict';\n\nvar inherits = require('inherits');\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\nvar some = require('min-dash').some,\n    forEach = require('min-dash').forEach;\n\nvar ModelUtil = require('../../../util/ModelUtil'),\n    is = ModelUtil.is,\n    isCasePlanModel = ModelUtil.isCasePlanModel,\n    getDefinition = ModelUtil.getDefinition,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar getParent = require('../util/ModelingUtil').getParent,\n    isLabel = require('../util/ModelingUtil').isLabel,\n    getParents = require('../util/ModelingUtil').getParents;\n\nvar PlanItemDefinitionUtil = require('../util/PlanItemDefinitionUtil'),\n    isDiscretionaryToHumanTask = PlanItemDefinitionUtil.isDiscretionaryToHumanTask,\n    isDiscretionaryItem = PlanItemDefinitionUtil.isDiscretionaryItem,\n    isPlanFragment = PlanItemDefinitionUtil.isPlanFragment,\n    getAllDiscretionaryItems = PlanItemDefinitionUtil.getAllDiscretionaryItems,\n    isHumanTask = PlanItemDefinitionUtil.isHumanTask;\n\n\n/**\n * A handler responsible for adding, moving and deleting discretionary items\n * and adding them to planning table. These changes are reflected to\n * the underlying CMMN 1.1 XML.\n */\nfunction PlanningTableUpdater(eventBus, cmmnFactory, modeling, itemRegistry) {\n\n  this._cmmnFactory = cmmnFactory;\n  this._modeling = modeling;\n  this._itemRegistry = itemRegistry;\n\n  var self = this;\n\n  CommandInterceptor.call(this, eventBus);\n\n  var containment = 'tableItems';\n\n  // CONNECTION /////////////////////////////////////////////\n\n\n  // delete + reconnectEnd //////////////////////////////////\n\n\n  this.preExecuted([ 'connection.delete', 'connection.reconnectEnd', 'connection.reconnectStart' ], function(event) {\n\n    var context = event.context,\n        isReconnectStart = (event.command === 'connection.reconnectStart'),\n        connection = context.connection,\n        target = connection.target;\n\n    if (!isDiscretionaryConnection(connection)) {\n      return;\n    }\n\n    if (isReconnectStart) {\n\n      if (context.newSource && context.newTarget) {\n        target = context.newSource;\n        context.oldPlanningTable = getParentPlanningTable(target);\n      }\n      else {\n        return;\n      }\n\n    }\n\n    // (1) remember current\n    context.planningTable = getParentPlanningTable(target);\n\n    // (2) if the target did not change, then do nothing (in case of reconnectEnd)\n    if (target === context.newTarget) {\n      return;\n    }\n\n    // (3) is there at least another discretionary connection referencing\n    // this target.\n    // note: there could be multiple plan items (with the same definition -\n    // human task) referencing the same discretionary item. in such case\n    // the deletion/reconnection of a discretionary connection does not trigger\n    // the deletion of the other discretionary connections. As a result, the\n    // the discretionary item remains in its current planning table.\n    if (isReferencedByAnotherDiscretionaryConnection(target, connection)) {\n      return;\n    }\n\n    // (4) get new target definition of discretionary item\n    var definition = getTargetDefinition(target.parent);\n\n    // (5) create a planning table if necessary\n    var planningTable = self.createPlanningTable(definition);\n\n    // (6) move (current target) discretionary item from current planning table\n    // to the new planning table\n    modeling.updateSemanticParent(target, planningTable, containment);\n\n  });\n\n\n  this.postExecuted('connection.delete', function(context) {\n\n    if (!isDiscretionaryConnection(context.connection)) {\n      return;\n    }\n\n    // triggers deletion of planning table if it is empty\n    self.deletePlanningTable(context.planningTable);\n\n  }, true);\n\n\n  this.postExecuted('connection.reconnectEnd', function(context) {\n\n    var connection = context.connection,\n        target = connection.target;\n\n    if (!isDiscretionaryConnection(connection)) {\n      return;\n    }\n\n    // (1) remember old planning table of new target\n    var oldPlanningTable = getParentPlanningTable(target);\n\n    // (2) add new target as discretionary item into the planning table of the source element\n    modeling.updateSemanticParent(target, context.planningTable, containment);\n\n    // (3) remove old planning table if its empty\n    self.deletePlanningTable(oldPlanningTable);\n\n  }, true);\n\n\n  this.postExecuted('connection.reconnectStart', function(context) {\n\n    var connection = context.connection;\n\n    if (!isDiscretionaryConnection(connection)) {\n      return;\n    }\n\n    if (!context.newSource || !context.newTarget) {\n      return;\n    }\n\n    self.deletePlanningTable(context.oldPlanningTable);\n\n  }, true);\n\n  // create + reconnectStart ////////////////////////////////////////\n\n  this.preExecuted([ 'connection.create', 'connection.reconnectStart' ], function(context) {\n\n    var connection = context.connection,\n        source = context.newSource || context.source,\n        target = context.target || context.newTarget || connection.target;\n\n    if (!isDiscretionaryConnection(connection)) {\n      return;\n    }\n\n    // (1) remember planning table of target discretionary item\n    context.planningTable = getParentPlanningTable(target);\n\n    var definition = getDefinition(source);\n\n    if (connection.source) {\n      var oldDefinition = getDefinition(connection.source);\n      if (oldDefinition === definition) {\n        return;\n      }\n    }\n\n    // (2) create a planning table if necessary\n    var planningTable = self.createPlanningTable(definition);\n\n    // (3) add target discretionary item to planning table\n    modeling.updateSemanticParent(target, planningTable, containment);\n\n  }, true);\n\n\n  this.postExecuted([ 'connection.create', 'connection.reconnectStart' ], function(context) {\n\n    var connection = context.connection;\n    if (!isDiscretionaryConnection(connection)) {\n      return;\n    }\n\n    // remove planning table if its empty\n    self.deletePlanningTable(context.planningTable);\n\n  }, true);\n\n\n  // SHAPE /////////////////////////////////////////////////////////////////////////////\n\n  this.preExecuted('elements.move', 500, function(context) {\n\n    var allShapes = context.closure.allShapes,\n        newParent = context.newParent,\n        hints = context.hints,\n        oldParent = hints && hints.primaryShape && hints.primaryShape.parent,\n        replacements = context.definitionReplacements,\n        replacedPlanningTableArray = [],\n        planningTableReplacedBy = {};\n\n\n    function clonePlanningTable(planningTable) {\n      var newPlanningTable = cmmnFactory.create('cmmn:PlanningTable', {\n        applicabilityRules: planningTable.applicabilityRules\n      });\n      var idx = replacedPlanningTableArray.push(planningTable);\n      planningTableReplacedBy[idx-1] = newPlanningTable;\n\n      return newPlanningTable;\n    }\n\n\n    if (!newParent || oldParent === newParent) {\n      return;\n    }\n\n\n    forEach(allShapes, function(shape) {\n\n      var bo = getBusinessObject(shape),\n          newPlanningTables = [],\n          discretionaryTo,\n          replacedBy,\n          items,\n          planningTables,\n          previousPlanningTable;\n\n\n      if (!isDiscretionaryItem(shape) || isLabel(shape)) {\n        return;\n      }\n\n      discretionaryTo = getParent(bo, 'cmmn:PlanItemDefinition');\n      if (!is(discretionaryTo, 'cmmn:HumanTask')) {\n        return;\n      }\n\n      replacedBy = replacements[discretionaryTo.id];\n      if (!replacedBy) {\n        return;\n      }\n\n      // discretionary item is already contained by replacement\n      if ((getAllDiscretionaryItems(replacedBy) || []).indexOf(bo) !== -1) {\n        return;\n      }\n\n      // have been all contained discretionary items moved?\n      items = getAllDiscretionaryItems(discretionaryTo);\n      var allMoved = !some(items, function(item) {\n        return !allShapes[item.id];\n      });\n\n\n      if (allMoved) {\n\n        // if yes, then just move planning table to replacement\n\n        var planningTable = discretionaryTo.planningTable;\n\n        modeling.updateProperties(replacedBy, {\n          planningTable: planningTable\n        }, itemRegistry.getShapes(replacedBy));\n\n        modeling.updateSemanticParent(planningTable, replacedBy);\n\n        modeling.updateProperties(discretionaryTo, {\n          planningTable: undefined\n        }, itemRegistry.getShapes(discretionaryTo));\n\n        return;\n      }\n\n\n      planningTables = getParents(bo, 'cmmn:PlanningTable');\n\n      if (planningTables && planningTables.length) {\n\n        forEach(planningTables, function(planningTable) {\n\n          var idx = replacedPlanningTableArray.indexOf(planningTable),\n              newPlanningTable;\n\n          if (idx === -1) {\n            newPlanningTable = clonePlanningTable(planningTable);\n          }\n          else {\n            newPlanningTable = planningTableReplacedBy[idx];\n          }\n\n          if (previousPlanningTable && !previousPlanningTable.$parent) {\n            modeling.updateSemanticParent(previousPlanningTable, newPlanningTable, 'tableItems');\n          }\n\n          previousPlanningTable = newPlanningTable;\n          newPlanningTables.push(newPlanningTable);\n\n        });\n\n        if (!replacedBy.planningTable) {\n\n          modeling.updateProperties(replacedBy, {\n            planningTable: previousPlanningTable\n          }, itemRegistry.getShapes(replacedBy));\n          modeling.updateSemanticParent(previousPlanningTable, replacedBy);\n\n        }\n\n        var first = newPlanningTables.splice(0, 1)[0],\n            oldPlanningTable = getParentPlanningTable(bo);\n\n        modeling.updateSemanticParent(bo, first, 'tableItems');\n\n        self.deletePlanningTable(oldPlanningTable);\n      }\n\n    });\n\n  }, true);\n\n\n  this.preExecuted([ 'shape.create', 'shape.move' ], function(context) {\n\n    var shape = context.shape;\n\n    if (!isDiscretionaryItem(shape) || isLabel(shape)) {\n      return;\n    }\n\n    // (1) if is discretionary to human task, then there is nothing to do\n    // in case of 'shape.move'\n    if (isDiscretionaryToHumanTask(shape)) {\n      return;\n    }\n\n    // remember old planning table\n    context.planningTable = getParentPlanningTable(shape);\n\n    var newParent = context.parent || context.newParent;\n\n    if (newParent) {\n\n      // (2) parent changed\n\n      var definition = getTargetDefinition(newParent);\n\n      // (3) create new planning table if necessary\n      var planningTable = self.createPlanningTable(definition);\n\n      // (4) add discretionary item to planning table\n      modeling.updateSemanticParent(shape, planningTable, containment);\n    }\n\n  }, true);\n\n\n  this.postExecuted('shape.move', function(context) {\n\n    var shape = context.shape;\n\n    if (!isDiscretionaryItem(shape) || isLabel(shape)) {\n      return;\n    }\n\n    // if an item which is discretionary to a human task is moved,\n    // then no update is necessary\n    if (isDiscretionaryToHumanTask(shape)) {\n      return;\n    }\n\n    self.deletePlanningTable(context.planningTable);\n\n  }, true);\n\n\n  this.preExecuted('shape.delete', function(context) {\n\n    var shape = context.shape;\n\n    if (!isDiscretionaryItem(shape) || isLabel(shape)) {\n      return;\n    }\n\n    // remember old planning table\n    context.planningTable = getParentPlanningTable(shape);\n\n    // remove discretionary item from planning table\n    modeling.updateSemanticParent(shape, null, containment);\n\n  }, true);\n\n\n  this.postExecuted('shape.delete', function(context) {\n\n    var shape = context.shape;\n\n    if (!isDiscretionaryItem(shape) || isLabel(shape)) {\n      return;\n    }\n\n    self.deletePlanningTable(context.planningTable);\n\n  }, true);\n\n\n  this.postExecuted('shape.delete', 500, function(context) {\n\n    var shape = context.shape;\n\n    var definition = getDefinition(shape);\n\n    if (!isHumanTask(definition) || definition.$parent) {\n      return;\n    }\n\n    var discretionaryItems = getAllDiscretionaryItems(definition);\n\n    // repair the model\n    forEach(discretionaryItems, function(item) {\n      var shapeItem = itemRegistry.getShape(item.id);\n\n      if (shapeItem) {\n        // get new target definition of discretionary item\n        var definition = getTargetDefinition(shapeItem.parent);\n\n        // create a planning table if necessary\n        var planningTable = self.createPlanningTable(definition);\n\n        // move (current target) discretionary item from current planning table\n        // to the new planning table\n        modeling.updateSemanticParent(shapeItem, planningTable, containment);\n      }\n\n    });\n\n    if (definition.planningTable) {\n      self.deletePlanningTable(definition.planningTable);\n    }\n\n  }, true);\n\n  // API ////////////////////////////////////////////////////////\n\n  /**\n   * Creates a new planning table for the given definition, if necessary.\n   *\n   * If the given definition already contains a planning table, this\n   * planning table is returned.\n   *\n   * @param {ModdleElement} definition where the planning table is added\n   *\n   * @return {ModdleElement} the create planning table\n   */\n  this.createPlanningTable = function(definition) {\n\n    var planningTable = definition.planningTable;\n\n    if (!planningTable) {\n\n      // (1) create new planning table\n      planningTable = self._cmmnFactory.create('cmmn:PlanningTable');\n\n      // (2) filter all items which are affected by adding a planning\n      // table to its definition\n      var shapes = itemRegistry.getShapes(definition);\n\n      // (3) set planning table\n      modeling.updateProperties(definition, {\n        planningTable: planningTable\n      }, shapes);\n\n      // (4) set parent of planning table to definition\n      modeling.updateSemanticParent(planningTable, definition);\n    }\n\n\n    return planningTable;\n  };\n\n\n  /**\n   * Deletes a given planning table from the definition. If the planning\n   * table is nested inside other planning tables, then the plannings tables\n   * are also deleted, if they do not contain any element.\n   *\n   * @param {ModdleElement} planningTable to delete\n   *\n   */\n  this.deletePlanningTable = function(planningTable) {\n\n    // According to spec: a planning table must contain at least one element.\n    // if it does not contain any element, then the planning table is deleted.\n\n    // (1) cannot delete planning table if contains at least one element\n    if (planningTable.get(containment).length > 0) {\n      return;\n    }\n\n    // (2) if planning table does not contain any element, then remove it\n    var oldParent = planningTable.$parent;\n    while (is(oldParent, 'cmmn:PlanningTable') && !planningTable.get(containment).length) {\n      modeling.updateSemanticParent(planningTable, null, containment);\n      planningTable = oldParent;\n      oldParent = oldParent.$parent;\n    }\n\n    if (is(oldParent, 'cmmn:PlanItemDefinition')) {\n\n      if (planningTable && !planningTable.get(containment).length) {\n\n        // (3) get definition containing this planning table\n        var definition = getParent(planningTable, 'cmmn:PlanItemDefinition');\n\n        // (4) filter all items which are affected by removing this planning\n        // table from its definition\n        var shapes = itemRegistry.getShapes(definition);\n\n        // (5) set planning table attribute to undefined\n        modeling.updateProperties(definition, {\n          planningTable: undefined\n        }, shapes);\n\n        // (6) set planning tables parent to null\n        modeling.updateSemanticParent(planningTable, null, null);\n      }\n    }\n  };\n\n\n  /**\n   * Returns true, if there is another incoming discretionary connection\n   * apart the given connection.\n   *\n   * @param {djs.mode.Base} shape\n   * @param {djs.mode.Base} connection\n   *\n   * @return {boolean} if there is another incoming discretionary connection\n   */\n  function isReferencedByAnotherDiscretionaryConnection(shape, connection) {\n    return some(shape.incoming, function(con) {\n      return con !== connection && isDiscretionaryConnection(con);\n    });\n  }\n\n\n  function isDiscretionaryConnection(connection) {\n    return !connection.businessObject.cmmnElementRef;\n  }\n\n}\n\nPlanningTableUpdater.$inject = [\n  'eventBus',\n  'cmmnFactory',\n  'modeling',\n  'itemRegistry'\n];\n\ninherits(PlanningTableUpdater, CommandInterceptor);\n\nmodule.exports = PlanningTableUpdater;\n\n\nfunction getTargetDefinition(shape) {\n  var target = fixTarget(shape);\n  return getDefinition(target) || getBusinessObject(target);\n}\n\n/**\n * Fixes the target.\n * A discretionary item cannot be added to plan fragment,\n * in that case the discretionary item is added to the visual\n * surrounding stage.\n *\n * @param {djs.model.Base} target\n *\n * @return {djs.model.Base} the fixed target\n */\nfunction fixTarget(target) {\n  if (target && !isCasePlanModel(target)) {\n\n    var definition = getDefinition(target);\n\n    if (isPlanFragment(definition)) {\n      target = getParent(target, [\n        'cmmn:Stage',\n        'cmmn:PlanItem',\n        'cmmn:DiscretionaryItem'\n      ]);\n      target = fixTarget(target);\n    }\n  }\n\n  return target;\n}\n\n\n/**\n * Returns parent planning table of the given element.\n *\n * @param {ModdleElement} element\n *\n * @param {ModdleElement} the parent planning table\n */\nfunction getParentPlanningTable(element) {\n  element = getBusinessObject(element);\n  return getParent(element, 'cmmn:PlanningTable');\n}\n","'use strict';\n\nvar forEach = require('min-dash').forEach,\n    inherits = require('inherits'),\n    assign = require('min-dash').assign;\n\nvar isArray = require('min-dash').isArray;\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\nvar is = require('../../../util/ModelUtil').is;\n\nvar LOW_PRIORITY = 200,\n    HIGH_PRIORITY = 5000;\n\nfunction ReplaceConnectionBehavior(eventBus, modeling, cmmnRules, selection, rules) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function canConnectPlanItemOnPartConnection(source, target) {\n    return cmmnRules.canConnectPlanItemOnPartConnection(source, target);\n  }\n\n\n  function canConnectCaseFileItemOnPartConnection(source, target) {\n    return cmmnRules.canConnectCaseFileItemOnPartConnection(source, target);\n  }\n\n\n  function canConnectDiscretionaryConnection(source, target, connection) {\n    return cmmnRules.canConnectDiscretionaryConnection(source, target, connection);\n  }\n\n\n  function canConnectAssociation(source, target) {\n    return cmmnRules.canConnectAssociation(source, target);\n  }\n\n\n  function canReconnect(type, attrs) {\n    return rules.allowed(type, attrs);\n  }\n\n  function fixConnection(connection, source, target, hints) {\n\n    var parent = connection.parent;\n\n    hints = hints || {};\n    source = source || connection.source;\n    target = target || connection.target;\n\n    if (!parent) {\n      return;\n    }\n\n    var remove,\n        replacement,\n        cmmnElement = getCmmnElement(connection);\n\n    /**\n     * Check if incoming or outgoing connections can stay and/or replaced.\n     */\n\n    if (cmmnElement) {\n\n      if (is(cmmnElement, 'cmmn:PlanItemOnPart')) {\n\n        if (!canConnectPlanItemOnPartConnection(source, target)) {\n          remove = true;\n        }\n\n        if (canConnectCaseFileItemOnPartConnection(source, target)) {\n          replacement = {\n            type: 'cmmn:CaseFileItemOnPart',\n            name: cmmnElement.name,\n            isStandardEventVisible: isStandardEventVisible(connection)\n          };\n        }\n\n        if (canConnectDiscretionaryConnection(source, target, connection)) {\n          replacement = {\n            type: 'cmmndi:CMMNEdge'\n          };\n        }\n\n      }\n\n\n      if (is(cmmnElement, 'cmmn:CaseFileItemOnPart')) {\n\n        if (!canConnectCaseFileItemOnPartConnection(source, target)) {\n          remove = true;\n        }\n\n        if (canConnectPlanItemOnPartConnection(source, target)) {\n          replacement = {\n            type: 'cmmn:PlanItemOnPart',\n            name: cmmnElement.name,\n            isStandardEventVisible: isStandardEventVisible(connection)\n          };\n        }\n\n      }\n\n      if (is(cmmnElement, 'cmmn:Association') && !canConnectAssociation(source, target)) {\n        remove = true;\n      }\n\n    }\n    else {\n\n      if (!canConnectDiscretionaryConnection(source, target, connection)) {\n        remove = true;\n      }\n\n      if (canConnectPlanItemOnPartConnection(source, target)) {\n        replacement = {\n          type: 'cmmn:PlanItemOnPart',\n          isStandardEventVisible: true\n        };\n      }\n\n    }\n\n    if (remove) {\n\n      if (!replacement && (isTextAnnotation(source) || isTextAnnotation(target))) {\n\n        replacement = {\n          type: 'cmmn:Association'\n        };\n      }\n\n      modeling.removeConnection(connection);\n    }\n\n    if (replacement) {\n\n      var attrs = assign({\n        waypoints: connection.waypoints.slice()\n      }, replacement);\n\n      var newConnection = modeling.connect(source, target, attrs);\n\n      if (hints.select !== false) {\n        selection.select(newConnection);\n      }\n\n      return newConnection;\n\n    }\n\n  }\n\n\n  this.postExecuted('elements.move', LOW_PRIORITY, function(context) {\n\n    var closure = context.closure,\n        allConnections = closure.allConnections;\n\n    forEach(allConnections, function(connection) {\n      fixConnection(connection, null, null, {\n        select: false\n      });\n    });\n\n  }, true);\n\n\n  this.preExecute([\n    'connection.reconnectEnd',\n    'connection.reconnectStart'\n  ], HIGH_PRIORITY + LOW_PRIORITY, function(event) {\n\n    var type = event.command,\n        isReconnectStart = (type === 'connection.reconnectStart'),\n        context = event.context,\n        connection = context.connection,\n        source = context.newSource || connection.source,\n        target = context.newTarget || connection.target,\n        dockingOrPoints = context.dockingOrPoints,\n        canExecute = context.canExecute;\n\n    if (context.hints && context.hints.nested) {\n      return;\n    }\n\n    if (canExecute === undefined) {\n\n      var attrs = {\n        connection: connection\n      };\n\n      attrs[ isReconnectStart ? 'hover' : 'source' ] = source;\n      attrs[ !isReconnectStart ? 'hover' : 'target' ] = target;\n\n      canExecute = canReconnect(type, attrs);\n\n    }\n\n    if (canExecute && canExecute.reverse) {\n\n      if (!isArray(dockingOrPoints)) {\n        var waypoints = connection.waypoints.slice();\n        waypoints.splice(isReconnectStart ? 0 : -1, 1, dockingOrPoints);\n        dockingOrPoints = waypoints;\n      }\n\n      context.newSource = target;\n      context.newTarget = source;\n      context.dockingOrPoints = dockingOrPoints.reverse();\n\n    }\n\n  });\n\n\n  this.preExecute([\n    'connection.reconnectStart',\n    'connection.reconnectEnd'\n  ], HIGH_PRIORITY, function(context) {\n\n    var connection = context.connection,\n        source = context.newSource || connection.source,\n        target = context.newTarget || connection.target,\n        hints = context.hints || {};\n\n    context.connection = fixConnection(connection, source, target, {\n      select: !hints.nested\n    }) || connection;\n\n  }, true);\n\n\n  this.postExecuted('shape.replace', function(context) {\n\n    var shape = context.newShape,\n        bo = shape.businessObject,\n        connections = getAttachersOutgoingConnections(shape);\n\n    forEach(connections, function(connection) {\n\n      var source = connection.source,\n          target = connection.target,\n          cmmnElement = getCmmnElement(connection);\n\n      if (is(cmmnElement, 'cmmn:PlanItemOnPart')) {\n\n        if (canConnectPlanItemOnPartConnection(source, target)) {\n          modeling.updateProperties(cmmnElement, { sourceRef: bo }, connection);\n        }\n        else {\n          modeling.removeConnection(connection);\n        }\n\n      }\n\n    });\n\n  }, true);\n\n\n  this.postExecuted('element.updateProperties', function(context) {\n\n    var properties = context.properties,\n        changed = context.changed;\n\n    if (properties && properties.isBlocking === false) {\n\n      forEach(changed, function(shape) {\n\n        var connections = shape.outgoing;\n\n        forEach(connections, function(connection) {\n          fixConnection(connection, null, null, {\n            select: false\n          });\n        });\n\n      });\n\n    }\n\n  }, true);\n\n}\n\ninherits(ReplaceConnectionBehavior, CommandInterceptor);\n\nReplaceConnectionBehavior.$inject = [ 'eventBus', 'modeling', 'cmmnRules', 'selection', 'rules' ];\n\nmodule.exports = ReplaceConnectionBehavior;\n\n\nfunction isStandardEventVisible(connection) {\n  return connection.businessObject.isStandardEventVisible;\n}\n\nfunction getCmmnElement(connection) {\n  return connection.businessObject && connection.businessObject.cmmnElementRef;\n}\n\nfunction getAttachersOutgoingConnections(shape) {\n\n  var attachers = shape.attachers,\n      connections = [];\n\n  forEach(attachers, function(attacher) {\n    forEach(attacher.outgoing, function(connection) {\n      connections.push(connection);\n    });\n  });\n\n  return connections;\n}\n\nfunction isTextAnnotation(element) {\n  return is(element, 'cmmn:TextAnnotation');\n}","'use strict';\n\nvar inherits = require('inherits');\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\nvar saveClear = require('diagram-js/lib/util/Removal').saveClear;\n\nvar ModelUtil = require('../../../util/ModelUtil'),\n    is = ModelUtil.is,\n    getDefinition = ModelUtil.getDefinition,\n    getSentry = ModelUtil.getSentry;\n\nvar forEach = require('min-dash').forEach,\n    filter = require('min-dash').filter,\n    assign = require('min-dash').assign;\n\nvar HIGH_PRIORITY = 6000,\n    LOW_PRIORITY = 500,\n    VERY_LOW_PRIORITY = 100;\n\n\nfunction ReplaceElementBehavior(\n    cmmnReplace,\n    cmmnRules,\n    elementFactory,\n    elementRegistry,\n    eventBus,\n    modeling,\n    selection,\n    rules\n) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this._cmmnReplace = cmmnReplace;\n  this._cmmnRules = cmmnRules;\n  this._elementFactory = elementFactory;\n  this._elementRegistry = elementRegistry;\n  this._modeling = modeling;\n  this._selection = selection;\n  this._rules = rules;\n\n  var self = this;\n\n\n  function canConnect(source, target) {\n\n    return rules.allowed('connection.create', {\n      source: source,\n      target: target\n    });\n\n  }\n\n  function canReconnect(type, attrs) {\n    return rules.allowed(type, attrs);\n  }\n\n\n  // SHAPES //////////////////////////////////////////////////////////////////\n\n  this.preExecute([ 'shape.create', 'shape.append' ], HIGH_PRIORITY, function(context) {\n\n    var shape = context.shape,\n        source = context.source,\n        target = context.parent || context.target || (source && source.parent),\n        host = context.host,\n        position = context.position,\n        hints = context.hints || {};\n\n    if (hints.nested) {\n      return;\n    }\n\n    if (host && isCriterion(shape)) {\n      target = host;\n    }\n\n    if (!cmmnRules.canCreate(shape, target, source, position)) {\n\n      var canReplace = cmmnRules.canReplace([ shape ], target, position, source);\n\n      if (canReplace && canReplace.replacements) {\n\n        var replacement = canReplace.replacements[0],\n            definition = getDefinition(shape),\n            sentry = getSentry(shape),\n            elementType = replacement.newElementType,\n            definitionType = replacement.newDefinitionType || (definition && definition.$type);\n\n        var attrs = assign({}, {\n          type: elementType\n        });\n\n        if (definitionType) {\n          assign(attrs, {\n            definitionType: definitionType\n          });\n        }\n\n        if (sentry) {\n          assign(attrs, {\n            sentryRef: sentry\n          });\n        }\n\n        context.shape = elementFactory.createShape(attrs);\n\n      }\n\n    }\n\n  }, true);\n\n\n  this.postExecuted('elements.move', LOW_PRIORITY, function(context) {\n\n    var target = context.newParent,\n        newHost = context.newHost,\n        elements = context.shapes.slice();\n\n    if (elements.length === 1 && newHost) {\n      target = newHost;\n    }\n    else {\n      elements = filter(elements, function(elem) {\n        return !isCriterion(elem);\n      });\n    }\n\n    if (target && !cmmnRules.canMove(elements, target)) {\n\n      var canReplace = cmmnRules.canReplace(elements, target);\n\n      if (canReplace && canReplace.replacements) {\n        self.replaceElements(elements, canReplace.replacements);\n      }\n\n    }\n\n  }, true);\n\n\n  this.postExecuted([ 'shape.replace' ], 1500, function(e) {\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape;\n\n    modeling.unclaimId(oldShape.businessObject.id, oldShape.businessObject);\n    modeling.updateProperties(newShape, { id: oldShape.id });\n  });\n\n\n  // CONNECTIONS /////////////////////////////////////////////////////////////////////\n\n  this.preExecute('connection.create', HIGH_PRIORITY, function(context) {\n\n    var source = context.source,\n        target = context.target,\n        canReplace = context.canExecute || canConnect(source, target);\n\n    if (canReplace && canReplace.replacements) {\n\n      var replacements = self.replaceElements([ source, target ], canReplace.replacements, {\n        select: false\n      });\n\n      context.source = replacements[source.id] || context.source;\n      context.target = replacements[target.id] || context.target;\n\n      // remember replaced by element in canReplace object (see 'connect.end')\n      assign(canReplace, {\n        replacedBy: !canReplace.reverse ? context.target : context.source\n      });\n\n    }\n\n  }, true);\n\n\n  eventBus.on('connect.end', LOW_PRIORITY + VERY_LOW_PRIORITY, function(e) {\n\n    var canExecute = e.context.canExecute,\n        replacedBy = canExecute && canExecute.replacedBy;\n\n    // if target shape has been replaced, then select the\n    // new element and not the old target.\n    if (replacedBy) {\n      e.context.target = replacedBy;\n    }\n\n  });\n\n\n  this.preExecute([\n    'connection.reconnectStart',\n    'connection.reconnectEnd'\n  ], HIGH_PRIORITY, function(event) {\n\n    var type = event.command,\n        isReconnectStart = (type === 'connection.reconnectStart'),\n        context = event.context,\n        connection = context.connection,\n        source = context.newSource || connection.source,\n        target = context.newTarget || connection.target,\n        attrs = { connection: connection },\n        canReplace;\n\n    if (context.hints && context.hints.nested) {\n      return;\n    }\n\n    attrs[ isReconnectStart ? 'hover' : 'source' ] = source;\n    attrs[ !isReconnectStart ? 'hover' : 'target' ] = target;\n\n    canReplace = canReconnect(type, attrs);\n\n    if (canReplace && canReplace.replacements) {\n      var replacements = self.replaceElements([ source, target ], canReplace.replacements, {\n        select: false\n      });\n\n      context.newSource = replacements[source.id] || context.newSource;\n      context.newTarget = replacements[target.id] || context.newTarget;\n    }\n\n    // remember result in context, so that this can be re-used\n    context.canExecute = canReplace;\n\n  });\n\n\n  this.preExecute('shape.delete', HIGH_PRIORITY, function(context) {\n\n    var shape = context.shape,\n        parent = isCriterion(shape) ? shape.host : shape.parent,\n        definition = getDefinition(parent);\n\n    // if the shape to delete is contained by a plan fragment (and not stage)\n    // then remove incoming connections. Thereby an additional hint is provided\n    // to the context, so that shape delete is not replaced when the connection\n    // is deleted.\n\n    if (is(definition, 'cmmn:Stage')) {\n      return;\n    }\n\n    saveClear(shape.incoming, function(connection) {\n      modeling.removeConnection(connection, { nested: true, endChanged: true });\n    });\n\n  }, true);\n\n\n  this.postExecuted([\n    'connection.delete',\n    'connection.reconnectEnd'\n  ], LOW_PRIORITY, function(context) {\n\n    var shape = context.target || context.oldTarget,\n        elements = [ shape ],\n        target = isCriterion(shape) ? shape.host : shape.parent,\n        hints = context.hints || {};\n\n    if (hints.endChanged) {\n      return;\n    }\n\n    if (target && !cmmnRules.canMove(elements, target)) {\n\n      var canReplace = cmmnRules.canReplace(elements, target);\n\n      if (canReplace && canReplace.replacements) {\n        self.replaceElements(elements, canReplace.replacements, { select: false });\n      }\n\n    }\n\n  }, true);\n\n\n  // PROPERTIES /////////////////////////////////////////////////////////////////////\n\n  this.postExecuted('element.updateProperties', function(context) {\n\n    var properties = context.properties,\n        changed = context.changed;\n\n    if (properties && properties.isBlocking === false) {\n\n      forEach(changed, function(shape) {\n\n        var attachers = shape.attachers,\n            canReplace = cmmnRules.canReplace(attachers, shape);\n\n        if (canReplace) {\n          self.replaceElements(attachers, canReplace.replacements, { select: false });\n        }\n      });\n\n    }\n\n  }, true);\n\n\n  // API ///////////////////////////////////////////////////////////////////////////\n\n  this.replaceElements = function(elements, newElements, hints) {\n\n    var self = this;\n\n    var elementRegistry = this._elementRegistry,\n        selection = this._selection;\n\n    var executedReplacements = {};\n\n    hints = hints || {};\n\n    forEach(newElements, function(replacement) {\n\n      var oldElement = elementRegistry.get(replacement.oldElementId),\n          idx = elements.indexOf(oldElement),\n          replacedBy;\n\n      if (!oldElement) {\n        return;\n      }\n\n      replacedBy = self.replaceElement(oldElement, replacement);\n\n      if (idx !== -1) {\n        elements[idx] = replacedBy;\n      }\n\n      executedReplacements[oldElement.id] = replacedBy;\n\n    });\n\n    if (newElements && hints.select !== false) {\n      selection.select(elements);\n    }\n\n    return executedReplacements;\n\n  };\n\n\n  this.replaceElement = function(element, replacement) {\n\n    var cmmnReplace = this._cmmnReplace;\n\n    var definition = getDefinition(element),\n        definitionType = replacement.newDefinitionType || (definition && definition.$type);\n\n    if (!element) {\n      return;\n    }\n\n    var newElement = {\n      type: replacement.newElementType\n    };\n\n    if (definitionType) {\n      assign(newElement, {\n        definitionType: definitionType\n      });\n    }\n\n    return cmmnReplace.replaceElement(element, newElement, { select: false });\n\n  };\n\n}\n\n\nReplaceElementBehavior.$inject = [\n  'cmmnReplace',\n  'cmmnRules',\n  'elementFactory',\n  'elementRegistry',\n  'eventBus',\n  'modeling',\n  'selection',\n  'rules'\n];\n\ninherits(ReplaceElementBehavior, CommandInterceptor);\n\nmodule.exports = ReplaceElementBehavior;\n\n\nfunction isCriterion(element) {\n  return is(element, 'cmmn:Criterion');\n}\n","'use strict';\n\nvar ModelUtil = require('../../../util/ModelUtil');\n\nvar is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject,\n    isCasePlanModel = ModelUtil.isCasePlanModel;\n\nvar filter = require('min-dash').filter;\nvar ResizeUtil = require('diagram-js/lib/features/resize/ResizeUtil');\nvar getBBox = require('diagram-js/lib/util/Elements').getBBox;\n\nvar SLIGHTLY_HIGHER_PRIORITY = 1001;\n\nvar DEFAULT_MIN_WIDTH = 10;\n\n/**\n * Computes the minimum resize box.\n *\n * Note: it is slightly different than\n * diagram-js/lib/features/resize/Resize#computeMinResizeBox\n */\nfunction computeMinResizeBox(context) {\n  var shape = context.shape,\n      direction = context.direction,\n      minDimensions,\n      childrenBounds;\n\n  minDimensions = context.minDimensions || {\n    width: DEFAULT_MIN_WIDTH,\n    height: DEFAULT_MIN_WIDTH\n  };\n\n  // get children bounds\n  childrenBounds = computeChildrenBBox(shape, context.childrenBoxPadding);\n\n  // get correct minimum bounds from given resize direction\n  // basically ensures that the minBounds is max(childrenBounds, minDimensions)\n  return ResizeUtil.getMinResizeBounds(direction, shape, minDimensions, childrenBounds);\n}\n\n/**\n * Computes the bbox of the children.\n *\n * It first determine all relevant children,\n * then it computes the size of the bbox.\n */\nfunction computeChildrenBBox(shape, padding) {\n  // grab all the children that are part of the\n  // parents children box\n  var elements = filter(shape.children, function(element) {\n    return isBBoxChild(shape, element);\n  });\n\n  if (elements.length) {\n    return ResizeUtil.addPadding(getBBox(elements), padding);\n  }\n}\n\n/**\n * Returns true, if the given element does\n * have any waypoints, is not a label or an\n * exit criterian attached to the given shape.\n */\nfunction isBBoxChild(shape, element) {\n\n  // exclude connections\n  if (element.waypoints) {\n    return false;\n  }\n\n  // exclude labels\n  if (element.type === 'label') {\n    return false;\n  }\n\n  if (is(element, 'cmmn:ExitCriterion')) {\n    var bo = getBusinessObject(shape);\n    var exitCriteria = bo.get('exitCriteria');\n    var exitCriterion = getBusinessObject(element);\n    if (exitCriteria.indexOf(exitCriterion) >= 0) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Computes the minimum resize box by excluding\n * attached exit criteria to the case plan model.\n */\nfunction ResizeCasePlanModelBehavior(eventBus, modeling) {\n\n  eventBus.on('resize.start', SLIGHTLY_HIGHER_PRIORITY, function(event) {\n    var context = event.context,\n        shape = context.shape;\n\n    if (isCasePlanModel(shape)) {\n      context.minBounds = computeMinResizeBox(context);\n    }\n  });\n\n}\n\nResizeCasePlanModelBehavior.$inject = [ 'eventBus', 'modeling' ];\n\nmodule.exports = ResizeCasePlanModelBehavior;\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\nvar forEach = require('min-dash').forEach,\n    flatten = require('min-dash').flatten,\n    groupBy = require('min-dash').groupBy,\n    map = require('min-dash').map,\n    some = require('min-dash').some;\n\nvar ModelUtil = require('../../../util/ModelUtil'),\n    is = ModelUtil.is,\n    isCasePlanModel = ModelUtil.isCasePlanModel,\n    getSentry = ModelUtil.getSentry,\n    getBusinessObject = ModelUtil.getBusinessObject,\n    getDefinition = ModelUtil.getDefinition,\n    getStandardEvents = ModelUtil.getStandardEvents;\n\nvar getParent = require('../util/ModelingUtil').getParent;\n\nvar PlanItemDefinitionUtil = require('../util/PlanItemDefinitionUtil'),\n    isItemCapable = PlanItemDefinitionUtil.isItemCapable,\n    getAllDiscretionaryItems = PlanItemDefinitionUtil.getAllDiscretionaryItems,\n    getDirectItemCapables = PlanItemDefinitionUtil.getDirectItemCapables,\n    isHumanTask = PlanItemDefinitionUtil.isHumanTask;\n\nvar VERY_LOW_PRIORITY = 300;\n\n/**\n * A handler responsible for adding, moving and deleting sentries.\n * These changes are reflected to the underlying CMMN 1.1 XML.\n */\nfunction SentryUpdater(eventBus, modeling, itemRegistry, cmmnReplace, cmmnFactory) {\n\n  var self = this;\n\n  CommandInterceptor.call(this, eventBus);\n\n  var containment = 'sentries';\n\n\n  // CONNECTIONS ////////////////////////////////////////////////////////////\n\n  this.postExecuted('connection.create', function(context) {\n\n    var connection = context.connection;\n\n    if (!isOnPartConnection(connection)) {\n      return;\n    }\n\n    var onPart = getOnPart(connection),\n        criterion = connection.target,\n        host = criterion.host,\n        sentry = getSentry(criterion);\n\n    if (!sentry) {\n      sentry = createSentry(criterion);\n      modeling.updateSemanticParent(sentry, getSentryParent(host), 'sentries');\n    }\n\n    modeling.updateSemanticParent(onPart, sentry, 'onParts', connection);\n\n  }, true);\n\n\n  this.preExecuted('connection.delete', function(context) {\n\n    var connection = context.connection;\n\n    if (!isOnPartConnection(connection)) {\n      return;\n    }\n\n    var source = connection.source,\n        onPart = getOnPart(connection);\n\n    if (existsAnotherConnection(source, connection)) {\n      onPart = cloneOnPart(onPart);\n      setCmmnElementRef(connection, onPart);\n    }\n\n    modeling.updateSemanticParent(onPart, null, 'onParts', connection);\n\n  }, true);\n\n\n  this.preExecuted('connection.reconnectStart', function(context) {\n\n    var connection = context.connection,\n        source = connection.source;\n\n    if (!isOnPartConnection(connection)) {\n      return;\n    }\n\n    var onPart = getOnPart(connection),\n        criterion = connection.target,\n        sentry = getSentry(criterion);\n\n    if (existsAnotherConnection(source, connection)) {\n      onPart = cloneOnPart(onPart);\n      setCmmnElementRef(connection, onPart);\n      modeling.updateSemanticParent(onPart, sentry, 'onParts', connection);\n    }\n\n  }, true);\n\n\n  this.preExecuted('connection.reconnectEnd', function(context) {\n\n    var connection = context.connection,\n        source = connection.source;\n\n    if (!isOnPartConnection(connection)) {\n      return;\n    }\n\n    var onPart = getOnPart(connection),\n        oldCriterion = connection.target,\n        oldSentry = getSentry(oldCriterion),\n        newCriterion = context.newTarget,\n        newSentry = getSentry(newCriterion);\n\n    if (oldSentry === newSentry) {\n      return;\n    }\n\n    if (!newSentry) {\n      newSentry = createSentry(newCriterion);\n      modeling.updateSemanticParent(newSentry, getSentryParent(newCriterion.host), 'sentries');\n    }\n\n    if (existsAnotherConnection(source, connection)) {\n      onPart = cloneOnPart(onPart);\n      setCmmnElementRef(connection, onPart);\n    }\n\n    modeling.updateSemanticParent(onPart, newSentry, 'onParts', connection);\n\n  }, true);\n\n\n  this.postExecuted([ 'connection.create', 'connection.reconnectStart'], function(context) {\n\n    var connection = context.connection;\n\n    if (!isOnPartConnection(connection)) {\n      return;\n    }\n\n    var onPart = getOnPart(connection),\n        standardEvent;\n\n    if (!isValidStandardEvent(connection)) {\n      standardEvent = getDefaultStandardEvent(connection);\n      modeling.updateProperties(onPart, {\n        standardEvent: standardEvent\n      }, connection);\n    }\n\n  }, true);\n\n\n  // CREATE //////////////////////////////////////////////////////////////////\n\n  this.postExecuted('element.updateAttachment', function(context) {\n\n    var shape = context.shape;\n\n    if (!isCriterion(shape)) {\n      return;\n    }\n\n    if (shape.host) {\n      self.updateSentriesSemanticParent([ shape ]);\n    }\n    else {\n      self.deleteSentry(shape);\n    }\n\n  }, true);\n\n\n  // DELETE /////////////////////////////////////////////////////////////\n\n  this.preExecuted('shape.delete', function(context) {\n\n    var definition = getDefinition(context.shape);\n\n    if (!isHumanTask(definition)) {\n      return;\n    }\n\n    // get remaining discretionary items\n    context.discretionaryItems = context.discretionaryItems || getAllDiscretionaryItems(definition);\n\n  }, true);\n\n\n  this.postExecuted('shape.delete', VERY_LOW_PRIORITY, function(context) {\n\n    var discretionaryItems = context.discretionaryItems,\n        attachers;\n\n    attachers = getAttachersRecurse(discretionaryItems);\n\n    if (attachers && attachers.length) {\n      self.updateSentriesSemanticParent(attachers);\n    }\n\n  }, true);\n\n\n  // MOVING /////////////////////////////////////////////////////////////\n\n  this.postExecuted([\n    'connection.create',\n    'connection.delete',\n    'connection.reconnectEnd',\n    'connection.reconnectStart'\n  ], VERY_LOW_PRIORITY, function(context) {\n\n    var connection = context.connection,\n        source = context.newSource || context.source || connection.source,\n        target = context.newTarget || context.target || connection.target,\n        shapes = [],\n        attachers;\n\n    if (!isDiscretionaryConnection(connection, source, target)) {\n      return;\n    }\n\n    if (connection.target) {\n      shapes.push(connection.target);\n    }\n\n    if (!connection.target && context.target) {\n      shapes.push(context.target);\n    }\n\n    if (context.oldTarget) {\n      shapes.push(context.oldTarget);\n    }\n\n    attachers = getAttachersRecurse(shapes);\n\n    if (attachers && attachers.length) {\n      self.updateSentriesSemanticParent(attachers);\n    }\n\n  }, true);\n\n\n  this.postExecuted('elements.move', VERY_LOW_PRIORITY, function(context) {\n\n    var shapes = context.shapes,\n        newParent = context.newParent,\n        oldParent = context.hints && context.hints.oldParent,\n        attachers;\n\n    if (oldParent === newParent) {\n      return;\n    }\n\n    attachers = getAttachersRecurse(shapes);\n\n    if (attachers && attachers.length) {\n      self.updateSentriesSemanticParent(attachers);\n    }\n\n  }, true);\n\n\n  // API //////////////////////////////////////////////////////\n\n\n  /**\n   * Deletes by given criteria referenced sentries, if the\n   * the sentry is not referenced by any other criterion.\n   *\n   * @param {Object} criteria deleted criteria\n   */\n  this.deleteSentry = function(criterion) {\n\n    var sentry = getSentry(criterion),\n        references;\n\n    if (sentry) {\n      references = itemRegistry.getReferences(sentry);\n\n      if (references.length <= 1) {\n        modeling.updateSemanticParent(sentry, null, containment);\n      }\n    }\n\n  };\n\n\n  /**\n   * Updates the parent of by given criteria referenced sentries.\n   *\n   * If the sentry is referenced by multiple criteria and only\n   * a part of them has been moved, then the sentry is duplicated.\n   *\n   * @param {Object} criteria updated criteria\n   */\n  this.updateSentriesSemanticParent = function(criteria) {\n\n    var groupedCriteria = groupBySentry(criteria),\n        replacements = {};\n\n    /**\n     * Returns true if the given element is replaced\n     */\n    function isReplaced(elem) {\n      return !!replacements[elem.id];\n    }\n\n    /**\n     * Set the given old element as replaced\n     * with the given new element.\n     */\n    function replace(oldElem, newElem) {\n      replacements[oldElem.id] = newElem;\n    }\n\n    /**\n     * Returns the replacement of the given element.\n     * If no replacement is available the given element\n     * itself is returned.\n     */\n    function getReplacement(elem) {\n      return replacements[elem.id] || elem;\n    }\n\n    /**\n     * Returns true if the sentry should be replaced.\n     */\n    function shouldReplace(sentry, newParent) {\n      var references = itemRegistry.getReferences(sentry),\n          criteria = (groupedCriteria[sentry.id] || []),\n          referencesLength = itemRegistry.getReferences(sentry).length,\n          criteriaLength = criteria.length;\n\n      if (referencesLength > criteriaLength) {\n\n        if (!newParent) {\n          return true;\n        }\n\n        return some(references, function(criterion) {\n          var criterionShape = itemRegistry.getShape(criterion);\n          return criterionShape && newParent !== getSentryParent(criterionShape.host);\n        });\n\n      }\n\n      return false;\n    }\n\n\n    handleEachElement(criteria, function(criterion) {\n\n      var sentry = getSentry(criterion);\n\n      if (sentry) {\n\n        var newParent = getSentryParent(criterion.host);\n\n        if (!newParent) {\n          var parent = getParent(getBusinessObject(criterion));\n          newParent = parent && getSentryParent(parent);\n        }\n\n        if (sentry.$parent === newParent) {\n          return;\n        }\n\n        if (!isReplaced(sentry) && shouldReplace(sentry, newParent)) {\n          var newSentry = cmmnReplace.replaceSentry(sentry);\n          replace(sentry, newSentry);\n\n          forEach(criterion.incoming, function(con) {\n\n            var cmmnElement = con.businessObject.cmmnElementRef;\n            if (cmmnElement && is(cmmnElement, 'cmmn:OnPart')) {\n              replace(cmmnElement, cloneOnPart(cmmnElement));\n            }\n\n          });\n        }\n\n        sentry = getReplacement(sentry);\n\n        if (getSentry(criterion) !== sentry) {\n          setSentryRef(criterion, sentry);\n        }\n\n        forEach(criterion.incoming, function(con) {\n\n          var cmmnElement = con.businessObject.cmmnElementRef;\n          if (cmmnElement && is(cmmnElement, 'cmmn:OnPart')) {\n\n            var replaceBy = getReplacement(cmmnElement);\n\n            if (replaceBy && cmmnElement !== replaceBy) {\n              setCmmnElementRef(con, replaceBy);\n              modeling.updateSemanticParent(replaceBy, sentry, 'onParts');\n            }\n\n          }\n\n        });\n\n        modeling.updateSemanticParent(sentry, newParent, containment);\n\n      }\n\n    });\n\n  };\n\n\n  // UTILITIES /////////////////////////////////////////////////////////////////\n\n\n  function getAttachersRecurse(shapes) {\n\n    var attachers = getAttachers(shapes);\n\n    handleEachElement(shapes, function(shape) {\n\n      var definition = getDefinition(shape);\n\n      if (isHumanTask(definition)) {\n\n        var items = getAllDiscretionaryItems(shape);\n\n        if (items && items.length) {\n          attachers = attachers.concat(getAttachers(items));\n        }\n\n        return items;\n      }\n\n      return getDirectItemCapables(shape);\n\n    });\n\n    return flatten(attachers);\n  }\n\n\n  function handleEachElement(shapes, fn) {\n\n    var handledElements = {};\n\n    function handled(element) {\n      handledElements[element.id] = element;\n    }\n\n    function isHandled(element) {\n      return !!handledElements[element.id];\n    }\n\n    function eachElement(elements, isRoot) {\n      forEach(elements, function(element) {\n\n        if (!isHandled(element)) {\n          handled(element);\n\n          element = itemRegistry.getShape(element.id) || element;\n\n          var children = fn(element);\n\n          if (children && children.length) {\n            eachElement(children);\n          }\n        }\n\n        if (isRoot) {\n          handledElements = {};\n        }\n\n      });\n    }\n\n    eachElement(shapes, true);\n  }\n\n  function createSentry(criterion) {\n    var sentry = cmmnFactory.createSentry();\n    setSentryRef(criterion, sentry);\n    return sentry;\n  }\n\n  function setSentryRef(criterion, sentry) {\n    modeling.updateProperties(criterion, {\n      sentryRef: sentry\n    });\n  }\n\n  function setCmmnElementRef(connection, ref) {\n    modeling.updateProperties(connection, {\n      cmmnElementRef: ref\n    });\n  }\n\n  function cloneOnPart(onPart) {\n    var attrs = {\n      name: onPart.name,\n      sourceRef: onPart.sourceRef,\n      standardEvent: onPart.standardEvent\n    };\n\n    if (is(onPart, 'cmmn:PlanItemOnPart')) {\n      attrs.exitCriterionRef = onPart.exitCriterionRef;\n    }\n\n    return cmmnFactory.create(onPart.$type, attrs);\n  }\n\n\n  function isOnPartConnection(connection) {\n    var cmmnElement = connection.businessObject.cmmnElementRef;\n    return is(cmmnElement, 'cmmn:OnPart');\n  }\n\n  function isDiscretionaryConnection(connection, source, target) {\n    return !connection.businessObject.cmmnElementRef;\n  }\n\n}\n\nSentryUpdater.$inject = [\n  'eventBus',\n  'modeling',\n  'itemRegistry',\n  'cmmnReplace',\n  'cmmnFactory'\n];\n\ninherits(SentryUpdater, CommandInterceptor);\n\nmodule.exports = SentryUpdater;\n\n\n/**\n * Returns based on the given host the parent\n * for a sentry.\n *\n * @param {djs.model.Base} host\n *\n * @result {ModdleElement} parent\n */\nfunction getSentryParent(host) {\n\n  if (isCasePlanModel(host)) {\n    return getBusinessObject(host);\n  }\n\n  if (isItemCapable(host)) {\n    var bo = getBusinessObject(host);\n    return getParent(bo, 'cmmn:PlanFragment');\n  }\n\n}\n\n\n/**\n * Returns all attachers for the given shapes.\n *\n * @param {Array<djs.model.Base>} shapes\n *\n * @result {Array<djs.model.Base>} attachers\n */\nfunction getAttachers(shapes) {\n  return flatten(map(shapes, function(s) {\n    var attachers = [];\n\n    if (s.attachers) {\n      attachers = s.attachers;\n    }\n    else {\n      var bo = getBusinessObject(s);\n\n      var exitCriteria = bo.get('exitCriteria');\n      forEach(exitCriteria, function(criterion) {\n        attachers.push(criterion);\n      });\n\n      var entryCriteria = bo.get('entryCriteria');\n      forEach(entryCriteria, function(criterion) {\n        attachers.push(criterion);\n      });\n    }\n\n    return attachers || [];\n  }));\n}\n\n\n/**\n * Groups given criteria by sentry.\n *\n * @param {Object} criteria group by id\n *\n * @result {Object} criteria grouped by sentry\n */\nfunction groupBySentry(criteria) {\n  return groupBy(criteria, function(criterion) {\n    var sentry = getSentry(criterion);\n    return sentry && sentry.id;\n  });\n}\n\n\n/**\n * Returns true if the given element is a criterion.\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean}\n */\nfunction isCriterion(element) {\n  return is(element, 'cmmn:Criterion');\n}\n\nfunction existsAnotherConnection(source, connection) {\n  var onPart = getOnPart(connection);\n  return some(source.outgoing, function(con) {\n    return connection !== con && onPart === getOnPart(con);\n  });\n}\n\nfunction getOnPart(connection) {\n  connection = getBusinessObject(connection);\n  return connection.cmmnElementRef;\n}\n\nfunction isValidStandardEvent(connection) {\n\n  var onPart = getOnPart(connection),\n      standardEvent = onPart.standardEvent,\n      possibleStandardEvents = getStandardEvents(onPart);\n\n  return standardEvent && possibleStandardEvents.indexOf(standardEvent) !== -1;\n\n}\n\nfunction getDefaultStandardEvent(element) {\n\n  element = getOnPart(element);\n\n  if (is(element.sourceRef, 'cmmn:CaseFileItem')) {\n    return 'update';\n  }\n\n  if (is(element.exitCriterionRef, 'cmmn:ExitCriterion')) {\n    return 'exit';\n  }\n\n  if (is(element.sourceRef, 'cmmn:PlanItem')) {\n\n    var definition = getDefinition(element.sourceRef);\n    if (is(definition, 'cmmn:EventListener') || is(definition, 'cmmn:Milestone')) {\n      return 'occur';\n    }\n    else {\n      return 'complete';\n    }\n\n  }\n\n}\n","'use strict';\n\nvar forEach = require('min-dash').forEach;\n\nvar inherits = require('inherits');\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\nfunction UnclaimIdBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this.preExecute('elements.delete', function(event) {\n    var context = event.context,\n        elements = context.elements;\n\n    forEach(elements, function(element) {\n      modeling.unclaimId(element.businessObject.id, element.businessObject);\n    });\n\n  });\n}\n\ninherits(UnclaimIdBehavior, CommandInterceptor);\n\nUnclaimIdBehavior.$inject = [ 'eventBus', 'modeling' ];\n\nmodule.exports = UnclaimIdBehavior;\n","module.exports = {\n  __init__: [ 'cmmnOrderingProvider' ],\n  cmmnOrderingProvider: [ 'type', require('./CmmnOrderingProvider') ]\n};","'use strict';\n\nvar inherits = require('inherits');\n\nvar OrderingProvider = require('diagram-js/lib/features/ordering/OrderingProvider').default;\nvar findIndex = require('min-dash').findIndex;\nvar find = require('min-dash').find;\nvar is = require('../../util/ModelUtil').is;\nvar isAny = require('../modeling/util/ModelingUtil').isAny;\n\nfunction CmmnOrderingProvider(eventBus) {\n\n  OrderingProvider.call(this, eventBus);\n\n  var orders = [\n    { type: 'label', order: { level: 10 } },\n    { type: 'cmmn:Criterion', order: { level: 6 } },\n    {\n      type: 'cmmn:OnPart',\n      order: {\n        level: 9,\n        containers: [\n          'cmmn:Stage'\n        ]\n      }\n    },\n    {\n      type: 'cmmn:Association',\n      order: {\n        level: 9,\n        containers: [\n          'cmmndi:CMMNDiagram'\n        ]\n      }\n    },\n    {\n      type: 'cmmndi:CMMNEdge',\n      order: {\n        level: 9,\n        containers: [\n          'cmmn:PlanItem',\n          'cmmn:DiscretionaryItem',\n          'cmmn:Stage'\n        ]\n      }\n    }\n  ];\n\n  function computeOrder(element) {\n\n    if (isCMMNEdge(element)) {\n      element = element.businessObject.cmmnElementRef || element;\n    }\n\n    var entry = find(orders, function(o) {\n      return is(element, o.type);\n    });\n\n    return entry && entry.order || { level: 1 };\n  }\n\n  function getOrder(element) {\n\n    var order = element.order;\n\n    if (!order) {\n      element.order = order = computeOrder(element);\n    }\n\n    return order;\n  }\n\n  function findActualParent(element, newParent, containers) {\n\n    var actualParent = newParent;\n\n    if (isCMMNEdge(element) && element.source) {\n      actualParent = element.source.parent;\n    }\n\n    while (actualParent) {\n\n      if (isAny(actualParent, containers)) {\n        break;\n      }\n\n      actualParent = actualParent.parent;\n    }\n\n    if (!actualParent) {\n      throw new Error('no parent for ' + element.id + ' in ' + newParent.id);\n    }\n\n    return actualParent;\n  }\n\n  this.getOrdering = function(element, newParent) {\n\n    var elementOrder = getOrder(element);\n\n    if (elementOrder.containers) {\n      newParent = findActualParent(element, newParent, elementOrder.containers);\n    }\n\n    var currentIndex = newParent.children.indexOf(element);\n\n    var insertIndex = findIndex(newParent.children, function(child) {\n\n      // do not compare with labels, they are created\n      // in the wrong order (right after elements) during import and\n      // mess up the positioning.\n      if (!element.labelTarget && child.labelTarget) {\n        return false;\n      }\n\n      return elementOrder.level < getOrder(child).level;\n    });\n\n\n    // if the element is already in the child list at\n    // a smaller index, we need to adjust the insert index.\n    // this takes into account that the element is being removed\n    // before being re-inserted\n    if (insertIndex !== -1) {\n      if (currentIndex !== -1 && currentIndex < insertIndex) {\n        insertIndex -= 1;\n      }\n    }\n\n    return {\n      index: insertIndex,\n      parent: newParent\n    };\n\n  };\n}\n\nCmmnOrderingProvider.$inject = [ 'eventBus' ];\n\ninherits(CmmnOrderingProvider, OrderingProvider);\n\nmodule.exports = CmmnOrderingProvider;\n\nfunction isCMMNEdge(element) {\n  return is(element, 'cmmndi:CMMNEdge');\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * An abstract provider that allows modelers to implement a custom\n * ordering of diagram elements on the canvas.\n *\n * It makes sure that the order is always preserved during element\n * creation and move operations.\n *\n * In order to use this behavior, inherit from it and override\n * the method {@link OrderingProvider#getOrdering}.\n *\n * @example\n *\n * ```javascript\n * function CustomOrderingProvider(eventBus) {\n *   OrderingProvider.call(this, eventBus);\n *\n *   this.getOrdering = function(element, newParent) {\n *     // always insert elements at the front\n *     // when moving\n *     return {\n *       index: 0,\n *       parent: newParent\n *     };\n *   };\n * }\n * ```\n *\n * @param {EventBus} eventBus\n */\nexport default function OrderingProvider(eventBus) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  var self = this;\n\n  this.preExecute([ 'shape.create', 'connection.create' ], function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection,\n        parent = context.parent;\n\n    var ordering = self.getOrdering(element, parent);\n\n    if (ordering) {\n\n      if (ordering.parent !== undefined) {\n        context.parent = ordering.parent;\n      }\n\n      context.parentIndex = ordering.index;\n    }\n  });\n\n  this.preExecute([ 'shape.move', 'connection.move' ], function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection,\n        parent = context.newParent || element.parent;\n\n    var ordering = self.getOrdering(element, parent);\n\n    if (ordering) {\n\n      if (ordering.parent !== undefined) {\n        context.newParent = ordering.parent;\n      }\n\n      context.newParentIndex = ordering.index;\n    }\n  });\n}\n\n/**\n * Return a custom ordering of the element, both in terms\n * of parent element and index in the new parent.\n *\n * Implementors of this method must return an object with\n * `parent` _and_ `index` in it.\n *\n * @param {djs.model.Base} element\n * @param {djs.model.Shape} newParent\n *\n * @return {Object} ordering descriptor\n */\nOrderingProvider.prototype.getOrdering = function(element, newParent) {\n  return null;\n};\n\ninherits(OrderingProvider, CommandInterceptor);","module.exports = {\n  __depends__: [\n    require('diagram-js/lib/features/popup-menu').default,\n    require('diagram-js/lib/features/replace').default,\n    require('diagram-js/lib/features/selection').default\n  ],\n  cmmnReplace: [ 'type', require('./CmmnReplace') ]\n};","'use strict';\n\nvar ModelUtil = require('../../util/ModelUtil'),\n    is = ModelUtil.is,\n    getDefinition = ModelUtil.getDefinition,\n    isAutoComplete = ModelUtil.isAutoComplete;\n\nvar isCollapsed = require('../../util/DiUtil').isCollapsed,\n    isPlanningTableCollapsed = require('../../util/DiUtil').isPlanningTableCollapsed;\n\nvar isPlanningTableCapable = require('../modeling/util/PlanItemDefinitionUtil').isPlanningTableCapable;\nvar isItemCapable = require('../modeling/util/PlanItemDefinitionUtil').isItemCapable;\n\n/**\n * This module takes care of replacing CMMN elements\n */\nfunction CmmnReplace(cmmnFactory, replace, selection, cmmnRules) {\n\n  /**\n   * Prepares a new business object for the replacement element\n   * and triggers the replace operation.\n   *\n   * @param  {djs.model.Base} element\n   * @param  {Object} target\n   * @param  {Object} [hints]\n   *\n   * @return {djs.model.Base} the newly created element\n   */\n  function replaceElement(element, target, hints) {\n\n    hints = hints || {};\n\n    var type = target.type,\n        oldBusinessObject = element.businessObject,\n        newBusinessObject;\n\n\n    // TODO: need also to respect min/max Size\n    var newElement = {\n      type: type\n    };\n\n    if (isCriterion(oldBusinessObject)) {\n      newBusinessObject = replaceCriterion(oldBusinessObject, type);\n    }\n\n\n    if (isItemCapable(oldBusinessObject)) {\n\n      var oldDefinition = getDefinition(oldBusinessObject),\n          definitionType = target.definitionType,\n          newDefinition = oldDefinition;\n\n\n      // replace plan item definition if necessary\n      if (oldDefinition.$type !== definitionType) {\n        newDefinition = replacePlanItemDefinition(oldDefinition, definitionType);\n      }\n\n\n      // replace plan/discretionary item\n      newBusinessObject = replaceItemCapable(oldBusinessObject, type, newDefinition);\n\n\n      // handle isCollapsed property\n      if (isPlanFragment(oldDefinition) && isPlanFragment(newDefinition) && target.isCollapsed !== false) {\n        newElement.isCollapsed = isCollapsed(oldBusinessObject);\n      }\n\n\n      // switch collapsed/expanded plan fragment\n      if (isTask(oldDefinition) && target.isCollapsed === true) {\n        newElement.isCollapsed = true;\n      }\n\n      if (isTask(newDefinition) && target.isBlocking === false) {\n        newElement.isBlocking = false;\n      }\n\n\n      // handle isPlanningTableCollapsed property\n      if (isPlanningTableCapable(oldDefinition) && isPlanningTableCapable(newDefinition)) {\n        newElement.isPlanningTableCollapsed = isPlanningTableCollapsed(oldBusinessObject);\n      }\n\n\n      // handle autoComplete property\n      if (isStage(oldDefinition) && isStage(newDefinition)) {\n        newElement.autoComplete = isAutoComplete(oldBusinessObject);\n      }\n\n\n      // TODO: need also to respect min/max Size\n      // copy size, from an expanded plan fragment to an expanded alternative plan fragment\n      // except cmmn:Task, because Task is always expanded\n      if (!isCollapsed(oldBusinessObject) && !target.isCollapsed && !isTask(oldDefinition)) {\n        newElement.width = element.width;\n        newElement.height = element.height;\n      }\n    }\n\n    // create new business object if necessary\n    newElement.businessObject = newBusinessObject || cmmnFactory.create(type);\n\n    // trigger replacement\n    newElement = replace.replaceElement(element, newElement, hints);\n\n\n    if (hints.select !== false) {\n      selection.select(newElement);\n    }\n\n    return newElement;\n  }\n\n  this.replaceElement = replaceElement;\n\n\n  function replaceCriterion(criterion, type) {\n\n    var newCriterion;\n\n    if (criterion) {\n\n      type = type || criterion.$type;\n\n      newCriterion = cmmnFactory.createCriterion(type, {\n        sentryRef: criterion.sentryRef,\n        name: criterion.name\n      });\n\n    }\n\n    return newCriterion;\n\n  }\n\n  this.replaceCriterion = replaceCriterion;\n\n\n  function replaceSentry(sentry) {\n\n    var newSentry;\n\n    if (sentry) {\n\n      newSentry = cmmnFactory.createSentry({\n        name: sentry.name\n      });\n\n      if (sentry.ifPart) {\n\n        var newIfPart = cmmnFactory.create('cmmn:IfPart');\n        setParent(newIfPart, newSentry);\n        newSentry.ifPart = newIfPart;\n\n        var condition = replaceCondition(sentry.ifPart.condition);\n        setParent(condition, newIfPart);\n        newIfPart.condition = condition;\n\n      }\n\n    }\n\n    return newSentry;\n  }\n\n  this.replaceSentry = replaceSentry;\n\n\n  function replacePlanItemDefinition(definition, type) {\n\n    type = type || definition.$type;\n\n    var newDefinition = cmmnFactory.create(type, {\n      name: definition.name\n    });\n\n    if (isPlanItemControlCapable(newDefinition) && definition.defaultControl) {\n\n      var defaultControl = replacePlanItemControl(definition.defaultControl, newDefinition);\n\n      setParent(defaultControl, newDefinition);\n      newDefinition.defaultControl = defaultControl;\n\n    }\n\n    if (isStage(newDefinition) && definition.autoComplete) {\n      newDefinition.autoComplete = definition.autoComplete;\n    }\n\n    if (isTask(definition) && isTask(newDefinition)) {\n      newDefinition.isBlocking = definition.isBlocking;\n    }\n\n    return newDefinition;\n\n  }\n\n  this.replacePlanItemDefinition = replacePlanItemDefinition;\n\n\n  function replaceItemCapable(item, type, definition) {\n\n    type = type || item.$type;\n    definition = definition || getDefinition(item);\n\n    var newItem = cmmnFactory.create(type, {\n      name: item.name,\n      definitionRef: definition\n    });\n\n    if (isPlanItemControlCapable(newItem) && item.itemControl) {\n\n      var itemControl = replacePlanItemControl(item.itemControl, newItem);\n\n      setParent(itemControl, newItem);\n      newItem.itemControl = itemControl;\n\n    }\n\n    return newItem;\n\n  }\n\n  this.replaceItemCapable = replaceItemCapable;\n\n\n  function replacePlanItemControl(control, element) {\n\n    var newControl;\n\n    if (control) {\n\n      newControl = cmmnFactory.create('cmmn:PlanItemControl');\n\n      var repetitionRule = control.repetitionRule;\n      if (repetitionRule && (!element || cmmnRules.canSetRepetitionRule(element))) {\n\n        repetitionRule = replaceRule(repetitionRule);\n\n        setParent(repetitionRule, newControl);\n        newControl.repetitionRule = repetitionRule;\n\n      }\n\n      var requiredRule = control.requiredRule;\n      if (requiredRule && (!element || cmmnRules.canSetRequiredRule(element))) {\n\n        requiredRule = replaceRule(requiredRule);\n\n        setParent(requiredRule, newControl);\n        newControl.requiredRule = requiredRule;\n\n      }\n\n      var manualActivationRule = control.manualActivationRule;\n      if (manualActivationRule && (!element || cmmnRules.canSetManualActivationRule(element))) {\n\n        manualActivationRule = replaceRule(manualActivationRule);\n\n        setParent(manualActivationRule, newControl);\n        newControl.manualActivationRule = manualActivationRule;\n\n      }\n\n    }\n\n    return newControl;\n\n  }\n\n  this.replacePlanItemControl = replacePlanItemControl;\n\n\n  function replaceRule(rule) {\n\n    var newRule;\n\n    if (rule) {\n\n      var type = rule.$type;\n\n      var condition = replaceCondition(rule.condition);\n      newRule = cmmnFactory.create(type, {\n        condition: condition\n      });\n\n      setParent(condition, newRule);\n\n    }\n\n    return newRule;\n\n  }\n\n  this.replaceRule = replaceRule;\n\n\n  function replaceCondition(condition) {\n    var newCondition;\n\n    if (condition) {\n      newCondition = cmmnFactory.create('cmmn:Expression', {\n        language: condition.language,\n        body: condition.body\n      });\n    }\n\n    return newCondition;\n  }\n\n  this.replaceCondition = replaceCondition;\n\n\n  function setParent(element, parent) {\n    if (element) {\n      element.$parent = parent;\n    }\n  }\n\n}\n\nCmmnReplace.$inject = [ 'cmmnFactory', 'replace', 'selection', 'cmmnRules' ];\n\nmodule.exports = CmmnReplace;\n\nfunction isInstanceOf(element, type) {\n  element = getDefinition(element);\n  return is(element, type);\n}\n\nfunction isTask(element) {\n  return isInstanceOf(element, 'cmmn:Task');\n}\n\nfunction isMilestone(element) {\n  return isInstanceOf(element, 'cmmn:Milestone');\n}\n\nfunction isPlanFragment(element) {\n  return isInstanceOf(element, 'cmmn:PlanFragment');\n}\n\nfunction isStage(element) {\n  return isInstanceOf(element, 'cmmn:Stage');\n}\n\nfunction isCriterion(element) {\n  return is(element, 'cmmn:Criterion');\n}\n\nfunction isPlanItemControlCapable(element) {\n  return isTask(element) || isStage(element) || isMilestone(element);\n}","module.exports = {\n  __depends__: [\n    require('diagram-js/lib/features/rules').default\n  ],\n  __init__: [ 'cmmnRules' ],\n  cmmnRules: [ 'type', require('./CmmnRules') ]\n};","'use strict';\n\nvar inherits = require('inherits');\n\nvar some = require('min-dash').some,\n    forEach = require('min-dash').forEach,\n    assign = require('min-dash').assign,\n    filter = require('min-dash').filter;\n\nvar ModelUtil = require('../../util/ModelUtil'),\n    is = ModelUtil.is,\n    isCasePlanModel = ModelUtil.isCasePlanModel,\n    getDefinition = ModelUtil.getDefinition,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar isCollapsed = require('../../util/DiUtil').isCollapsed;\n\nvar ModelingUtil = require('../modeling/util/ModelingUtil'),\n    isAny = ModelingUtil.isAny,\n    isSame = ModelingUtil.isSame,\n    isSameCase = ModelingUtil.isSameCase,\n    getParent = ModelingUtil.getParent,\n    getParents = ModelingUtil.getParents;\n\nvar PlanItemDefinitionUtil = require('../modeling/util/PlanItemDefinitionUtil'),\n    isDiscretionaryToHumanTask = PlanItemDefinitionUtil.isDiscretionaryToHumanTask,\n    isHumanTask = PlanItemDefinitionUtil.isHumanTask,\n    isDiscretionaryItem = PlanItemDefinitionUtil.isDiscretionaryItem;\n\nvar isCriterionAttachment = require('../snapping/CmmnSnappingUtil').getCriterionAttachment;\n\nvar RuleProvider = require('diagram-js/lib/features/rules/RuleProvider').default;\n\n\n/**\n * CMMN specific modeling rule\n */\nfunction CmmnRules(eventBus) {\n  RuleProvider.call(this, eventBus);\n}\n\ninherits(CmmnRules, RuleProvider);\n\nCmmnRules.$inject = [ 'eventBus' ];\n\nmodule.exports = CmmnRules;\n\nCmmnRules.prototype.init = function() {\n\n  var self = this;\n\n  this.addRule('connection.start', function(context) {\n    var source = context.source;\n\n    return canStartConnection(source);\n  });\n\n  this.addRule('connection.create', function(context) {\n\n    var source = context.source,\n        target = context.target,\n        allowed = false,\n        hints = context.hints || {},\n        targetParent = hints.targetParent,\n        targetAttach = hints.targetAttach;\n\n    // don't allow incoming connections on\n    // attach from context-pad\n    if (targetAttach) {\n      return false;\n    }\n\n    // temporarily set target parent for scoping\n    // checks to work\n    if (targetParent) {\n      target.parent = targetParent;\n    }\n\n    try {\n      allowed = self.canConnect(source, target) ||\n                self.canReplaceConnectionEnd(source, target, 'target');\n\n      if (!allowed) {\n\n        allowed = self.canConnect(target, source) ||\n                     self.canReplaceConnectionEnd(target, source, 'source');\n\n        if (allowed) {\n          assign(allowed, {\n            reverse: true\n          });\n        }\n      }\n    } finally {\n      // unset temporary target parent\n      if (targetParent) {\n        target.parent = null;\n      }\n    }\n\n    return allowed;\n  });\n\n  this.addRule('connection.reconnectStart', function(context) {\n\n    var connection = context.connection,\n        hover = context.hover,\n        source = hover || context.source,\n        target = connection.target,\n        allowed = false;\n\n    allowed = self.canConnect(source, target, connection);\n\n    if (!allowed && hover) {\n\n      allowed = self.canReplaceConnectionEnd(hover, target, 'source');\n\n      if (!allowed) {\n\n        allowed = self.canConnect(target, hover, connection) ||\n                  self.canReplaceConnectionEnd(target, hover, 'target');\n\n        if (allowed) {\n          assign(allowed, {\n            reverse: true\n          });\n        }\n\n      }\n\n    }\n\n    return allowed;\n\n  });\n\n  this.addRule('connection.reconnectEnd', function(context) {\n\n    var connection = context.connection,\n        source = connection.source,\n        hover = context.hover,\n        target = hover || context.target,\n        allowed = false;\n\n    allowed = self.canConnect(source, target, connection);\n\n    if (!allowed && hover) {\n\n      allowed = self.canReplaceConnectionEnd(source, hover, 'target');\n\n      if (!allowed) {\n\n        allowed = self.canConnect(hover, source, connection) ||\n                  self.canReplaceConnectionEnd(hover, source, 'source');\n\n        if (allowed) {\n          assign(allowed, {\n            reverse: true\n          });\n        }\n\n      }\n\n    }\n\n    return allowed;\n\n  });\n\n  this.addRule('connection.updateWaypoints', function(context) {\n    var connection = context.connection;\n\n    return {\n      type: connection.type,\n      businessObject: connection.businessObject\n    };\n  });\n\n  this.addRule('shape.attach', function(context) {\n\n    return self.canAttach(\n      context.shape,\n      context.target,\n      null,\n      context.position\n    );\n  });\n\n  this.addRule('shape.create', function(context) {\n\n    var target = context.target,\n        shape = context.shape,\n        source = context.source,\n        position = context.position,\n        shapes = [ shape ];\n\n    return self.canCreate(shape, target, source, position) ||\n           self.canReplace(shapes, target, position, source);\n  });\n\n  this.addRule('shape.resize', function(context) {\n\n    var shape = context.shape,\n        newBounds = context.newBounds;\n\n    return self.canResize(shape, newBounds);\n  });\n\n  this.addRule('elements.move', function(context) {\n    var target = context.target,\n        shapes = context.shapes,\n        position = context.position;\n\n    return self.canAttach(shapes, target, null, position) ||\n           self.canMove(shapes, target, position) ||\n           self.canReplace(shapes, target, position);\n  });\n\n  this.addRule('shape.replace', function(context) {\n\n    var element = context.element,\n        host;\n\n    if (isCriterion(element)) {\n\n      host = element.host;\n\n      if (isCasePlanModel(host)) {\n        return false;\n      }\n\n      if (isTask(host) && !isBlocking(host)) {\n        return false;\n      }\n\n      if (isMilestone(host) || isEventListener(host)) {\n        return false;\n      }\n\n    }\n\n  });\n\n  this.addRule([ 'elements.delete' ], function(context) {\n    return self.canRemove(context.elements);\n  });\n\n};\n\n\nCmmnRules.prototype.canRemove = function(elements) {\n\n  // do not allow deletion of labels\n  return filter(elements, function(e) {\n    return !isLabel(e);\n  });\n\n};\n\n\nCmmnRules.prototype.canMove = function(elements, target) {\n\n  var self = this;\n\n  // allow default move check to start move operation\n  if (!target) {\n    return true;\n  }\n\n  return elements.every(function(element) {\n\n    if (isDiscretionaryItem(element)) {\n      if (!self.canMoveDiscretionaryItem(element, elements, target)) {\n        return false;\n      }\n    }\n\n    return self.canDrop(element, target);\n  });\n\n};\n\n\nCmmnRules.prototype.canMoveDiscretionaryItem = function(element, elements, target) {\n\n  return !isPlanFragment(target) || some(element.incoming, function(connection) {\n    var source = connection.source;\n    if (isDiscretionaryConnection(connection)) {\n      return isParent(target, source) || elements.indexOf(source) !== -1;\n    }\n  });\n\n};\n\nCmmnRules.prototype.canCreate = function(shape, target, source, position) {\n\n  var self = this;\n\n  if (!target) {\n    return false;\n  }\n\n  if (isLabel(target)) {\n    return null;\n  }\n\n  if (isSame(source, target)) {\n    return false;\n  }\n\n  // ensure we do not drop the element\n  // into source\n  if (source && isParent(source, target)) {\n    return false;\n  }\n\n  if (isDiscretionaryItem(shape)) {\n    if (!self.canCreateDiscretionaryItem(shape, target, source)) {\n      return false;\n    }\n  }\n\n  return self.canDrop(shape, target, position);\n\n};\n\nCmmnRules.prototype.canCreateDiscretionaryItem = function(shape, target, source) {\n  return !isPlanFragment(target) || isParent(target, source);\n};\n\n\nCmmnRules.prototype.canDrop = function(element, target) {\n\n  // can move labels everywhere\n  if (isLabel(element) && !isConnection(target)) {\n    return true;\n  }\n\n  if (isArtifact(element)) {\n\n    return is(target, 'cmmndi:CMMNDiagram') ||\n           isPlanFragment(target, true);\n  }\n\n  if (isCriterion(element)) {\n    return false;\n  }\n\n  if (isCasePlanModel(element)) {\n    // allow casePlanModels to drop only on root (CMMNDiagram)\n    return is(target, 'cmmndi:CMMNDiagram');\n  }\n\n  // allow any other element to drop on a case plan model or on an expanded stage\n  if (!isPlanFragment(target, true)) {\n    return false;\n  }\n\n  return !isCollapsed(target);\n\n};\n\n\nCmmnRules.prototype.canResize = function(shape, newBounds) {\n  if (isPlanFragment(shape, true)) {\n    return (!isCollapsed(shape)) && (\n      !newBounds || (newBounds.width >= 100 && newBounds.height >= 80)\n    );\n  }\n\n  if (isTextAnnotation(shape)) {\n    return true;\n  }\n\n  return false;\n};\n\nCmmnRules.prototype.canConnect = function(source, target, connection) {\n\n  if (nonExistingOrLabel(source) || nonExistingOrLabel(target)) {\n    return null;\n  }\n\n  // Disallow connections with same target and source element.\n  if (isSame(source, target)) {\n    return false;\n  }\n\n  if (this.canConnectPlanItemOnPartConnection(source, target)) {\n    return {\n      type: 'cmmn:PlanItemOnPart',\n      isStandardEventVisible: true\n    };\n  }\n\n  if (this.canConnectCaseFileItemOnPartConnection(source, target)) {\n    return {\n      type: 'cmmn:CaseFileItemOnPart',\n      isStandardEventVisible: true\n    };\n  }\n\n  if (this.canConnectDiscretionaryConnection(source, target, connection)) {\n    return {\n      type: 'cmmndi:CMMNEdge'\n    };\n  }\n\n  if (connection &&\n      is(connection.businessObject.cmmnElementRef, 'cmmn:Association') &&\n      this.canConnectAssociation(source, target)) {\n\n    return {\n      type: 'cmmn:Association'\n    };\n  }\n\n  if (isTextAnnotation(source) || isTextAnnotation(target)) {\n\n    return {\n      type: 'cmmn:Association'\n    };\n  }\n\n  return false;\n};\n\n\nCmmnRules.prototype.canConnectDiscretionaryConnection = function(source, target, connection) {\n\n  if (!isHumanTask(getDefinition(source))) {\n    return false;\n  }\n\n  if (!isBlocking(source)) {\n    return false;\n  }\n\n  if (!isDiscretionaryItem(target)) {\n    return false;\n  }\n\n  // A HumanTask MUST NOT be discretionary to itself.\n  var sourceDefinition = getDefinition(source);\n  var targetDefinition = getDefinition(target);\n\n  if (isSame(sourceDefinition, targetDefinition)) {\n    return false;\n  }\n\n  var sourceParent = getParent(source);\n  var targetParent = getParent(target);\n\n  if (!isSame(sourceParent, targetParent)) {\n    return false;\n  }\n\n  // if the target discretionary item is already\n  // part of a human task, then it should not be\n  // possible to create a connection to it in some\n  // cases.\n  if (isDiscretionaryToHumanTask(target)) {\n\n    if (!isUniqueDiscretionaryConnection(source, target, connection)) {\n      return false;\n    }\n\n    var parent = getParent(getBusinessObject(target), 'cmmn:HumanTask');\n\n    if (!isSame(getDefinition(source), parent)) {\n      if (hasIncomingDiscretionaryConnections(target, connection)) {\n        return false;\n      }\n    }\n\n  }\n\n  return true;\n};\n\n\nCmmnRules.prototype.canConnectPlanItemOnPartConnection = function(source, target) {\n\n  if (!isSameCase(source, target)) {\n    return false;\n  }\n\n  if (isExitCriterion(source)) {\n    source = source.host;\n  }\n\n  if (isSame(source, target.host)) {\n    return false;\n  }\n\n  if (isParent(source, target.host)) {\n    return false;\n  }\n\n  if (isEntryCriterion(target) && isParent(target.host, source)) {\n    return false;\n  }\n\n  return isPlanItem(source) && isCriterion(target);\n};\n\n\nCmmnRules.prototype.canConnectCaseFileItemOnPartConnection = function(source, target) {\n  return !!(isSameCase(source, target) &&\n            isCaseFileItem(source) &&\n            isCriterion(target));\n};\n\nCmmnRules.prototype.canConnectAssociation = function(source, target) {\n\n  // do not connect connections\n  if (isConnection(source) || isConnection(target)) {\n    return false;\n  }\n\n  // connect if different parent\n  return !isParent(target, source) &&\n         !isParent(source, target);\n\n};\n\nCmmnRules.prototype.canAttach = function(elements, target, source, position) {\n\n  if (isSame(source, target)) {\n    return false;\n  }\n\n\n  if (!Array.isArray(elements)) {\n    elements = [ elements ];\n  }\n\n  // only (re-)attach one element at a time\n  if (elements.length !== 1) {\n    return false;\n  }\n\n  var element = elements[0];\n\n  // do not attach labels\n  if (isLabel(element)) {\n    return false;\n  }\n\n  // only handle entry/exit criterion\n  if (!isCriterion(element)) {\n    return false;\n  }\n\n  // allow default move operation\n  if (!target) {\n    return true;\n  }\n\n  if (!this.canAttachCriterion(element, target, position, source)) {\n    return false;\n  }\n\n  return 'attach';\n\n};\n\n\nCmmnRules.prototype.canAttachEntryCriterion = function(element, target, position, source) {\n\n  if (!this.canAttachCriterion(element, target, position, source)) {\n    return false;\n  }\n\n  if (source && isParent(target, source)) {\n    return false;\n  }\n\n  // disallow drop entry criterion...\n\n  // ... on case plan model\n  if (isCasePlanModel(target)) {\n    return false;\n  }\n\n  if (isPlanFragment(target, true)) {\n\n    // ... when element has an incoming connection which source\n    // is a child of the target\n    return !some(element.incoming, function(connection) {\n      if (is(connection.businessObject.cmmnElementRef, 'cmmn:PlanItemOnPart')) {\n        return isParent(target, connection.source);\n      }\n    });\n\n  }\n\n  return true;\n};\n\n\nCmmnRules.prototype.canAttachExitCriterion = function(element, target, position, source) {\n\n  if (!this.canAttachCriterion(element, target, position, source)) {\n    return false;\n  }\n\n  // disallow drop exit criterion...\n\n  // ... on milestone\n  if (isMilestone(target)) {\n    return false;\n  }\n\n  // ... on non blocking task\n  if (isTask(target) && !isBlocking(target)) {\n    return false;\n  }\n\n  return true;\n\n};\n\n\nCmmnRules.prototype.canAttachCriterion = function(element, target, position, source) {\n\n  if (source && isParent(source, target)) {\n    return false;\n  }\n\n  // disallow drop criterion...\n\n  // ... on another criterion\n  if (isCriterion(target)) {\n    return false;\n  }\n\n  // ... on event listener\n  if (isEventListener(target)) {\n    return false;\n  }\n\n  // a plan fragment does not have any execution semantic,\n  // that why it should not be possible to attach an criterion\n  if (isPlanFragment(target)) {\n    return false;\n  }\n\n  // ... on a text annotation\n  if (isTextAnnotation(target)) {\n    return false;\n  }\n\n  // ... on a case file item\n  if (isCaseFileItem(target)) {\n    return false;\n  }\n\n  // only attach to border\n  if (position && !isCriterionAttachment(position, target)) {\n    return false;\n  }\n\n  return true;\n\n};\n\n\nCmmnRules.prototype.canReplace = function(elements, target, position, source) {\n\n  if (!target) {\n    return false;\n  }\n\n  if (isSame(source, target)) {\n    return false;\n  }\n\n  var canExecute = {\n    replacements: []\n  };\n\n  var self = this;\n\n  forEach(elements, function(element) {\n\n    if (isEntryCriterion(element) && !self.canAttachEntryCriterion(element, target, position, source)) {\n      if (self.canAttachExitCriterion(element, target, position, source)) {\n        canExecute.replacements.push({\n          oldElementId: element.id,\n          newElementType: 'cmmn:ExitCriterion'\n        });\n      }\n    }\n\n    if (isExitCriterion(element) && !self.canAttachExitCriterion(element, target, position, source)) {\n      if (self.canAttachEntryCriterion(element, target, position, source)) {\n        canExecute.replacements.push({\n          oldElementId: element.id,\n          newElementType: 'cmmn:EntryCriterion'\n        });\n      }\n    }\n\n    if (isPlanFragment(target) &&\n        isDiscretionaryItem(element) &&\n        self.canDrop(element, target) &&\n        !self.canMoveDiscretionaryItem(element, elements, target)) {\n\n      var replacement = {\n        oldElementId: element.id,\n        newElementType: 'cmmn:PlanItem'\n      };\n\n      if (isPlanFragment(element)) {\n        assign(replacement, {\n          newDefinitionType: 'cmmn:Stage'\n        });\n      }\n\n      canExecute.replacements.push(replacement);\n\n    }\n\n  });\n\n  return canExecute.replacements.length ? canExecute : false;\n};\n\n\nCmmnRules.prototype.canReplaceConnectionEnd = function(source, target, side) {\n\n  if (!source || !target) {\n    return false;\n  }\n\n  if (isSame(source, target)) {\n    return false;\n  }\n\n  if (!isSameCase(source, target)) {\n    return false;\n  }\n\n  return side === 'source' ? this.canReplaceSource(source, target) : this.canReplaceTarget(source, target);\n\n};\n\n\nCmmnRules.prototype.canReplaceSource = function(source, target) {\n\n  if (isDiscretionaryItem(source) && isCriterion(target)) {\n\n    if (isSame(source, target.host)) {\n      return false;\n    }\n\n    if (isPlanFragment(source)) {\n      return false;\n    }\n\n    if (isParent(source, target.host)) {\n      return false;\n    }\n\n    if (isEntryCriterion(target) && isParent(target.host, source)) {\n      return false;\n    }\n\n    return {\n      type: 'cmmn:PlanItemOnPart',\n      isStandardEventVisible: true,\n      replacements: [{\n        oldElementId: source.id,\n        newElementType: 'cmmn:PlanItem'\n      }]\n    };\n\n  }\n\n\n  if (isEntryCriterion(source) && isEntryCriterion(target)) {\n\n    if (isSame(source.host, target.host)) {\n      return false;\n    }\n\n    if (isParent(target.host, source.host) ||\n        isParent(source.host, target.host)) {\n      return false;\n    }\n\n    if (hasIncomingOnPartConnections(source)) {\n      return false;\n    }\n\n    if (!this.canAttachExitCriterion(source, source.host)) {\n      return false;\n    }\n\n    return {\n      type: 'cmmn:PlanItemOnPart',\n      isStandardEventVisible: true,\n      replacements: [{\n        oldElementId: source.id,\n        newElementType: 'cmmn:ExitCriterion'\n      }]\n    };\n\n  }\n\n  return false;\n\n};\n\n\nCmmnRules.prototype.canReplaceTarget = function(source, target) {\n\n  if (isHumanTask(getDefinition(source)) && isPlanItem(target)) {\n\n    if (!isBlocking(source)) {\n      return false;\n    }\n\n    if (isEventListener(target) || isMilestone(target)) {\n      return false;\n    }\n\n    if (isSameDefinition(source, target)) {\n      return false;\n    }\n\n    if (!isSameParent(source, target)) {\n      return false;\n    }\n\n    return {\n      type: 'cmmndi:CMMNEdge',\n      replacements: [{\n        oldElementId: target.id,\n        newElementType: 'cmmn:DiscretionaryItem'\n      }]\n    };\n\n  }\n\n  if ((isPlanItem(source) || isExitCriterion(source)) && isEntryCriterion(target)) {\n\n    if (isSame(source.host || source, target.host)) {\n      return false;\n    }\n\n    if (!isParent(target.host, source.host || source)) {\n      return false;\n    }\n\n    if (hasIncomingOnPartConnections(target)) {\n      return false;\n    }\n\n    if (!this.canAttachExitCriterion(target, target.host)) {\n      return false;\n    }\n\n    return {\n      type: 'cmmn:PlanItemOnPart',\n      isStandardEventVisible: true,\n      replacements: [{\n        oldElementId: target.id,\n        newElementType: 'cmmn:ExitCriterion'\n      }]\n    };\n\n  }\n\n  return false;\n\n};\n\n\nCmmnRules.prototype.canSetRepetitionRule = function(element) {\n  return isPlanItemControlCapable(element);\n};\n\n\nCmmnRules.prototype.canSetRequiredRule = function(element) {\n  return isPlanItemControlCapable(element);\n};\n\n\nCmmnRules.prototype.canSetManualActivationRule = function(element) {\n  if (isMilestone(element)) {\n    return false;\n  }\n  return isPlanItemControlCapable(element);\n};\n\n\n/**\n * Utility functions for rule checking\n */\n\n/**\n * Checks if given element can be used for starting connection.\n *\n * @param  {Element} source\n * @return {Boolean}\n */\nfunction canStartConnection(element) {\n  if (nonExistingOrLabel(element)) {\n    return null;\n  }\n\n  return isAny(element, [\n    'cmmn:CaseFileItem',\n    'cmmn:Criterion',\n    'cmmn:DiscretionaryItem',\n    'cmmn:PlanItem'\n  ]);\n}\n\nfunction isParent(possibleParent, element) {\n  var allParents = getParents(element);\n  return allParents.indexOf(possibleParent) !== -1;\n}\n\nfunction isPlanItemControlCapable(element) {\n  return isTask(element) || isMilestone(element) || is(getDefinition(element), 'cmmn:Stage');\n}\n\nfunction nonExistingOrLabel(element) {\n  return !element || isLabel(element);\n}\n\nfunction isLabel(element) {\n  return element.labelTarget;\n}\n\nfunction isConnection(element) {\n  return element.waypoints;\n}\n\nfunction isUniqueDiscretionaryConnection(source, target, connection) {\n  return !some(target.incoming, function(con) {\n    return con !== connection &&\n        isDiscretionaryConnection(con) &&\n        con.source === source &&\n        con.target === target;\n  });\n}\n\nfunction hasIncomingDiscretionaryConnections(target, connection) {\n  return some(target.incoming, function(con) {\n    return con !== connection && isDiscretionaryConnection(con);\n  });\n}\n\nfunction isDiscretionaryConnection(connection) {\n  return !connection.businessObject.cmmnElementRef;\n}\n\nfunction hasIncomingOnPartConnections(target) {\n  return some(target.incoming, function(con) {\n    return isOnPartConnection(con);\n  });\n}\n\nfunction isOnPartConnection(connection) {\n  return is(connection.businessObject.cmmnElementRef, 'cmmn:OnPart');\n}\n\nfunction isPlanFragment(element, isStage) {\n  var definition = getDefinition(element) || element;\n\n  if (!is(definition, 'cmmn:PlanFragment')) {\n    return false;\n  }\n\n  if (!isStage && is(definition, 'cmmn:Stage')) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction isEventListener(element) {\n  return is(getDefinition(element), 'cmmn:EventListener');\n}\n\nfunction isMilestone(element) {\n  return is(getDefinition(element), 'cmmn:Milestone');\n}\n\nfunction isTask(element) {\n  return is(getDefinition(element), 'cmmn:Task');\n}\n\nfunction isBlocking(element) {\n  element = getDefinition(element);\n  return !!(element && element.isBlocking);\n}\n\nfunction isCriterion(element) {\n  return is(element, 'cmmn:Criterion');\n}\n\nfunction isEntryCriterion(element) {\n  return is(element, 'cmmn:EntryCriterion');\n}\n\nfunction isExitCriterion(element) {\n  return is(element, 'cmmn:ExitCriterion');\n}\n\nfunction isArtifact(element) {\n  if (isConnection(element)) {\n    element = element.businessObject.cmmnElementRef;\n  }\n  return is(element, 'cmmn:Artifact');\n}\n\nfunction isTextAnnotation(element) {\n  return is(element, 'cmmn:TextAnnotation');\n}\n\nfunction isCaseFileItem(element) {\n  return is(element, 'cmmn:CaseFileItem');\n}\n\nfunction isPlanItem(element) {\n  return is(element, 'cmmn:PlanItem');\n}\n\nfunction isSameParent(a, b) {\n  return isSame(getParent(a), getParent(b));\n}\n\nfunction isSameDefinition(a, b) {\n  return isSame(getDefinition(a), getDefinition(b));\n}\n","'use strict';\n\nvar map = require('min-dash').map,\n    assign = require('min-dash').assign,\n    pick = require('min-dash').pick;\n\nvar isAny = require('./util/ModelingUtil').isAny;\n\nfunction CmmnFactory(moddle) {\n  this._model = moddle;\n}\n\nCmmnFactory.$inject = [ 'moddle' ];\n\n\nCmmnFactory.prototype._needsId = function(element) {\n  return isAny(element, [\n    'cmmn:CMMNElement',\n    'cmmndi:CMMNShape',\n    'cmmndi:CMMNEdge',\n    'cmmndi:CMMNStyle',\n    'cmmndi:CMMNDiagram'\n  ]);\n};\n\nCmmnFactory.prototype._ensureId = function(element) {\n  // generate semantic ids for elements\n  var prefix = (element.$type || '').replace(/^[^:]*:/g, '') + '_';\n\n  if (!element.id && this._needsId(element)) {\n    element.id = this._model.ids.nextPrefixed(prefix, element);\n  }\n};\n\n\nCmmnFactory.prototype.create = function(type, attrs) {\n  var element = this._model.create(type, attrs || {});\n\n  this._ensureId(element);\n\n  return element;\n};\n\n\nCmmnFactory.prototype.createDiLabel = function() {\n  return this.create('cmmndi:CMMNLabel');\n};\n\n\nCmmnFactory.prototype.createDiShape = function(semantic, bounds, attrs) {\n  return this.create('cmmndi:CMMNShape', assign({\n    cmmnElementRef: semantic,\n    bounds: this.createDiBounds(bounds),\n    label: this.createDiLabel()\n  }, attrs));\n};\n\n\nCmmnFactory.prototype.createDiEdge = function(semantic, waypoints, attrs) {\n  return this.create('cmmndi:CMMNEdge', assign({\n    cmmnElementRef: semantic,\n    label: this.createDiLabel()\n  }, attrs));\n};\n\n\nCmmnFactory.prototype.createDiBounds = function(bounds) {\n  return this.create('dc:Bounds', bounds);\n};\n\n\nCmmnFactory.prototype.createDiWaypoints = function(waypoints) {\n\n  var self = this;\n\n  return map(waypoints, function(pos) {\n    return self.createDiWaypoint(pos);\n  });\n};\n\n\nCmmnFactory.prototype.createDiWaypoint = function(point) {\n  return this.create('dc:Point', pick(point, [ 'x', 'y' ]));\n};\n\n\nCmmnFactory.prototype.createItem = function(itemType, definitionType) {\n\n  var definition = this.create(definitionType);\n\n  return this.create(itemType, {\n    definitionRef: definition\n  });\n};\n\n\nCmmnFactory.prototype.createCriterion = function(criterionType, attrs) {\n\n  attrs = attrs || {};\n\n  if (!attrs.sentryRef) {\n    attrs = assign({\n      sentryRef: this.createSentry()\n    }, attrs);\n  }\n\n  return this.create(criterionType, attrs);\n};\n\n\nCmmnFactory.prototype.createSentry = function(attrs) {\n  return this.create('cmmn:Sentry', attrs);\n};\n\n\nCmmnFactory.prototype.createCasePlanModel = function() {\n\n  var casePlanModel = this.create('cmmn:Stage');\n\n  // overwrite generated id to 'CasePlanModel_...'\n  this._model.ids.unclaim(casePlanModel.id);\n  casePlanModel.id = this._model.ids.nextPrefixed('CasePlanModel_', casePlanModel);\n\n  var _case = this.create('cmmn:Case', {\n    casePlanModel: casePlanModel\n  });\n\n  casePlanModel.$parent = _case;\n\n  return casePlanModel;\n\n};\n\n\nCmmnFactory.prototype.createCaseFileModel = function(_case) {\n\n  var caseFileModel = this.create('cmmn:CaseFile');\n\n  // overwrite generated id to 'CaseFileModel_...'\n  this._model.ids.unclaim(caseFileModel.id);\n  caseFileModel.id = this._model.ids.nextPrefixed('CaseFileModel_', caseFileModel);\n\n  caseFileModel.$parent = _case;\n\n  return caseFileModel;\n\n};\n\n\nCmmnFactory.prototype.createCaseFileItem = function(attrs) {\n\n  attrs = attrs || {};\n\n  if (!attrs.definitionRef) {\n\n    attrs = assign({\n      definitionRef: this.create('cmmn:CaseFileItemDefinition')\n    }, attrs);\n\n  }\n\n  return this.create('cmmn:CaseFileItem', attrs);\n\n};\n\nmodule.exports = CmmnFactory;\n","'use strict';\n\nvar assign = require('min-dash').assign,\n    inherits = require('inherits');\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\nvar Collections = require('diagram-js/lib/util/Collections');\n\nvar getBusinessObject = require('../../util/ModelUtil').getBusinessObject,\n    is = require('../../util/ModelUtil').is,\n    isCasePlanModel = require('../../util/ModelUtil').isCasePlanModel;\n\nvar getParent = require('./util/ModelingUtil').getParent,\n    isLabel = require('./util/ModelingUtil').isLabel;\n\nvar isAny = require('./util/ModelingUtil').isAny;\n\n/**\n * A handler responsible for updating the underlying CMMN 1.1 XML + DI\n * once changes on the diagram happen\n */\nfunction CmmnUpdater(eventBus, cmmnFactory, itemRegistry, connectionDocking) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this._cmmnFactory = cmmnFactory;\n  this._itemRegistry = itemRegistry;\n\n  var self = this;\n\n\n  // connection cropping /////////////////\n\n  // crop connection ends during create/update\n  function cropConnection(e) {\n    var context = e.context,\n        connection;\n\n    if (!context.cropped) {\n      connection = context.connection;\n      connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n      context.cropped = true;\n    }\n  }\n\n  this.executed([\n    'connection.layout',\n    'connection.create',\n    'connection.reconnectEnd',\n    'connection.reconnectStart'\n  ], cropConnection);\n\n  this.reverted([\n    'connection.layout',\n    'connection.create',\n    'connection.reconnectEnd',\n    'connection.reconnectStart'\n  ], function(e) {\n    delete e.context.cropped;\n  });\n\n  // CMMN + DI update /////////////////\n\n  function updateParent(e) {\n    var context = e.context;\n\n    self.updateParent(context.shape || context.connection, context.oldParent);\n  }\n\n  function reverseUpdateParent(e) {\n\n    var context = e.context;\n\n    var element = context.shape || context.connection,\n        // oldParent is the (old) new parent, because we are undoing\n        oldParent = context.parent || context.newParent;\n\n    self.updateParent(element, oldParent);\n  }\n\n  this.executed([\n    'shape.create',\n    'shape.move',\n    'shape.delete',\n    'connection.delete',\n    'connection.create'\n  ], ifCmmn(updateParent));\n  this.reverted([\n    'shape.create',\n    'shape.move',\n    'shape.delete',\n    'connection.delete',\n    'connection.create'\n  ], ifCmmn(reverseUpdateParent));\n\n\n  // update bounds\n  function updateBounds(e) {\n    var shape = e.context.shape;\n    self.updateBounds(shape);\n  }\n\n  this.executed([\n    'shape.create',\n    'shape.move',\n    'shape.resize'\n  ], ifCmmn(function(event) {\n\n    // exclude labels because they're handled separately during shape.changed\n    if (event.context.shape.type === 'label') {\n      return;\n    }\n\n    updateBounds(event);\n  }));\n\n  this.reverted([\n    'shape.create',\n    'shape.move',\n    'shape.resize'\n  ], ifCmmn(function(event) {\n\n    // exclude labels because they're handled separately during shape.changed\n    if (event.context.shape.type === 'label') {\n      return;\n    }\n\n    updateBounds(event);\n  }));\n\n  // Handle labels separately. This is necessary, because the label bounds have to be updated\n  // every time its shape changes, not only on move, create and resize.\n  eventBus.on('shape.changed', function(event) {\n    if (event.element.type === 'label') {\n      updateBounds({ context: { shape: event.element } });\n    }\n  });\n\n  // attach / detach connection\n  function updateConnection(e) {\n    self.updateConnection(e.context);\n  }\n\n  this.executed([\n    'connection.create',\n    'connection.move',\n    'connection.delete',\n    'connection.reconnectEnd',\n    'connection.reconnectStart'\n  ], ifCmmn(updateConnection));\n\n  this.reverted([\n    'connection.create',\n    'connection.move',\n    'connection.delete',\n    'connection.reconnectEnd',\n    'connection.reconnectStart'\n  ], ifCmmn(updateConnection));\n\n\n  // update waypoints\n  function updateConnectionWaypoints(e) {\n    self.updateConnectionWaypoints(e.context.connection);\n  }\n\n  this.executed([\n    'connection.create',\n    'connection.layout',\n    'connection.move',\n    'connection.reconnectStart',\n    'connection.reconnectEnd',\n    'connection.updateWaypoints'\n  ], ifCmmn(updateConnectionWaypoints));\n\n  this.reverted([\n    'connection.create',\n    'connection.layout',\n    'connection.move',\n    'connection.reconnectStart',\n    'connection.reconnectEnd',\n    'connection.updateWaypoints'\n  ], ifCmmn(updateConnectionWaypoints));\n\n  // update attachments\n  function updateAttachment(e) {\n    self.updateAttachment(e.context);\n  }\n\n  this.executed([ 'element.updateAttachment' ], ifCmmn(updateAttachment));\n  this.reverted([ 'element.updateAttachment' ], ifCmmn(updateAttachment));\n\n\n  // update item registry\n\n  function addItem(e) {\n    var context = e.context,\n        shape = context.shape,\n        bo = getBusinessObject(shape);\n\n    itemRegistry.add(bo);\n  }\n\n  function removeItem(e) {\n\n    var context = e.context,\n        shape = context.shape;\n\n    if (isLabel(shape)) {\n      return;\n    }\n\n    var bo = getBusinessObject(shape);\n    itemRegistry.remove(bo);\n  }\n\n  this.executed('shape.create', ifCmmn(addItem));\n  this.reverted('shape.create', ifCmmn(removeItem));\n\n  this.executed('shape.delete', ifCmmn(removeItem));\n  this.reverted('shape.delete', ifCmmn(addItem));\n\n}\n\ninherits(CmmnUpdater, CommandInterceptor);\n\nmodule.exports = CmmnUpdater;\n\nCmmnUpdater.$inject = [ 'eventBus', 'cmmnFactory', 'itemRegistry', 'connectionDocking' ];\n\n\n// implementation /////////////////\n\n\nCmmnUpdater.prototype.updateAttachment = function(context) {\n  var shape = context.shape,\n      businessObject = getBusinessObject(shape),\n      host = shape.host,\n      businessObjectHost = host && getBusinessObject(host);\n\n  this.updateSemanticParent(businessObject, businessObjectHost);\n};\n\n\nCmmnUpdater.prototype.updateParent = function(element, oldParent) {\n  // do not update CMMN 1.1 label parent\n  if (isLabel(element)) {\n    return;\n  }\n\n  var businessObject = getBusinessObject(element),\n      parentBusinessObject = getBusinessObject(element.parent),\n      businessObjectDi = businessObject.di || businessObject,\n      parentDi = parentBusinessObject && parentBusinessObject.di;\n\n  if (isAssociation(businessObject)) {\n    businessObject = businessObject.cmmnElementRef;\n  }\n\n  if (shouldUpdateSemanticParent(businessObject)) {\n    this.updateSemanticParent(businessObject, parentBusinessObject);\n  }\n\n  if (is(parentBusinessObject, 'cmmndi:CMMNDiagram')) {\n    parentDi = parentBusinessObject;\n  }\n\n  this.updateDiParent(businessObjectDi, parentDi);\n};\n\n\n/**\n * Update the semantic parent\n *\n * - add/remove the business object to/from the parent's containment(s)\n * - set/unset the $parent property of the business object\n *\n * @param  {ModdleElement} businessObject\n * @param  {ModdleElement} newParent\n */\nCmmnUpdater.prototype.updateSemanticParent = function(businessObject, newParent) {\n\n  var containment;\n\n  if (businessObject.$parent === newParent) {\n    return;\n  }\n\n  if (is(businessObject, 'cmmn:PlanItem')) {\n    containment = 'planItems';\n\n    if (newParent && !isCasePlanModel(newParent)) {\n      newParent = newParent.definitionRef;\n    }\n\n  } else\n\n  if (isCasePlanModel(businessObject)) {\n    containment = 'cases';\n    businessObject = businessObject.$parent;\n    newParent = newParent && getDefinitions(newParent);\n  } else\n\n  if (is(businessObject, 'cmmn:EntryCriterion')) {\n\n    if (isCasePlanModel(newParent)) {\n      newParent = null;\n    }\n\n    containment = 'entryCriteria';\n  } else\n\n  if (is(businessObject, 'cmmn:ExitCriterion')) {\n    containment = 'exitCriteria';\n  } else\n\n  if (is(businessObject, 'cmmn:Artifact')) {\n    newParent = newParent && getDefinitions(newParent);\n    containment = 'artifacts';\n  }\n\n  if (!containment) {\n    throw new Error('no parent for ', businessObject, newParent);\n  }\n\n  var children;\n\n  if (businessObject.$parent) {\n    // remove from old parent\n    children = businessObject.$parent.get(containment);\n    Collections.remove(children, businessObject);\n  }\n\n  if (newParent) {\n    // add to new parent\n    children = newParent.get(containment);\n    children.push(businessObject);\n    businessObject.$parent = newParent;\n  } else {\n    businessObject.$parent = null;\n  }\n\n};\n\n\n/**\n * Upate the parent of an DI element\n *\n * - Add/remove DI element to the root element's diagramElements conainment\n * - Set/unset the $parent property of the DI element\n *\n * @param  {ModdleElement} di\n * @param  {ModdleElement} parentDi\n */\nCmmnUpdater.prototype.updateDiParent = function(di, parentDi) {\n  if (parentDi && !is(parentDi, 'cmmndi:CMMNDiagram')) {\n    parentDi = parentDi.$parent;\n  }\n\n  if (di.$parent === parentDi) {\n    return;\n  }\n\n  var diagramElements = (parentDi || di.$parent).get('diagramElements');\n\n  if (parentDi) {\n    diagramElements.push(di);\n    di.$parent = parentDi;\n  }\n  else {\n    Collections.remove(diagramElements, di);\n    di.$parent = null;\n  }\n};\n\n\nCmmnUpdater.prototype.updateBounds = function(shape) {\n  var di = shape.businessObject.di || shape.businessObject;\n\n  var bounds = isLabel(shape) ? this._getLabel(di).bounds : di.bounds;\n\n  assign(bounds, {\n    x: shape.x,\n    y: shape.y,\n    width: shape.width,\n    height: shape.height\n  });\n};\n\n\nCmmnUpdater.prototype.updateConnectionWaypoints = function(connection) {\n  var di = connection.businessObject;\n  di.set('waypoint', this._cmmnFactory.createDiWaypoints(connection.waypoints));\n};\n\n\nCmmnUpdater.prototype.updateConnection = function(context) {\n\n  var connection = context.connection,\n      businessObject = getBusinessObject(connection),\n      newSource = getBusinessObject(connection.source),\n      newTarget = getBusinessObject(connection.target),\n      cmmnElement = businessObject.cmmnElementRef,\n      sourceElem,\n      targetElem,\n      sourceAttr,\n      targetAttr;\n\n\n  if (is(cmmnElement, 'cmmn:Association')) {\n    sourceElem = cmmnElement;\n    targetElem = cmmnElement;\n\n    sourceAttr = 'sourceRef';\n    targetAttr = 'targetRef';\n  }\n  else {\n    targetElem = businessObject;\n    targetAttr = 'targetCMMNElementRef';\n\n    if (is(cmmnElement, 'cmmn:OnPart')) {\n\n      sourceElem = cmmnElement;\n      sourceAttr = 'sourceRef';\n\n      var newExitCriterionRef;\n      if (is(newSource, 'cmmn:ExitCriterion')) {\n        newExitCriterionRef = newSource;\n        newSource = getParent(newExitCriterionRef);\n      }\n\n      if (cmmnElement.exitCriterionRef !== newExitCriterionRef) {\n        cmmnElement.exitCriterionRef = newExitCriterionRef;\n      }\n\n    }\n    else {\n      sourceElem = businessObject;\n      sourceAttr = 'sourceCMMNElementRef';\n    }\n\n  }\n\n  if (sourceAttr && sourceElem[sourceAttr] !== newSource) {\n    sourceElem[sourceAttr] = newSource;\n  }\n\n  if (targetAttr && targetElem[targetAttr] !== newTarget) {\n    targetElem[targetAttr] = newTarget;\n  }\n\n  this.updateConnectionWaypoints(connection);\n};\n\n// helpers /////////////////\n\nCmmnUpdater.prototype._getLabel = function(di) {\n\n  if (!di.label) {\n    di.label = this._cmmnFactory.createDiLabel();\n  }\n\n  if (!di.label.bounds) {\n    di.label.bounds = this._cmmnFactory.createDiBounds();\n  }\n\n  return di.label;\n};\n\n\n/**\n * Make sure the event listener is only called\n * if the touched element is a CMMN element.\n *\n * @param  {Function} fn\n * @return {Function} guarded function\n */\nfunction ifCmmn(fn) {\n\n  return function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection;\n\n    if (is(element, 'cmmn:CMMNElement') || is(element, 'cmmndi:CMMNDiagramElement')) {\n      fn(event);\n    }\n  };\n}\n\n/**\n * Returns the cmmn:Definitions element for a given element.\n */\nfunction getDefinitions(element) {\n  return getParent(element, 'cmmn:Definitions');\n}\n\nfunction shouldUpdateSemanticParent(element) {\n  return !isAny(element, [\n    'cmmn:CaseFileItem',\n    'cmmn:Criterion',\n    'cmmn:DiscretionaryItem',\n    'cmmn:OnPart',\n    'cmmndi:CMMNEdge'\n  ]);\n}\n\nfunction isAssociation(connection) {\n  connection = connection.businessObject || connection;\n  return !!(connection.cmmnElementRef && is(connection.cmmnElementRef, 'cmmn:Association'));\n}\n","'use strict';\n\nvar assign = require('min-dash').assign,\n    inherits = require('inherits');\n\nvar BaseElementFactory = require('diagram-js/lib/core/ElementFactory').default,\n    LabelUtil = require('../../util/LabelUtil');\n\nvar is = require('../../util/ModelUtil').is,\n    getDefinition = require('../../util/ModelUtil').getDefinition,\n    isCasePlanModel = require('../../util/ModelUtil').isCasePlanModel;\n\nvar isCollapsed = require('../../util/DiUtil').isCollapsed;\n\n/**\n * A cmmn-aware factory for diagram-js shapes\n */\nfunction ElementFactory(cmmnFactory, moddle) {\n  BaseElementFactory.call(this);\n\n  this._cmmnFactory = cmmnFactory;\n  this._moddle = moddle;\n}\n\ninherits(ElementFactory, BaseElementFactory);\n\n\nElementFactory.$inject = [ 'cmmnFactory', 'moddle' ];\n\nmodule.exports = ElementFactory;\n\nElementFactory.prototype.baseCreate = BaseElementFactory.prototype.create;\n\nElementFactory.prototype.create = function(elementType, attrs) {\n  // no special magic for labels,\n  // we assume their businessObjects have already been created\n  // and wired via attrs\n  if (elementType === 'label') {\n    return this.baseCreate(elementType, assign({ type: 'label' }, LabelUtil.DEFAULT_LABEL_SIZE, attrs));\n  }\n\n  if (elementType === 'root') {\n    return this.baseCreate(elementType, attrs);\n  }\n\n  return this.createCmmnElement(elementType, attrs);\n};\n\n\nElementFactory.prototype.createCmmnElement = function(elementType, attrs) {\n\n  attrs = assign({}, attrs || {});\n\n  var size;\n\n  var businessObject = attrs.businessObject;\n\n  if (!businessObject) {\n    if (!attrs.type) {\n      throw new Error('no shape type specified');\n    }\n\n    var props = {};\n\n    if (attrs.name) {\n      assign(props, {\n        name: attrs.name\n      });\n    }\n\n    businessObject = this._cmmnFactory.create(attrs.type, props);\n  }\n\n\n  if (elementType === 'connection') {\n\n    if (!is(businessObject, 'cmmndi:CMMNEdge')) {\n      businessObject = this._cmmnFactory.createDiEdge(businessObject, [], {\n        id: businessObject.id + '_di'\n      });\n    }\n\n    if (!businessObject.label) {\n      businessObject.label = this._cmmnFactory.createDiLabel();\n    }\n\n    attrs.type = 'cmmndi:CMMNEdge';\n  }\n\n  if (attrs.definitionType) {\n    var definition = this._cmmnFactory.create(attrs.definitionType);\n    businessObject.definitionRef = definition;\n  }\n\n  if (attrs.sentryRef) {\n    businessObject.sentryRef = attrs.sentryRef;\n  }\n\n  if (elementType === 'shape' && !businessObject.di) {\n    businessObject.di = this._cmmnFactory.createDiShape(businessObject, {}, {\n      id: businessObject.id + '_di'\n    });\n  }\n\n  if (attrs.isCollapsed) {\n    businessObject.di.isCollapsed = attrs.isCollapsed;\n  }\n\n  if (attrs.isPlanningTableCollapsed) {\n    businessObject.di.isPlanningTableCollapsed = attrs.isPlanningTableCollapsed;\n  }\n\n  if (attrs.isStandardEventVisible) {\n    businessObject.isStandardEventVisible = attrs.isStandardEventVisible;\n  }\n\n  if (attrs.isBlocking !== undefined) {\n    businessObject.definitionRef.isBlocking = attrs.isBlocking;\n  }\n\n  if (attrs.autoComplete) {\n    businessObject.definitionRef.autoComplete = true;\n  }\n\n  size = this._getDefaultSize(businessObject);\n\n  attrs = assign({\n    businessObject: businessObject,\n    id: businessObject.id\n  }, size, attrs);\n\n  return this.baseCreate(elementType, attrs);\n};\n\n\nElementFactory.prototype._getDefaultSize = function(semantic) {\n\n  var definition = getDefinition(semantic);\n\n  // CasePlanModel (type of semantic is 'cmmn:Stage')\n  if (isCasePlanModel(semantic)) {\n    return { width: 400, height: 250 };\n  }\n\n  if (is(definition, 'cmmn:PlanFragment')) {\n    if (isCollapsed(semantic)) {\n      return { width: 100, height: 80 };\n    }\n    else {\n      return { width: 350, height: 200 };\n    }\n  }\n\n  if (is(definition, 'cmmn:Milestone')) {\n    return { width: 100, height: 40 };\n  }\n\n  if (is(definition, 'cmmn:EventListener')) {\n    return { width: 36, height: 36 };\n  }\n\n  if (is(semantic, 'cmmn:Criterion')) {\n    return { width: 20, height: 28 };\n  }\n\n  if (is(semantic, 'cmmn:TextAnnotation')) {\n    return { width: 100, height: 30 };\n  }\n\n  if (is(semantic, 'cmmn:CaseFileItem')) {\n    return { width: 36, height: 50 };\n  }\n\n  return { width: 100, height: 80 };\n};\n\n\nElementFactory.prototype.createPlanItemShape = function(type) {\n  return this.createShape({\n    type: 'cmmn:PlanItem',\n    businessObject: this._cmmnFactory.createItem('cmmn:PlanItem', type)\n  });\n};\n\n\nElementFactory.prototype.createDiscretionaryItemShape = function(type) {\n  return this.createShape({\n    type: 'cmmn:DiscretionaryItem',\n    businessObject: this._cmmnFactory.createItem('cmmn:DiscretionaryItem', type)\n  });\n};\n\n\nElementFactory.prototype.createCasePlanModelShape = function() {\n  return this.createShape({\n    type: 'cmmn:Stage',\n    businessObject: this._cmmnFactory.createCasePlanModel()\n  });\n};\n\n\nElementFactory.prototype.createCriterionShape = function(type) {\n  return this.createShape({\n    type: type,\n    businessObject: this._cmmnFactory.createCriterion(type)\n  });\n};\n\n\nElementFactory.prototype.createCaseFileItemShape = function() {\n  return this.createShape({\n    type: 'cmmn:CaseFileItem',\n    businessObject: this._cmmnFactory.createCaseFileItem()\n  });\n};\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar assign = require('min-dash').assign;\n\nvar BaseModeling = require('diagram-js/lib/features/modeling/Modeling').default;\n\nvar AppendShapeHandler = require('./cmd/AppendShapeHandler');\nvar ReconnectConnectionHandler = require('./cmd/ReconnectConnectionHandler');\nvar ReplaceShapeHandler = require('./cmd/ReplaceShapeHandler');\n\nvar UpdatePropertiesHandler = require('./cmd/UpdatePropertiesHandler');\nvar UpdateSemanticParentHandler = require('./cmd/UpdateSemanticParentHandler');\nvar UpdateControlsHandler = require('./cmd/UpdateControlsHandler');\n\nvar IdClaimHandler = require('./cmd/IdClaimHandler');\n\n/**\n * CMMN 1.1 modeling features activator\n *\n * @param {EventBus} eventBus\n * @param {ElementFactory} elementFactory\n * @param {CommandStack} commandStack\n */\nfunction Modeling(eventBus, elementFactory, commandStack, cmmnRules, rules) {\n  BaseModeling.call(this, eventBus, elementFactory, commandStack);\n\n  this._cmmnRules = cmmnRules;\n  this._rules = rules;\n}\n\ninherits(Modeling, BaseModeling);\n\nModeling.$inject = [ 'eventBus', 'elementFactory', 'commandStack', 'cmmnRules', 'rules' ];\n\nmodule.exports = Modeling;\n\n\nModeling.prototype.getHandlers = function() {\n  var handlers = BaseModeling.prototype.getHandlers.call(this);\n\n  handlers['shape.append'] = AppendShapeHandler;\n  handlers['shape.replace'] = ReplaceShapeHandler;\n  handlers['connection.reconnectStart'] = ReconnectConnectionHandler;\n  handlers['connection.reconnectEnd'] = ReconnectConnectionHandler;\n\n  handlers['element.updateProperties'] = UpdatePropertiesHandler;\n  handlers['element.updateSemanticParent'] = UpdateSemanticParentHandler;\n\n  handlers['element.updateControls'] = UpdateControlsHandler;\n\n  handlers['id.updateClaim'] = IdClaimHandler;\n\n  return handlers;\n};\n\n\nModeling.prototype.connect = function(source, target, attrs, hints) {\n\n  var rules = this._rules;\n\n  if (!attrs) {\n    attrs = rules.allowed('connection.create', {\n      source: source,\n      target: target\n    }) || { type: 'cmmn:Association' };\n  }\n\n  if (attrs.reverse) {\n\n    if (hints) {\n      hints = {\n        connectionStart: hints.connectionEnd,\n        connectionEnd: hints.connectionStart\n      };\n    }\n\n    return this.createConnection(target, source, attrs, target.parent, hints);\n  }\n\n  return this.createConnection(source, target, attrs, source.parent, hints);\n};\n\n\nModeling.prototype.createConnection = function(source, target, targetIndex, connection, parent, hints) {\n\n  // Overwrite existing createConnection() method to provide additional\n  // information in the context. This must be done to enable the replacement\n  // of the target element, if necessary.\n\n  if (typeof targetIndex === 'object') {\n    hints = parent;\n    parent = connection;\n    connection = targetIndex;\n    targetIndex = undefined;\n  }\n\n  var context = {\n    source: source,\n    target: target,\n    parent: parent,\n    parentIndex: targetIndex,\n    canExecute: connection,\n    hints: hints\n  };\n\n  connection = this._create('connection', connection);\n\n  assign(context, {\n    connection: connection\n  });\n\n  this._commandStack.execute('connection.create', context);\n\n  return context.connection;\n};\n\n\nModeling.prototype.reconnectStart = function(connection, newSource, dockingOrPoints, hints) {\n  var context = {\n    connection: connection,\n    newSource: newSource,\n    dockingOrPoints: dockingOrPoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.reconnectStart', context);\n};\n\n\nModeling.prototype.reconnectEnd = function(connection, newTarget, dockingOrPoints, hints) {\n  var context = {\n    connection: connection,\n    newTarget: newTarget,\n    dockingOrPoints: dockingOrPoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.reconnectEnd', context);\n};\n\n\nModeling.prototype.updateProperties = function(element, properties, shape) {\n  this._commandStack.execute('element.updateProperties', {\n    element: element,\n    properties: properties,\n    shape: shape\n  });\n};\n\n\nModeling.prototype.updateSemanticParent = function(element, newParent, containment, shape) {\n  this._commandStack.execute('element.updateSemanticParent', {\n    element: element,\n    newParent: newParent,\n    containment: containment,\n    shape: shape\n  });\n};\n\n\nModeling.prototype.updateControls = function(element, values) {\n  this._commandStack.execute('element.updateControls', {\n    element: element,\n    values: values\n  });\n};\n\n\nModeling.prototype.claimId = function(id, moddleElement) {\n  this._commandStack.execute('id.updateClaim', {\n    id: id,\n    element: moddleElement,\n    claiming: true\n  });\n};\n\n\nModeling.prototype.unclaimId = function(id, moddleElement) {\n  this._commandStack.execute('id.updateClaim', {\n    id: id,\n    element: moddleElement\n  });\n};\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar is = require('../../../util/ModelUtil').is;\n\nvar BaseHandler = require('diagram-js/lib/features/modeling/cmd/AppendShapeHandler').default;\n\n\nfunction AppendShapeHandler(modeling, cmmnRules) {\n  this._modeling = modeling;\n  this._cmmnRules = cmmnRules;\n}\n\ninherits(AppendShapeHandler, BaseHandler);\n\n\nAppendShapeHandler.$inject = [ 'modeling', 'cmmnRules' ];\n\nmodule.exports = AppendShapeHandler;\n\n\n// api /////////////////\n\nAppendShapeHandler.prototype.preExecute = function(context) {\n\n  if (!context.source) {\n    throw new Error('source required');\n  }\n\n  var cmmnRules = this._cmmnRules;\n\n  var shape = context.shape,\n      source = context.source,\n      parent = context.target || context.source.parent,\n      position = context.position,\n      isAttach = context.attach;\n\n  if (isCriterion(shape)) {\n    isAttach = cmmnRules.canAttach(shape, parent, source, position) === 'attach';\n  }\n\n  context.shape = this._modeling.createShape(shape, position, parent, {\n    attach: isAttach,\n    nested: true\n  });\n\n};\n\nfunction isCriterion(element) {\n  return is(element, 'cmmn:Criterion');\n}","'use strict';\n\nvar inherits = require('inherits');\n\nvar isArray = require('min-dash').isArray;\n\nvar BaseHandler = require('diagram-js/lib/features/modeling/cmd/ReconnectConnectionHandler').default;\n\n/**\n * Overwrites the behavior of diagram-js/ReconnectConnectionHandler to enable\n * a switch between source and target of a connection on reconnect.\n */\nfunction ReconnectConnectionHandler(injector) {\n  injector.invoke(BaseHandler, this);\n}\n\ninherits(ReconnectConnectionHandler, BaseHandler);\n\nReconnectConnectionHandler.$inject = [ 'injector' ];\n\nmodule.exports = ReconnectConnectionHandler;\n\n\nReconnectConnectionHandler.prototype.execute = function(context) {\n\n  var newSource = context.newSource,\n      newTarget = context.newTarget,\n      connection = context.connection,\n      dockingOrPoints = context.dockingOrPoints;\n\n  if (!newSource && !newTarget) {\n    throw new Error('newSource or newTarget are required');\n  }\n\n  // removed from corresponding method in diagram-js@3.3.0\n\n  // if (newSource && newTarget) {\n  //   throw new Error('must specify either newSource or newTarget');\n  // }\n\n  if (isArray(dockingOrPoints)) {\n    context.oldWaypoints = connection.waypoints;\n    connection.waypoints = dockingOrPoints;\n  }\n\n  if (newSource) {\n    context.oldSource = connection.source;\n    connection.source = newSource;\n  }\n\n  if (newTarget) {\n    context.oldTarget = connection.target;\n    connection.target = newTarget;\n  }\n\n  return connection;\n};","'use strict';\n\nvar inherits = require('inherits');\n\nvar BaseHandler = require('diagram-js/lib/features/modeling/cmd/ReplaceShapeHandler').default;\n\n\nfunction ReplaceShapeHandler(modeling, rules) {\n  this._modeling = modeling;\n  this._rules = rules;\n}\n\ninherits(ReplaceShapeHandler, BaseHandler);\n\nReplaceShapeHandler.$inject = [ 'modeling', 'rules' ];\n\nmodule.exports = ReplaceShapeHandler;\n\n\n// api /////////////////\n\n\nReplaceShapeHandler.prototype.createShape = function(shape, position, target) {\n  var modeling = this._modeling;\n  return modeling.createShape(shape, position, target, {\n    nested: true\n  });\n};\n\n\nReplaceShapeHandler.prototype.reconnectStart = function(connection, newSource, dockingPoint) {\n  var modeling = this._modeling;\n  modeling.reconnectStart(connection, newSource, dockingPoint, {\n    nested: true,\n    startChanged: true\n  });\n};\n\n\nReplaceShapeHandler.prototype.reconnectEnd = function(connection, newTarget, dockingPoint) {\n  var modeling = this._modeling;\n  modeling.reconnectEnd(connection, newTarget, dockingPoint, {\n    nested: true,\n    endChanged: true\n  });\n};\n","'use strict';\n\nvar reduce = require('min-dash').reduce,\n    keys = require('min-dash').keys,\n    forEach = require('min-dash').forEach,\n    assign = require('min-dash').assign;\n\nvar getBusinessObject = require('../../../util/ModelUtil').getBusinessObject;\n\nvar NAME = 'name',\n    STANDARD_EVENT = 'standardEvent',\n    ID = 'id',\n    DEFINITION_REF = 'definitionRef',\n    SENTRY_REF = 'sentryRef',\n    IS_STANDARD_EVENT_VISIBLE = 'isStandardEventVisible';\n\nvar flatten = require('min-dash').flatten;\n\n/**\n * A handler that implements a CMMN 1.1 property update.\n *\n * This should be used to set simple properties on elements with\n * an underlying CMMN business object.\n *\n * Use respective diagram-js provided handlers if you would\n * like to perform automated modeling.\n */\nfunction UpdatePropertiesHandler(elementRegistry, itemRegistry, moddle) {\n  this._elementRegistry = elementRegistry;\n  this._itemRegistry = itemRegistry;\n  this._moddle = moddle;\n}\n\nUpdatePropertiesHandler.$inject = [ 'elementRegistry', 'itemRegistry', 'moddle' ];\n\nmodule.exports = UpdatePropertiesHandler;\n\n\n// api /////////////////\n\nUpdatePropertiesHandler.prototype.preExecute = function(context) {\n\n  var element = context.element,\n      shape = context.shape;\n\n  if (!element) {\n    throw new Error('element required');\n  }\n\n  var bo = element.businessObject || element;\n\n  context.businessObject = bo;\n\n  var changed = [];\n\n  if (element.businessObject) {\n    changed.push(element);\n  }\n\n  if (shape) {\n    changed.push(shape);\n  }\n\n  context.changed = flatten(changed);\n};\n\n\n/**\n * Updates a CMMN element with a list of new properties\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element the element to update\n * @param {Object} context.properties a list of properties to set on the element's\n *                                    businessObject (the CMMN model element)\n *\n * @return {Array<djs.mode.Base>} the updated element\n */\nUpdatePropertiesHandler.prototype.execute = function(context) {\n\n  var elementRegistry = this._elementRegistry,\n      itemRegistry = this._itemRegistry,\n      ids = this._moddle.ids;\n\n  var changed = context.changed;\n\n  var element = context.element,\n      businessObject = context.businessObject,\n      properties = unwrapBusinessObjects(context.properties),\n      oldProperties = context.oldProperties || getProperties(businessObject, keys(properties));\n\n  if (isIdChange(properties, businessObject)) {\n    ids.unclaim(businessObject[ID]);\n\n    itemRegistry.updateId(businessObject, properties[ID]);\n\n    var shape = elementRegistry.get(element.id);\n\n    if (shape) {\n      elementRegistry.updateId(shape, properties[ID]);\n    }\n\n    ids.claim(properties[ID], businessObject);\n  }\n\n  if (isDefinitionRefChange(properties, businessObject)) {\n    itemRegistry.updateReference(businessObject, properties[DEFINITION_REF]);\n  }\n\n  if (isSentryRefChange(properties, businessObject)) {\n    itemRegistry.updateReference(businessObject, properties[SENTRY_REF]);\n  }\n\n  if (NAME in properties) {\n\n    forEach(changed, function(changedShape) {\n      if (changedShape.label) {\n        changed.push(changedShape.label);\n      }\n    });\n\n  }\n\n  if (STANDARD_EVENT in properties || IS_STANDARD_EVENT_VISIBLE in properties) {\n\n    forEach(changed, function(changedShape) {\n      if (changedShape.label) {\n        changed.push(changedShape.label);\n      }\n    });\n\n  }\n\n  // update properties\n  setProperties(businessObject, properties);\n\n  // store old values\n  context.oldProperties = oldProperties;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update on a CMMN elements properties.\n *\n * @param  {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nUpdatePropertiesHandler.prototype.revert = function(context) {\n\n  var properties = context.properties,\n      oldProperties = context.oldProperties,\n      businessObject = context.businessObject,\n      elementRegistry = this._elementRegistry,\n      itemRegistry = this._itemRegistry,\n      ids = this._moddle.ids;\n\n  if (isIdChange(oldProperties, businessObject)) {\n    itemRegistry.updateId(businessObject, oldProperties[ID]);\n  }\n\n  if (isDefinitionRefChange(oldProperties, businessObject)) {\n    itemRegistry.updateReference(businessObject, oldProperties[DEFINITION_REF]);\n  }\n\n  if (isSentryRefChange(oldProperties, businessObject)) {\n    itemRegistry.updateReference(businessObject, oldProperties[SENTRY_REF]);\n  }\n\n  // update properties\n  setProperties(businessObject, oldProperties);\n\n  if (isIdChange(properties, businessObject)) {\n    ids.unclaim(properties[ID]);\n\n    var shape = elementRegistry.get(properties[ID]);\n\n    if (shape) {\n      elementRegistry.updateId(shape, oldProperties[ID]);\n    }\n\n    ids.claim(oldProperties[ID], businessObject);\n  }\n\n  return context.changed;\n};\n\n\nfunction isIdChange(properties, businessObject) {\n  return ID in properties && properties[ID] !== businessObject[ID];\n}\n\nfunction isDefinitionRefChange(properties, businessObject) {\n  return DEFINITION_REF in properties && properties[DEFINITION_REF] !== businessObject[DEFINITION_REF];\n}\n\nfunction isSentryRefChange(properties, businessObject) {\n  return SENTRY_REF in properties && properties[SENTRY_REF] !== businessObject[SENTRY_REF];\n}\n\n\nfunction getProperties(businessObject, propertyNames) {\n  return reduce(propertyNames, function(result, key) {\n    result[key] = businessObject.get(key);\n    return result;\n  }, {});\n}\n\n\nfunction setProperties(businessObject, properties) {\n  forEach(properties, function(value, key) {\n    businessObject.set(key, value);\n  });\n}\n\n\nvar referencePropertyNames = [ 'default' ];\n\n/**\n * Make sure we unwrap the actual business object\n * behind diagram element that may have been\n * passed as arguments.\n *\n * @param  {Object} properties\n *\n * @return {Object} unwrappedProps\n */\nfunction unwrapBusinessObjects(properties) {\n\n  var unwrappedProps = assign({}, properties);\n\n  referencePropertyNames.forEach(function(name) {\n    if (name in properties) {\n      unwrappedProps[name] = getBusinessObject(unwrappedProps[name]);\n    }\n  });\n\n  return unwrappedProps;\n}","'use strict';\n\nvar flatten = require('min-dash').flatten;\n\nvar Collections = require('diagram-js/lib/util/Collections');\n\n\nfunction UpdateSemanticParentHandler() {\n}\n\nmodule.exports = UpdateSemanticParentHandler;\n\n\n// api /////////////////\n\nUpdateSemanticParentHandler.prototype.preExecute = function(context) {\n  var element = context.element,\n      shape = context.shape;\n\n  if (!element) {\n    throw new Error('element required');\n  }\n\n  var bo = element.businessObject || element;\n\n  context.businessObject = bo;\n  context.oldParent = bo.$parent;\n\n  var changed = [];\n\n  if (element.businessObject) {\n    changed.push(element);\n  }\n\n  if (shape) {\n    changed.push(shape);\n  }\n\n  context.changed = flatten(changed);\n};\n\nUpdateSemanticParentHandler.prototype.execute = function(context) {\n\n  var businessObject = context.businessObject,\n      newParent = context.newParent,\n      containment = context.containment;\n\n  this.updateSemanticParent(businessObject, newParent, containment);\n\n  // indicate changed on objects affected by the update\n  return context.changed;\n};\n\n\nUpdateSemanticParentHandler.prototype.revert = function(context) {\n\n  var businessObject = context.businessObject,\n      newParent = context.oldParent,\n      containment = context.containment;\n\n  this.updateSemanticParent(businessObject, newParent, containment);\n\n  return context.changed;\n};\n\n\nUpdateSemanticParentHandler.prototype.updateSemanticParent = function(element, newParent, containment) {\n\n  if (element.$parent === newParent) {\n    return;\n  }\n\n  var children;\n\n  if (element.$parent && containment) {\n    // remove from old parent\n    children = element.$parent.get(containment);\n    Collections.remove(children, element);\n  }\n\n  element.$parent = null;\n\n  if (newParent) {\n\n    if (containment) {\n      // add to new parent\n      children = newParent.get(containment);\n      children.push(element);\n    }\n\n    element.$parent = newParent;\n  }\n\n};\n","'use strict';\n\nvar filter = require('min-dash').filter,\n    forEach = require('min-dash').forEach;\n\nvar getBusinessObject = require('../../../util/ModelUtil').getBusinessObject,\n    getItemControl = require('../../../util/ModelUtil').getItemControl,\n    getDefaultControl = require('../../../util/ModelUtil').getDefaultControl,\n    getDefinition = require('../../../util/ModelUtil').getDefinition,\n    hasPlanningTable = require('../../../util/ModelUtil').hasPlanningTable;\n\nvar isPlanningTableCapable = require('../util/PlanItemDefinitionUtil').isPlanningTableCapable;\n\n\nfunction UpdateControlsHandler(itemRegistry, modeling, cmmnReplace, cmmnFactory) {\n  this._itemRegistry = itemRegistry;\n  this._modeling = modeling;\n  this._cmmnReplace = cmmnReplace;\n  this._cmmnFactory = cmmnFactory;\n}\n\nUpdateControlsHandler.$inject = [ 'itemRegistry', 'modeling', 'cmmnReplace', 'cmmnFactory' ];\n\nmodule.exports = UpdateControlsHandler;\n\n\nvar PLAN_ITEM_CONTROL_PROPS = [\n  'requiredRule',\n  'repetitionRule',\n  'manualActivationRule'\n];\n\nfunction getUpdate(key, value) {\n  var update = {};\n  update[key] = value;\n  return update;\n}\n\n\nUpdateControlsHandler.prototype.preExecute = function(context) {\n\n  var self = this;\n\n  var element = context.element,\n      values = context.values;\n\n  if (!element) {\n    throw new Error('element required');\n  }\n\n  forEach(values, function(value, key) {\n\n    if (PLAN_ITEM_CONTROL_PROPS.indexOf(key) !== -1) {\n      self._updateRule(element, key, value);\n    }\n    else {\n      self._updateDecorator(element, key, value);\n    }\n\n  });\n\n};\n\n\nUpdateControlsHandler.prototype.execute = function() {};\n\nUpdateControlsHandler.prototype.revert = function() {};\n\n\n// API ////////////////////////////////////////////////\n\n\nUpdateControlsHandler.prototype._updateDecorator = function(element, key, value) {\n\n  var self = this,\n      modeling = self._modeling;\n\n  var definition = getDefinition(element),\n      update = getUpdate(key, value),\n      changed = [];\n\n  if (definition[key] !== value) {\n\n    changed = self._getReferencingShapes(definition);\n\n    if (changed.length > 1 && canReplaceDefinition(definition)) {\n      definition = self._replaceDefinition(element);\n      changed = element;\n    }\n\n    modeling.updateProperties(definition, update, changed);\n\n  }\n\n};\n\n\nUpdateControlsHandler.prototype._updateRule = function(element, rule, value) {\n\n  var self = this,\n      modeling = self._modeling,\n      cmmnFactory = self._cmmnFactory;\n\n  var itemControl = getItemControl(element),\n      defaultControl = getDefaultControl(element),\n      definition = getDefinition(element),\n      update = getUpdate(rule, value);\n\n\n  !value ? deleteRule() : setRule();\n\n\n  function deleteRule() {\n\n    var oldValue;\n\n    if (isRulePresent(itemControl, rule)) {\n      oldValue = itemControl[rule];\n      modeling.updateProperties(itemControl, update, element);\n      modeling.updateSemanticParent(oldValue);\n\n      if (canDeletePlanItemControl(itemControl)) {\n        modeling.updateProperties(element, { itemControl: undefined });\n        modeling.updateSemanticParent(itemControl);\n      }\n\n    }\n\n    if (isRulePresent(defaultControl, rule)) {\n      oldValue = defaultControl[rule];\n\n      var changed = self._getReferencingShapes(definition);\n\n      if (changed.length > 1 && canReplaceDefinition(definition)) {\n\n        changed = filter(changed, function(elem) {\n          var localItemControl = getItemControl(elem),\n              localDefaultControl = getDefaultControl(elem);\n\n          return !isRulePresent(localItemControl, rule) &&\n                  isRulePresent(localDefaultControl, rule);\n        });\n\n        if (changed.length > 1) {\n          self._replaceDefinition(element);\n          defaultControl = getDefaultControl(element);\n          changed = element;\n        }\n\n      }\n\n      modeling.updateProperties(defaultControl, update, changed);\n      modeling.updateSemanticParent(oldValue);\n\n      if (canDeletePlanItemControl(defaultControl)) {\n        modeling.updateProperties(definition, { defaultControl: undefined }, changed);\n        modeling.updateSemanticParent(defaultControl);\n      }\n\n    }\n\n  }\n\n  function setRule() {\n\n    if (!itemControl) {\n      itemControl = createPlanItemControl();\n      modeling.updateProperties(element, { itemControl: itemControl });\n      modeling.updateSemanticParent(itemControl, getBusinessObject(element));\n    }\n\n    modeling.updateProperties(itemControl, update, element);\n    modeling.updateSemanticParent(value, itemControl);\n  }\n\n  function isRulePresent(control, rule) {\n    return control && control[rule];\n  }\n\n  function createPlanItemControl() {\n    return cmmnFactory.create('cmmn:PlanItemControl');\n  }\n\n  function canDeletePlanItemControl(control) {\n    return !!(control && !control.repetitionRule && !control.requiredRule && !control.manualActivationRule);\n  }\n\n};\n\n\nUpdateControlsHandler.prototype._replaceDefinition = function(element) {\n\n  var self = this,\n      modeling = self._modeling,\n      cmmnReplace = self._cmmnReplace;\n\n  var definition = getDefinition(element);\n\n  var newDefinition = cmmnReplace.replacePlanItemDefinition(definition);\n  modeling.updateProperties(element, { definitionRef: newDefinition });\n\n  modeling.updateSemanticParent(newDefinition, definition.$parent, 'planItemDefinitions');\n\n  return newDefinition;\n\n};\n\n\nUpdateControlsHandler.prototype._getReferencingShapes = function(definition) {\n\n  var self = this,\n      itemRegistry = self._itemRegistry;\n\n  return itemRegistry.getShapes(definition);\n\n};\n\n\nfunction canReplaceDefinition(definition) {\n  return !(isPlanningTableCapable(definition) && hasPlanningTable(definition));\n}","'use strict';\n\n\nfunction IdClaimHandler(moddle) {\n  this._moddle = moddle;\n}\n\nIdClaimHandler.$inject = [ 'moddle' ];\n\nmodule.exports = IdClaimHandler;\n\n\nIdClaimHandler.prototype.execute = function(context) {\n  var ids = this._moddle.ids,\n      id = context.id,\n      element = context.element,\n      claiming = context.claiming;\n\n  if (claiming) {\n    ids.claim(id, element);\n  } else {\n    ids.unclaim(id);\n  }\n};\n\n\nIdClaimHandler.prototype.revert = function(context) {\n  var ids = this._moddle.ids,\n      id = context.id,\n      element = context.element,\n      claiming = context.claiming;\n\n  if (claiming) {\n    ids.unclaim(id);\n  } else {\n    ids.claim(id, element);\n  }\n};\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar BaseLayouter = require('diagram-js/lib/layout/BaseLayouter').default,\n    ManhattanLayout = require('diagram-js/lib/layout/ManhattanLayout');\n\nvar getMid = require('diagram-js/lib/layout/LayoutUtil').getMid;\n\n\nfunction CmmnLayouter() {}\n\ninherits(CmmnLayouter, BaseLayouter);\n\nmodule.exports = CmmnLayouter;\n\n\nCmmnLayouter.prototype.layoutConnection = function(connection, hints) {\n\n  hints = hints || {};\n\n  var source = hints.source || connection.source,\n      target = hints.target || connection.target,\n      waypoints = connection.waypoints,\n      start = hints.connectionStart,\n      end = hints.connectionEnd;\n\n\n  if (!start) {\n    start = getConnectionDocking(waypoints && waypoints[0], source);\n  }\n\n  if (!end) {\n    end = getConnectionDocking(waypoints && waypoints[waypoints.length - 1], target);\n  }\n\n  var updatedWaypoints =\n    ManhattanLayout.repairConnection(\n      source, target,\n      start, end,\n      waypoints,\n      hints);\n\n  return updatedWaypoints || [ start, end ];\n};\n\nfunction getConnectionDocking(point, shape) {\n  return point ? (point.original || point) : getMid(shape);\n}","import {\n  getMid\n} from './LayoutUtil';\n\n\n/**\n * A base connection layouter implementation\n * that layouts the connection by directly connecting\n * mid(source) + mid(target).\n */\nexport default function BaseLayouter() {}\n\n\n/**\n * Return the new layouted waypoints for the given connection.\n *\n * The connection passed is still unchanged; you may figure out about\n * the new connection start / end via the layout hints provided.\n *\n * @param {djs.model.Connection} connection\n * @param {Object} [hints]\n * @param {Point} [hints.connectionStart]\n * @param {Point} [hints.connectionEnd]\n * @param {Point} [hints.source]\n * @param {Point} [hints.target]\n *\n * @return {Array<Point>} the layouted connection waypoints\n */\nBaseLayouter.prototype.layoutConnection = function(connection, hints) {\n\n  hints = hints || {};\n\n  return [\n    hints.connectionStart || getMid(hints.source || connection.source),\n    hints.connectionEnd || getMid(hints.target || connection.target)\n  ];\n};\n","import {\n  isArray,\n  find,\n  without,\n  assign\n} from 'min-dash';\n\nimport {\n  getOrientation,\n  getMid\n} from './LayoutUtil';\n\nimport {\n  pointInRect,\n  pointDistance,\n  pointsAligned,\n  pointsOnLine\n} from '../util/Geometry';\n\nvar MIN_SEGMENT_LENGTH = 20,\n    POINT_ORIENTATION_PADDING = 5;\n\nvar round = Math.round;\n\nvar INTERSECTION_THRESHOLD = 20,\n    ORIENTATION_THRESHOLD = {\n      'h:h': 20,\n      'v:v': 20,\n      'h:v': -10,\n      'v:h': -10\n    };\n\nfunction needsTurn(orientation, startDirection) {\n  return !{\n    t: /top/,\n    r: /right/,\n    b: /bottom/,\n    l: /left/,\n    h: /./,\n    v: /./\n  }[startDirection].test(orientation);\n}\n\nfunction canLayoutStraight(direction, targetOrientation) {\n  return {\n    t: /top/,\n    r: /right/,\n    b: /bottom/,\n    l: /left/,\n    h: /left|right/,\n    v: /top|bottom/\n  }[direction].test(targetOrientation);\n}\n\nfunction getSegmentBendpoints(a, b, directions) {\n  var orientation = getOrientation(b, a, POINT_ORIENTATION_PADDING);\n\n  var startDirection = directions.split(':')[0];\n\n  var xmid = round((b.x - a.x) / 2 + a.x),\n      ymid = round((b.y - a.y) / 2 + a.y);\n\n  var segmentEnd, segmentDirections;\n\n  var layoutStraight = canLayoutStraight(startDirection, orientation),\n      layoutHorizontal = /h|r|l/.test(startDirection),\n      layoutTurn = false;\n\n  var turnNextDirections = false;\n\n  if (layoutStraight) {\n    segmentEnd = layoutHorizontal ? { x: xmid, y: a.y } : { x: a.x, y: ymid };\n\n    segmentDirections = layoutHorizontal ? 'h:h' : 'v:v';\n  } else {\n    layoutTurn = needsTurn(orientation, startDirection);\n\n    segmentDirections = layoutHorizontal ? 'h:v' : 'v:h';\n\n    if (layoutTurn) {\n\n      if (layoutHorizontal) {\n        turnNextDirections = ymid === a.y;\n\n        segmentEnd = {\n          x: a.x + MIN_SEGMENT_LENGTH * (/l/.test(startDirection) ? -1 : 1),\n          y: turnNextDirections ? ymid + MIN_SEGMENT_LENGTH : ymid\n        };\n      } else {\n        turnNextDirections = xmid === a.x;\n\n        segmentEnd = {\n          x: turnNextDirections ? xmid + MIN_SEGMENT_LENGTH : xmid,\n          y: a.y + MIN_SEGMENT_LENGTH * (/t/.test(startDirection) ? -1 : 1)\n        };\n      }\n\n    } else {\n      segmentEnd = {\n        x: xmid,\n        y: ymid\n      };\n    }\n  }\n\n  return {\n    waypoints: getBendpoints(a, segmentEnd, segmentDirections).concat(segmentEnd),\n    directions:  segmentDirections,\n    turnNextDirections: turnNextDirections\n  };\n}\n\nfunction getStartSegment(a, b, directions) {\n  return getSegmentBendpoints(a, b, directions);\n}\n\nfunction getEndSegment(a, b, directions) {\n  var invertedSegment = getSegmentBendpoints(b, a, invertDirections(directions));\n\n  return {\n    waypoints: invertedSegment.waypoints.slice().reverse(),\n    directions: invertDirections(invertedSegment.directions),\n    turnNextDirections: invertedSegment.turnNextDirections\n  };\n}\n\nfunction getMidSegment(startSegment, endSegment) {\n\n  var startDirection = startSegment.directions.split(':')[1],\n      endDirection = endSegment.directions.split(':')[0];\n\n  if (startSegment.turnNextDirections) {\n    startDirection = startDirection == 'h' ? 'v' : 'h';\n  }\n\n  if (endSegment.turnNextDirections) {\n    endDirection = endDirection == 'h' ? 'v' : 'h';\n  }\n\n  var directions = startDirection + ':' + endDirection;\n\n  var bendpoints = getBendpoints(\n    startSegment.waypoints[startSegment.waypoints.length - 1],\n    endSegment.waypoints[0],\n    directions\n  );\n\n  return {\n    waypoints: bendpoints,\n    directions: directions\n  };\n}\n\nfunction invertDirections(directions) {\n  return directions.split(':').reverse().join(':');\n}\n\n/**\n * Handle simple layouts with maximum two bendpoints.\n */\nfunction getSimpleBendpoints(a, b, directions) {\n\n  var xmid = round((b.x - a.x) / 2 + a.x),\n      ymid = round((b.y - a.y) / 2 + a.y);\n\n  // one point, right or left from a\n  if (directions === 'h:v') {\n    return [ { x: b.x, y: a.y } ];\n  }\n\n  // one point, above or below a\n  if (directions === 'v:h') {\n    return [ { x: a.x, y: b.y } ];\n  }\n\n  // vertical segment between a and b\n  if (directions === 'h:h') {\n    return [\n      { x: xmid, y: a.y },\n      { x: xmid, y: b.y }\n    ];\n  }\n\n  // horizontal segment between a and b\n  if (directions === 'v:v') {\n    return [\n      { x: a.x, y: ymid },\n      { x: b.x, y: ymid }\n    ];\n  }\n\n  throw new Error('invalid directions: can only handle varians of [hv]:[hv]');\n}\n\n\n/**\n * Returns the mid points for a manhattan connection between two points.\n *\n * @example h:h (horizontal:horizontal)\n *\n * [a]----[x]\n *         |\n *        [x]----[b]\n *\n * @example h:v (horizontal:vertical)\n *\n * [a]----[x]\n *         |\n *        [b]\n *\n * @example h:r (horizontal:right)\n *\n * [a]----[x]\n *         |\n *    [b]-[x]\n *\n * @param  {Point} a\n * @param  {Point} b\n * @param  {String} directions\n *\n * @return {Array<Point>}\n */\nfunction getBendpoints(a, b, directions) {\n  directions = directions || 'h:h';\n\n  if (!isValidDirections(directions)) {\n    throw new Error(\n      'unknown directions: <' + directions + '>: ' +\n      'must be specified as <start>:<end> ' +\n      'with start/end in { h,v,t,r,b,l }'\n    );\n  }\n\n  // compute explicit directions, involving trbl dockings\n  // using a three segmented layouting algorithm\n  if (isExplicitDirections(directions)) {\n    var startSegment = getStartSegment(a, b, directions),\n        endSegment = getEndSegment(a, b, directions),\n        midSegment = getMidSegment(startSegment, endSegment);\n\n    return [].concat(\n      startSegment.waypoints,\n      midSegment.waypoints,\n      endSegment.waypoints\n    );\n  }\n\n  // handle simple [hv]:[hv] cases that can be easily computed\n  return getSimpleBendpoints(a, b, directions);\n}\n\n/**\n * Create a connection between the two points according\n * to the manhattan layout (only horizontal and vertical) edges.\n *\n * @param {Point} a\n * @param {Point} b\n *\n * @param {String} [directions='h:h'] specifies manhattan directions for each point as {adirection}:{bdirection}.\n                   A directionfor a point is either `h` (horizontal) or `v` (vertical)\n *\n * @return {Array<Point>}\n */\nexport function connectPoints(a, b, directions) {\n\n  var points = getBendpoints(a, b, directions);\n\n  points.unshift(a);\n  points.push(b);\n\n  return withoutRedundantPoints(points);\n}\n\n\n/**\n * Connect two rectangles using a manhattan layouted connection.\n *\n * @param {Bounds} source source rectangle\n * @param {Bounds} target target rectangle\n * @param {Point} [start] source docking\n * @param {Point} [end] target docking\n *\n * @param {Object} [hints]\n * @param {String} [hints.preserveDocking=source] preserve docking on selected side\n * @param {Array<String>} [hints.preferredLayouts]\n * @param {Point|Boolean} [hints.connectionStart] whether the start changed\n * @param {Point|Boolean} [hints.connectionEnd] whether the end changed\n *\n * @return {Array<Point>} connection points\n */\nexport function connectRectangles(source, target, start, end, hints) {\n\n  var preferredLayouts = hints && hints.preferredLayouts || [];\n\n  var preferredLayout = without(preferredLayouts, 'straight')[0] || 'h:h';\n\n  var threshold = ORIENTATION_THRESHOLD[preferredLayout] || 0;\n\n  var orientation = getOrientation(source, target, threshold);\n\n  var directions = getDirections(orientation, preferredLayout);\n\n  start = start || getMid(source);\n  end = end || getMid(target);\n\n  var directionSplit = directions.split(':');\n\n  // compute actual docking points for start / end\n  // this ensures we properly layout only parts of the\n  // connection that lies in between the two rectangles\n  var startDocking = getDockingPoint(start, source, directionSplit[0], invertOrientation(orientation)),\n      endDocking = getDockingPoint(end, target, directionSplit[1], orientation);\n\n  return connectPoints(startDocking, endDocking, directions);\n}\n\n\n/**\n * Repair the connection between two rectangles, of which one has been updated.\n *\n * @param {Bounds} source\n * @param {Bounds} target\n * @param {Point} [start]\n * @param {Point} [end]\n * @param {Array<Point>} [waypoints]\n * @param {Object} [hints]\n * @param {Array<String>} [hints.preferredLayouts] list of preferred layouts\n * @param {Boolean} [hints.connectionStart]\n * @param {Boolean} [hints.connectionEnd]\n *\n * @return {Array<Point>} repaired waypoints\n */\nexport function repairConnection(source, target, start, end, waypoints, hints) {\n\n  if (isArray(start)) {\n    waypoints = start;\n    hints = end;\n\n    start = getMid(source);\n    end = getMid(target);\n  }\n\n  hints = assign({ preferredLayouts: [] }, hints);\n  waypoints = waypoints || [];\n\n  var preferredLayouts = hints.preferredLayouts,\n      preferStraight = preferredLayouts.indexOf('straight') !== -1,\n      repairedWaypoints;\n\n  // just layout non-existing or simple connections\n  // attempt to render straight lines, if required\n\n  // attempt to layout a straight line\n  repairedWaypoints = preferStraight && tryLayoutStraight(source, target, start, end, hints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // try to layout from end\n  repairedWaypoints = hints.connectionEnd && tryRepairConnectionEnd(target, source, end, waypoints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // try to layout from start\n  repairedWaypoints = hints.connectionStart && tryRepairConnectionStart(source, target, start, waypoints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // or whether nothing seems to have changed\n  if (!hints.connectionStart && !hints.connectionEnd && waypoints && waypoints.length) {\n    return waypoints;\n  }\n\n  // simply reconnect if nothing else worked\n  return connectRectangles(source, target, start, end, hints);\n}\n\n\nfunction inRange(a, start, end) {\n  return a >= start && a <= end;\n}\n\nfunction isInRange(axis, a, b) {\n  var size = {\n    x: 'width',\n    y: 'height'\n  };\n\n  return inRange(a[axis], b[axis], b[axis] + b[size[axis]]);\n}\n\n/**\n * Layout a straight connection\n *\n * @param {Bounds} source\n * @param {Bounds} target\n * @param {Point} start\n * @param {Point} end\n * @param {Object} [hints]\n *\n * @return {Array<Point>|null} waypoints if straight layout worked\n */\nexport function tryLayoutStraight(source, target, start, end, hints) {\n  var axis = {},\n      primaryAxis,\n      orientation;\n\n  orientation = getOrientation(source, target);\n\n  // only layout a straight connection if shapes are\n  // horizontally or vertically aligned\n  if (!/^(top|bottom|left|right)$/.test(orientation)) {\n    return null;\n  }\n\n  if (/top|bottom/.test(orientation)) {\n    primaryAxis = 'x';\n  }\n\n  if (/left|right/.test(orientation)) {\n    primaryAxis = 'y';\n  }\n\n  if (hints.preserveDocking === 'target') {\n\n    if (!isInRange(primaryAxis, end, source)) {\n      return null;\n    }\n\n    axis[primaryAxis] = end[primaryAxis];\n\n    return [\n      {\n        x: axis.x !== undefined ? axis.x : start.x,\n        y: axis.y !== undefined ? axis.y : start.y,\n        original: {\n          x: axis.x !== undefined ? axis.x : start.x,\n          y: axis.y !== undefined ? axis.y : start.y\n        }\n      },\n      {\n        x: end.x,\n        y: end.y\n      }\n    ];\n\n  } else {\n\n    if (!isInRange(primaryAxis, start, target)) {\n      return null;\n    }\n\n    axis[primaryAxis] = start[primaryAxis];\n\n    return [\n      {\n        x: start.x,\n        y: start.y\n      },\n      {\n        x: axis.x !== undefined ? axis.x : end.x,\n        y: axis.y !== undefined ? axis.y : end.y,\n        original: {\n          x: axis.x !== undefined ? axis.x : end.x,\n          y: axis.y !== undefined ? axis.y : end.y\n        }\n      }\n    ];\n  }\n\n}\n\n/**\n * Repair a connection from start.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>|null} the repaired points between the two rectangles\n */\nfunction tryRepairConnectionStart(moved, other, newDocking, points) {\n  return _tryRepairConnectionSide(moved, other, newDocking, points);\n}\n\n/**\n * Repair a connection from end.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>|null} the repaired points between the two rectangles\n */\nfunction tryRepairConnectionEnd(moved, other, newDocking, points) {\n  var waypoints = points.slice().reverse();\n\n  waypoints = _tryRepairConnectionSide(moved, other, newDocking, waypoints);\n\n  return waypoints ? waypoints.reverse() : null;\n}\n\n/**\n * Repair a connection from one side that moved.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>} the repaired points between the two rectangles\n */\nfunction _tryRepairConnectionSide(moved, other, newDocking, points) {\n\n  function needsRelayout(moved, other, points) {\n\n    if (points.length < 3) {\n      return true;\n    }\n\n    if (points.length > 4) {\n      return false;\n    }\n\n    // relayout if two points overlap\n    // this is most likely due to\n    return !!find(points, function(p, idx) {\n      var q = points[idx - 1];\n\n      return q && pointDistance(p, q) < 3;\n    });\n  }\n\n  function repairBendpoint(candidate, oldPeer, newPeer) {\n\n    var alignment = pointsAligned(oldPeer, candidate);\n\n    switch (alignment) {\n    case 'v':\n      // repair horizontal alignment\n      return { x: newPeer.x, y: candidate.y };\n    case 'h':\n      // repair vertical alignment\n      return { x: candidate.x, y: newPeer.y };\n    }\n\n    return { x: candidate.x, y: candidate. y };\n  }\n\n  function removeOverlapping(points, a, b) {\n    var i;\n\n    for (i = points.length - 2; i !== 0; i--) {\n\n      // intersects (?) break, remove all bendpoints up to this one and relayout\n      if (pointInRect(points[i], a, INTERSECTION_THRESHOLD) ||\n          pointInRect(points[i], b, INTERSECTION_THRESHOLD)) {\n\n        // return sliced old connection\n        return points.slice(i);\n      }\n    }\n\n    return points;\n  }\n\n\n  // (0) only repair what has layoutable bendpoints\n\n  // (1) if only one bendpoint and on shape moved onto other shapes axis\n  //     (horizontally / vertically), relayout\n\n  if (needsRelayout(moved, other, points)) {\n    return null;\n  }\n\n  var oldDocking = points[0],\n      newPoints = points.slice(),\n      slicedPoints;\n\n  // (2) repair only last line segment and only if it was layouted before\n\n  newPoints[0] = newDocking;\n  newPoints[1] = repairBendpoint(newPoints[1], oldDocking, newDocking);\n\n\n  // (3) if shape intersects with any bendpoint after repair,\n  //     remove all segments up to this bendpoint and repair from there\n\n  slicedPoints = removeOverlapping(newPoints, moved, other);\n\n  if (slicedPoints !== newPoints) {\n    return _tryRepairConnectionSide(moved, other, newDocking, slicedPoints);\n  }\n\n  return newPoints;\n}\n\n\n/**\n * Returns the manhattan directions connecting two rectangles\n * with the given orientation.\n *\n * Will always return the default layout, if it is specific\n * regarding sides already (trbl).\n *\n * @example\n *\n * getDirections('top'); // -> 'v:v'\n * getDirections('intersect'); // -> 't:t'\n *\n * getDirections('top-right', 'v:h'); // -> 'v:h'\n * getDirections('top-right', 'h:h'); // -> 'h:h'\n *\n *\n * @param {String} orientation\n * @param {String} defaultLayout\n *\n * @return {String}\n */\nfunction getDirections(orientation, defaultLayout) {\n\n  // don't override specific trbl directions\n  if (isExplicitDirections(defaultLayout)) {\n    return defaultLayout;\n  }\n\n  switch (orientation) {\n  case 'intersect':\n    return 't:t';\n\n  case 'top':\n  case 'bottom':\n    return 'v:v';\n\n  case 'left':\n  case 'right':\n    return 'h:h';\n\n  // 'top-left'\n  // 'top-right'\n  // 'bottom-left'\n  // 'bottom-right'\n  default:\n    return defaultLayout;\n  }\n}\n\nfunction isValidDirections(directions) {\n  return directions && /^h|v|t|r|b|l:h|v|t|r|b|l$/.test(directions);\n}\n\nfunction isExplicitDirections(directions) {\n  return directions && /t|r|b|l/.test(directions);\n}\n\nfunction invertOrientation(orientation) {\n  return {\n    'top': 'bottom',\n    'bottom': 'top',\n    'left': 'right',\n    'right': 'left',\n    'top-left': 'bottom-right',\n    'bottom-right': 'top-left',\n    'top-right': 'bottom-left',\n    'bottom-left': 'top-right',\n  }[orientation];\n}\n\nfunction getDockingPoint(point, rectangle, dockingDirection, targetOrientation) {\n\n  // ensure we end up with a specific docking direction\n  // based on the targetOrientation, if <h|v> is being passed\n\n  if (dockingDirection === 'h') {\n    dockingDirection = /left/.test(targetOrientation) ? 'l' : 'r';\n  }\n\n  if (dockingDirection === 'v') {\n    dockingDirection = /top/.test(targetOrientation) ? 't' : 'b';\n  }\n\n  if (dockingDirection === 't') {\n    return { original: point, x: point.x, y: rectangle.y };\n  }\n\n  if (dockingDirection === 'r') {\n    return { original: point, x: rectangle.x + rectangle.width, y: point.y };\n  }\n\n  if (dockingDirection === 'b') {\n    return { original: point, x: point.x, y: rectangle.y + rectangle.height };\n  }\n\n  if (dockingDirection === 'l') {\n    return { original: point, x: rectangle.x, y: point.y };\n  }\n\n  throw new Error('unexpected dockingDirection: <' + dockingDirection + '>');\n}\n\n\n/**\n * Return list of waypoints with redundant ones filtered out.\n *\n * @example\n *\n * Original points:\n *\n *   [x] ----- [x] ------ [x]\n *                         |\n *                        [x] ----- [x] - [x]\n *\n * Filtered:\n *\n *   [x] ---------------- [x]\n *                         |\n *                        [x] ----------- [x]\n *\n * @param  {Array<Point>} waypoints\n *\n * @return {Array<Point>}\n */\nexport function withoutRedundantPoints(waypoints) {\n  return waypoints.reduce(function(points, p, idx) {\n\n    var previous = points[points.length - 1],\n        next = waypoints[idx + 1];\n\n    if (!pointsOnLine(previous, next, p, 0)) {\n      points.push(p);\n    }\n\n    return points;\n  }, []);\n}\n","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getElementLineIntersection\n} from './LayoutUtil';\n\n\nfunction dockingToPoint(docking) {\n  // use the dockings actual point and\n  // retain the original docking\n  return assign({ original: docking.point.original || docking.point }, docking.actual);\n}\n\n\n/**\n * A {@link ConnectionDocking} that crops connection waypoints based on\n * the path(s) of the connection source and target.\n *\n * @param {djs.core.ElementRegistry} elementRegistry\n */\nexport default function CroppingConnectionDocking(elementRegistry, graphicsFactory) {\n  this._elementRegistry = elementRegistry;\n  this._graphicsFactory = graphicsFactory;\n}\n\nCroppingConnectionDocking.$inject = [ 'elementRegistry', 'graphicsFactory' ];\n\n\n/**\n * @inheritDoc ConnectionDocking#getCroppedWaypoints\n */\nCroppingConnectionDocking.prototype.getCroppedWaypoints = function(connection, source, target) {\n\n  source = source || connection.source;\n  target = target || connection.target;\n\n  var sourceDocking = this.getDockingPoint(connection, source, true),\n      targetDocking = this.getDockingPoint(connection, target);\n\n  var croppedWaypoints = connection.waypoints.slice(sourceDocking.idx + 1, targetDocking.idx);\n\n  croppedWaypoints.unshift(dockingToPoint(sourceDocking));\n  croppedWaypoints.push(dockingToPoint(targetDocking));\n\n  return croppedWaypoints;\n};\n\n/**\n * Return the connection docking point on the specified shape\n *\n * @inheritDoc ConnectionDocking#getDockingPoint\n */\nCroppingConnectionDocking.prototype.getDockingPoint = function(connection, shape, dockStart) {\n\n  var waypoints = connection.waypoints,\n      dockingIdx,\n      dockingPoint,\n      croppedPoint;\n\n  dockingIdx = dockStart ? 0 : waypoints.length - 1;\n  dockingPoint = waypoints[dockingIdx];\n\n  croppedPoint = this._getIntersection(shape, connection, dockStart);\n\n  return {\n    point: dockingPoint,\n    actual: croppedPoint || dockingPoint,\n    idx: dockingIdx\n  };\n};\n\n\n// helpers //////////////////////\n\nCroppingConnectionDocking.prototype._getIntersection = function(shape, connection, takeFirst) {\n\n  var shapePath = this._getShapePath(shape),\n      connectionPath = this._getConnectionPath(connection);\n\n  return getElementLineIntersection(shapePath, connectionPath, takeFirst);\n};\n\nCroppingConnectionDocking.prototype._getConnectionPath = function(connection) {\n  return this._graphicsFactory.getConnectionPath(connection);\n};\n\nCroppingConnectionDocking.prototype._getShapePath = function(shape) {\n  return this._graphicsFactory.getShapePath(shape);\n};\n\nCroppingConnectionDocking.prototype._getGfx = function(element) {\n  return this._elementRegistry.getGraphics(element);\n};\n","module.exports = {\n  __depends__: [\n    require('diagram-js/lib/features/palette').default,\n    require('diagram-js/lib/features/create').default,\n    require('diagram-js/lib/features/space-tool').default,\n    require('diagram-js/lib/features/lasso-tool').default,\n    require('diagram-js/lib/features/hand-tool').default,\n    require('diagram-js/lib/features/global-connect').default\n  ],\n  __init__: [ 'paletteProvider' ],\n  paletteProvider: [ 'type', require('./PaletteProvider') ]\n};\n","'use strict';\n\nvar assign = require('min-dash').assign;\n\n/**\n * A palette provider for CMMN 1.1 elements.\n */\nfunction PaletteProvider(\n    create,\n    elementFactory,\n    globalConnect,\n    handTool,\n    lassoTool,\n    palette,\n    spaceTool\n) {\n\n  this._create = create;\n  this._elementFactory = elementFactory;\n  this._globalConnect = globalConnect;\n  this._handTool = handTool;\n  this._palette = palette;\n  this._lassoTool = lassoTool;\n  this._spaceTool = spaceTool;\n\n  palette.registerProvider(this);\n}\n\nmodule.exports = PaletteProvider;\n\nPaletteProvider.$inject = [\n  'create',\n  'elementFactory',\n  'globalConnect',\n  'handTool',\n  'lassoTool',\n  'palette',\n  'spaceTool'\n];\n\n\nPaletteProvider.prototype.getPaletteEntries = function(element) {\n\n  var actions = {},\n      create = this._create,\n      elementFactory = this._elementFactory,\n      spaceTool = this._spaceTool,\n      lassoTool = this._lassoTool,\n      globalConnect = this._globalConnect,\n      handTool = this._handTool;\n\n  function createPlanItem(type, group, className, title) {\n\n    function createListener(event) {\n      create.start(event, elementFactory.createPlanItemShape(type));\n    }\n\n    var shortType = type.replace(/^cmmn:/, '');\n\n    return {\n      group: group,\n      className: className,\n      title: title || 'Create ' + shortType,\n      action: {\n        dragstart: createListener,\n        click: createListener\n      }\n    };\n  }\n\n  function createCasePlanModel(event) {\n    create.start(event, elementFactory.createCasePlanModelShape());\n  }\n\n  function createCriterion(event) {\n    create.start(event, elementFactory.createCriterionShape('cmmn:EntryCriterion'));\n  }\n\n  function createCaseFileItem(event) {\n    create.start(event, elementFactory.createCaseFileItemShape());\n  }\n\n  assign(actions, {\n    'hand-tool': {\n      group: 'tools',\n      className: 'cmmn-icon-hand-tool',\n      title: 'Activate the hand tool',\n      action: {\n        click: function(event) {\n          handTool.activateHand(event);\n        }\n      }\n    },\n    'lasso-tool': {\n      group: 'tools',\n      className: 'cmmn-icon-lasso-tool',\n      title: 'Activate the lasso tool',\n      action: {\n        click: function(event) {\n          lassoTool.activateSelection(event);\n        }\n      }\n    },\n    'space-tool': {\n      group: 'tools',\n      className: 'cmmn-icon-space-tool',\n      title: 'Activate the create/remove space tool',\n      action: {\n        click: function(event) {\n          spaceTool.activateSelection(event);\n        }\n      }\n    },\n    'global-connect-tool': {\n      group: 'tools',\n      className: 'cmmn-icon-connection',\n      title: 'Activate the global connect tool',\n      action: {\n        click: function(event) {\n          globalConnect.toggle(event);\n        }\n      }\n    },\n    'tool-separator': {\n      group: 'tools',\n      separator: true\n    },\n    'create.task': createPlanItem(\n      'cmmn:Task', 'planItem', 'cmmn-icon-task'\n    ),\n    'create.stage': createPlanItem(\n      'cmmn:Stage', 'planItem', 'cmmn-icon-stage-expanded', 'Create expanded Stage'\n    ),\n    'create.milestone': createPlanItem(\n      'cmmn:Milestone', 'planItem', 'cmmn-icon-milestone'\n    ),\n    'create.eventListener': createPlanItem(\n      'cmmn:EventListener', 'planItem', 'cmmn-icon-event-listener'\n    ),\n    'create.criterion': {\n      group: 'criterion',\n      className: 'cmmn-icon-entry-criterion',\n      title: 'Create Criterion',\n      action: {\n        dragstart: createCriterion,\n        click: createCriterion\n      }\n    },\n    'create.casePlanModel': {\n      group: 'casePlanModel',\n      className: 'cmmn-icon-case-plan-model',\n      title: 'Create CasePlanModel',\n      action: {\n        dragstart: createCasePlanModel,\n        click: createCasePlanModel\n      }\n    },\n    'create.caseFileItem': {\n      group: 'caseFileItem',\n      className: 'cmmn-icon-case-file-item',\n      title: 'Create Case File Item',\n      action: {\n        dragstart: createCaseFileItem,\n        click: createCaseFileItem\n      }\n    }\n\n  });\n\n  return actions;\n};","var CmmnConnectSnapping = require('./CmmnConnectSnapping');\nvar CmmnCreateMoveSnapping = require('./CmmnCreateMoveSnapping');\nvar CmmnResizeSnapping = require('./CmmnResizeSnapping');\nvar SnappingModule = require('diagram-js/lib/features/snapping').default;\n\n\nmodule.exports = {\n  __depends__: [ SnappingModule ],\n  __init__: [\n    'connectSnapping',\n    'createMoveSnapping',\n    'resizeSnapping'\n  ],\n  connectSnapping: [ 'type', CmmnConnectSnapping ],\n  createMoveSnapping: [ 'type', CmmnCreateMoveSnapping],\n  resizeSnapping: [ 'type', CmmnResizeSnapping ]\n};","var SnapUtil = require('diagram-js/lib/features/snapping/SnapUtil'),\n    mid =SnapUtil.mid,\n    setSnapped = SnapUtil.setSnapped;\n\nvar isCmd = require('diagram-js/lib/features/keyboard/KeyboardUtil').isCmd;\n\nvar ModelUtil = require('../../util/ModelUtil'),\n    is = ModelUtil.is,\n    getDefinition = ModelUtil.getDefinition,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar HIGHER_PRIORITY = 1250;\n\n\n/**\n   * Snap during connect.\n   *\n   * @param {EventBus} eventBus\n   * @param {Rules} rules\n   */\nfunction CmmnConnectSnapping(eventBus, rules) {\n  eventBus.on([\n    'connect.hover',\n    'connect.move',\n    'connect.end',\n  ], HIGHER_PRIORITY, function(event) {\n    var context = event.context,\n        source = context.source,\n        target = context.target,\n        canExecute = context.canExecute;\n\n    if (!canExecute) {\n      return;\n    }\n\n    if (event.originalEvent && isCmd(event.originalEvent)) {\n      return;\n    }\n\n    if (!context.initialSourcePosition) {\n      context.initialSourcePosition = context.sourcePosition;\n    }\n\n    var connectionAttrs = rules.allowed('connection.create', {\n      source: source,\n      target: target\n    });\n\n    if (connectionAttrs && isCenterSnapTarget(source)) {\n      // snap source\n      context.sourcePosition = mid(source);\n    }\n\n    if (connectionAttrs && isCenterSnapTarget(target)) {\n\n      // snap target\n      snapToPosition(event, mid(target));\n    }\n  });\n}\n\nCmmnConnectSnapping.$inject = [\n  'eventBus',\n  'rules'\n];\n\nmodule.exports = CmmnConnectSnapping;\n\n// helpers //////////\n\nfunction snapToPosition(event, position) {\n  setSnapped(event, 'x', position.x);\n  setSnapped(event, 'y', position.y);\n}\n\n/**\n * Returns true if element should be center snapped when\n * creating a connection.\n *\n * This applies to all collapsed and non container elements.\n *\n * @param {djs.model.Base} element\n *\n * @return {Boolean}\n */\nfunction isCenterSnapTarget(element) {\n\n  if (!element) {\n    return false;\n  }\n\n  if (is(element, 'cmmn:Stage')) {\n    return false;\n  }\n\n  var bo = getBusinessObject(element);\n  var definition = getDefinition(element) || element;\n\n  if (!is(definition, 'cmmn:PlanFragment')) {\n    return true;\n  }\n\n  var di = bo.di;\n\n  if (di && di.isCollapsed === true) {\n    return true;\n  }\n\n  return false;\n}","'use strict';\n\nvar inherits = require('inherits');\n\nvar SnapUtil = require('diagram-js/lib/features/snapping/SnapUtil');\n\nvar CreateMoveSnapping = require('diagram-js/lib/features/snapping/CreateMoveSnapping').default;\n\nvar isSnapped = SnapUtil.isSnapped,\n    setSnapped = SnapUtil.setSnapped;\n\nvar asTRBL = require('diagram-js/lib/layout/LayoutUtil').asTRBL,\n    getMid = require('diagram-js/lib/layout/LayoutUtil').getMid;\n\nvar getCriterionAttachment = require('./CmmnSnappingUtil').getCriterionAttachment;\n\nvar forEach = require('min-dash').forEach;\n\n\n/**\n * Cmmn specific create move snapping functionality\n *\n * @param {EventBus} eventBus\n * @param {CmmnRules} cmmnRules\n */\nfunction CmmnCreateMoveSnapping(eventBus, cmmnRules, injector) {\n\n  injector.invoke(CreateMoveSnapping, this);\n\n  function canAttach(shape, target, position) {\n    return cmmnRules.canAttach([ shape ], target, null, position) === 'attach';\n  }\n\n  eventBus.on([\n    'create.move',\n    'create.end',\n    'shape.move.move',\n    'shape.move.end'\n  ], 1500, function(event) {\n\n    var context = event.context,\n        target = context.target,\n        shape = context.shape;\n\n    if (target && !isSnapped(event) && canAttach(shape, target, event)) {\n      snapCriterion(event, shape, target);\n    }\n  });\n\n\n  function snapCriterion(event, shape, target) {\n    var targetTRBL = asTRBL(target);\n\n    var direction = getCriterionAttachment(event, target);\n\n    if (/top/.test(direction)) {\n      setSnapped(event, 'y', targetTRBL.top);\n    } else\n    if (/bottom/.test(direction)) {\n      setSnapped(event, 'y', targetTRBL.bottom);\n    }\n\n    if (/left/.test(direction)) {\n      setSnapped(event, 'x', targetTRBL.left);\n    } else\n    if (/right/.test(direction)) {\n      setSnapped(event, 'x', targetTRBL.right);\n    }\n  }\n}\n\ninherits(CmmnCreateMoveSnapping, CreateMoveSnapping);\n\nCmmnCreateMoveSnapping.$inject = [ 'eventBus', 'cmmnRules', 'injector' ];\n\nmodule.exports = CmmnCreateMoveSnapping;\n\n\nCmmnCreateMoveSnapping.prototype.initSnap = function(event) {\n  var snapContext = CreateMoveSnapping.prototype.initSnap.call(this, event);\n\n  var shape = event.shape;\n\n  // snap to docking points\n  forEach(shape.outgoing, function(connection) {\n    var docking = connection.waypoints[0];\n\n    docking = docking.original || docking;\n\n    snapContext.setSnapOrigin(connection.id + '-docking', {\n      x: docking.x - event.x,\n      y: docking.y - event.y\n    });\n  });\n\n  forEach(shape.incoming, function(connection) {\n    var docking = connection.waypoints[connection.waypoints.length - 1];\n\n    docking = docking.original || docking;\n\n    snapContext.setSnapOrigin(connection.id + '-docking', {\n      x: docking.x - event.x,\n      y: docking.y - event.y\n    });\n  });\n\n  return snapContext;\n};\n\n\nCmmnCreateMoveSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target) {\n  CreateMoveSnapping.prototype.addSnapTargetPoints.call(this, snapPoints, shape, target);\n\n  var snapTargets = this.getSnapTargets(shape, target);\n\n  // snap to docking points\n  forEach(shape.incoming, function(connection) {\n\n    if (!includes(snapTargets, connection.source)) {\n      snapPoints.add('mid', getMid(connection.source));\n    }\n\n    var docking = connection.waypoints[0];\n\n    snapPoints.add(connection.id + '-docking', docking.original || docking);\n  });\n\n\n  forEach(shape.outgoing, function(connection) {\n\n    if (!includes(snapTargets, connection.target)) {\n      snapPoints.add('mid', getMid(connection.target));\n    }\n\n    var docking = connection.waypoints[ connection.waypoints.length - 1 ];\n\n    snapPoints.add(connection.id + '-docking', docking.original || docking);\n  });\n\n  return snapPoints;\n};\n\n\n// helpers ////////////////////\n\nfunction includes(array, value) {\n  return array.indexOf(value) !== -1;\n}","'use strict';\n\nvar is = require('../../util/ModelUtil').is,\n    getDefinition = require('../../util/ModelUtil').getDefinition,\n    isCollapsed = require('../../util/DiUtil').isCollapsed;\n\nvar SLIGHTLY_HIGHER_PRIORITY = 1001;\n\n\n/**\n * Cmmn specific resize snapping functionality\n *\n * @param {EventBus} eventBus\n * @param {CmmnRules} cmmnRules\n */\nfunction CmmnResizeSnapping(eventBus) {\n\n  eventBus.on('resize.start', SLIGHTLY_HIGHER_PRIORITY + 500, function(event) {\n    var context = event.context,\n        shape = context.shape;\n\n    if (isStage(shape) && !isCollapsed(shape)) {\n      context.minDimensions = { width: 140, height: 120 };\n    }\n\n    if (is(shape, 'cmmn:TextAnnotation')) {\n      context.minDimensions = { width: 50, height: 30 };\n    }\n\n  });\n\n}\n\nCmmnResizeSnapping.$inject = [ 'eventBus', 'cmmnRules', 'injector' ];\n\nmodule.exports = CmmnResizeSnapping;\n\n// helpers //////////\n\nfunction isStage(element) {\n  return is(getDefinition(element), 'cmmn:PlanFragment');\n}\n","module.exports = {\n  __depends__: [\n    require('diagram-js/lib/features/search-pad').default\n  ],\n  __init__: [ 'cmmnSearch'],\n  cmmnSearch: [ 'type', require('./CmmnSearchProvider') ]\n};\n","'use strict';\n\nvar map = require('min-dash').map,\n    filter = require('min-dash').filter,\n    sortBy = require('min-dash').sortBy;\n\nvar labelUtil = require('../label-editing/LabelUtil');\n\n\n/**\n * Provides ability to search through CMMN elements\n */\nfunction CmmnSearchProvider(elementRegistry, searchPad, canvas) {\n\n  this._elementRegistry = elementRegistry;\n  this._canvas = canvas;\n\n  searchPad.registerProvider(this);\n}\n\nmodule.exports = CmmnSearchProvider;\n\nCmmnSearchProvider.$inject = [\n  'elementRegistry',\n  'searchPad',\n  'canvas'\n];\n\n\n/**\n * Finds all elements that match given pattern\n *\n * <Result> :\n *  {\n *    primaryTokens: <Array<Token>>,\n *    secondaryTokens: <Array<Token>>,\n *    element: <Element>\n *  }\n *\n * <Token> :\n *  {\n *    normal|matched: <String>\n *  }\n *\n * @param  {String} pattern\n * @return {Array<Result>}\n */\nCmmnSearchProvider.prototype.find = function(pattern) {\n  var rootElement = this._canvas.getRootElement();\n\n  var elements = this._elementRegistry.filter(function(element) {\n    if (element.labelTarget) {\n      return false;\n    }\n    return true;\n  });\n\n  // do not include root element\n  elements = filter(elements, function(element) {\n    return element !== rootElement;\n  });\n\n  elements = map(elements, function(element) {\n    return {\n      primaryTokens: matchAndSplit(labelUtil.getLabel(element), pattern),\n      secondaryTokens: matchAndSplit(element.id, pattern),\n      element: element\n    };\n  });\n\n  // exclude non-matched elements\n  elements = filter(elements, function(element) {\n    return hasMatched(element.primaryTokens) || hasMatched(element.secondaryTokens);\n  });\n\n  elements = sortBy(elements, function(element) {\n    return labelUtil.getLabel(element.element) + element.element.id;\n  });\n\n  return elements;\n};\n\n\nfunction hasMatched(tokens) {\n  var matched = filter(tokens, function(t) {\n    return !!t.matched;\n  });\n\n  return matched.length > 0;\n}\n\n\nfunction matchAndSplit(text, pattern) {\n  var tokens = [],\n      originalText = text;\n\n  if (!text) {\n    return tokens;\n  }\n\n  text = text.toLowerCase();\n  pattern = pattern.toLowerCase();\n\n  var i = text.indexOf(pattern);\n\n  if (i > -1) {\n    if (i !== 0) {\n      tokens.push({\n        normal: originalText.substr(0, i)\n      });\n    }\n\n    tokens.push({\n      matched: originalText.substr(i, pattern.length)\n    });\n\n    if (pattern.length + i < text.length) {\n      tokens.push({\n        normal: originalText.substr(pattern.length + i, text.length)\n      });\n    }\n  } else {\n    tokens.push({\n      normal: originalText\n    });\n  }\n\n  return tokens;\n}","module.exports = {\n  __depends__: [\n    require('diagram-js/lib/features/move').default\n  ],\n  __init__: ['cmmnReplacePreview'],\n  cmmnReplacePreview: [ 'type', require('./CmmnReplacePreview') ]\n};\n","'use strict';\n\nvar CommandInterceptor = require('diagram-js/lib/command/CommandInterceptor').default;\n\nvar cssEscape = require('css.escape');\n\nvar inherits = require('inherits');\n\nvar assign = require('min-dash').assign,\n    forEach = require('min-dash').forEach;\n\nvar getVisual = require('diagram-js/lib/util/GraphicsUtil').getVisual;\n\nvar isItemCapable = require('../modeling/util/PlanItemDefinitionUtil').isItemCapable;\n\nvar ModelUtil = require('../../util/ModelUtil'),\n    getBusinessObject = ModelUtil.getBusinessObject,\n    getDefinition = ModelUtil.getDefinition;\n\nvar domQuery = require('min-dom').query;\n\nvar svgAppend = require('tiny-svg').append,\n    svgClasses = require('tiny-svg').classes,\n    svgCreate = require('tiny-svg').create,\n    svgRemove = require('tiny-svg').remove;\n\nvar LOW_PRIORITY = 250;\n\nfunction CmmnReplacePreview(\n    cmmnReplace,\n    cmmnRules,\n    elementFactory,\n    elementRegistry,\n    eventBus,\n    graphicsFactory\n) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function createShape(element, replacement) {\n\n    var newElement = {\n      type: replacement.newElementType,\n      x: element.x,\n      y: element.y,\n      width: element.width,\n      height: element.height\n    };\n\n    if (isItemCapable(element)) {\n\n      var bo = getBusinessObject(element),\n          definition = getDefinition(element),\n          newElementType = replacement.newElementType,\n          newDefinitionType = replacement.newDefinitionType,\n          replaceCandidate;\n\n      if (newDefinitionType) {\n        definition = cmmnReplace.replacePlanItemDefinition(definition, newDefinitionType);\n      }\n\n      replaceCandidate = cmmnReplace.replaceItemCapable(bo, newElementType, definition);\n\n      assign(newElement, {\n        businessObject: replaceCandidate\n      });\n    }\n\n    return elementFactory.createShape(newElement);\n  }\n\n\n  function initVisualReplacements(context) {\n    if (!context.visualReplacements) {\n      context.visualReplacements = {};\n    }\n    return context.visualReplacements;\n  }\n\n\n  function canReplace(event) {\n    var context = event.context,\n        canExecute = context.canExecute || context.allowed;\n\n    if (canExecute === 'attach') {\n      var position = context.position || { x: event.x, y: event.y },\n          shapes = context.shapes || [ context.shape ],\n          target = context.target;\n\n      canExecute = cmmnRules.canReplace(shapes, target, position, context.source);\n    }\n\n\n    return canExecute;\n  }\n\n\n  /**\n   * Replace the visuals to the given shape\n   */\n  function replaceVisualGraphics(gfx, shape) {\n\n    var visual = gfx && getVisual(gfx);\n\n    if (visual) {\n      svgRemove(visual);\n\n      visual = svgCreate('g');\n      svgClasses(visual).add('djs-visual');\n\n      svgAppend(gfx, visual);\n\n      graphicsFactory.drawShape(visual, shape);\n    }\n\n  }\n\n\n  function replaceVisual(context, replacements, gfxSelector) {\n\n    forEach(replacements, function(replacement) {\n\n      var id = replacement.oldElementId,\n          shape = elementRegistry.get(id) || context.shape;\n\n      // if the visual of the element is already replaced\n      if (context.visualReplacements[id]) {\n        return;\n      }\n\n      // create a temporary shape\n      var tempShape = createShape(shape, replacement);\n\n      // select the original SVG element related to the element and hide it\n      var gfx = gfxSelector(shape);\n\n      replaceVisualGraphics(gfx, tempShape);\n      context.visualReplacements[id] = shape;\n\n    });\n\n  }\n\n  function restoreVisual(context, gfxSelector) {\n\n    var visualReplacements = context.visualReplacements;\n\n    forEach(visualReplacements, function(shape, id) {\n\n      var gfx = gfxSelector(shape);\n      replaceVisualGraphics(gfx, shape);\n\n      delete visualReplacements[id];\n\n    });\n  }\n\n\n  eventBus.on([ 'shape.move.move', 'create.move' ], LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        dragGroup = context.dragGroup,\n        visual = context.visual,\n        canExecute = canReplace(event),\n        replacements = canExecute && canExecute.replacements;\n\n    initVisualReplacements(context);\n\n    var getGfx = function(shape) {\n      var selector,\n          gfx;\n\n      if (dragGroup) {\n        selector = '[data-element-id=\"' + cssEscape(shape.id) + '\"]';\n        gfx = dragGroup;\n      }\n      else if (visual) {\n        selector = '.djs-dragger';\n        gfx = visual;\n      }\n\n      return gfx && domQuery(selector, gfx);\n    };\n\n    if (replacements && replacements.length) {\n      replaceVisual(context, replacements, getGfx);\n    }\n    else {\n      restoreVisual(context, getGfx);\n    }\n\n  });\n\n\n  eventBus.on([\n    'bendpoint.move.move',\n    'connect.move'\n  ], LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        canExecute = canReplace(event),\n        replacements = canExecute && canExecute.replacements;\n\n    initVisualReplacements(context);\n\n    if (replacements && replacements.length) {\n      replaceVisual(context, replacements, function(shape) {\n        return elementRegistry.getGraphics(shape);\n      });\n    }\n\n  });\n\n\n  eventBus.on([\n    'bendpoint.move.cancel',\n    'bendpoint.move.cleanup',\n    'bendpoint.move.end',\n    'bendpoint.move.out',\n    'connect.cleanup',\n    'connect.end',\n    'connect.out'\n  ], LOW_PRIORITY, function(event) {\n\n    var context = event.context;\n\n    restoreVisual(context, function(shape) {\n      return elementRegistry.getGraphics(shape);\n    });\n\n  });\n\n}\n\nCmmnReplacePreview.$inject = [\n  'cmmnReplace',\n  'cmmnRules',\n  'elementFactory',\n  'elementRegistry',\n  'eventBus',\n  'graphicsFactory'\n];\n\ninherits(CmmnReplacePreview, CommandInterceptor);\n\nmodule.exports = CmmnReplacePreview;\n","module.exports = require('./lib');","module.exports = {\n  __depends__: [\n    require('./cmd')\n  ],\n  __init__: [ 'propertiesPanel' ],\n  propertiesPanel: [ 'type', require('./PropertiesPanel') ]\n};\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\nvar HANDLERS = {\n  'properties-panel.update-businessobject': require('./UpdateBusinessObjectHandler'),\n  'properties-panel.update-businessobject-list': require('./UpdateBusinessObjectListHandler'),\n  'properties-panel.multi-command-executor': require('./MultiCommandHandler')\n};\n\n\nfunction CommandInitializer(eventBus, commandStack) {\n\n  eventBus.on('diagram.init', function() {\n    forEach(HANDLERS, function(handler, id) {\n      commandStack.registerHandler(id, handler);\n    });\n  });\n}\n\nCommandInitializer.$inject = [ 'eventBus', 'commandStack' ];\n\nmodule.exports = {\n  __init__: [ CommandInitializer ]\n};\n","'use strict';\n\nvar reduce = require('lodash/transform'),\n    keys = require('lodash/keys'),\n    forEach = require('lodash/forEach');\n\n/**\n * A handler that implements a CMMN 1.1 property update\n * for business objects which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * @class\n * @constructor\n */\nfunction UpdateBusinessObjectHandler() { }\n\n\nmodule.exports = UpdateBusinessObjectHandler;\n\n\nfunction getProperties(businessObject, propertyNames) {\n  return reduce(propertyNames, function(result, key) {\n    result[key] = businessObject.get(key);\n    return result;\n  }, {});\n}\n\n\nfunction setProperties(businessObject, properties) {\n  forEach(properties, function(value, key) {\n    businessObject.set(key, value);\n  });\n}\n\n\n// api /////////////////////////////////////////////\n\n/**\n * Updates a business object with a list of new properties\n *\n * @method  UpdateBusinessObjectHandler#execute\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element the element which has a child business object updated\n * @param {moddle.businessObject} context.businessObject the businessObject to update\n * @param {Object} context.properties a list of properties to set on the businessObject\n *\n * @return {Array<djs.mode.Base>} the updated element\n */\nUpdateBusinessObjectHandler.prototype.execute = function(context) {\n\n  var element = context.element,\n      businessObject = context.businessObject,\n      changed = [ element ]; // this will not change any diagram-js elements\n\n  if (!element) {\n    throw new Error('element required');\n  }\n\n  if (!businessObject) {\n    throw new Error('businessObject required');\n  }\n\n  var properties = context.properties,\n      oldProperties = context.oldProperties || getProperties(businessObject, keys(properties));\n\n  // update properties\n  setProperties(businessObject, properties);\n\n  // store old values\n  context.oldProperties = oldProperties;\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  UpdateBusinessObjectHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nUpdateBusinessObjectHandler.prototype.revert = function(context) {\n\n  var oldProperties = context.oldProperties,\n      businessObject = context.businessObject;\n\n  // update properties\n  setProperties(businessObject, oldProperties);\n\n  return context.changed;\n};\n","var arrayEach = require('./_arrayEach'),\n    baseCreate = require('./_baseCreate'),\n    baseForOwn = require('./_baseForOwn'),\n    baseIteratee = require('./_baseIteratee'),\n    getPrototype = require('./_getPrototype'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isFunction = require('./isFunction'),\n    isObject = require('./isObject'),\n    isTypedArray = require('./isTypedArray');\n\n/**\n * An alternative to `_.reduce`; this method transforms `object` to a new\n * `accumulator` object which is the result of running each of its own\n * enumerable string keyed properties thru `iteratee`, with each invocation\n * potentially mutating the `accumulator` object. If `accumulator` is not\n * provided, a new object with the same `[[Prototype]]` will be used. The\n * iteratee is invoked with four arguments: (accumulator, value, key, object).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @static\n * @memberOf _\n * @since 1.3.0\n * @category Object\n * @param {Object} object The object to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @param {*} [accumulator] The custom accumulator value.\n * @returns {*} Returns the accumulated value.\n * @example\n *\n * _.transform([2, 3, 4], function(result, n) {\n *   result.push(n *= n);\n *   return n % 2 == 0;\n * }, []);\n * // => [4, 9]\n *\n * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n *   (result[value] || (result[value] = [])).push(key);\n * }, {});\n * // => { '1': ['a', 'c'], '2': ['b'] }\n */\nfunction transform(object, iteratee, accumulator) {\n  var isArr = isArray(object),\n      isArrLike = isArr || isBuffer(object) || isTypedArray(object);\n\n  iteratee = baseIteratee(iteratee, 4);\n  if (accumulator == null) {\n    var Ctor = object && object.constructor;\n    if (isArrLike) {\n      accumulator = isArr ? new Ctor : [];\n    }\n    else if (isObject(object)) {\n      accumulator = isFunction(Ctor) ? baseCreate(getPrototype(object)) : {};\n    }\n    else {\n      accumulator = {};\n    }\n  }\n  (isArrLike ? arrayEach : baseForOwn)(object, function(value, index, object) {\n    return iteratee(accumulator, value, index, object);\n  });\n  return accumulator;\n}\n\nmodule.exports = transform;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\n/**\n * A handler that implements a CMMN 1.1 property update\n * for business object lists which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * @class\n * @constructor\n */\nfunction UpdateBusinessObjectListHandler() { }\n\nmodule.exports = UpdateBusinessObjectListHandler;\n\nfunction ensureNotNull(prop, name) {\n  if (!prop) {\n    throw new Error(name + 'required');\n  }\n  return prop;\n}\n\n// api /////////////////////////////////////////////\n\n/**\n * Updates a element under a provided parent.\n */\nUpdateBusinessObjectListHandler.prototype.execute = function(context) {\n\n  var currentObject = ensureNotNull(context.currentObject, 'currentObject'),\n      propertyName = ensureNotNull(context.propertyName, 'propertyName'),\n      updatedObjectList = context.updatedObjectList,\n      objectsToRemove = context.objectsToRemove || [],\n      objectsToAdd = context.objectsToAdd || [],\n      changed = [ context.element], // this will not change any diagram-js elements\n      referencePropertyName;\n\n  if (context.referencePropertyName) {\n    referencePropertyName = context.referencePropertyName;\n  }\n\n  var objectList = currentObject[propertyName];\n  // adjust array reference in the parent business object\n  context.previousList = currentObject[propertyName];\n\n  if (updatedObjectList) {\n    currentObject[propertyName] = updatedObjectList;\n  }\n  else {\n    var listCopy = [];\n    // remove all objects which should be removed\n    forEach(objectList, function(object) {\n      if (objectsToRemove.indexOf(object) == -1) {\n        listCopy.push(object);\n      }\n    });\n    // add all objects which should be added\n    listCopy = listCopy.concat(objectsToAdd);\n\n    // set property to new list\n    if (listCopy.length > 0 || !referencePropertyName) {\n\n      // as long as there are elements in the list update the list\n      currentObject[propertyName] = listCopy;\n    } else if (referencePropertyName) {\n\n      // remove the list when it is empty\n      var parentObject = currentObject.$parent;\n      parentObject.set(referencePropertyName, undefined);\n    }\n  }\n\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  CreateBusinessObjectListHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nUpdateBusinessObjectListHandler.prototype.revert = function(context) {\n\n  var currentObject = context.currentObject,\n      propertyName = context.propertyName,\n      previousList = context.previousList,\n      parentObject = currentObject.$parent;\n\n  if (context.referencePropertyName) {\n    parentObject.set(context.referencePropertyName, currentObject);\n  }\n\n  // remove new element\n  currentObject.set(propertyName, previousList);\n\n  return context.changed;\n};\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\n/**\n * A handler that combines and executes multiple commands.\n *\n * All updates are bundled on the command stack and executed in one step.\n * This also makes it possible to revert the changes in one step.\n *\n * Example use case: remove the camunda:formKey attribute and in addition\n * add all form fields needed for the camunda:formData property.\n *\n * @class\n * @constructor\n */\nfunction MultiCommandHandler(commandStack) {\n  this._commandStack = commandStack;\n}\n\nMultiCommandHandler.$inject = [ 'commandStack' ];\n\nmodule.exports = MultiCommandHandler;\n\nMultiCommandHandler.prototype.preExecute = function(context) {\n\n  var commandStack = this._commandStack;\n\n  forEach(context, function(command) {\n    commandStack.execute(command.cmd, command.context);\n  });\n};","'use strict';\n\nvar escapeHTML = require('./Utils').escapeHTML;\n\nvar domify = require('min-dom').domify,\n    domQuery = require('min-dom').query,\n    domQueryAll = require('min-dom').queryAll,\n    domRemove = require('min-dom').remove,\n    domClasses = require('min-dom').classes,\n    domClosest = require('min-dom').closest,\n    domAttr = require('min-dom').attr,\n    domDelegate = require('min-dom').delegate,\n    domMatches = require('min-dom').matches;\n\nvar forEach = require('lodash/forEach'),\n    filter = require('lodash/filter'),\n    get = require('lodash/get'),\n    keys = require('lodash/keys'),\n    isEmpty = require('lodash/isEmpty'),\n    isArray = require('lodash/isArray'),\n    xor = require('lodash/xor'),\n    debounce = require('lodash/debounce');\n\nvar updateSelection = require('selection-update');\n\nvar scrollTabs = require('scroll-tabs').default;\n\nvar HIDE_CLASS = 'cpp-hidden';\nvar DEBOUNCE_DELAY = 300;\n\n\nfunction isToggle(node) {\n  return node.type === 'checkbox' || node.type === 'radio';\n}\n\nfunction isSelect(node) {\n  return node.type === 'select-one';\n}\n\nfunction isContentEditable(node) {\n  return domAttr(node, 'contenteditable');\n}\n\nfunction getPropertyPlaceholders(node) {\n  var selector = 'input[name], textarea[name], [data-value], [contenteditable]';\n  var placeholders = domQueryAll(selector, node);\n  if ((!placeholders || !placeholders.length) && domMatches(node, selector)) {\n    placeholders = [ node ];\n  }\n  return placeholders;\n}\n\n/**\n * Return all active form controls.\n * This excludes the invisible controls unless all is true\n *\n * @param {Element} node\n * @param {Boolean} [all=false]\n */\nfunction getFormControls(node, all) {\n  var controls = domQueryAll('input[name], textarea[name], select[name], [contenteditable]', node);\n\n  if (!controls || !controls.length) {\n    controls = domMatches(node, 'option') ? [ node ] : controls;\n  }\n\n  if (!all) {\n    controls = filter(controls, function(node) {\n      return !domClosest(node, '.' + HIDE_CLASS);\n    });\n  }\n\n  return controls;\n}\n\nfunction getFormControlValuesInScope(entryNode) {\n  var values = {};\n\n  var controlNodes = getFormControls(entryNode);\n\n  forEach(controlNodes, function(controlNode) {\n    var value = controlNode.value;\n\n    var name = domAttr(controlNode, 'name') || domAttr(controlNode, 'data-name');\n\n    // take toggle state into account for radio / checkboxes\n    if (isToggle(controlNode)) {\n      if (controlNode.checked) {\n        if (!domAttr(controlNode, 'value')) {\n          value = true;\n        } else {\n          value = controlNode.value;\n        }\n      } else {\n        value = null;\n      }\n    } else\n    if (isContentEditable(controlNode)) {\n      value = controlNode.innerText;\n    }\n\n    if (value !== null) {\n      // return the actual value\n      // handle serialization in entry provider\n      // (ie. if empty string should be serialized or not)\n      values[name] = value;\n    }\n  });\n\n  return values;\n\n}\n\n/**\n * Extract input values from entry node\n *\n * @param  {DOMElement} entryNode\n * @returns {Object}\n */\nfunction getFormControlValues(entryNode) {\n\n  var values;\n\n  var listContainer = domQuery('[data-list-entry-container]', entryNode);\n  if (listContainer) {\n    values = [];\n    var listNodes = listContainer.children || [];\n    forEach(listNodes, function(listNode) {\n      values.push(getFormControlValuesInScope(listNode));\n    });\n  }\n  else {\n    values = getFormControlValuesInScope(entryNode);\n  }\n\n  return values;\n}\n\n/**\n * Return true if the given form extracted value equals\n * to an old cached version.\n *\n * @param {Object} value\n * @param {Object} oldValue\n * @return {Boolean}\n */\nfunction valueEqual(value, oldValue) {\n\n  if (value && !oldValue) {\n    return false;\n  }\n\n  var allKeys = keys(value).concat(keys(oldValue));\n\n  return allKeys.every(function(key) {\n    return value[key] === oldValue[key];\n  });\n}\n\n/**\n * Return true if the given form extracted value(s)\n * equal an old cached version.\n *\n * @param {Array<Object>|Object} values\n * @param {Array<Object>|Object} oldValues\n * @return {Boolean}\n */\nfunction valuesEqual(values, oldValues) {\n\n  if (isArray(values)) {\n\n    if (values.length !== oldValues.length) {\n      return false;\n    }\n\n    return values.every(function(v, idx) {\n      return valueEqual(v, oldValues[idx]);\n    });\n  }\n\n  return valueEqual(values, oldValues);\n}\n\n/**\n * Return a mapping of { id: entry } for all entries in the given groups in the given tabs.\n *\n * @param {Object} tabs\n * @return {Object}\n */\nfunction extractEntries(tabs) {\n  return keyBy(flattenDeep(map(flattenDeep(map(tabs, 'groups')), 'entries')), 'id');\n}\n\n/**\n * Return a mapping of { id: group } for all groups in the given tabs.\n *\n * @param {Object} tabs\n * @return {Object}\n */\nfunction extractGroups(tabs) {\n  return keyBy(flattenDeep(map(tabs, 'groups')), 'id');\n}\n\n/**\n * A properties panel implementation.\n *\n * To use it provide a `propertiesProvider` component that knows\n * about which properties to display.\n *\n * Properties edit state / visibility can be intercepted\n * via a custom {@link PropertiesActivator}.\n *\n * @class\n * @constructor\n *\n * @param {Object} config\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {PropertiesProvider} propertiesProvider\n * @param {Canvas} canvas\n * @param {CommandStack} commandStack\n */\nfunction PropertiesPanel(config, eventBus, modeling, propertiesProvider, commandStack, canvas) {\n\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._commandStack = commandStack;\n  this._canvas = canvas;\n  this._propertiesProvider = propertiesProvider;\n\n  this._init(config);\n}\n\nPropertiesPanel.$inject = [\n  'config.propertiesPanel',\n  'eventBus',\n  'modeling',\n  'propertiesProvider',\n  'commandStack',\n  'canvas' ];\n\nmodule.exports = PropertiesPanel;\n\n\nPropertiesPanel.prototype._init = function(config) {\n\n  var eventBus = this._eventBus;\n\n  var self = this;\n\n  /**\n   * Select the root element once it is added to the canvas\n   */\n  eventBus.on('root.added', function(e) {\n    self.update(e.element);\n  });\n\n  eventBus.on('selection.changed', function(e) {\n    var newElement = e.newSelection[0];\n\n    self.update(newElement);\n  });\n\n  // add / update tab-bar scrolling\n  eventBus.on([\n    'propertiesPanel.changed',\n    'propertiesPanel.resized'\n  ], function(event) {\n\n    var tabBarNode = domQuery('.cpp-properties-tab-bar', self._container);\n\n    if (!tabBarNode) {\n      return;\n    }\n\n    var scroller = scrollTabs.get(tabBarNode);\n\n    if (!scroller) {\n\n      // we did not initialize yet, do that\n      // now and make sure we select the active\n      // tab on scroll update\n      scroller = scrollTabs(tabBarNode, {\n        selectors: {\n          tabsContainer: '.cpp-properties-tabs-links',\n          tab: '.cpp-properties-tabs-links li',\n          ignore: '.cpp-hidden',\n          active: '.cpp-active'\n        }\n      });\n\n\n      scroller.on('scroll', function(newActiveNode, oldActiveNode, direction) {\n\n        var linkNode = domQuery('[data-tab-target]', newActiveNode);\n\n        var tabId = domAttr(linkNode, 'data-tab-target');\n\n        self.activateTab(tabId);\n      });\n    }\n\n    // react on tab changes and or tabContainer resize\n    // and make sure the active tab is shown completely\n    scroller.update();\n  });\n\n  eventBus.on('elements.changed', function(e) {\n\n    var current = self._current;\n    var element = current && current.element;\n\n    if (element) {\n      if (e.elements.indexOf(element) !== -1) {\n        self.update(element);\n      }\n    }\n  });\n\n  eventBus.on('diagram.destroy', function() {\n    self.detach();\n  });\n\n  this._container = domify('<div class=\"cpp-properties-panel\"></div>');\n\n  this._bindListeners(this._container);\n\n  if (config && config.parent) {\n    this.attachTo(config.parent);\n  }\n};\n\n\nPropertiesPanel.prototype.attachTo = function(parentNode) {\n\n  if (!parentNode) {\n    throw new Error('parentNode required');\n  }\n\n  // ensure we detach from the\n  // previous, old parent\n  this.detach();\n\n  // unwrap jQuery if provided\n  if (parentNode.get) {\n    parentNode = parentNode.get(0);\n  }\n\n  if (typeof parentNode === 'string') {\n    parentNode = domQuery(parentNode);\n  }\n\n  var container = this._container;\n\n  parentNode.appendChild(container);\n\n  this._emit('attach');\n};\n\nPropertiesPanel.prototype.detach = function() {\n\n  var container = this._container,\n      parentNode = container.parentNode;\n\n  if (!parentNode) {\n    return;\n  }\n\n  this._emit('detach');\n\n  parentNode.removeChild(container);\n};\n\n\n/**\n * Select the given tab within the properties panel.\n *\n * @param {Object|String} tab\n */\nPropertiesPanel.prototype.activateTab = function(tab) {\n\n  var tabId = typeof tab === 'string' ? tab : tab.id;\n\n  var current = this._current;\n\n  var panelNode = current.panel;\n\n  var allTabNodes = domQueryAll('.cpp-properties-tab', panelNode),\n      allTabLinkNodes = domQueryAll('.cpp-properties-tab-link', panelNode);\n\n  forEach(allTabNodes, function(tabNode) {\n    var currentTabId = domAttr(tabNode, 'data-tab');\n\n    domClasses(tabNode).toggle('cpp-active', tabId === currentTabId);\n  });\n\n  forEach(allTabLinkNodes, function(tabLinkNode) {\n    var tabLink = domQuery('[data-tab-target]', tabLinkNode),\n        currentTabId = domAttr(tabLink, 'data-tab-target');\n\n    domClasses(tabLinkNode).toggle('cpp-active', tabId === currentTabId);\n  });\n};\n\n/**\n * Update the DOM representation of the properties panel\n */\nPropertiesPanel.prototype.update = function(element) {\n  var current = this._current;\n\n  // no actual selection change\n  var needsCreate = true;\n\n  if (typeof element === 'undefined') {\n\n    // use RootElement of BPMN diagram to generate properties panel if no element is selected\n    element = this._canvas.getRootElement();\n  }\n\n  var newTabs = this._propertiesProvider.getTabs(element);\n\n  if (current && current.element === element) {\n    // see if we can reuse the existing panel\n\n    needsCreate = this._entriesChanged(current, newTabs);\n    // needsCreate = false;\n  }\n\n  if (needsCreate) {\n\n    if (current) {\n\n      // get active tab from the existing panel before remove it\n      var activeTabNode = domQuery('.cpp-properties-tab.cpp-active', current.panel);\n\n      var activeTabId;\n      if (activeTabNode) {\n        activeTabId = domAttr(activeTabNode, 'data-tab');\n      }\n\n      // remove old panel\n      domRemove(current.panel);\n    }\n\n    this._current = this._create(element, newTabs);\n\n    // activate the saved active tab from the remove panel or the first tab\n    (activeTabId) ? this.activateTab(activeTabId) : this.activateTab(this._current.tabs[0]);\n  }\n\n  if (this._current) {\n    // make sure correct tab contents are visible\n    this._updateActivation(this._current);\n\n  }\n\n  this._emit('changed');\n};\n\n\n/**\n * Returns true if one of two groups has different entries than the other.\n *\n * @param  {Object} current\n * @param  {Object} newTabs\n * @return {Booelan}\n */\nPropertiesPanel.prototype._entriesChanged = function(current, newTabs) {\n\n  var oldEntryIds = keys(current.entries),\n      newEntryIds = keys(extractEntries(newTabs));\n\n  return !isEmpty(xor(oldEntryIds, newEntryIds));\n};\n\nPropertiesPanel.prototype._emit = function(event) {\n  this._eventBus.fire('propertiesPanel.' + event, { panel: this, current: this._current });\n};\n\nPropertiesPanel.prototype._bindListeners = function(container) {\n\n  var self = this;\n\n  // handles a change for a given event\n  var handleChange = function handleChange(event) {\n\n    // see if we handle a change inside a [data-entry] element.\n    // if not, drop out\n    var node = domClosest(event.delegateTarget, '[data-entry]'),\n        entryId, entry;\n\n    // change from outside a [data-entry] element, simply ignore\n    if (!node) {\n      return;\n    }\n\n    entryId = domAttr(node, 'data-entry');\n    entry = self.getEntry(entryId);\n\n    var values = getFormControlValues(node);\n\n    if (event.type === 'change') {\n\n      // - if the \"data-on-change\" attribute is present and a value is changed,\n      //   then the associated action is performed.\n      // - if the associated action returns \"true\" then an update to the business\n      //   object is done\n      // - if it does not return \"true\", then only the DOM content is updated\n      var onChangeAction = event.delegateTarget.getAttribute('data-on-change');\n\n      if (onChangeAction) {\n        var isEntryDirty = self.executeAction(entry, node, onChangeAction, event);\n\n        if (!isEntryDirty) {\n          return self.update(self._current.element);\n        }\n      }\n    }\n    self.applyChanges(entry, values, node);\n    self.updateState(entry, node);\n  };\n\n  // debounce update only elements that are target of key events,\n  // i.e. INPUT and TEXTAREA. SELECTs will trigger an immediate update anyway.\n  domDelegate.bind(container, 'input, textarea, [contenteditable]', 'input', debounce(handleChange, DEBOUNCE_DELAY));\n  domDelegate.bind(container, 'input, textarea, select, [contenteditable]', 'change', handleChange);\n\n  // paste as plain text only\n  domDelegate.bind(container, '[contenteditable]', 'paste', handlePaste);\n\n  function handlePaste(event) {\n    var text = (event.clipboardData || window.clipboardData).getData('text');\n    document.execCommand('insertText', false, text);\n\n    event.preventDefault();\n  }\n\n  domDelegate.bind(container, '[data-action]', 'click', function onClick(event) {\n\n    // triggers on all inputs\n    var inputNode = event.delegateTarget;\n    var entryNode = domClosest(inputNode, '[data-entry]');\n\n    var actionId = domAttr(inputNode, 'data-action'),\n        entryId = domAttr(entryNode, 'data-entry');\n\n    var entry = self.getEntry(entryId);\n\n    var isEntryDirty = self.executeAction(entry, entryNode, actionId, event);\n\n    if (isEntryDirty) {\n      var values = getFormControlValues(entryNode);\n\n      self.applyChanges(entry, values, entryNode, isEntryDirty.force);\n    }\n\n    self.updateState(entry, entryNode);\n  });\n\n  function handleInput(event, element) {\n    // triggers on all inputs\n    var inputNode = event.delegateTarget;\n\n    var entryNode = domClosest(inputNode, '[data-entry]');\n\n    // only work on data entries\n    if (!entryNode) {\n      return;\n    }\n\n    var eventHandlerId = domAttr(inputNode, 'data-blur'),\n        entryId = domAttr(entryNode, 'data-entry');\n\n    var entry = self.getEntry(entryId);\n\n    var isEntryDirty = self.executeAction(entry, entryNode, eventHandlerId, event);\n\n    if (isEntryDirty) {\n      var values = getFormControlValues(entryNode);\n\n      self.applyChanges(entry, values, entryNode);\n    }\n\n    self.updateState(entry, entryNode);\n  }\n\n  domDelegate.bind(container, '[data-blur]', 'blur', handleInput, true);\n\n  // make tab links interactive\n  domDelegate.bind(container, '.cpp-properties-tabs-links [data-tab-target]', 'click', function(event) {\n    event.preventDefault();\n\n    var delegateTarget = event.delegateTarget;\n\n    var tabId = domAttr(delegateTarget, 'data-tab-target');\n\n    // activate tab on link click\n    self.activateTab(tabId);\n  });\n\n};\n\nPropertiesPanel.prototype.updateState = function(entry, entryNode) {\n  this.updateShow(entry, entryNode);\n  this.updateDisable(entry, entryNode);\n};\n\n/**\n * Update the visibility of the entry node in the DOM\n */\nPropertiesPanel.prototype.updateShow = function(entry, node) {\n\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  domClasses(node).remove(HIDE_CLASS);\n\n  if (typeof entry.hideEntry === 'function') {\n\n    var shouldHideEntry = entry.hideEntry(current.element, node);\n    if (shouldHideEntry) {\n      domClasses(node).add(HIDE_CLASS);\n    }\n\n  }\n\n  var showNodes = domQueryAll('[data-show]', node) || [];\n\n  forEach(showNodes, function(showNode) {\n\n    var expr = domAttr(showNode, 'data-show');\n    var fn = get(entry, expr);\n    if (fn) {\n      var scope = domClosest(showNode, '[data-scope]') || node;\n      var shouldShow = fn(current.element, node, showNode, scope) || false;\n      var hasClass = domClasses(showNode).has(HIDE_CLASS);\n      if (shouldShow) {\n        if (hasClass) {\n          domClasses(showNode).remove(HIDE_CLASS);\n        }\n      } else {\n        domClasses(showNode).add(HIDE_CLASS);\n      }\n    }\n  });\n};\n\n/**\n * Evaluates a given function. If it returns true, then the\n * node is marked as \"disabled\".\n */\nPropertiesPanel.prototype.updateDisable = function(entry, node) {\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var nodes = domQueryAll('[data-disable]', node) || [];\n\n  forEach(nodes, function(currentNode) {\n    var expr = domAttr(currentNode, 'data-disable');\n    var fn = get(entry, expr);\n    if (fn) {\n      var scope = domClosest(currentNode, '[data-scope]') || node;\n      var shouldDisable = fn(current.element, node, currentNode, scope) || false;\n      domAttr(currentNode, 'disabled', shouldDisable ? '' : null);\n    }\n  });\n};\n\nPropertiesPanel.prototype.executeAction = function(entry, entryNode, actionId, event) {\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var fn = get(entry, actionId);\n  if (fn) {\n    var scopeNode = domClosest(event.target, '[data-scope]') || entryNode;\n    return fn.apply(entry, [ current.element, entryNode, event, scopeNode ]);\n  }\n};\n\n/**\n * Apply changes to the business object by executing a command\n */\nPropertiesPanel.prototype.applyChanges = function(entry, values, containerElement, force) {\n\n  var element = this._current.element;\n\n  // ensure we only update the model if we got dirty changes\n  if (!force && valuesEqual(values, entry.oldValues)) {\n    return;\n  }\n\n  var command = entry.set(element, values, containerElement);\n\n  var commandToExecute;\n\n  if (isArray(command)) {\n    if (command.length) {\n      commandToExecute = {\n        cmd: 'properties-panel.multi-command-executor',\n        context: flattenDeep(command)\n      };\n    }\n  } else {\n    commandToExecute = command;\n  }\n\n  if (commandToExecute) {\n    this._commandStack.execute(commandToExecute.cmd, commandToExecute.context || { element : element });\n  } else {\n    this.update(element);\n  }\n};\n\n\n/**\n * apply validation results in the DOM and show or remove a message near the entry node.\n */\nPropertiesPanel.prototype.applyValidationResults = function(validationResults, entryNode) {\n\n  validationResults = validationResults || {};\n\n  var controlNodes = getFormControls(entryNode, true);\n\n  forEach(controlNodes, function(controlNode) {\n\n    var name = domAttr(controlNode, 'name') || domAttr(controlNode, 'data-name'),\n        message = validationResults[name],\n        messageNode = domQuery('.cpp-validation-message', controlNode.parentNode);\n\n    domClasses(controlNode).remove('invalid');\n    domClasses(controlNode).remove('warning');\n\n\n    if (messageNode) {\n      domClasses(messageNode).remove('cpp-error-message');\n      domClasses(messageNode).remove('cpp-warning-message');\n\n      if (!message) {\n        controlNode.parentNode.removeChild(messageNode);\n      }\n    }\n\n\n    if (message) {\n\n      if (!messageNode) {\n        messageNode = domify('<div></div>');\n        domClasses(messageNode).add('cpp-validation-message');\n\n        // insert messageNode after controlNode\n        controlNode.parentNode.insertBefore(messageNode, controlNode.nextSibling);\n      }\n\n\n      if (typeof message === 'string' || message.error) {\n        message = message.error || message;\n\n        domClasses(controlNode).add('invalid');\n        domClasses(messageNode).add('cpp-error-message');\n      }\n      else {\n        message = message.warning;\n\n        domClasses(controlNode).add('warning');\n        domClasses(messageNode).add('cpp-warning-message');\n      }\n\n      messageNode.textContent = message;\n\n    }\n\n  });\n\n};\n\n\n/**\n * Check if the entry contains valid input\n */\nPropertiesPanel.prototype.validate = function(entry, values, entryNode) {\n  var self = this;\n\n  var current = this._current;\n\n  entryNode = entryNode || domQuery('[data-entry=\"' + entry.id + '\"]', current.panel);\n\n  if (values instanceof Array) {\n    var listContainer = domQuery('[data-list-entry-container]', entryNode),\n        listEntryNodes = listContainer.children || [];\n\n    // create new elements\n    for (var i = 0; i < values.length; i++) {\n      var listValue = values[i];\n\n      if (entry.validateListItem) {\n\n        var validationResults = entry.validateListItem(current.element, listValue, entryNode, i),\n            listEntryNode = listEntryNodes[i];\n\n        self.applyValidationResults(validationResults, listEntryNode);\n      }\n    }\n  }\n  else {\n    if (entry.validate) {\n      this.validationResults = entry.validate(current.element, values, entryNode);\n\n      self.applyValidationResults(this.validationResults, entryNode);\n    }\n  }\n\n};\n\nPropertiesPanel.prototype.getEntry = function(id) {\n  return this._current && this._current.entries[id];\n};\n\nvar flattenDeep = require('lodash/flattenDeep'),\n    keyBy = require('lodash/keyBy'),\n    map = require('lodash/map');\n\nPropertiesPanel.prototype._create = function(element, tabs) {\n\n  if (!element) {\n    return null;\n  }\n\n  var containerNode = this._container;\n\n  var panelNode = this._createPanel(element, tabs);\n\n  containerNode.appendChild(panelNode);\n\n  var entries = extractEntries(tabs);\n  var groups = extractGroups(tabs);\n\n  return {\n    tabs: tabs,\n    groups: groups,\n    entries: entries,\n    element: element,\n    panel: panelNode\n  };\n};\n\nPropertiesPanel.prototype._bindTemplate = function(element, entry, values, entryNode, idx) {\n\n  var eventBus = this._eventBus;\n\n  function isPropertyEditable(entry, propertyName) {\n    return eventBus.fire('propertiesPanel.isPropertyEditable', {\n      entry: entry,\n      propertyName: propertyName,\n      element: element\n    });\n  }\n\n  var inputNodes = getPropertyPlaceholders(entryNode);\n\n  forEach(inputNodes, function(node) {\n\n    var name,\n        newValue,\n        editable;\n\n    // we deal with an input element\n    if ('value' in node || isContentEditable(node) === 'true') {\n      name = domAttr(node, 'name') || domAttr(node, 'data-name');\n      newValue = values[name];\n\n      editable = isPropertyEditable(entry, name);\n      if (editable && entry.editable) {\n        editable = entry.editable(element, entryNode, node, name, newValue, idx);\n      }\n\n      domAttr(node, 'readonly', editable ? null : '');\n      domAttr(node, 'disabled', editable ? null : '');\n\n      if (entry.setControlValue) {\n        entry.setControlValue(element, entryNode, node, name, newValue, idx);\n      } else if (isToggle(node)) {\n        setToggleValue(node, newValue);\n      } else if (isSelect(node)) {\n        setSelectValue(node, newValue);\n      } else {\n        setInputValue(node, newValue);\n      }\n    }\n\n    // we deal with some non-editable html element\n    else {\n      name = domAttr(node, 'data-value');\n      newValue = values[name];\n      if (entry.setControlValue) {\n        entry.setControlValue(element, entryNode, node, name, newValue, idx);\n      }\n      else {\n        setTextValue(node, newValue);\n      }\n    }\n  });\n};\n\n// TODO(nikku): WTF freaking name? Change / clarify.\nPropertiesPanel.prototype._updateActivation = function(current) {\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var element = current.element;\n\n  function isEntryVisible(entry) {\n    return eventBus.fire('propertiesPanel.isEntryVisible', {\n      entry: entry,\n      element: element\n    });\n  }\n\n  function isGroupVisible(group, element, groupNode) {\n    if (typeof group.enabled === 'function') {\n      return group.enabled(element, groupNode);\n    } else {\n      return true;\n    }\n  }\n\n  function isTabVisible(tab, element) {\n    if (typeof tab.enabled === 'function') {\n      return tab.enabled(element);\n    } else {\n      return true;\n    }\n  }\n\n  function toggleVisible(node, visible) {\n    domClasses(node).toggle(HIDE_CLASS, !visible);\n  }\n\n  // check whether the active tab is visible\n  // if not: set the first tab as active tab\n  function checkActiveTabVisibility(node, visible) {\n    var isActive = domClasses(node).has('cpp-active');\n    if (!visible && isActive) {\n      self.activateTab(current.tabs[0]);\n    }\n  }\n\n  function updateLabel(element, selector, text) {\n    var labelNode = domQuery(selector, element);\n\n    if (!labelNode) {\n      return;\n    }\n\n    labelNode.textContent = text;\n  }\n\n  var panelNode = current.panel;\n\n  forEach(current.tabs, function(tab) {\n\n    var tabNode = domQuery('[data-tab=' + tab.id + ']', panelNode);\n    var tabLinkNode = domQuery('[data-tab-target=' + tab.id + ']', panelNode).parentNode;\n\n    var tabVisible = false;\n\n    forEach(tab.groups, function(group) {\n\n      var groupVisible = false;\n\n      var groupNode = domQuery('[data-group=' + group.id + ']', tabNode);\n\n      forEach(group.entries, function(entry) {\n\n        var entryNode = domQuery('[data-entry=\"' + entry.id + '\"]', groupNode);\n\n        var entryVisible = isEntryVisible(entry);\n\n        groupVisible = groupVisible || entryVisible;\n\n        toggleVisible(entryNode, entryVisible);\n\n        var values = 'get' in entry ? entry.get(element, entryNode) : {};\n\n        if (values instanceof Array) {\n          var listEntryContainer = domQuery('[data-list-entry-container]', entryNode);\n          var existingElements = listEntryContainer.children || [];\n\n          for (var i = 0; i < values.length; i++) {\n            var listValue = values[i];\n            var listItemNode = existingElements[i];\n            if (!listItemNode) {\n              listItemNode = domify(entry.createListEntryTemplate(listValue, i, listEntryContainer));\n              listEntryContainer.appendChild(listItemNode);\n            }\n            domAttr(listItemNode, 'data-index', i);\n\n            self._bindTemplate(element, entry, listValue, listItemNode, i);\n          }\n\n          var entriesToRemove = existingElements.length - values.length;\n\n          for (var j = 0; j < entriesToRemove; j++) {\n            // remove orphaned element\n            listEntryContainer.removeChild(listEntryContainer.lastChild);\n          }\n\n        } else {\n          self._bindTemplate(element, entry, values, entryNode);\n        }\n\n        // update conditionally visible elements\n        self.updateState(entry, entryNode);\n        self.validate(entry, values, entryNode);\n\n        // remember initial state for later dirty checking\n        entry.oldValues = getFormControlValues(entryNode);\n      });\n\n      if (typeof group.label === 'function') {\n        updateLabel(groupNode, '.group-label', group.label(element, groupNode));\n      }\n\n      groupVisible = groupVisible && isGroupVisible(group, element, groupNode);\n\n      tabVisible = tabVisible || groupVisible;\n\n      toggleVisible(groupNode, groupVisible);\n    });\n\n    tabVisible = tabVisible && isTabVisible(tab, element);\n\n    toggleVisible(tabNode, tabVisible);\n    toggleVisible(tabLinkNode, tabVisible);\n\n    checkActiveTabVisibility(tabNode, tabVisible);\n  });\n\n  // inject elements id into header\n  var propertiesProvider = self._propertiesProvider,\n      labelId = element.id;\n\n  if (propertiesProvider.getHeaderLabel) {\n    labelId = propertiesProvider.getHeaderLabel(element);\n  }\n\n  updateLabel(panelNode, '[data-label-id]', labelId || '');\n};\n\nPropertiesPanel.prototype._createPanel = function(element, tabs) {\n  var self = this;\n\n  var panelNode = domify('<div class=\"cpp-properties\"></div>'),\n      headerNode = domify('<div class=\"cpp-properties-header\">' +\n        '<div class=\"label\" data-label-id></div>' +\n        '<div class=\"search\">' +\n          '<input type=\"search\" placeholder=\"Search for property\" />' +\n          '<button><span>Search</span></button>' +\n        '</div>' +\n      '</div>'),\n      tabBarNode = domify('<div class=\"cpp-properties-tab-bar\"></div>'),\n      tabLinksNode = domify('<ul class=\"cpp-properties-tabs-links\"></ul>'),\n      tabContainerNode = domify('<div class=\"cpp-properties-tabs-container\"></div>');\n\n  panelNode.appendChild(headerNode);\n\n  forEach(tabs, function(tab, tabIndex) {\n\n    if (!tab.id) {\n      throw new Error('tab must have an id');\n    }\n\n    var tabNode = domify('<div class=\"cpp-properties-tab\" data-tab=\"' + escapeHTML(tab.id) + '\"></div>'),\n        tabLinkNode = domify('<li class=\"cpp-properties-tab-link\">' +\n          '<a href data-tab-target=\"' + escapeHTML(tab.id) + '\">' + escapeHTML(tab.label) + '</a>' +\n        '</li>');\n\n    var groups = tab.groups;\n\n    forEach(groups, function(group) {\n\n      if (!group.id) {\n        throw new Error('group must have an id');\n      }\n\n      var groupNode = domify('<div class=\"cpp-properties-group\" data-group=\"' + escapeHTML(group.id) + '\">' +\n          '<span class=\"group-toggle\"></span>' +\n          '<span class=\"group-label\">' + escapeHTML(group.label) + '</span>' +\n        '</div>');\n\n      // TODO(nre): use event delegation to handle that...\n      groupNode.querySelector('.group-toggle').addEventListener('click', function(evt) {\n        domClasses(groupNode).toggle('group-closed');\n        evt.preventDefault();\n        evt.stopPropagation();\n      });\n      groupNode.addEventListener('click', function(evt) {\n        if (!evt.defaultPrevented && domClasses(groupNode).has('group-closed')) {\n          domClasses(groupNode).remove('group-closed');\n        }\n      });\n\n      forEach(group.entries, function(entry) {\n\n        if (!entry.id) {\n          throw new Error('entry must have an id');\n        }\n\n        var html = entry.html;\n\n        if (typeof html === 'string') {\n          html = domify(html);\n        }\n\n        // unwrap jquery\n        if (html.get) {\n          html = html.get(0);\n        }\n\n        var entryNode = domify('<div class=\"cpp-properties-entry\" data-entry=\"' + escapeHTML(entry.id) + '\"></div>');\n\n        forEach(entry.cssClasses || [], function(cssClass) {\n          domClasses(entryNode).add(cssClass);\n        });\n\n        entryNode.appendChild(html);\n\n        groupNode.appendChild(entryNode);\n\n        // update conditionally visible elements\n        self.updateState(entry, entryNode);\n      });\n\n      tabNode.appendChild(groupNode);\n    });\n\n    tabLinksNode.appendChild(tabLinkNode);\n    tabContainerNode.appendChild(tabNode);\n  });\n\n  tabBarNode.appendChild(tabLinksNode);\n\n  panelNode.appendChild(tabBarNode);\n  panelNode.appendChild(tabContainerNode);\n\n  return panelNode;\n};\n\n\n\nfunction setInputValue(node, value) {\n\n  var contentEditable = isContentEditable(node);\n\n  var oldValue = contentEditable ? node.innerText : node.value;\n\n  var selection;\n\n  // prevents input fields from having the value 'undefined'\n  if (value === undefined) {\n    value = '';\n  }\n\n  if (oldValue === value) {\n    return;\n  }\n\n  // update selection on undo/redo\n  if (document.activeElement === node) {\n    selection = updateSelection(getSelection(node), node.value, value);\n  }\n\n  if (contentEditable) {\n    node.innerText = value;\n  } else {\n    node.value = value;\n  }\n\n  if (selection) {\n    setSelection(node, selection);\n  }\n}\n\nfunction setSelectValue(node, value) {\n  if (value !== undefined) {\n    node.value = value;\n  }\n}\n\nfunction setToggleValue(node, value) {\n  var nodeValue = node.value;\n\n  node.checked = (value === nodeValue) || (!domAttr(node, 'value') && value);\n}\n\nfunction setTextValue(node, value) {\n  node.textContent = value;\n}\n\n\nfunction getSelection(node) {\n\n  return isContentEditable(node) ? getContentEditableSelection(node) : {\n    start: node.selectionStart,\n    end: node.selectionEnd\n  };\n}\n\nfunction getContentEditableSelection(node) {\n\n  var selection = window.getSelection();\n\n  var focusNode = selection.focusNode,\n      focusOffset = selection.focusOffset,\n      anchorOffset = selection.anchorOffset;\n\n  if (!focusNode) {\n    throw new Error('not selected');\n  }\n\n  // verify we have selection on the current element\n  if (!node.contains(focusNode)) {\n    throw new Error('not selected');\n  }\n\n  return {\n    start: Math.min(focusOffset, anchorOffset),\n    end: Math.max(focusOffset, anchorOffset)\n  };\n}\n\nfunction setSelection(node, selection) {\n  if (isContentEditable(node)) {\n    setContentEditableSelection(node, selection);\n  } else {\n    node.selectionStart = selection.start;\n    node.selectionEnd = selection.end;\n  }\n}\n\nfunction setContentEditableSelection(node, selection) {\n\n  var focusNode,\n      domRange,\n      domSelection;\n\n  focusNode = node.firstChild || node,\n  domRange = document.createRange();\n  domRange.setStart(focusNode, selection.start);\n  domRange.setEnd(focusNode, selection.end);\n\n  domSelection = window.getSelection();\n  domSelection.removeAllRanges();\n  domSelection.addRange(domRange);\n}\n","'use strict';\n\nvar hat = require('hat');\n\n\n/**\n * Create a new id generator / cache instance.\n *\n * You may optionally provide a seed that is used internally.\n *\n * @param {Seed} seed\n */\nfunction Ids(seed) {\n\n  if (!(this instanceof Ids)) {\n    return new Ids(seed);\n  }\n\n  seed = seed || [ 128, 36, 1 ];\n  this._seed = seed.length ? hat.rack(seed[0], seed[1], seed[2]) : seed;\n}\n\nmodule.exports = Ids;\n\n/**\n * Generate a next id.\n *\n * @param {Object} [element] element to bind the id to\n *\n * @return {String} id\n */\nIds.prototype.next = function(element) {\n  return this._seed(element || true);\n};\n\n/**\n * Generate a next id with a given prefix.\n *\n * @param {Object} [element] element to bind the id to\n *\n * @return {String} id\n */\nIds.prototype.nextPrefixed = function(prefix, element) {\n  var id;\n\n  do {\n    id = prefix + this.next(true);\n  } while (this.assigned(id));\n\n  // claim {prefix}{random}\n  this.claim(id, element);\n\n  // return\n  return id;\n};\n\n/**\n * Manually claim an existing id.\n *\n * @param {String} id\n * @param {String} [element] element the id is claimed by\n */\nIds.prototype.claim = function(id, element) {\n  this._seed.set(id, element || true);\n};\n\n/**\n * Returns true if the given id has already been assigned.\n *\n * @param  {String} id\n * @return {Boolean}\n */\nIds.prototype.assigned = function(id) {\n  return this._seed.get(id) || false;\n};\n\n/**\n * Unclaim an id.\n *\n * @param  {String} id the id to unclaim\n */\nIds.prototype.unclaim = function(id) {\n  delete this._seed.hats[id];\n};\n\n\n/**\n * Clear all claimed ids.\n */\nIds.prototype.clear = function() {\n\n  var hats = this._seed.hats,\n      id;\n\n  for (id in hats) {\n    this.unclaim(id);\n  }\n};","module.exports = {\n  __init__: [ 'propertiesProvider' ],\n  propertiesProvider: [ 'type', require('./CamundaPropertiesProvider') ]\n};","'use strict';\n\nvar inherits = require('inherits');\n\nvar is = require('cmmn-js/lib/util/ModelUtil').is;\n\nvar CmmnElementHelper = require('../../helper/CmmnElementHelper'),\n    isCMMNEdge = CmmnElementHelper.isCMMNEdge,\n    getCMMNElementRef = CmmnElementHelper.getCMMNElementRef;\n\nvar PropertiesActivator = require('../../PropertiesActivator');\n\n// cmmn properties\n\n// item properties\nvar caseProps = require('../cmmn/parts/CaseProps'),\n    idProps = require('../cmmn/parts/IdProps'),\n    nameProps = require('../cmmn/parts/NameProps'),\n    documentationProps = require('../cmmn/parts/DocumentationProps');\n\n// detail properties\nvar ifPartProps = require('../cmmn/parts/IfPartProps'),\n    humanTaskProps = require('./parts/HumanTaskProps'),\n    onPartProps = require('../cmmn/parts/OnPartProps'),\n    variableMapping = require('./parts/VariableMappingProps');\n\n// plan item control properties\nvar planItemControlProps = require('../cmmn/parts/PlanItemControlProps'),\n    repeatOnStandardEventProps = require('./parts/RepeatOnStandardEventProps');\n\n// definition props\nvar definitionIdProps = require('../cmmn/parts/DefinitionIdProps'),\n    definitionNameProps = require('../cmmn/parts/DefinitionNameProps'),\n    definitionDocumentationProps = require('../cmmn/parts/DefinitionDocumentationProps'),\n    callableProps = require('../cmmn/parts/CallableProps'),\n    callableExtensionProps = require('./parts/CallableExtensionProps');\n\n// listener\nvar caseExecutionListenerProps = require('./parts/CaseExecutionListenerProps'),\n    variableListenerProps = require('./parts/VariableListenerProps'),\n    taskListenerProps = require('./parts/TaskListenerProps'),\n    listenerDetailProps = require('./parts/ListenerDetailProps'),\n    listenerFields = require('./parts/ListenerFieldInjectionProps');\n\n// history time to live\nvar historyTimeToLive = require('./parts/HistoryTimeToLiveProps');\n\n\nvar getListenerLabel = function(listener) {\n\n  if (is(listener, 'camunda:CaseExecutionListener')) {\n    return 'Case Execution Listener';\n  }\n\n  if (is(listener, 'camunda:TaskListener')) {\n    return 'Task Listener';\n  }\n\n  if (is(listener, 'camunda:VariableListener')) {\n    return 'Variable Listener';\n  }\n\n  return '';\n};\n\n\nfunction createGeneralTabGroups(element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules) {\n\n  var generalGroup = {\n    id: 'general',\n    label: 'General',\n    entries: []\n  };\n\n  caseProps(generalGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules);\n  idProps(generalGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules);\n  nameProps(generalGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules);\n\n\n  var detailsGroup = {\n    id: 'details',\n    label: 'Details',\n    entries: []\n  };\n\n  onPartProps(detailsGroup, element, cmmnFactory, elementRegistry, itemRegistry);\n  ifPartProps(detailsGroup, element, cmmnFactory, elementRegistry, itemRegistry);\n  humanTaskProps(detailsGroup, element, cmmnFactory, elementRegistry, itemRegistry);\n  callableProps(detailsGroup, element, cmmnFactory, elementRegistry, itemRegistry);\n  callableExtensionProps(detailsGroup, element, cmmnFactory, elementRegistry, itemRegistry);\n\n\n  var documentationGroup = {\n    id: 'documentation',\n    label: 'Documentation',\n    entries: []\n  };\n\n  documentationProps(documentationGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules);\n\n\n  var historyTimeToLiveGroup = {\n    id: 'historyConfiguration',\n    label: 'History Configuration',\n    entries: []\n  };\n\n  historyTimeToLive(historyTimeToLiveGroup, element, cmmnFactory, elementRegistry, itemRegistry);\n\n  return [\n    generalGroup,\n    detailsGroup,\n    documentationGroup,\n    historyTimeToLiveGroup\n  ];\n}\n\n\nfunction createRulesTabGroups(element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules) {\n\n  var itemControlGroup = {\n    id: 'itemControl',\n    label: 'Item Control',\n    entries: []\n  };\n\n  planItemControlProps(itemControlGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules);\n  repeatOnStandardEventProps(itemControlGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules);\n\n\n  var defaultControlGroup = {\n    id: 'defaultControl',\n    label: 'Default Control',\n    entries: []\n  };\n\n  planItemControlProps(defaultControlGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules, {\n    isDefaultControl: true\n  });\n  repeatOnStandardEventProps(defaultControlGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules, {\n    isDefaultControl: true\n  });\n\n  return [\n    itemControlGroup,\n    defaultControlGroup\n  ];\n}\n\n\nfunction createVariablesTabGroups(element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules) {\n\n  var variablesGroup = {\n    id : 'variables',\n    label : 'Variables',\n    entries: []\n  };\n\n  variableMapping(variablesGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules);\n\n  return [\n    variablesGroup\n  ];\n}\n\n\nfunction createListenerTabGroups(element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules) {\n\n  var caseExecutionListenerGroup = {\n    id: 'caseExecutionListeners',\n    label: 'Case Execution Listeners',\n    entries: []\n  };\n\n  var caseExecutionListenerProvider = caseExecutionListenerProps(\n    caseExecutionListenerGroup,\n    element,\n    cmmnFactory,\n    elementRegistry,\n    itemRegistry,\n    cmmnRules\n  );\n\n\n  var taskListenerGroup = {\n    id: 'taskListeners',\n    label: 'Task Listeners',\n    entries: []\n  };\n\n  var taskListenerProvider = taskListenerProps(\n    taskListenerGroup,\n    element,\n    cmmnFactory,\n    elementRegistry,\n    itemRegistry,\n    cmmnRules\n  );\n\n\n  var variableListenerGroup = {\n    id: 'variableListeners',\n    label: 'Variable Listeners',\n    entries: []\n  };\n\n  var variableListenerProvider = variableListenerProps(\n    variableListenerGroup,\n    element,\n    cmmnFactory,\n    elementRegistry,\n    itemRegistry,\n    cmmnRules\n  );\n\n\n  caseExecutionListenerProvider.register([ taskListenerGroup, variableListenerGroup ]);\n  taskListenerProvider.register([ caseExecutionListenerGroup, variableListenerGroup ]);\n  variableListenerProvider.register([ caseExecutionListenerGroup, taskListenerGroup ]);\n\n\n  function getSelectedListener(element, node) {\n\n    return caseExecutionListenerProvider.getSelectedListener(element, node) ||\n           taskListenerProvider.getSelectedListener(element, node) ||\n           variableListenerProvider.getSelectedListener(element, node);\n  }\n\n\n  var listenerDetailsGroup = {\n    id: 'listenerDetails',\n    entries: [],\n    enabled: function(element, node) {\n      return getSelectedListener(element, node);\n    },\n    label: function(element, node) {\n      var param = getSelectedListener(element, node);\n      return getListenerLabel(param);\n    }\n  };\n\n  listenerDetailProps(\n    listenerDetailsGroup,\n    element,\n    cmmnFactory,\n    elementRegistry,\n    itemRegistry,\n    cmmnRules,\n    { getListener : getSelectedListener }\n  );\n\n\n  var listenerFieldsGroup = {\n    id: 'listener-fields',\n    label: 'Field Injection',\n    entries: [],\n    enabled: function(element, node) {\n      return getSelectedListener(element, node);\n    }\n  };\n\n  listenerFields(\n    listenerFieldsGroup,\n    element,\n    cmmnFactory,\n    elementRegistry,\n    itemRegistry,\n    cmmnRules,\n    { getListener : getSelectedListener }\n  );\n\n\n  return [\n    caseExecutionListenerGroup,\n    taskListenerGroup,\n    variableListenerGroup,\n    listenerDetailsGroup,\n    listenerFieldsGroup\n  ];\n}\n\n\nfunction createDefinitionTabGroups(element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules) {\n\n  var detailsGroup = {\n    id: 'definitionDetails',\n    label: 'Details',\n    entries: []\n  };\n\n  definitionIdProps(detailsGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules);\n  definitionNameProps(detailsGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules);\n\n\n  var documentationGroup = {\n    id: 'definitionDocumentation',\n    label: 'Documentation',\n    entries: []\n  };\n\n  definitionDocumentationProps(documentationGroup, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules);\n\n  return [\n    detailsGroup,\n    documentationGroup\n  ];\n}\n\n\n// Camunda Properties Provider /////////////////////////////////////\n\n\n/**\n * A properties provider for Camunda related properties.\n *\n * @param {EventBus} eventBus\n * @param {CmmnFactory} cmmnFactory\n * @param {ElementRegistry} elementRegistry\n */\nfunction CamundaPropertiesProvider(eventBus, cmmnFactory, elementRegistry, itemRegistry, cmmnRules) {\n\n  PropertiesActivator.call(this, eventBus);\n\n  this.getTabs = function(element) {\n\n    var generalTab = {\n      id: 'general',\n      label: 'General',\n      groups: createGeneralTabGroups(element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules)\n    };\n\n    var rulesTab = {\n      id: 'rules',\n      label: 'Rules',\n      groups: createRulesTabGroups(element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules)\n    };\n\n    var variablesTab = {\n      id: 'variables',\n      label: 'Variables',\n      groups: createVariablesTabGroups(element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules)\n    };\n\n    var listenerTab = {\n      id: 'listener',\n      label: 'Listener',\n      groups: createListenerTabGroups(element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules)\n    };\n\n    var definitionTab = {\n      id: 'definition',\n      label: 'Definition',\n      groups: createDefinitionTabGroups(element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules)\n    };\n\n    return [\n      generalTab,\n      rulesTab,\n      variablesTab,\n      listenerTab,\n      definitionTab\n    ];\n\n  };\n\n  this.getHeaderLabel = function(element) {\n\n    if (isCMMNEdge(element)) {\n      element = getCMMNElementRef(element) || element;\n    }\n\n    return element.id;\n\n  };\n}\n\nCamundaPropertiesProvider.$inject = [\n  'eventBus',\n  'cmmnFactory',\n  'elementRegistry',\n  'itemRegistry',\n  'cmmnRules'\n];\n\ninherits(CamundaPropertiesProvider, PropertiesActivator);\n\nmodule.exports = CamundaPropertiesProvider;\n","'use strict';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A component that decides upon the visibility / editable\n * state of properties in the properties panel.\n *\n * Implementors must subclass this component and override\n * {@link PropertiesActivator#isEntryVisible} and\n * {@link PropertiesActivator#isPropertyEditable} to provide\n * custom behavior.\n *\n * @class\n * @constructor\n *\n * @param {EventBus} eventBus\n * @param {Number} [priority] at which priority to hook into the activation\n */\nfunction PropertiesActivator(eventBus, priority) {\n  var self = this;\n\n  priority = priority || DEFAULT_PRIORITY;\n\n  eventBus.on('propertiesPanel.isEntryVisible', priority, function(e) {\n    return self.isEntryVisible(e.entry, e.element);\n  });\n\n  eventBus.on('propertiesPanel.isPropertyEditable', priority, function(e) {\n    return self.isPropertyEditable(e.entry, e.propertyName, e.element);\n  });\n}\n\nPropertiesActivator.$inject = [ 'eventBus' ];\n\nmodule.exports = PropertiesActivator;\n\n\n/**\n * Should the given entry be visible for the specified element.\n *\n * @method  PropertiesActivator#isEntryVisible\n *\n * @param {EntryDescriptor} entry\n * @param {ModdleElement} element\n *\n * @returns {Boolean}\n */\nPropertiesActivator.prototype.isEntryVisible = function(entry, element) {\n  return true;\n};\n\n/**\n * Should the given property be editable for the specified element\n *\n * @method  PropertiesActivator#isPropertyEditable\n *\n * @param {EntryDescriptor} entry\n * @param {String} propertyName\n * @param {ModdleElement} element\n *\n * @returns {Boolean}\n */\nPropertiesActivator.prototype.isPropertyEditable = function(entry, propertyName, element) {\n  return true;\n};","'use strict';\n\nvar IdProp = require('./implementation/IdProp'),\n    NameProp = require('./implementation/NameProp');\n\nvar cmdHelper = require('../../../helper/CmdHelper');\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getBusinessObject = ModelUtil.getBusinessObject,\n    isCasePlanModel = ModelUtil.isCasePlanModel;\n\n\nmodule.exports = function(group, element) {\n\n  if (!isCasePlanModel(element)) {\n    return;\n  }\n\n  var getValue = function(modelProperty) {\n    return function(element, node) {\n      var bo = getBusinessObject(element).$parent;\n      var value = {};\n\n      value[modelProperty] = bo.get(modelProperty);\n\n      return value;\n    };\n  };\n\n  var setValue = function(modelProperty) {\n    return function(element, values, node) {\n      var bo = getBusinessObject(element).$parent;\n      var props = {};\n\n      props[modelProperty] = values[modelProperty] || undefined;\n\n      return cmdHelper.updateBusinessObject(element, bo, props);\n    };\n  };\n\n  // Case Id\n  group.entries = group.entries.concat(IdProp(element, {\n    id: 'caseId',\n    label: 'Case Id',\n    reference: '$parent',\n\n    get: getValue('id'),\n\n    set: setValue('id')\n\n  }));\n\n\n  // name\n  group.entries = group.entries.concat(NameProp(element, {\n\n    id: 'caseName',\n    label: 'Case Name',\n\n    get: getValue('name'),\n\n    set: setValue('name')\n\n  }));\n\n};\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar getBusinessObject = require('cmmn-js/lib/util/ModelUtil').getBusinessObject,\n    cmdHelper = require('../helper/CmdHelper');\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar checkbox = function(options, defaultParameters) {\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      description = options.description;\n\n\n  resource.html =\n    '<input id=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n         'type=\"checkbox\" ' +\n         'name=\"' + escapeHTML(options.modelProperty) + '\" ' +\n         (canBeDisabled ? 'data-show=\"isDisabled\"' : '') +\n         ' />' +\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n         (canBeDisabled ? 'data-show=\"isDisabled\"' : '') +\n         '>' + escapeHTML(label) + '</label>';\n\n  // add description below checkbox entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource.get = function(element) {\n    var bo = getBusinessObject(element),\n        res = {};\n\n    res[options.modelProperty] = bo.get(options.modelProperty);\n\n    return res;\n  };\n  resource.set = function(element, values) {\n    var res = {};\n\n    res[options.modelProperty] = !!values[options.modelProperty];\n\n    return cmdHelper.updateProperties(element, res);\n  };\n\n  if (typeof options.set === 'function') {\n    resource.set = options.set;\n  }\n\n  if (typeof options.get === 'function') {\n    resource.get = options.get;\n  }\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return !options.disabled.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['cpp-checkbox'];\n\n  return resource;\n};\n\nmodule.exports = checkbox;\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar forEach = require('lodash/forEach');\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar isList = function(list) {\n  return !(!list || Object.prototype.toString.call(list) !== '[object Array]');\n};\n\nvar addEmptyParameter = function(list) {\n  list.unshift({ name: '', value: '' });\n};\n\n/**\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} [options.label]\n * @param  {Array<Object>} options.selectOptions\n * @param  {string} options.modelProperty\n * @param  {boolean} options.emptyParameter\n * @param  {function} options.disabled\n * @param  {Object} defaultParameters\n *\n * @return {Object}\n */\nvar selectbox = function(options, defaultParameters) {\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      selectOptions = options.selectOptions,\n      modelProperty = options.modelProperty,\n      emptyParameter = options.emptyParameter,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      description = options.description;\n\n  if (isList(selectOptions)) {\n    if (emptyParameter) {\n      addEmptyParameter(selectOptions);\n    }\n  } else {\n    selectOptions = [ { name: '', value: '' } ];\n  }\n\n  resource.html =\n    '<label for=\"camunda-' + resource.id + '\"' +\n    (canBeDisabled ? 'data-show=\"isDisabled\" ' : '') + '>' + escapeHTML(label) + '</label>' +\n    '<select id=\"camunda-' + escapeHTML(resource.id) + '-select\" name=\"' + escapeHTML(modelProperty) + '\"' +\n    (canBeDisabled ? 'data-show=\"isDisabled\" ' : '') + ' data-value>';\n\n  forEach(selectOptions, function(option) {\n    resource.html += '<option value=\"' + escapeHTML(option.value) + '\">' + (option.name ? escapeHTML(option.name) : '') + '</option>';\n  });\n\n  resource.html += '</select>';\n\n  // add description below select box entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return !options.disabled.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['dropdown'];\n\n  return resource;\n};\n\nmodule.exports = selectbox;\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar textBox = function(options, defaultParameters) {\n\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      canBeShown = !!options.show && typeof options.show === 'function',\n      description = options.description;\n\n  resource.html =\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n    (canBeShown ? 'data-show=\"isShown\"' : '') +\n    '>' + escapeHTML(label) + '</label>' +\n    '<div class=\"cpp-field-wrapper\" ' +\n    (canBeShown ? 'data-show=\"isShown\"' : '') +\n    '>' +\n      '<div contenteditable=\"true\" id=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n            'name=\"' + escapeHTML(options.modelProperty) + '\" />' +\n    '</div>';\n\n  // add description below text box entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  if (canBeShown) {\n    resource.isShown = function() {\n      return options.show.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['cpp-textbox'];\n\n  return resource;\n};\n\nmodule.exports = textBox;\n","'use strict';\n\nvar textField = require('./TextInputEntryFactory');\n\n/**\n * This function is a wrapper around TextInputEntryFactory.\n * It adds functionality to cache an invalid value entered in the\n * text input, instead of setting it on the business object.\n */\nvar validationAwareTextField = function(options, defaultParameters) {\n\n  var modelProperty = options.modelProperty,\n      defaultGet = defaultParameters.get,\n      defaultSet = defaultParameters.set;\n\n\n  defaultParameters.get = function(element, node) {\n    var value = this.__lastInvalidValue;\n\n    delete this.__lastInvalidValue;\n\n    var properties = {};\n\n    if (value !== undefined) {\n      properties[modelProperty] = value;\n    }\n    else {\n      properties = defaultGet(element, node);\n    }\n\n    return properties;\n  };\n\n  defaultParameters.set = function(element, values, node) {\n    var validationErrors = validate.apply(this, [ element, values, node ]),\n        propertyValue = values[modelProperty],\n        properties = {};\n\n    // make sure we do not update the id\n    if (validationErrors && validationErrors[modelProperty]) {\n\n      this.__lastInvalidValue = propertyValue;\n      properties = defaultGet(element, node);\n\n    } else {\n\n      properties[modelProperty] = propertyValue;\n\n    }\n\n    return defaultSet(element, properties, node);\n  };\n\n  var validate = defaultParameters.validate = function(element, values, node) {\n    var value = values[modelProperty] || this.__lastInvalidValue;\n\n    var property = {};\n    property[modelProperty] = value;\n\n    return options.validate(element, property, node);\n  };\n\n  return textField(options, defaultParameters);\n};\n\nmodule.exports = validationAwareTextField;\n","'use strict';\n\n/**\n * The label factory provides a label entry. For the label text\n * it expects either a string provided by the options.labelText\n * parameter or it could be generated programmatically using a\n * function passed as the options.get parameter.\n *\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} [options.labelText]\n * @param  {Function} [options.get]\n * @param  {Function} [options.showLabel]\n * @param  {Boolean} [options.divider] adds a divider at the top of the label if true; default: false\n */\nvar label = function(options) {\n  return {\n    id: options.id,\n    html: '<label data-value=\"label\" ' +\n            'data-show=\"showLabel\" ' +\n            'class=\"entry-label' + (options.divider ? ' divider' : '') + '\">' +\n          '</label>',\n    get: function(element, node) {\n      if (typeof options.get === 'function') {\n        return options.get(element, node);\n      }\n      return { label: options.labelText };\n    },\n    showLabel: function(element, node) {\n      if (typeof options.showLabel === 'function') {\n        return options.showLabel(element, node);\n      }\n      return true;\n    }\n  };\n};\n\nmodule.exports = label;\n","'use strict';\n\nvar IdProp = require('./implementation/IdProp');\n\nvar isCMMNEdge = require('../../../helper/CmmnElementHelper').isCMMNEdge;\n\nmodule.exports = function(group, element) {\n\n  // Id\n  group.entries = group.entries.concat(IdProp(element, {\n    reference: isCMMNEdge(element) ? 'cmmnElementRef' : undefined\n  }));\n\n};\n","'use strict';\n\nvar cmdHelper = require('../../../helper/CmdHelper');\n\nvar NameProp = require('./implementation/NameProp');\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getName = ModelUtil.getName;\n\nvar isLabel = require('cmmn-js/lib/features/modeling/util/ModelingUtil').isLabel;\n\nvar CmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isOnPartConnection = CmmnElementHelper.isOnPartConnection,\n    isCMMNEdge = CmmnElementHelper.isCMMNEdge,\n    isDiscretionaryConnection = CmmnElementHelper.isDiscretionaryConnection,\n    isAssociationConnection = CmmnElementHelper.isAssociationConnection,\n    isCriterion = CmmnElementHelper.isCriterion,\n    isTextAnnotation = CmmnElementHelper.isTextAnnotation,\n    isItemCapable = CmmnElementHelper.isItemCapable,\n    getOutgoingOnParts = CmmnElementHelper.getOutgoingOnParts;\n\n\nmodule.exports = function(group, element) {\n\n  if (isCriterion(element)) {\n    return;\n  }\n\n  if (isCMMNEdge(element) &&\n      (isDiscretionaryConnection(element) ||\n       isAssociationConnection(element))) {\n    return;\n  }\n\n\n  var setter;\n  if (isOnPartConnection(element)) {\n    setter = function(element, values, node, bo) {\n\n      var connection = !isLabel(element) ? element : element.labelTarget,\n          source = connection.source,\n          changed = getOutgoingOnParts(source, bo) || [],\n          name = values.name || undefined;\n\n      if (changed.indexOf(element) === -1) {\n        changed.push(element);\n      }\n\n      return cmdHelper.updateProperties(bo, { name: name }, changed);\n\n    };\n  }\n\n\n  // name\n  group.entries = group.entries.concat(NameProp(element, {\n\n    modelProperty: isTextAnnotation(element) ? 'text' : undefined,\n    reference: isCMMNEdge(element) ? 'cmmnElementRef' : undefined,\n\n    get: function(element, node, bo) {\n\n      if (isTextAnnotation(bo)) {\n        return {\n          text: bo.text\n        };\n      }\n\n      return {\n        name: getName(bo)\n      };\n    },\n\n    set: setter,\n\n    validate: function(element, values, node, bo) {\n\n      var result = {};\n\n      if (isItemCapable(bo) && getName(bo) && !bo.name) {\n        result = { name: { warning: 'Definition name is used' } };\n      }\n\n      return result;\n\n    }\n\n  }));\n\n};\n","'use strict';\n\nvar DocumentationProp = require('./implementation/DocumentationProp');\n\nvar CmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isCMMNEdge = CmmnElementHelper.isCMMNEdge,\n    isDiscretionaryConnection = CmmnElementHelper.isDiscretionaryConnection;\n\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry) {\n\n  if (isCMMNEdge(element) && isDiscretionaryConnection(element)) {\n    return;\n  }\n\n  // name\n  group.entries = group.entries.concat(DocumentationProp(element, cmmnFactory, {\n    reference: isCMMNEdge(element) ? 'cmmnElementRef' : undefined\n  }));\n\n};\n","'use strict';\n\nvar cmdHelper = require('../../../helper/CmdHelper');\nvar ConditionProp = require('./implementation/ConditionProp');\n\nvar CmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isCriterion = CmmnElementHelper.isCriterion,\n    isItemCapable = CmmnElementHelper.isItemCapable;\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    isCasePlanModel = ModelUtil.isCasePlanModel,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar getParent = require('cmmn-js/lib/features/modeling/util/ModelingUtil').getParent;\n\nmodule.exports = function(group, element, cmmnFactory) {\n\n  function getIfPart(bo) {\n    return bo && bo.get('ifPart');\n  }\n\n  function getIfPartCondition(bo) {\n    var ifPart = getIfPart(bo);\n    return ifPart && ifPart.get('condition');\n  }\n\n\n  if (!isCriterion(element)) {\n    return;\n  }\n\n\n  group.entries = group.entries.concat(ConditionProp(element, cmmnFactory, {\n\n    id: 'ifPartCondition',\n    label: 'If Part Condition',\n    reference: 'sentryRef',\n\n    getCondition: function(element, node, bo) {\n      return getIfPartCondition(bo);\n    },\n\n    createdCondition: function(condition, element, node, bo) {\n      var cmds = [],\n          ifPart = getIfPart(bo);\n\n      if (!bo) {\n\n        // criterion without referencing a sentry\n        bo = cmmnFactory.create('cmmn:Sentry');\n\n        var container = getSentryParent(element.host),\n            criterion = getBusinessObject(element);\n        if (container) {\n          cmds.push(\n            cmdHelper.updateProperties(criterion, { sentryRef: bo }, element),\n            cmdHelper.updateSemanticParent(bo, container, 'sentries', element)\n          );\n        }\n\n      }\n\n      if (!ifPart) {\n        ifPart = cmmnFactory.create('cmmn:IfPart');\n        cmds.push(\n          cmdHelper.updateProperties(bo, { ifPart: ifPart }, element),\n          cmdHelper.updateSemanticParent(ifPart, bo, null, element)\n        );\n      }\n\n      cmds.push(\n        cmdHelper.updateProperties(ifPart, { condition: condition }, element),\n        cmdHelper.updateSemanticParent(condition, ifPart, null, element)\n      );\n\n      return cmds;\n    },\n\n    removedCondition: function(condition, element, node, bo) {\n      var cmds = [],\n          ifPart = getIfPart(bo);\n\n      if (ifPart) {\n        cmds.push(\n          cmdHelper.updateProperties(ifPart, { condition: undefined }, element),\n          cmdHelper.updateProperties(bo, { ifPart: undefined }, element),\n          cmdHelper.updateSemanticParent(ifPart, null, null, element)\n        );\n      }\n\n      return cmds;\n    }\n\n  }));\n\n};\n\n\nfunction getSentryParent(host) {\n\n  if (isCasePlanModel(host)) {\n    return getBusinessObject(host);\n  }\n\n  if (isItemCapable(host)) {\n    var bo = getBusinessObject(host);\n    return getParent(bo, 'cmmn:PlanFragment');\n  }\n\n}","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar CmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isAssignable = CmmnElementHelper.isAssignable,\n    isFormSupported = CmmnElementHelper.isFormSupported;\n\n\nmodule.exports = function(group, element) {\n\n  if (isFormSupported(element)) {\n\n    // Form Key\n    group.entries.push(entryFactory.textField({\n      id : 'formKey',\n      label : 'Form Key',\n      modelProperty : 'formKey',\n      reference: 'definitionRef'\n    }));\n  }\n\n  if (isAssignable(element)) {\n\n    // Assignee\n    group.entries.push(entryFactory.textField({\n      id : 'assignee',\n      label : 'Assignee',\n      modelProperty : 'assignee',\n      reference: 'definitionRef'\n    }));\n\n    // Candidate Users\n    group.entries.push(entryFactory.textField({\n      id : 'candidateUsers',\n      label : 'Candidate Users',\n      modelProperty : 'candidateUsers',\n      reference: 'definitionRef'\n    }));\n\n    // Candidate Groups\n    group.entries.push(entryFactory.textField({\n      id : 'candidateGroups',\n      label : 'Candidate Groups',\n      modelProperty : 'candidateGroups',\n      reference: 'definitionRef'\n    }));\n\n    // Due Date\n    group.entries.push(entryFactory.textField({\n      id : 'dueDate',\n      description : 'The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)',\n      label : 'Due Date',\n      modelProperty : 'dueDate',\n      reference: 'definitionRef'\n    }));\n\n    // FollowUp Date\n    group.entries.push(entryFactory.textField({\n      id : 'followUpDate',\n      description : 'The follow up date as an EL expression (e.g. ${someDate} or an ' +\n                    'ISO date (e.g. 2015-06-26T09:54:00)',\n      label : 'Follow Up Date',\n      modelProperty : 'followUpDate',\n      reference: 'definitionRef'\n    }));\n\n    // priority\n    group.entries.push(entryFactory.textField({\n      id : 'priority',\n      label : 'Priority',\n      modelProperty : 'priority',\n      reference: 'definitionRef'\n    }));\n  }\n};\n","'use strict';\n\nvar cmdHelper = require('../../../helper/CmdHelper'),\n    entryFactory = require('../../../factory/EntryFactory');\n\nvar TransitionProp = require('./implementation/TransitionProp');\n\nvar CmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isOnPartConnection = CmmnElementHelper.isOnPartConnection,\n    getOutgoingOnParts = CmmnElementHelper.getOutgoingOnParts;\n\nvar isLabel = require('cmmn-js/lib/features/modeling/util/ModelingUtil').isLabel;\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry) {\n\n\n  if (!isOnPartConnection(element)) {\n    return;\n  }\n\n\n  // standard event\n  group.entries = group.entries.concat(TransitionProp(element, {\n\n    id: 'onPartStandardEvent',\n    label: 'Standard Event',\n    reference: 'cmmnElementRef',\n    modelProperty: 'standardEvent',\n\n    set: function(element, values, node, bo) {\n\n      var connection = !isLabel(element) ? element : element.labelTarget,\n          source = connection.source,\n          changed = getOutgoingOnParts(source, bo) || [],\n          standardEvent = values.standardEvent || undefined;\n\n      if (changed.indexOf(element) === -1) {\n        changed.push(element);\n      }\n\n      return cmdHelper.updateProperties(bo, { standardEvent: standardEvent }, changed);\n\n    },\n\n    validate: function(element, values, node, bo) {\n      return bo && !bo.get('standardEvent') ? { standardEvent: 'Must provide a standard event' } : {};\n    }\n\n  }));\n\n\n  // is standard event visible\n  group.entries.push(entryFactory.checkbox({\n\n    id: 'onPartIsStandardEventVisible',\n    label: 'Show Standard Event',\n    modelProperty: 'isStandardEventVisible'\n\n  }));\n\n};\n","'use strict';\n\nvar is = require('cmmn-js/lib/util/ModelUtil').is,\n    getDefinition = require('cmmn-js/lib/util/ModelUtil').getDefinition;\n\nvar filter = require('lodash/filter');\n\nvar extensionElementsHelper = require('../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n\n    cmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isInOutBindingCapable = cmmnElementHelper.isInOutBindingCapable;\n\nvar extensionElementsEntry = require('./implementation/ExtensionElements');\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\n\nvar inOutTypeOptions = [\n  {\n    name: 'Source',\n    value: 'source'\n  },\n  {\n    name: 'Source Expression',\n    value: 'sourceExpression'\n  },\n  {\n    name: 'All',\n    value: 'variables'\n  }\n];\n\n/**\n  * return depend on parameter 'type' camunda:in or camunda:out extension elements\n  */\nfunction getCamundaInOutMappings(bo, type) {\n  return (bo && extensionElementsHelper.getExtensionElements(bo, type)) || [];\n}\n\n/**\n  * return depend on parameter 'type' camunda:in or camunda:out extension elements\n  * with source or sourceExpression attribute\n  */\nfunction getVariableMappings(bo, type, reference) {\n  var camundaMappings = getCamundaInOutMappings(bo, type);\n  return filter(camundaMappings, function(mapping) {\n    return !mapping.businessKey;\n  });\n}\n\nfunction getInOutType(mapping) {\n  var inOutType = 'source';\n\n  if (mapping.variables === 'all') {\n    inOutType = 'variables';\n  }\n  else if (typeof mapping.source !== 'undefined') {\n    inOutType = 'source';\n  }\n  else if (typeof mapping.sourceExpression !== 'undefined') {\n    inOutType = 'sourceExpression';\n  }\n\n  return inOutType;\n}\n\nvar CAMUNDA_IN_EXTENSION_ELEMENT = 'camunda:In',\n    CAMUNDA_OUT_EXTENSION_ELEMENT = 'camunda:Out';\n\n\nmodule.exports = function(group, element, cmmnFactory) {\n\n  if (!isInOutBindingCapable(element)) {\n    return;\n  }\n\n  var isSelected = function(element, node) {\n    return !!getSelected(element, node);\n  };\n\n  var getSelected = function(element, node) {\n    var parentNode = node.parentNode;\n    var selection = inEntry.getSelected(element, parentNode);\n\n    var parameter = getVariableMappings(getDefinition(element), CAMUNDA_IN_EXTENSION_ELEMENT)[selection.idx];\n    if (!parameter && outEntry) {\n      selection = outEntry.getSelected(element, parentNode);\n      parameter = getVariableMappings(getDefinition(element), CAMUNDA_OUT_EXTENSION_ELEMENT)[selection.idx];\n    }\n    return parameter;\n  };\n\n  var setOptionLabelValue = function(type) {\n    return function(element, node, option, property, value, idx, bo) {\n      var label = idx + ' : ';\n\n      var variableMappings = getVariableMappings(bo, type);\n      var mappingValue = variableMappings[idx];\n      var mappingType = getInOutType(mappingValue);\n\n      if (mappingType === 'variables') {\n        label = label + 'all';\n      }\n      else if (mappingType === 'source') {\n        label = label + (mappingValue.source || '<empty>');\n      }\n      else if (mappingType === 'sourceExpression') {\n        label = label + (mappingValue.sourceExpression || '<empty>');\n      }\n      else {\n        label = label + '<empty>';\n      }\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function(type) {\n    return function(element, extensionElements, value) {\n      var newElem = cmmnFactory.create(type, { source: '' });\n      return cmdHelper.updateSemanticParent(newElem, extensionElements, 'values', element);\n    };\n  };\n\n  var removeElement = function(type) {\n    return function(element, extensionElements, value, idx) {\n      var variablesMappings= getVariableMappings(getDefinition(element), type);\n      var mapping = variablesMappings[idx];\n      return extensionElementsHelper.removeEntry(getDefinition(element), element, mapping);\n    };\n  };\n\n  // in mapping for source and sourceExpression ///////////////////////////////////////////////////////////////\n\n  var inEntry = extensionElementsEntry(element, cmmnFactory, {\n    id: 'variableMapping-in',\n    label: 'In Mapping',\n    modelProperty: 'source',\n    prefix: 'In',\n    idGeneration: false,\n    resizable: true,\n    reference: 'definitionRef',\n\n    createExtensionElement: newElement(CAMUNDA_IN_EXTENSION_ELEMENT),\n    removeExtensionElement: removeElement(CAMUNDA_IN_EXTENSION_ELEMENT),\n\n    getExtensionElements: function(element, bo) {\n      return getVariableMappings(bo, CAMUNDA_IN_EXTENSION_ELEMENT);\n    },\n\n    onSelectionChange: function(element, node, event, scope) {\n      outEntry && outEntry.deselect(element, node.parentNode);\n    },\n\n    setOptionLabelValue: setOptionLabelValue(CAMUNDA_IN_EXTENSION_ELEMENT)\n  });\n  group.entries.push(inEntry);\n\n  // out mapping for source and sourceExpression ///////////////////////////////////////////////////////\n\n  var outEntry = extensionElementsEntry(element, cmmnFactory, {\n    id: 'variableMapping-out',\n    label: 'Out Mapping',\n    modelProperty: 'source',\n    prefix: 'Out',\n    idGeneration: false,\n    resizable: true,\n    reference: 'definitionRef',\n\n    createExtensionElement: newElement(CAMUNDA_OUT_EXTENSION_ELEMENT),\n    removeExtensionElement: removeElement(CAMUNDA_OUT_EXTENSION_ELEMENT),\n\n    getExtensionElements: function(element, bo) {\n      return getVariableMappings(bo, CAMUNDA_OUT_EXTENSION_ELEMENT);\n    },\n\n    onSelectionChange: function(element, node, event, scope) {\n      inEntry.deselect(element, node.parentNode);\n    },\n\n    setOptionLabelValue: setOptionLabelValue(CAMUNDA_OUT_EXTENSION_ELEMENT)\n  });\n  group.entries.push(outEntry);\n\n  // label for selected mapping ///////////////////////////////////////////////////////\n\n  group.entries.push(entryFactory.label({\n    id: 'variableMapping-typeLabel',\n    get: function(element, node) {\n      var mapping = getSelected(element, node);\n\n      var value = '';\n      if (is(mapping, CAMUNDA_IN_EXTENSION_ELEMENT)) {\n        value = 'In Mapping';\n      }\n      else if (is(mapping, CAMUNDA_OUT_EXTENSION_ELEMENT)) {\n        value = 'Out Mapping';\n      }\n\n      return {\n        label: value\n      };\n    },\n\n    showLabel: function(element, node) {\n      return isSelected(element, node);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.selectBox({\n    id: 'variableMapping-inOutType',\n    label: 'Type',\n    selectOptions: inOutTypeOptions,\n    modelProperty: 'inOutType',\n    reference: 'definitionRef',\n    get: function(element, node) {\n      var mapping = getSelected(element, node) || {};\n      return {\n        inOutType: getInOutType(mapping)\n      };\n    },\n    set: function(element, values, node) {\n      var inOutType = values.inOutType;\n\n      var props = {\n        'source' : undefined,\n        'sourceExpression' : undefined,\n        'variables' : undefined\n      };\n\n      if (inOutType === 'source') {\n        props.source = '';\n      }\n      else if (inOutType === 'sourceExpression') {\n        props.sourceExpression = '';\n      }\n      else if (inOutType === 'variables') {\n        props.variables = 'all';\n      }\n\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, props);\n    },\n    disabled: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableMapping-source',\n    dataValueLabel: 'sourceLabel',\n    modelProperty: 'source',\n    reference: 'definitionRef',\n    get: function(element, node) {\n      var mapping = getSelected(element, node) || {};\n\n      var label = '';\n      var inOutType = getInOutType(mapping);\n      if (inOutType === 'source') {\n        label = 'Source';\n      }\n      else if (inOutType === 'sourceExpression') {\n        label = 'Source Expression';\n      }\n\n      return {\n        source: mapping[inOutType],\n        sourceLabel: label\n      };\n    },\n    set: function(element, values, node) {\n      values.source = values.source || undefined;\n\n      var mapping = getSelected(element, node);\n      var inOutType = getInOutType(mapping);\n\n      var props = {};\n      props[inOutType] = values.source || '';\n\n      return cmdHelper.updateBusinessObject(element, mapping, props);\n    },\n    // one of both (source or sourceExpression) must have a value to make\n    // the configuration easier and more understandable\n    // it is not engine conform\n    validate: function(element, values, node) {\n      var mapping = getSelected(element, node);\n\n      var validation = {};\n      if (mapping) {\n        if (!values.source) {\n          validation.source = 'Mapping must have a ' + values.sourceLabel.toLowerCase() || 'value';\n        }\n      }\n\n      return validation;\n    },\n    disabled: function(element, node) {\n      var selectedMapping = getSelected(element, node);\n      return !selectedMapping || (selectedMapping && selectedMapping.variables);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableMapping-target',\n    label: 'Target',\n    modelProperty: 'target',\n    reference: 'definitionRef',\n    get: function(element, node) {\n      return {\n        target: (getSelected(element, node) || {}).target\n      };\n    },\n    set: function(element, values, node) {\n      values.target = values.target || undefined;\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, values);\n    },\n    validate: function(element, values, node) {\n      var mapping = getSelected(element, node);\n\n      var validation = {};\n      if (mapping) {\n        var mappingType = getInOutType(mapping);\n        if (!values.target && mappingType !== 'variables') {\n          validation.target = 'Mapping must have a target';\n        }\n      }\n\n      return validation;\n    },\n    disabled: function(element, node) {\n      var selectedMapping = getSelected(element, node);\n      return !selectedMapping || (selectedMapping && selectedMapping.variables);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.checkbox({\n    id: 'variableMapping-local',\n    label: 'Local',\n    modelProperty: 'local',\n    reference: 'definitionRef',\n    get: function(element, node) {\n      return {\n        local: (getSelected(element, node) || {}).local\n      };\n    },\n    set: function(element, values, node) {\n      values.local = values.local || false;\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, values);\n    },\n    disabled: function(element, node) {\n      var selectedMapping = getSelected(element, node);\n      return !selectedMapping || is(selectedMapping, CAMUNDA_OUT_EXTENSION_ELEMENT);\n    }\n  }));\n\n};\n","'use strict';\n\nvar RuleProp = require('./implementation/RuleProp');\n\nvar cmdHelper = require('../../../helper/CmdHelper');\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getBusinessObject = ModelUtil.getBusinessObject,\n    isCasePlanModel = ModelUtil.isCasePlanModel,\n    getDefinition = ModelUtil.getDefinition;\n\nvar CmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isTask = CmmnElementHelper.isTask,\n    isStage = CmmnElementHelper.isStage,\n    isMilestone = CmmnElementHelper.isMilestone;\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules, options) {\n\n\n  function getItemControl(element) {\n    var bo = getBusinessObject(element);\n    return bo && bo.get(itemControlProp);\n  }\n\n  function getDefaultControl(element) {\n    var bo = getDefinition(element);\n    return bo && bo.get(defaultControlProp);\n  }\n\n  function hasItemControl(element) {\n    var bo = getBusinessObject(element);\n    return !!(bo && bo.get(itemControlProp));\n  }\n\n  function hasDefaultControl(element) {\n    var bo = getDefinition(element);\n    return !!(bo && bo.get(defaultControlProp));\n  }\n\n  function isPlanItemControlAvailable(element, isDefaultControl) {\n    return isDefaultControl ? hasDefaultControl(element) : hasItemControl(element);\n  }\n\n\n\n  function validateRule(prop) {\n\n    return function(element, values, node, definition) {\n      var itemControl = getItemControl(element),\n          itemRule = itemControl && itemControl.get(prop),\n          defaultControl = getDefaultControl(definition),\n          defaultRule = defaultControl && defaultControl.get(prop),\n          result = {};\n\n      if (itemRule && defaultRule) {\n        result[prop] = { warning: 'Rule is overwritten by item control' };\n      }\n\n      return result;\n    };\n\n  }\n\n\n  if (isCasePlanModel(element) ||\n      (!isTask(element) &&\n      !isStage(element) &&\n      !isMilestone(element))) {\n    return;\n  }\n\n\n  options = options || {};\n\n  var defaultControlProp = 'defaultControl',\n      itemControlProp = 'itemControl',\n      manualActivationRuleProp = 'manualActivationRule',\n      requiredRuleProp = 'requiredRule',\n      repetitionRuleProp = 'repetitionRule';\n\n  var isDefaultControl = options.isDefaultControl,\n      idPrefix = (isDefaultControl ? 'default' : 'item') + 'Control',\n      reference = isDefaultControl ? 'definitionRef' : undefined,\n      controlRef = isDefaultControl ? defaultControlProp : itemControlProp;\n\n\n  group.entries.push({\n\n    id: idPrefix + 'ControlAction',\n    html: '<div class=\"cpp-row cpp-action\">' +\n             '<div data-show=\"canBeAdded\">' +\n                '<label>Add ' + (isDefaultControl ? 'Default' : 'Item') + ' Control</label>' +\n                '<button class=\"add\" data-action=\"add\"><span>+</span></button>' +\n             '</div>' +\n             '<div data-show=\"canBeRemoved\">' +\n                '<label>Remove ' + (isDefaultControl ? 'Default' : 'Item') + ' Control</label>' +\n                '<button class=\"clear\" data-action=\"remove\"><span>x</span></button>' +\n             '</div>' +\n          '</div>',\n\n    canBeAdded: function(element) {\n      return !isPlanItemControlAvailable(element, isDefaultControl);\n    },\n    canBeRemoved: function(element) {\n      return isPlanItemControlAvailable(element, isDefaultControl);\n    },\n    add: function() {\n      this.__action = 'add';\n      return { force: true };\n    },\n    remove: function() {\n      this.__action = 'remove';\n      return { force: true };\n    },\n    set: function(element) {\n\n      var action = this.__action;\n      delete this.__action;\n\n      var bo = isDefaultControl ? getDefinition(element) : getBusinessObject(element),\n          cmds = [],\n          update = {},\n          parent,\n          control;\n\n\n      if (action === 'add') {\n        control = cmmnFactory.create('cmmn:PlanItemControl');\n        update[controlRef] = control;\n        parent = bo;\n      }\n      else if (action === 'remove') {\n        control = isDefaultControl ? getDefaultControl(element) : getItemControl(element);\n        update[controlRef] = undefined;\n        parent = undefined;\n      }\n\n      cmds.push(\n        cmdHelper.updateProperties(bo, update, itemRegistry.getShapes(bo)),\n        cmdHelper.updateSemanticParent(control, parent, null, element)\n      );\n\n      return cmds;\n    }\n\n  });\n\n\n  // manual activation rule\n  if (cmmnRules.canSetManualActivationRule(element)) {\n\n    group.entries = group.entries.concat(RuleProp(element, cmmnFactory, itemRegistry, {\n\n      id: idPrefix + 'ManualActivationRule',\n      label: 'Manual Activation Rule',\n      reference: reference,\n      controlRef: controlRef,\n      ruleType: 'cmmn:ManualActivationRule',\n      ruleRef: manualActivationRuleProp,\n      modelProperty: manualActivationRuleProp,\n      validate: isDefaultControl ? validateRule(manualActivationRuleProp) : undefined,\n      disabled: function(element) {\n        return !isPlanItemControlAvailable(element, isDefaultControl);\n      }\n\n    }));\n\n  }\n\n\n  // required rule\n  if (cmmnRules.canSetRequiredRule(element)) {\n\n    group.entries = group.entries.concat(RuleProp(element, cmmnFactory, itemRegistry, {\n\n      id: idPrefix + 'RequiredRule',\n      label: 'Required Rule',\n      reference: reference,\n      controlRef: controlRef,\n      ruleType: 'cmmn:RequiredRule',\n      ruleRef: requiredRuleProp,\n      modelProperty: requiredRuleProp,\n      validate: isDefaultControl ? validateRule(requiredRuleProp) : undefined,\n      disabled: function(element) {\n        return !isPlanItemControlAvailable(element, isDefaultControl);\n      }\n\n    }));\n\n  }\n\n\n  // repetition rule\n  if (cmmnRules.canSetRepetitionRule(element)) {\n\n    group.entries = group.entries.concat(RuleProp(element, cmmnFactory, itemRegistry, {\n\n      id: idPrefix + 'RepetitionRule',\n      label: 'Repetition Rule',\n      reference: reference,\n      controlRef: controlRef,\n      ruleType: 'cmmn:RepetitionRule',\n      ruleRef: repetitionRuleProp,\n      modelProperty: repetitionRuleProp,\n      validate: isDefaultControl ? validateRule(repetitionRuleProp) : undefined,\n      disabled: function(element) {\n        return !isPlanItemControlAvailable(element, isDefaultControl);\n      }\n\n    }));\n\n  }\n\n};\n","'use strict';\n\nvar ConditionProp = require('./ConditionProp');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\n\nmodule.exports = function(element, cmmnFactory, itemRegistry, options) {\n\n\n  function getPlanItemControl(bo, controlRef) {\n    return bo && bo.get(controlRef);\n  }\n\n  function getRule(bo, controlRef, ruleRef) {\n    var control = getPlanItemControl(bo, controlRef);\n    return control && control.get(ruleRef);\n  }\n\n  function getRuleCondition(bo, controlRef, ruleRef) {\n    var rule = getRule(bo, controlRef, ruleRef);\n    return rule && rule.get('condition');\n  }\n\n\n  options = options || {};\n\n  var id = options.id,\n      label = options.label,\n      reference = options.reference,\n      modelProperty = options.modelProperty,\n      ruleType = options.ruleType,\n      controlRef = options.controlRef,\n      ruleRef = options.ruleRef;\n\n\n  return ConditionProp(element, cmmnFactory, {\n\n    id: id || 'rule',\n    label: label || 'Rule',\n    reference: reference,\n    modelProperty: modelProperty,\n\n    getCondition: function(element, node, bo) {\n      return getRuleCondition(bo, controlRef, ruleRef);\n    },\n\n    createdCondition: function(condition, element, node, bo) {\n      var cmds = [],\n          control = getPlanItemControl(bo, controlRef),\n          rule = getRule(bo, controlRef, ruleRef);\n\n      if (!rule) {\n        var ruleUpdate = {};\n        ruleUpdate[ruleRef] = rule = cmmnFactory.create(ruleType);\n        cmds.push(\n          cmdHelper.updateProperties(control, ruleUpdate, itemRegistry.getShapes(bo)),\n          cmdHelper.updateSemanticParent(rule, control, null, element)\n        );\n      }\n\n      cmds.push(\n        cmdHelper.updateProperties(rule, { condition: condition }, element),\n        cmdHelper.updateSemanticParent(condition, rule, null, element)\n      );\n\n      return cmds;\n    },\n\n    removedCondition: function(condition, element, node, bo) {\n      var cmds = [],\n          control = getPlanItemControl(bo, controlRef),\n          rule = getRule(bo, controlRef, ruleRef);\n\n      if (rule) {\n        cmds.push(\n          cmdHelper.updateProperties(rule, { condition: undefined }, element),\n          cmdHelper.updateSemanticParent(rule, null, null, element)\n        );\n      }\n\n      if (control) {\n        var ruleUpdate = {};\n        ruleUpdate[ruleRef] = undefined;\n        cmds.push(cmdHelper.updateProperties(control, ruleUpdate, itemRegistry.getShapes(bo)));\n      }\n\n      return cmds;\n    },\n\n    validate: options.validate,\n    disabled: options.disabled\n\n  });\n\n};\n","'use strict';\n\nvar cmdHelper = require('../../../helper/CmdHelper');\nvar TransitionProp = require('../../cmmn/parts/implementation/TransitionProp');\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getBusinessObject = ModelUtil.getBusinessObject,\n    isCasePlanModel = ModelUtil.isCasePlanModel,\n    getDefinition = ModelUtil.getDefinition;\n\nvar CmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isTask = CmmnElementHelper.isTask,\n    isStage = CmmnElementHelper.isStage;\n\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules, options) {\n\n  function getItemControl(element) {\n    var bo = getBusinessObject(element);\n    return bo && bo.get('itemControl');\n  }\n\n  function getDefaultControl(element) {\n    var bo = getDefinition(element);\n    return bo && bo.get('defaultControl');\n  }\n\n  function getPlanItemControl(element, isDefaultControl) {\n    return isDefaultControl ? getDefaultControl(element) : getItemControl(element);\n  }\n\n  function getRepetitionRule(element, isDefaultControl) {\n    var control = getPlanItemControl(element, isDefaultControl);\n    return control && control.get('repetitionRule');\n  }\n\n  function getRepeatOnStandardEvent(element, isDefaultControl) {\n    var rule = getRepetitionRule(element, isDefaultControl);\n    return rule && rule.get('camunda:repeatOnStandardEvent');\n  }\n\n  function isEntryCriteriaAttached(element) {\n    var bo = getBusinessObject(element),\n        criteria = bo.get('entryCriteria');\n    return !!(criteria && criteria.length);\n  }\n\n  if (isCasePlanModel(element) || (!isTask(element) && !isStage(element))) {\n    return;\n  }\n\n  options = options || {};\n\n  var isDefaultControl = options.isDefaultControl,\n      idPrefix = (isDefaultControl ? 'default' : 'item') + 'Control',\n      property = 'camunda:repeatOnStandardEvent';\n\n  var excludeTransitions = [\n    'fault',\n    'parentResume',\n    'parentSuspend',\n    'reactivate',\n    'resume',\n    'suspend',\n    'terminate'\n  ];\n\n\n  // repeat on standard event\n  group.entries = group.entries.concat(TransitionProp(element, {\n\n    id: idPrefix + 'RepeatOnStandardEvent',\n    label: 'Repeat On Standard Event',\n    modelProperty: 'repeatOnStandardEvent',\n    exclude: excludeTransitions,\n\n    get: function(element, node, bo) {\n\n      var event = getRepeatOnStandardEvent(bo, isDefaultControl) || '';\n      return {\n        repeatOnStandardEvent: event\n      };\n\n    },\n\n    set: function(element, values, node, bo) {\n\n      var rule = getRepetitionRule(bo, isDefaultControl),\n          update = {};\n\n      update[property] = values.repeatOnStandardEvent || undefined;\n      return cmdHelper.updateProperties(rule, update, itemRegistry.getShapes(bo));\n\n    },\n\n    disabled: function(element) {\n      return !getRepetitionRule(element, isDefaultControl);\n    },\n\n    validate: function(element, values, node, bo) {\n\n      var itemControlRule = getRepetitionRule(element),\n          validate = {},\n          warning;\n\n\n      if (!isDefaultControl) {\n\n        var itemRepeatOnStandardEvent = getRepeatOnStandardEvent(bo);\n\n        if (itemControlRule && itemRepeatOnStandardEvent && isEntryCriteriaAttached(element)) {\n          warning = 'Event is ignored due to entry criteria';\n        }\n\n      }\n      else {\n\n        var defaultControlRule = getRepetitionRule(bo, isDefaultControl),\n            defaultRepeatOnStandardEvent = getRepeatOnStandardEvent(bo, isDefaultControl);\n\n        if (defaultControlRule && defaultRepeatOnStandardEvent) {\n\n          if (isEntryCriteriaAttached(element)) {\n            warning = 'Event is ignored due to entry criteria';\n          }\n          else if (itemControlRule) {\n            warning = 'Event is overwritten by item control\\'s repetition rule';\n          }\n\n        }\n\n      }\n\n      if (warning) {\n        validate = { repeatOnStandardEvent: { warning: warning } };\n      }\n\n      return validate;\n\n    }\n\n  }));\n\n};\n","'use strict';\n\nvar IdProp = require('./implementation/IdProp');\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getDefinition = ModelUtil.getDefinition,\n    isCasePlanModel = ModelUtil.isCasePlanModel;\n\nmodule.exports = function(group, element) {\n\n  if (!getDefinition(element) || isCasePlanModel(element)) {\n    return;\n  }\n\n  // Id\n  group.entries = group.entries.concat(IdProp(element, {\n    id: 'definitionId',\n    label: 'Definition Id',\n    reference: 'definitionRef'\n  }));\n\n};\n","'use strict';\n\nvar NameProp = require('./implementation/NameProp');\nvar cmdHelper = require('../../../helper/CmdHelper');\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getDefinition = ModelUtil.getDefinition,\n    isCasePlanModel = ModelUtil.isCasePlanModel;\n\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry) {\n\n  if (!getDefinition(element) || isCasePlanModel(element)) {\n    return;\n  }\n\n\n  // name\n  group.entries = group.entries.concat(NameProp(element, {\n\n    id: 'definitionName',\n    label: 'Definition Name',\n    reference: 'definitionRef',\n\n    set: function(element, values, node, bo) {\n\n      var changed = itemRegistry.getShapes(bo);\n\n      if (changed.indexOf(element) === -1) {\n        changed.push(element);\n      }\n\n      var props = {\n        name: values.name || undefined\n      };\n\n      return cmdHelper.updateProperties(bo, props, changed);\n\n    }\n\n  }));\n\n};\n","'use strict';\n\nvar DocumentationProp = require('./implementation/DocumentationProp');\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getDefinition = ModelUtil.getDefinition,\n    isCasePlanModel = ModelUtil.isCasePlanModel;\n\nmodule.exports = function(group, element, cmmnFactory) {\n\n  if (!getDefinition(element) || isCasePlanModel(element)) {\n    return;\n  }\n\n\n  // documentation\n  group.entries = group.entries.concat(DocumentationProp(element, cmmnFactory, {\n\n    id: 'definitionDocumentation',\n    reference: 'definitionRef'\n\n  }));\n\n};\n","'use strict';\n\nvar cmdHelper = require('../../../helper/CmdHelper'),\n    entryFactory = require('../../../factory/EntryFactory');\n\nvar isCallable = require('../../../helper/CmmnElementHelper').isCallable;\n\nvar getBusinessObject = require('cmmn-js/lib/util/ModelUtil').getBusinessObject,\n    getDefinition = require('cmmn-js/lib/util/ModelUtil').getDefinition;\n\n\nvar ATTR_DECL = {\n  'cmmn:CaseTask': {\n    'ref': 'caseRef',\n    'expression': 'caseRefExpression'\n  },\n\n  'cmmn:ProcessTask': {\n    'ref': 'processRef',\n    'expression': 'processRefExpression'\n  },\n\n  'cmmn:DecisionTask': {\n    'ref': 'decisionRef',\n    'expression': 'decisionRefExpression'\n  }\n};\n\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry) {\n\n  if (!isCallable(element)) {\n    return;\n  }\n\n\n  function getAttribute(element, prop) {\n    var bo = getBusinessObject(element),\n        type = bo && bo.$type;\n    return (ATTR_DECL[type] || {})[prop];\n  }\n\n\n  var validate = function(prop) {\n    return function(element, values, node, bo) {\n      var attr = getAttribute(bo, prop),\n          validate = {};\n\n      if (!values[attr]) {\n        validate[attr] = 'Must provide a value';\n      }\n\n      return validate;\n    };\n  };\n\n\n  group.entries.push(entryFactory.selectBox({\n\n    id: 'callableRefType',\n    label: 'Type',\n    selectOptions: [\n      { name: 'Reference', value: 'ref' },\n      { name: 'Expression', value: 'expression' }\n    ],\n    modelProperty: 'type',\n    reference: 'definitionRef',\n\n    get: function(element, node, bo) {\n\n      var refAttr = getAttribute(bo, 'ref'),\n          expAttr = getAttribute(bo, 'expression'),\n          ref = bo && bo.get(refAttr),\n          expression = bo && bo.get(expAttr);\n\n      return {\n        type: (ref || !expression) ? 'ref' : 'expression'\n      };\n\n    },\n\n    set: function(element, values, node, bo) {\n\n      var refAttr = getAttribute(bo, 'ref'),\n          expAttr = getAttribute(bo, 'expression'),\n          type = values.type,\n          update = {};\n\n      update[refAttr] = type === 'ref' ? '' : undefined;\n      update[expAttr] = type === 'expression' ? cmmnFactory.create('cmmn:Expression') : undefined;\n\n      return cmdHelper.updateProperties(bo, update, element);\n\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n\n    id: 'callableReference',\n    label: 'Reference',\n    reference: 'definitionRef',\n    modelProperty: getAttribute(getDefinition(element), 'ref'),\n\n    validate: validate('ref'),\n\n    disabled: function(element) {\n\n      var definition = getDefinition(element),\n          refAttr = getAttribute(definition, 'ref'),\n          refExpAttr = getAttribute(definition, 'expression'),\n          ref = definition && definition.get(refAttr),\n          expression = definition && definition.get(refExpAttr);\n\n      return !ref && expression;\n\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n\n    id: 'callableReferenceExpression',\n    label: 'Expression',\n    reference: 'definitionRef',\n    modelProperty: getAttribute(getDefinition(element), 'expression'),\n\n    validate: validate('expression'),\n\n    get: function(element, node, bo) {\n\n      var attr = getAttribute(bo, 'expression'),\n          expression = bo.get(attr),\n          value = {};\n\n      value[attr] = expression && expression.get('body');\n\n      return value;\n\n    },\n\n    set: function(element, values, node, bo) {\n\n      var attr = getAttribute(bo, 'expression'),\n          expression = bo.get(attr),\n          value = values[attr] || undefined;\n\n      return cmdHelper.updateProperties(expression, { body: value }, element);\n\n    },\n\n    disabled: function(element) {\n\n      var definition = getDefinition(element),\n          refAttr = getAttribute(definition, 'ref'),\n          refExpAttr = getAttribute(definition, 'expression'),\n          ref = definition && definition.get(refAttr),\n          expression = definition && definition.get(refExpAttr);\n\n      return ref || !expression;\n\n    }\n\n  }));\n\n\n};\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar BusinessKeyProp = require('./implementation/BusinessKeyProp');\n\nvar cmdHelper = require('../../../helper/CmdHelper'),\n    cmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isCallable = cmmnElementHelper.isCallable,\n    isInOutBindingCapable = cmmnElementHelper.isInOutBindingCapable;\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getBusinessObject = ModelUtil.getBusinessObject,\n    getDefinition = ModelUtil.getDefinition,\n    is = ModelUtil.is;\n\nvar assign = require('lodash/assign');\n\n\nvar attributeInfo = {\n  'cmmn:CaseTask': {\n    binding: 'camunda:caseBinding',\n    version: 'camunda:caseVersion',\n    tenantId: 'camunda:caseTenantId'\n  },\n\n  'cmmn:ProcessTask': {\n    binding: 'camunda:processBinding',\n    version: 'camunda:processVersion',\n    tenantId: 'camunda:processTenantId'\n  },\n\n  'cmmn:DecisionTask': {\n    binding: 'camunda:decisionBinding',\n    version: 'camunda:decisionVersion',\n    tenantId: 'camunda:decisionTenantId'\n  }\n};\n\n\nvar bindingOptions = [\n  {\n    name: 'latest',\n    value: 'latest'\n  },\n  {\n    name: 'deployment',\n    value: 'deployment'\n  },\n  {\n    name: 'version',\n    value: 'version'\n  }\n];\n\n\nvar mapDecisionResultOptions = [\n  {\n    name: 'singleEntry',\n    value: 'singleEntry'\n  },\n  {\n    name:'singleResult',\n    value:'singleResult'\n  },\n  {\n    name:'collectEntries',\n    value:'collectEntries'\n  },\n  {\n    name:'resultList',\n    value:'resultList'\n  }\n];\n\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry) {\n\n  if (!isCallable(element)) {\n    return;\n  }\n\n\n  function getAttribute(element, prop) {\n    var bo = getBusinessObject(element),\n        type = bo && bo.$type;\n    return (attributeInfo[type] || {})[prop];\n  }\n\n  function getCallableBindingValue(element) {\n    var definition = getDefinition(element);\n    var attr = getAttribute(definition, 'binding');\n    return definition && definition.get(attr);\n  }\n\n\n  var getValue = function(modelProp, prop, defaultValue) {\n    return function(element, node, bo) {\n      var value = {};\n      value[modelProp] = (bo && bo.get(prop)) || defaultValue;\n      return value;\n    };\n  };\n\n  var setValue = function(modelProp, prop, defaultValue) {\n    return function(element, values, node, bo) {\n      var update = {};\n      update[prop] = values[modelProp] || defaultValue;\n      return cmdHelper.updateProperties(bo, update, element);\n    };\n  };\n\n\n  group.entries.push(entryFactory.selectBox({\n    id: 'callableBinding',\n    label: 'Binding',\n    selectOptions: bindingOptions,\n    modelProperty: 'callableBinding',\n    reference: 'definitionRef',\n\n    get: function(element, node, bo) {\n\n      var attr = getAttribute(bo, 'binding');\n\n      return {\n        callableBinding: (attr && bo.get(attr)) || 'latest'\n      };\n\n    },\n\n    set: function(element, values, node, bo) {\n\n      var binding = values.callableBinding,\n          attr = getAttribute(bo, 'binding'),\n          attrVer = getAttribute(bo, 'version');\n\n      var props = {};\n      props[attr] = binding;\n      // set version value always on undefined to delete the existing value\n      props[attrVer] = undefined;\n\n      return cmdHelper.updateProperties(bo, props, element);\n\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'callable-version',\n    label: 'Version',\n    modelProperty: 'callableVersion',\n    reference: 'definitionRef',\n\n    get: getValue('callableVersion', getAttribute(getDefinition(element), 'version')),\n    set: setValue('callableVersion', getAttribute(getDefinition(element), 'version')),\n\n    validate: function(element, values, node) {\n\n      var version = values.callableVersion,\n          validate = {};\n\n      if ((getCallableBindingValue(element) === 'version') && !version) {\n        validate.callableVersion = 'Must provide a value';\n      }\n\n      return validate;\n\n    },\n\n    disabled: function(element, node) {\n      return getCallableBindingValue(element) !== 'version';\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'tenant-id',\n    label: 'Tenant Id',\n    modelProperty: 'callableTenantId',\n    reference: 'definitionRef',\n\n    get: getValue('callableTenantId', getAttribute(getDefinition(element), 'tenantId')),\n    set: setValue('callableTenantId', getAttribute(getDefinition(element), 'tenantId'))\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'dmn-resultVariable',\n    label: 'Result Variable',\n    modelProperty: 'resultVariable',\n    reference: 'definitionRef',\n\n    get: getValue('resultVariable', 'camunda:resultVariable'),\n\n    set: function(element, values, node, bo) {\n      var resultVariable = values.resultVariable || undefined;\n\n      var props = {\n        'camunda:resultVariable': resultVariable\n      };\n\n      if (is(bo, 'camunda:DecisionTask') && !resultVariable) {\n        assign(props, {\n          'camunda:mapDecisionResult': 'resultList'\n        });\n      }\n\n      return cmdHelper.updateProperties(bo, props, element);\n    },\n\n    disabled: function(element, node) {\n      var definition = getDefinition(element);\n      return !is(definition, 'camunda:DecisionTask');\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.selectBox({\n    id: 'dmn-map-decision-result',\n    label: 'Map Decision Result',\n    selectOptions: mapDecisionResultOptions,\n    modelProperty: 'mapDecisionResult',\n    reference: 'definitionRef',\n\n    get: getValue('mapDecisionResult', 'camunda:mapDecisionResult', 'resultList'),\n\n    set: function(element, values, node, bo) {\n      var update = { 'camunda:mapDecisionResult': values.mapDecisionResult || 'resultList' };\n      return cmdHelper.updateProperties(bo, update, element);\n    },\n\n    disabled: function(element, node) {\n      var definition = getDefinition(element);\n      var resultVariable = definition && definition.get('camunda:resultVariable');\n      return !(is(definition, 'camunda:DecisionTask') && typeof resultVariable !== 'undefined');\n    }\n\n  }));\n\n  // businessKey only for ProcessTask and CaseTask\n  if (isInOutBindingCapable(element)) {\n    group.entries.push(BusinessKeyProp(element, cmmnFactory, {\n\n      id: 'callable-business-key',\n      label: 'Business Key',\n      modelProperty: 'callableBusinessKey',\n      reference: 'definitionRef'\n\n    }));\n  }\n\n};\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\n    getDefinition = ModelUtil.getDefinition;\n\nvar forEach = require('lodash/forEach');\n\n\nvar BUSINESS_KEY_VALUE = '#{caseExecution.caseBusinessKey}';\n\nfunction getCamundaInWithBusinessKey(element) {\n  var camundaIn = [],\n      bo = getDefinition(element);\n\n  var camundaInParams = bo && extensionElementsHelper.getExtensionElements(bo, 'camunda:In');\n  if (camundaInParams) {\n    forEach(camundaInParams, function(param) {\n      if (param.businessKey) {\n        camundaIn.push(param);\n      }\n    });\n  }\n  return camundaIn;\n}\n\nfunction setBusinessKey(element, cmmnFactory) {\n  var bo = getDefinition(element),\n      commands = [];\n\n  var extensionElements = bo && bo.extensionElements;\n\n  if (!extensionElements) {\n    extensionElements = elementHelper.createElement('cmmn:ExtensionElements', { values: [] }, bo, cmmnFactory);\n\n    commands.push(cmdHelper.updateProperties(bo, { extensionElements: extensionElements }));\n  }\n\n  var camundaIn = elementHelper.createElement(\n    'camunda:In',\n    { 'businessKey': BUSINESS_KEY_VALUE },\n    extensionElements,\n    cmmnFactory\n  );\n\n  commands.push(cmdHelper.addAndRemoveElementsFromList(\n    element,\n    extensionElements,\n    'values',\n    'extensionElements',\n    [ camundaIn ]\n  ));\n\n  return commands;\n}\n\nfunction deleteBusinessKey(element) {\n  var camundaInExtensions = getCamundaInWithBusinessKey(element),\n      commands = [];\n\n  forEach(camundaInExtensions, function(elem) {\n    commands.push(extensionElementsHelper.removeEntry(getDefinition(element), element, elem));\n  });\n\n  return commands;\n}\n\n\nmodule.exports = function(element, cmmnFactory, options) {\n\n  options = options || {};\n\n  var id = options.id,\n      label = options.label,\n      reference = options.reference,\n      modelProperty = options.modelProperty;\n\n\n  var businessKeyEntry = entryFactory.checkbox({\n    id: id || 'business-key',\n    label: label || 'Business Key',\n    modelProperty: modelProperty,\n    reference: reference,\n\n    get: function(element, node) {\n      var camundaIn = getCamundaInWithBusinessKey(element);\n\n      return {\n        callableBusinessKey: !!(camundaIn && camundaIn.length > 0)\n      };\n    },\n\n    set: function(element, values, node) {\n      if (values.callableBusinessKey) {\n        return setBusinessKey(element, cmmnFactory);\n      } else {\n        return deleteBusinessKey(element);\n      }\n    }\n  });\n\n  return businessKeyEntry;\n\n};\n","'use strict';\n\nvar CmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isCaseExecutionListenerCapable = CmmnElementHelper.isCaseExecutionListenerCapable,\n    isMilestone = CmmnElementHelper.isMilestone,\n    isEventListener = CmmnElementHelper.isEventListener;\n\nvar listenerElements = require('./implementation/ListenerElements');\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules, options) {\n\n  var initialEvent = isMilestone(element) || isEventListener(element) ? 'occur' : 'complete';\n\n  var listenerProps = listenerElements(element, cmmnFactory, {\n    id: 'caseExecutionListeners',\n    label: 'Case Execution Listener',\n    type: 'camunda:CaseExecutionListener',\n    initialEvent: initialEvent,\n    isApplicable: isCaseExecutionListenerCapable\n  });\n\n  if (listenerProps.entries && listenerProps.entries.length) {\n    group.entries = group.entries.concat(listenerProps.entries);\n  }\n\n  return {\n    register : listenerProps.register,\n    getSelectedListener: listenerProps.getSelectedListener\n  };\n\n};\n","'use strict';\n\nvar isVariableListenerCapable = require('../../../helper/CmmnElementHelper').isVariableListenerCapable;\n\nvar listenerElements = require('./implementation/ListenerElements');\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules, options) {\n\n\n  var listenerProps = listenerElements(element, cmmnFactory, {\n    id: 'variableListeners',\n    label: 'Variable Listener',\n    type: 'camunda:VariableListener',\n    initialEvent: 'update',\n    isApplicable: isVariableListenerCapable\n  });\n\n  if (listenerProps.entries && listenerProps.entries.length) {\n    group.entries = group.entries.concat(listenerProps.entries);\n  }\n\n  return {\n    register : listenerProps.register,\n    getSelectedListener: listenerProps.getSelectedListener\n  };\n\n};\n","'use strict';\n\nvar isTaskListenerCapable = require('../../../helper/CmmnElementHelper').isTaskListenerCapable;\n\nvar listenerElements = require('./implementation/ListenerElements');\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules, options) {\n\n\n  var listenerProps = listenerElements(element, cmmnFactory, {\n    id: 'taskListeners',\n    label: 'Task Listener',\n    type: 'camunda:TaskListener',\n    initialEvent: 'create',\n    isApplicable: isTaskListenerCapable\n  });\n\n  if (listenerProps.entries && listenerProps.entries.length) {\n    group.entries = group.entries.concat(listenerProps.entries);\n  }\n\n  return {\n    register : listenerProps.register,\n    getSelectedListener: listenerProps.getSelectedListener\n  };\n\n};\n","'use strict';\n\nvar ListenerEventTypeProp = require('./implementation/ListenerEventTypeProp'),\n    ListenerDelegateProp = require('./implementation/ListenerDelegateProp');\n\nvar CmmnElementHelper = require('../../../helper/CmmnElementHelper'),\n    isCaseExecutionListenerCapable = CmmnElementHelper.isCaseExecutionListenerCapable,\n    isTaskListenerCapable = CmmnElementHelper.isTaskListenerCapable,\n    isVariableListenerCapable = CmmnElementHelper.isVariableListenerCapable;\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules, options) {\n\n\n  options = options || {};\n\n  var getListener = options.getListener;\n\n\n  if (!isCaseExecutionListenerCapable(element) && !isTaskListenerCapable(element) && !isVariableListenerCapable(element)) {\n    return;\n  }\n\n  group.entries = group.entries.concat(ListenerEventTypeProp(element, {\n    getListener: getListener\n  }));\n\n\n  group.entries = group.entries.concat(ListenerDelegateProp(element, cmmnFactory, {\n    getListener: getListener\n  }));\n\n};\n","'use strict';\n\nvar is = require('cmmn-js/lib/util/ModelUtil').is;\n\nvar TransitionProp = require('../../../cmmn/parts/implementation/TransitionProp');\n\nvar cmdHelper = require('../../../../helper/CmdHelper'),\n    entryFactory = require('../../../../factory/EntryFactory');\n\nmodule.exports = function(element, options) {\n\n\n  options = options || {};\n\n  var getListener = options.getListener,\n      idSuffix = 'EventType',\n      label = 'Event Type',\n      modelProperty = 'eventType',\n      reference = 'definitionRef';\n\n\n  var getEventType = function(element, node) {\n    var listener = getListener(element, node),\n        value = {};\n\n    value[modelProperty] = (listener && listener.event) || '';\n\n    return value;\n  };\n\n  var setEventType = function(element, values, node) {\n    var listener = getListener(element, node),\n        eventType = values[modelProperty] || undefined;\n    return cmdHelper.updateProperties(listener, { event: eventType }, element);\n  };\n\n  var hideEntry = function(type) {\n    return function(element, node) {\n      return !is(getListener(element, node), type);\n    };\n  };\n\n  var validate = function(element, values) {\n    var value = values[modelProperty],\n        validate = {};\n\n    if (!value) {\n      validate[modelProperty] = {\n        warning: 'Listener is notified for all kinds of events'\n      };\n    }\n\n    return validate;\n  };\n\n\n  var caseExecutionListenerEventEntry = TransitionProp(element, {\n\n    id: 'caseExecutionListener' + idSuffix,\n    label: label,\n    modelProperty: modelProperty,\n    reference: reference,\n    emptyParameter: true,\n\n    get: getEventType,\n    set: setEventType,\n    hideEntry: hideEntry('camunda:CaseExecutionListener'),\n    validate: validate\n\n  })[0];\n\n\n  var taskListenerEventEntry = entryFactory.selectBox({\n\n    id: 'taskListener' + idSuffix,\n    label: label,\n    modelProperty: modelProperty,\n    reference: reference,\n    selectOptions: [\n      { name: 'create', value: 'create' },\n      { name: 'assignment', value: 'assignment' },\n      { name: 'complete', value: 'complete' },\n      { name: 'delete', value: 'delete' }\n    ],\n    emptyParameter: true,\n\n    get: getEventType,\n    set: setEventType,\n    hideEntry: hideEntry('camunda:TaskListener'),\n    validate: validate\n\n  });\n\n\n  var variableListenerEventEntry = entryFactory.selectBox({\n\n    id: 'variableListener' + idSuffix,\n    label: label,\n    modelProperty: modelProperty,\n    reference: reference,\n    selectOptions: [\n      { name: 'create', value: 'create' },\n      { name: 'update', value: 'update' },\n      { name: 'delete', value: 'delete' }\n    ],\n    emptyParameter: true,\n\n    get: getEventType,\n    set: setEventType,\n    hideEntry: hideEntry('camunda:VariableListener'),\n    validate: validate\n\n  });\n\n\n  return [ caseExecutionListenerEventEntry, taskListenerEventEntry, variableListenerEventEntry ];\n\n};\n","'use strict';\n\nvar cmdHelper = require('../../../../helper/CmdHelper'),\n    entryFactory = require('../../../../factory/EntryFactory');\n\nvar ScriptProp = require('./ScriptProp');\n\nvar getListenerType = require('../../../../helper/ListenerHelper').getListenerType;\n\n\nmodule.exports = function(element, cmmnFactory, options) {\n\n  options = options || {};\n\n  var getListener = options.getListener,\n      reference = 'definitionRef',\n      classProp = 'class',\n      expressionProp = 'expression',\n      delegateExpressionProp = 'delegateExpression',\n      scriptProp = 'script',\n      entries = [];\n\n\n  var getDelegate = function(prop) {\n    return function(element, node) {\n      var listener = getListener(element, node),\n          value = {};\n      value[prop] = (listener && listener.get(prop)) || undefined;\n      return value;\n    };\n  };\n\n  var setDelegate = function(prop) {\n    return function(element, values, node) {\n      var listener = getListener(element, node),\n          update = {};\n      update[prop] = values[prop] || '';\n      return cmdHelper.updateProperties(listener, update, element);\n    };\n  };\n\n  var hideDelegateEntry = function(prop) {\n    return function(elment, node) {\n      var listener = getListener(element, node);\n      return !listener || getListenerType(listener) !== prop;\n    };\n  };\n\n  var validate = function(prop) {\n    return function(element, values) {\n      var value = values[prop],\n          validate = {};\n\n      if (!value) {\n        validate[prop] = 'Must provide a value';\n      }\n\n      return validate;\n    };\n  };\n\n\n  entries.push(entryFactory.selectBox({\n\n    id: 'listenerType',\n    label: 'Listener Type',\n    modelProperty: 'type',\n    reference: reference,\n    selectOptions: [\n      { value: classProp, name: 'Java Class' },\n      { value: expressionProp, name: 'Expression' },\n      { value: delegateExpressionProp, name: 'Delegate Expression' },\n      { value: scriptProp, name: 'Script' }\n    ],\n    emptyParameter: false,\n\n    get: function(element, node) {\n\n      var listener = getListener(element, node);\n      return {\n        type: getListenerType(listener)\n      };\n\n    },\n\n    set: function(element, values, node) {\n\n      var listener = getListener(element, node),\n          type = values.type || undefined,\n          update = {};\n\n      update[classProp] = type === classProp ? '' : undefined;\n      update[expressionProp] = type === expressionProp ? '' : undefined;\n      update[delegateExpressionProp] = type === delegateExpressionProp ? '' : undefined;\n      update[scriptProp] = type === scriptProp ? cmmnFactory.create('camunda:Script') : undefined;\n\n      return cmdHelper.updateProperties(listener, update, element);\n\n    }\n\n  }));\n\n\n  entries.push(entryFactory.textField({\n\n    id: 'listenerClass',\n    label: 'Java Class',\n    modelProperty: classProp,\n    reference: reference,\n\n    get: getDelegate(classProp),\n    set: setDelegate(classProp),\n    hideEntry: hideDelegateEntry(classProp),\n    validate: validate(classProp)\n\n  }));\n\n\n  entries.push(entryFactory.textField({\n\n    id: 'listenerExpression',\n    label: 'Expression',\n    modelProperty: expressionProp,\n    reference: reference,\n\n    get: getDelegate(expressionProp),\n    set: setDelegate(expressionProp),\n    hideEntry: hideDelegateEntry(expressionProp),\n    validate: validate(expressionProp)\n\n  }));\n\n\n  entries.push(entryFactory.textField({\n\n    id: 'listenerDelegateExpression',\n    label: 'Delegate Expression',\n    modelProperty: delegateExpressionProp,\n    reference: reference,\n\n    get: getDelegate(delegateExpressionProp),\n    set: setDelegate(delegateExpressionProp),\n    hideEntry: hideDelegateEntry(delegateExpressionProp),\n    validate: validate(delegateExpressionProp)\n\n  }));\n\n\n  entries = entries.concat(ScriptProp(element, {\n    getScript: function(element, node) {\n      var listener = getListener(element, node),\n          type = getListenerType(listener);\n      return type === scriptProp && listener && listener.get(scriptProp);\n    }\n  }));\n\n\n  return entries;\n};\n","'use strict';\n\nvar cmdHelper = require('../../../../helper/CmdHelper'),\n    entryFactory = require('../../../../factory/EntryFactory');\n\nmodule.exports = function(element, options) {\n\n\n  var EXTERNAL_TYPE = 'external',\n      INLINE_TYPE = 'inline';\n\n  var scriptFormatProp = 'scriptFormat',\n      valueProp = 'value',\n      resourceProp = 'resource';\n\n\n  function getScriptType(script) {\n\n    var external = script && script.get(resourceProp);\n\n    if (external !== undefined) {\n      return EXTERNAL_TYPE;\n    }\n\n    return INLINE_TYPE;\n  }\n\n\n  options = options || {};\n\n  var getScript = options.getScript,\n      reference = 'definitionRef';\n\n  var getValue = function(prop) {\n    return function(element, node) {\n      var script = getScript(element, node),\n          value = {};\n\n      value[prop] = (script && script.get(prop)) || undefined;\n\n      return value;\n    };\n  };\n\n  var setValue = function(prop, defaultValue) {\n    return function(element, values, node) {\n      var script = getScript(element, node),\n          update = {};\n\n      update[prop] = values[prop] || defaultValue;\n\n      return cmdHelper.updateProperties(script, update, element);\n    };\n  };\n\n  var hideEntry = function(expectedType) {\n    return function(element, node) {\n      var script = getScript(element, node);\n      return !script || (expectedType && getScriptType(script) !== expectedType);\n    };\n  };\n\n  var validate = function(prop) {\n    return function(element, values) {\n      var value = values[prop],\n          validate = {};\n\n      if (!value) {\n        validate[prop] = 'Must provide a value';\n      }\n\n      return validate;\n    };\n  };\n\n\n  var scriptFormatEntry = entryFactory.textField({\n\n    id: 'scriptFormant',\n    label: 'Script Format',\n    modelProperty: scriptFormatProp,\n    reference: reference,\n\n    get: getValue(scriptFormatProp),\n    set: setValue(scriptFormatProp),\n    hideEntry: hideEntry(),\n    validate: validate(scriptFormatProp)\n\n  });\n\n\n  var scriptTypeEntry = entryFactory.selectBox({\n\n    id: 'scriptType',\n    label: 'Script Type',\n    modelProperty: 'type',\n    reference: reference,\n    selectOptions: [\n      { value: INLINE_TYPE, name: 'Inline Script' },\n      { value: EXTERNAL_TYPE, name: 'External Resource' }\n    ],\n\n    get: function(element, node) {\n\n      var script = getScript(element, node);\n      return {\n        type: getScriptType(script)\n      };\n\n    },\n\n    set: function(element, values, node) {\n\n      var script = getScript(element, node),\n          type = values.type || undefined,\n          update = {};\n\n      update[resourceProp] = type === EXTERNAL_TYPE ? '' : undefined;\n      update[valueProp] = undefined;\n\n      return cmdHelper.updateProperties(script, update, element);\n\n    },\n\n    hideEntry: hideEntry()\n\n  });\n\n\n  var scriptValueEntry = entryFactory.textBox({\n\n    id: 'scriptValue',\n    label: 'Script',\n    modelProperty: valueProp,\n    reference: reference,\n\n    get: getValue(valueProp),\n    set: setValue(valueProp),\n    hideEntry: hideEntry(INLINE_TYPE),\n    validate: validate(valueProp)\n\n  });\n\n\n  var scriptResouceEntry = entryFactory.textField({\n\n    id: 'scriptResource',\n    label: 'Resource',\n    modelProperty: resourceProp,\n    reference: reference,\n\n    get: getValue(resourceProp),\n    set: setValue(resourceProp, ''),\n    hideEntry: hideEntry(EXTERNAL_TYPE),\n    validate: validate(resourceProp)\n\n  });\n\n  return [ scriptFormatEntry, scriptTypeEntry, scriptValueEntry, scriptResouceEntry ];\n\n};\n","'use strict';\n\nvar fieldInjection = require('./implementation/FieldInjection');\n\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry, cmmnRules, options) {\n\n  var fieldInjectionEntry = fieldInjection(element, cmmnFactory, options);\n\n  if (fieldInjectionEntry && fieldInjectionEntry.length > 0) {\n    group.entries = group.entries.concat(fieldInjectionEntry);\n  }\n\n};\n","'use strict';\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar utils = require('../../../../Utils');\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar extensionElementsEntry = require('./ExtensionElements');\n\nvar assign = require('lodash/assign');\n\n\nvar DEFAULT_PROPS = {\n  'stringValue': undefined,\n  'string': undefined,\n  'expression': undefined\n};\n\nvar fieldTypeOptions = [\n  {\n    name: 'String',\n    value: 'string'\n  },\n  {\n    name: 'Expression',\n    value: 'expression'\n  }\n];\n\nvar CAMUNDA_FIELD_EXTENSION_ELEMENT = 'camunda:Field';\n\nmodule.exports = function(element, cmmnFactory, options) {\n\n  options = options || {};\n\n  var getSelectedListener = options.getListener,\n      reference = 'definitionRef';\n\n  var entries = [];\n\n  var isSelected = function(element, node) {\n    return getSelectedField(element, node);\n  };\n\n  function getSelectedField(element, node) {\n    var selected = fieldEntry.getSelected(element, node.parentNode);\n\n    if (selected.idx === -1) {\n      return;\n    }\n\n    var formFields = getCamundaListenerFields(element, node);\n\n    return formFields[selected.idx];\n  }\n\n  function getCamundaListenerFields(element, node) {\n    var selectedListener = getSelectedListener(element, node);\n    return selectedListener && selectedListener.fields || [];\n  }\n\n  function getFieldType(bo) {\n    var fieldType = 'string';\n\n    var expressionValue = bo && bo.expression;\n    var stringValue = bo && (bo.string || bo.stringValue);\n\n    if (typeof stringValue !== 'undefined') {\n      fieldType = 'string';\n    } else if (typeof expressionValue !== 'undefined') {\n      fieldType = 'expression';\n    }\n\n    return fieldType;\n  }\n\n  var setOptionLabelValue = function() {\n    return function(element, node, option, property, value, idx) {\n      var camundaFields = getCamundaListenerFields(element,node);\n      var field = camundaFields[idx];\n\n      value = (field.name) ? field.name : '<empty>';\n\n      var label = idx + ' : ' + value;\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function() {\n    return function(element, extensionElements, value, node) {\n      var props = {\n        name: '',\n        string: ''\n      };\n\n      var selectedListener = getSelectedListener(element, node);\n      var newFieldElem = elementHelper.createElement(CAMUNDA_FIELD_EXTENSION_ELEMENT, props, selectedListener, cmmnFactory);\n      return cmdHelper.addElementsTolist(element, selectedListener, 'fields', [ newFieldElem ]);\n\n    };\n  };\n\n  var removeElement = function() {\n    return function(element, extensionElements, value, idx, node) {\n      var camundaFields= getCamundaListenerFields(element, node);\n      var field = camundaFields[idx];\n      if (field) {\n        var selectedListener = getSelectedListener(element, node);\n        return cmdHelper.removeElementsFromList(element, selectedListener, 'fields', null, [ field ]);\n      }\n    };\n  };\n\n\n  var fieldEntry = extensionElementsEntry(element, cmmnFactory, {\n    id : 'listener-fields',\n    label : 'Fields',\n    modelProperty: 'fieldName',\n    reference: reference,\n    idGeneration: 'false',\n\n    createExtensionElement: newElement(),\n    removeExtensionElement: removeElement(),\n\n    getExtensionElements: function(element, node) {\n      return getCamundaListenerFields(element, node);\n    },\n\n    setOptionLabelValue: setOptionLabelValue()\n\n  });\n  entries.push(fieldEntry);\n\n\n  entries.push(entryFactory.validationAwareTextField({\n    id: 'listener-field-name',\n    label: 'Name',\n    reference: reference,\n    modelProperty: 'fieldName',\n\n    get: function(element, node) {\n      return { fieldName: (getSelectedField(element, node) || {}).name };\n    },\n\n    set: function(element, values, node) {\n      var selectedField = getSelectedField(element, node);\n      return cmdHelper.updateBusinessObject(element, selectedField, { name : values.fieldName });\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n\n      var validation = {};\n      if (bo) {\n        var nameValue = values.fieldName;\n\n        if (nameValue) {\n          if (utils.containsSpace(nameValue)) {\n            validation.fieldName = 'Name must not contain spaces';\n          }\n        }\n        else {\n          validation.fieldName = 'Parameter must have a name';\n        }\n      }\n\n      return validation;\n    },\n\n    disabled: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  entries.push(entryFactory.selectBox({\n    id: 'listener-field-type',\n    label: 'Type',\n    selectOptions: fieldTypeOptions,\n    reference: reference,\n    modelProperty: 'fieldType',\n\n    get: function(element, node) {\n      var bo = getSelectedField(element, node);\n\n      var fieldType = getFieldType(bo);\n\n      return {\n        fieldType: fieldType\n      };\n    },\n\n    set: function(element, values, node) {\n      var props = assign({}, DEFAULT_PROPS);\n\n      var fieldType = values.fieldType;\n\n      if (fieldType === 'string') {\n        props.string = '';\n      }\n      else if (fieldType === 'expression') {\n        props.expression = '';\n      }\n\n      return cmdHelper.updateBusinessObject(element, getSelectedField(element, node), props);\n    },\n\n    disabled: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  entries.push(entryFactory.textBox({\n    id: 'listener-field-value',\n    label: 'Value',\n    reference: reference,\n    modelProperty: 'fieldValue',\n\n    get: function(element, node) {\n      var bo = getSelectedField(element, node);\n      var fieldType = getFieldType(bo);\n\n      var fieldValue;\n\n      if (fieldType === 'string') {\n        fieldValue = bo && (bo.string || bo.stringValue);\n      }\n      else if (fieldType === 'expression') {\n        fieldValue = bo && bo.expression;\n      }\n\n      return {\n        fieldValue: fieldValue\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n      var fieldType = getFieldType(bo);\n\n      var props = assign({}, DEFAULT_PROPS);\n\n      var fieldValue = values.fieldValue || undefined;\n\n      if (fieldType === 'string') {\n        props.string = fieldValue;\n      }\n      else if (fieldType === 'expression') {\n        props.expression = fieldValue;\n      }\n\n      return cmdHelper.updateBusinessObject(element, bo, props);\n\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n\n      var validation = {};\n      if (bo) {\n        if (!values.fieldValue) {\n          validation.fieldValue = 'Must provide a value';\n        }\n      }\n\n      return validation;\n    },\n\n    show: function(element, node) {\n      return isSelected(element, node);\n    }\n\n  }));\n\n  return entries;\n\n};\n","'use strict';\r\n\r\nvar ModelUtil = require('cmmn-js/lib/util/ModelUtil'),\r\n    getBusinessObject = ModelUtil.getBusinessObject,\r\n    isCasePlanModel = ModelUtil.isCasePlanModel;\r\n\r\nvar HistoryTimeToLiveProp = require('./implementation/HistoryTimeToLiveProp');\r\n\r\nmodule.exports = function(group, element, cmmnFactory, elementRegistry, itemRegistry, options) {\r\n\r\n  if (isCasePlanModel(element)) {\r\n    group.entries = group.entries.concat(HistoryTimeToLiveProp(element, {\r\n      getBusinessObject: function(element) {\r\n        return getBusinessObject(element).$parent;\r\n      }\r\n    }));\r\n  }\r\n\r\n};\r\n","var cmdHelper = require('../../../../helper/CmdHelper');\r\n\r\nvar entryFactory = require('../../../../factory/EntryFactory');\r\n\r\nmodule.exports = function(element, options) {\r\n\r\n  options = options || {};\r\n\r\n  var getBusinessObject = options.getBusinessObject;\r\n\r\n  var historyTimeToLiveEntry = entryFactory.textField({\r\n    id: 'historyTimeToLive',\r\n    label: 'History Time To Live',\r\n    modelProperty: 'historyTimeToLive',\r\n\r\n    get: function(element, node) {\r\n      var bo = getBusinessObject(element);\r\n      var historyTimeToLive = bo.get('camunda:historyTimeToLive');\r\n\r\n      return {\r\n        historyTimeToLive: historyTimeToLive ? historyTimeToLive : ''\r\n      };\r\n    },\r\n\r\n    set: function(element, values) {\r\n      var bo = getBusinessObject(element);\r\n\r\n      return cmdHelper.updateBusinessObject(element, bo, {\r\n        'camunda:historyTimeToLive': values.historyTimeToLive || undefined\r\n      });\r\n    }\r\n\r\n  });\r\n\r\n  return [ historyTimeToLiveEntry ];\r\n\r\n};\r\n","\nvar content = require(\"!!../../css-loader/index.js!../../less-loader/dist/cjs.js!./properties.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../css-loader/index.js!../../less-loader/dist/cjs.js!./properties.less\", function() {\n\t\tvar newContent = require(\"!!../../css-loader/index.js!../../less-loader/dist/cjs.js!./properties.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@font-face {\\n  font-family: 'cmmn-js-pp';\\n  src: url(\\\"data:;base64,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\\\");\\n  src: url(\\\"data:;base64,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\\\") format('embedded-opentype'), url(\\\"data:application/font-woff;base64,d09GRgABAAAAAAyIAA8AAAAAFWgAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABWAAAADMAAABCsP6z7U9TLzIAAAGMAAAAQwAAAFY+IkmhY21hcAAAAdAAAABxAAABxp3ZvixjdnQgAAACRAAAAAoAAAAKAAAAAGZwZ20AAAJQAAAFlAAAC3CIkJBZZ2FzcAAAB+QAAAAIAAAACAAAABBnbHlmAAAH7AAAAbkAAAIOhlzkXGhlYWQAAAmoAAAAMwAAADYI4qaLaGhlYQAACdwAAAAgAAAAJAeRA01obXR4AAAJ/AAAABwAAAAcFWn/+mxvY2EAAAoYAAAAEAAAABABmgINbWF4cAAACigAAAAgAAAAIACaC6BuYW1lAAAKSAAAAYsAAALlD9cCaXBvc3QAAAvUAAAASgAAAGj6fxaccHJlcAAADCAAAABlAAAAe91rA4V4nGNgZGBg4GKQY9BhYHRx8wlh4GBgYYAAkAxjTmZ6IlAMygPKsYBpDiBmg4gCAIojA08AeJxjYGTmZ5zAwMrAwFTFtIeBgaEHQjM+YDBkZAKKMrAyM2AFAWmuKQwOL5heMjMH/c9iiGIOYpgGFGYEyQEAxHoLQgB4nO2R0Q2AMAhEr9ASYxzFERzEEfxybjqFHuAY0rzmONI0OQAMAEp20oF2oyHqotvSV6zpdxzsFx4BXN2mPg+V+JgSKqtxvmJLJXzb+YOxMfy15X1+nUV2RSTtWmS6o4jNuBWxnSlFbG1qAXsB44UXWgAAAAAAAAAAAAAAAAAAAHicrVZpcxNHEJ3VYcs2PoIPEjaBWcZyjHZWmMsIEMbsShbgHPKV7EKOXUt27otP/Ab9ml6RVJFv/LS8Hh3YYCdVVChK/ab37Uz3655ek9CSxF5Yj6TcfCmmtjZpZOdJSDdsWo7iQ9nZCylTTP4uiIJotdS+7TgkIhKBqnWFJYLY98jSJONDjzJatiW9alJu6Ul32RoP6q369tPQUY7dCSU1m6FD65EtqcKoEkUy7ZGSNi3D1V9JWuHnK8x81QwlgugkksabYQyP5GfjjFYZrcZ2HEWRTZYbRYpEMzyIIo+yWmKfXDFBQPmgGVJe+TSifIQfkRV7lNMKccl2mt/3JT/pHc6/JOJ6i7IlB/5AdmQHe6cr+SLS2grjpp1sR6GK8HR9J8Qjm5Pqn+xRXtNo4HZFpifNCJbKV5BY+Qll9g/JauF8ypc8GtWSg5wIWi9zYl/yDrQeR0yJaybIgu6OToig7pecodhj+rj4471dLBchBMg4lvWOSrgQRilhs5okbQQ5iJKyRZXUekdMnPI6LeItYb9O7ehLZ7RJqDsxnq2Hjq2cqOR4NKnTTKZO7aTm0ZQGUUo6Ezzm1wGUH9Ekr7axmsTKo2lsM2MkkVCghXNpKohlJ5Y0BdE8mtGbu2Gaa9eiRZo8UM89ek9vboWbOz2n7cA/a/xndSqmg70wnZ4OyEp8mna5SdG6fnqGfybxQ9YCKpEtNsOUxUO2fgfl5WNLjsJrA2z3nvMr6H32RMikgfgb8B4v1SkFTIWYVVAL3bTWtSzL1GpWi1Rk6rshTStf1mkCTTkOfWNfxjj+r5kZS0wJ3+/E6dkRl5659iXINIfcZl2P5nVqsV2AzmzP6TTL9n2d5th+oNM82/M6HWFr63SU7Yc6LbD9SKdjbC9oQZPuOwRyEYFcwAYSgbB1EAjbSwiErUIgbBcRCNsiAmG7hEDYfoxA2C4jELaXtayafippHDsTywBFiAOjOe7IZW4qV1PJpRKui0anNuQpcqukonhW/SsD/eKRN6yBtUC6RNb8ikmufFSV44+uaHnTxLkCjlV/e3NcnxMPZb9Y+FPwv9qaqqRXrHlkchV5I9CT40TXJhWPrunyuapH1/+Lig5rgX4DpRALRVmWDb6ZkPBRp9NQDVzlEDMbMw/X9bplzc/h/JsYIQvofvw3FBoL3INOWUlZ7WCv1dePZbm3B+WwJ1iSYr7M61vhi4zMSvtFZil7PvJ5wBUwKpVhqw1creDNexLzkOlN8kwQtxVlg6SNx5kgsYFjHjBvvpMgJExdtYHaKZywgbxgzCnY74RDVG+U5XB7oX0ejZR/a1fsyBkVTRD4bfZG2OuzUPJbrIGEJ7/U10BVIU3FuKmASyPlhmrwYVyt20YyTqCvqNgNy7KKDx9H3HdKjmUg+UgRq0dHP629Qp3Uuf3KKG7fO/0IgkFpYv72vpnioJR3tZJlVm0DU7calVPXmsPFqw7dzaPue8fZJ3LWNN10T9z0vqZVt4ODuVkQ7dsclKVMLqjrww4bqMvNpdDqZVyS3nYPMCwwoN+hFRv/V/dx+DxXqgqj40i9nagfo89iDPIPOH9H9QXo5zFMuYaU53uXE59u3MPZMl3FXayf4t/ArLXmZukacEPTDZiHrFodusoNfKcGOj3S3I70EPCx7grxAGATwGLwie5axvMpgPF8xhwf4HPmMGgyh8EWcxhsM2cNYIc5DHaZw2CPOQy+YM46wJfMYRAyh0HEHAZPmBMAPGUOg6+Yw+Br5jD4hjn3Ab5lDoOYOQwS5jDY13RrKHOLF3QXqG1QFejA9BMW97A41FQZsr/jhWF/bxCzfzCIqT9quj2k/sQLQ/3ZIKb+YhBTf9V0Z0j9jReG+rtBTP3DIKY+0y/GcpnBX0a+S4UDyi42n/P3xPsHwhpAtgABAAH//wAPeJxlUM9rE0EY/b6ZuLukTTs7O7sJxcZ1Nk2gaVOY/NiDiBcP0oMHDyGHniT0mD8h5BCk5ORxWaSnnjwUUdtCwUVKoSXHIv4BHv0D9iCaOJuAKA7DG943M++97wMEvfAreQmbYHxwKO7WtzxhyD00DVmrtp6ghrCjHqAGT6wjXvOK4uMxV5yxyYQxvmQVPrniSrIoWpTeHC8eaCYVP9YWmQ95SkbgaB9maB9Uoo6ukI8xkK1H2G6pTSTVcvmuf5cBvl6eGeivAPMrKsl3sGEDrLOSWM2RLOs6GntoBLLKOr7nCnNLeKrTqkqD5sqlRsVP9l+Mko8Inxuz0tG7od7P5f2G7yfbCcJ5Murtv+0dDd+/GgLQ+Y/5Ob2hFqwCAwH5C26vFfKE7tbveUbwUM8jxI4qOu3ADe3App/yQvwc83xhBRNrx9oYDAYlJhlndI3zX5V+/xR3Zl8W2S/pM0rA0qrWmb2SA5L17zHD17kxrJk1s2gWw2KIJ6dpOjtJU8zF3TjqxXEviruULGsH6ewg7kaRvskQ4D9tp/CvttNsBzpu4Dbd5h/tb7e3h9Pp4V+q2xmf/gaaAYe+AAAAeJxjYGRgYADiVL7Tf+L5bb4ycDO/AIowXPqwsQRG///1fxvzC2YOIJeDgQkkCgCeTA9OAHicY2BkYGAO+p/FEMX84v+v/5+ZXzAARVAAOwC+sAfjA+gAAAHWAAACRAAAAxUAAAPC//oDSAAAA0gAAAAAAAAANABUAIYAsgDgAQcAAQAAAAcAHgADAAAAAAACAAAAEABzAAAAHAtwAAAAAHicdZLNSgMxFIVPbKvYggsV3WYlSun0BxTsRqGgK0FcdOFu2qYzU6ZJyKRKn8E38B18JcE38XQarEKdMJnvnpzcexMGwCE+IbB+LvmuWaDOaM072MNN4Ar1u8BV8mPgGhp4DrxLXQWuowkTuIEjvDODqO4zmuEjsMCxOA28gwPRDFyhfh24Sn4IXMOJiAPvUn8NXMdQvAVu4Ex8DYxduixJvTwfXMhep3slR0tpKGU6zmW88KlxhbyVU6O9ynMTjc18ZOe6lZmWtU8qWeSx2wgbGipXZEbLbtTZiPdKKxd7NVlVKV6SnvdTOXVmLu9Cfmmdmamxj1Lvbb/d/l0XA16UxRIOGRKk8JA4p3rBbw8ddHFFGtEh6Vy7MmjEyKnEWHBHWq4UjG/5ThlpqoqOnBxhzHnOHJazRov7DWfL8URXwhw5M7mtjm3akLtW9bKykmSPETvd5rynU5fuuOxo8nOWAi+s3KPq2fGqa1d2Kfmj/e1fMs9qbUZlTD0qb8lT7aPN8c95vwGTUof7AHicY2BigAAuBuyAnZGJkZmRhZGVkY2RnZGDgTU5JzWxiDkxJYWtGMhIzuBMLClJzSvJzM/jBUvpJmcWARkp3EAlMDYDAwAmBxMfAAB4nGPw3sFwIihiIyNjX+QGxp0cDBwMyQUbGVidNjIwaEFoDhR6JwMDAycyi5nBZaMKY0dgxAaHjoiNzCkuG9VAvF0cDQyMLA4dySERICWRQLCRgUdrB+P/1g0svRuZGFwAB9MiuAAAAA==\\\") format('woff'), url(\\\"data:application/x-font-ttf;base64,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IDxZIyAuRrACJUZQWCA8WS6xKwEUKy2wPiywNSsjIC5GsAIlRlJYIDxZLrErARQrLbA/LLA2K4ogIDywBCNCijgjIC5GsAIlRlJYIDxZLrErARQrsARDLrArKy2wQCywABawBCWwBCYgLkcjRyNhsAlDKyMgPCAuIzixKwEUKy2wQSyxCAQlQrAAFrAEJbAEJSAuRyNHI2EgsAQjQrAJQysgsGBQWCCwQFFYswIgAyAbswImAxpZQkIjIEewBEOwAmIgsABQWLBAYFlmsAFjYCCwASsgiophILACQ2BkI7ADQ2FkUFiwAkNhG7ADQ2BZsAMlsAJiILAAUFiwQGBZZrABY2GwAiVGYTgjIDwjOBshICBGI0ewASsjYTghWbErARQrLbBCLLA1Ky6xKwEUKy2wQyywNishIyAgPLAEI0IjOLErARQrsARDLrArKy2wRCywABUgR7AAI0KyAAEBFRQTLrAxKi2wRSywABUgR7AAI0KyAAEBFRQTLrAxKi2wRiyxAAEUE7AyKi2wRyywNCotsEgssAAWRSMgLiBGiiNhOLErARQrLbBJLLAII0KwSCstsEossgAAQSstsEsssgABQSstsEwssgEAQSstsE0ssgEBQSstsE4ssgAAQistsE8ssgABQistsFAssgEAQistsFEssgEBQistsFIssgAAPistsFMssgABPistsFQssgEAPistsFUssgEBPistsFYssgAAQCstsFcssgABQCstsFgssgEAQCstsFkssgEBQCstsFossgAAQystsFsssgABQystsFwssgEAQystsF0ssgEBQystsF4ssgAAPystsF8ssgABPystsGAssgEAPystsGEssgEBPystsGIssDcrLrErARQrLbBjLLA3K7A7Ky2wZCywNyuwPCstsGUssAAWsDcrsD0rLbBmLLA4Ky6xKwEUKy2wZyywOCuwOystsGgssDgrsDwrLbBpLLA4K7A9Ky2waiywOSsusSsBFCstsGsssDkrsDsrLbBsLLA5K7A8Ky2wbSywOSuwPSstsG4ssDorLrErARQrLbBvLLA6K7A7Ky2wcCywOiuwPCstsHEssDorsD0rLbByLLMJBAIDRVghGyMhWUIrsAhlsAMkUHiwARUwLQBLuADIUlixAQGOWbABuQgACABjcLEABUKxAAAqsQAFQrEACCqxAAVCsQAIKrEABUK5AAAACSqxAAVCuQAAAAkqsQMARLEkAYhRWLBAiFixA2REsSYBiFFYugiAAAEEQIhjVFixAwBEWVlZWbEADCq4Af+FsASNsQIARAA=\\\") format('truetype'), url(\\\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxtZXRhZGF0YT5Db3B5cmlnaHQgKEMpIDIwMTYgYnkgb3JpZ2luYWwgYXV0aG9ycyBAIGZvbnRlbGxvLmNvbTwvbWV0YWRhdGE+CjxkZWZzPgo8Zm9udCBpZD0iYnBtbi1pby1wcCIgaG9yaXotYWR2LXg9IjEwMDAiID4KPGZvbnQtZmFjZSBmb250LWZhbWlseT0iYnBtbi1pby1wcCIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1zdHJldGNoPSJub3JtYWwiIHVuaXRzLXBlci1lbT0iMTAwMCIgYXNjZW50PSI4NTAiIGRlc2NlbnQ9Ii0xNTAiIC8+CjxtaXNzaW5nLWdseXBoIGhvcml6LWFkdi14PSIxMDAwIiAvPgo8Z2x5cGggZ2x5cGgtbmFtZT0iY2xlYXIiIHVuaWNvZGU9IiYjeGU4MDI7IiBkPSJNNDUyIDE5NHExOC0xOCAxOC00M3QtMTgtNDNxLTE4LTE2LTQzLTE2dC00MyAxNmwtMTMyIDE1Mi0xMzItMTUycS0xOC0xNi00My0xNnQtNDMgMTZxLTE2IDE4LTE2IDQzdDE2IDQzbDEzOCAxNTYtMTM4IDE1OHEtMTYgMTgtMTYgNDN0MTYgNDNxMTggMTYgNDMgMTZ0NDMtMTZsMTMyLTE1MiAxMzIgMTUycTE4IDE2IDQzIDE2dDQzLTE2cTE4LTE4IDE4LTQzdC0xOC00M2wtMTM4LTE1OHoiIGhvcml6LWFkdi14PSI0NzAiIC8+CjxnbHlwaCBnbHlwaC1uYW1lPSJhZGQiIHVuaWNvZGU9IiYjeGU4MDM7IiBkPSJNNTUwIDQwMHEzMCAwIDMwLTUwdC0zMC01MGwtMjEwIDAgMC0yMTBxMC0zMC01MC0zMHQtNTAgMzBsMCAyMTAtMjEwIDBxLTMwIDAtMzAgNTB0MzAgNTBsMjEwIDAgMCAyMTBxMCAzMCA1MCAzMHQ1MC0zMGwwLTIxMCAyMTAgMHoiIGhvcml6LWFkdi14PSI1ODAiIC8+CjxnbHlwaCBnbHlwaC1uYW1lPSJzZWFyY2giIHVuaWNvZGU9IiYjeGU4MDU7IiBkPSJNNzcyIDc4cTMwLTM0IDYtNjJsLTQ2LTQ2cS0zNi0zMi02OCAwbC0xOTAgMTkwcS03NC00Mi0xNTYtNDItMTI4IDAtMjIzIDk1dC05NSAyMjMgOTAgMjE5IDIxOCA5MSAyMjQtOTUgOTYtMjIzcTAtODgtNDYtMTYyeiBtLTY3OCAzNThxMC04OCA2OC0xNTZ0MTU2LTY4IDE1MSA2MyA2MyAxNTNxMCA4OC02OCAxNTV0LTE1NiA2Ny0xNTEtNjMtNjMtMTUxeiIgaG9yaXotYWR2LXg9Ijc4OSIgLz4KPGdseXBoIGdseXBoLW5hbWU9ImF0dGVudGlvbiIgdW5pY29kZT0iJiN4ZTgwNjsiIGQ9Ik05NTctMjRxMTAtMTYgMC0zNC0xMC0xNi0zMC0xNmwtODkyIDBxLTE4IDAtMjggMTYtMTMgMTgtMiAzNGw0NDYgNzgycTggMTggMzAgMTh0MzAtMTh6IG0tNDIwIDUwbDAgMTAwLTExMCAwIDAtMTAwIDExMCAweiBtMCAxNzRsMCAzMDAtMTEwIDAgMC0zMDAgMTEwIDB6IiBob3Jpei1hZHYteD0iOTYyIiAvPgo8Z2x5cGggZ2x5cGgtbmFtZT0iY2xlYXItY2lyY2xlZCIgdW5pY29kZT0iJiN4ZTkwMjsiIGQ9Ik00MjAgNzcwcTE3NCAwIDI5Ny0xMjN0MTIzLTI5Ny0xMjMtMjk3LTI5Ny0xMjMtMjk3IDEyMy0xMjMgMjk3IDEyMyAyOTcgMjk3IDEyM3ogbTg2LTQyMGwxNTQgMTU0LTg2IDg2LTE1NC0xNTItMTUyIDE1Mi04OC04NiAxNTQtMTU0LTE1NC0xNTIgODgtODYgMTUyIDE1MiAxNTQtMTUyIDg2IDg2eiIgaG9yaXotYWR2LXg9Ijg0MCIgLz4KPGdseXBoIGdseXBoLW5hbWU9ImFkZC1jaXJjbGVkIiB1bmljb2RlPSImI3hlOTAzOyIgZD0iTTQyMCA3NzBxMTc0IDAgMjk3LTEyM3QxMjMtMjk3LTEyMy0yOTctMjk3LTEyMy0yOTcgMTIzLTEyMyAyOTcgMTIzIDI5NyAyOTcgMTIzeiBtNTItNDcwbDIwMCAwIDAgMTAyLTIwMCAwIDAgMjAyLTEwMiAwIDAtMjAyLTIwMiAwIDAtMTAyIDIwMiAwIDAtMjAyIDEwMiAwIDAgMjAyeiIgaG9yaXotYWR2LXg9Ijg0MCIgLz4KPC9mb250Pgo8L2RlZnM+Cjwvc3ZnPg==\\\") format('svg');\\n  font-weight: normal;\\n  font-style: normal;\\n}\\n.cpp-properties-panel {\\n  background-color: #f8f8f8;\\n  position: relative;\\n}\\n.cpp-properties-panel:empty {\\n  display: none;\\n}\\n.cpp-properties-panel label,\\n.cpp-properties-panel input {\\n  vertical-align: middle;\\n}\\n.cpp-properties-panel input,\\n.cpp-properties-panel button,\\n.cpp-properties-panel textarea,\\n.cpp-properties-panel [contenteditable] {\\n  padding: 3px 6px;\\n  border: 1px solid #ccc;\\n}\\n.cpp-properties-panel input:focus,\\n.cpp-properties-panel button:focus,\\n.cpp-properties-panel textarea:focus,\\n.cpp-properties-panel [contenteditable]:focus {\\n  outline: none;\\n  border-color: #52B415;\\n  box-shadow: 0 0 1px 2px rgba(82, 180, 21, 0.2);\\n}\\n.cpp-properties-panel input.invalid,\\n.cpp-properties-panel button.invalid,\\n.cpp-properties-panel textarea.invalid,\\n.cpp-properties-panel [contenteditable].invalid {\\n  border-color: #cc3333;\\n  background: #f0c2c2;\\n}\\n.cpp-properties-panel input.invalid:focus,\\n.cpp-properties-panel button.invalid:focus,\\n.cpp-properties-panel textarea.invalid:focus,\\n.cpp-properties-panel [contenteditable].invalid:focus {\\n  box-shadow: 0 0 1px 2px rgba(204, 51, 51, 0.2);\\n}\\n.cpp-properties-panel input.warning:focus,\\n.cpp-properties-panel button.warning:focus,\\n.cpp-properties-panel textarea.warning:focus,\\n.cpp-properties-panel [contenteditable].warning:focus {\\n  border-color: #ec971f;\\n  box-shadow: 0 0 1px 2px rgba(236, 151, 31, 0.2);\\n}\\n.cpp-properties-panel [type=text],\\n.cpp-properties-panel [contenteditable],\\n.cpp-properties-panel textarea,\\n.cpp-properties-panel select {\\n  width: 100%;\\n}\\n.cpp-properties-panel [contenteditable],\\n.cpp-properties-panel textarea {\\n  resize: vertical;\\n}\\n.cpp-properties-panel [contenteditable] {\\n  outline: 0px solid transparent;\\n  background-color: white;\\n  overflow-y: auto;\\n  white-space: pre-wrap;\\n  /* css-3 */\\n  white-space: -moz-pre-wrap;\\n  /* Mozilla, since 1999 */\\n  white-space: -pre-wrap;\\n  /* Opera 4-6 */\\n  white-space: -o-pre-wrap;\\n  /* Opera 7 */\\n  word-wrap: break-word;\\n  /* Internet Explorer 5.5+ */\\n}\\n.cpp-properties-panel label {\\n  font-weight: bolder;\\n  display: inline-block;\\n  vertical-align: middle;\\n  color: #666;\\n}\\n.cpp-properties-panel label[for] {\\n  cursor: pointer;\\n}\\n.cpp-properties-panel label.cpp-hidden {\\n  display: none;\\n}\\n.cpp-properties-panel .entry-label {\\n  font-weight: bolder;\\n  display: inline-block;\\n  vertical-align: middle;\\n  color: #666;\\n  font-size: 120%;\\n  margin-top: 5px;\\n  margin-bottom: 10px;\\n  transition: margin 0.218s linear;\\n  font-style: italic;\\n}\\n.cpp-properties-panel .entry-label[for] {\\n  cursor: pointer;\\n}\\n.cpp-properties-panel .entry-label.cpp-hidden {\\n  display: none;\\n}\\n.cpp-properties-panel .entry-label.divider {\\n  border-top: 1px dotted #ccc;\\n  padding-top: 8px;\\n  margin-top: 16px;\\n  width: 100%;\\n}\\n.cpp-properties-panel button {\\n  position: absolute;\\n  top: 0;\\n  height: 23px;\\n  width: 24px;\\n  overflow: hidden;\\n  cursor: pointer;\\n  background-color: #f8f8f8;\\n  border: 1px solid #ccc;\\n}\\n.cpp-properties-panel button > span {\\n  display: none;\\n}\\n.cpp-properties-panel button:before {\\n  font-family: \\\"cmmn-js-pp\\\";\\n  font-style: normal;\\n  font-weight: normal;\\n  speak: none;\\n  display: inline-block;\\n  text-decoration: inherit;\\n  text-align: center;\\n  font-variant: normal;\\n  text-transform: none;\\n  line-height: 1em;\\n  -webkit-font-smoothing: antialiased;\\n  -moz-osx-font-smoothing: grayscale;\\n  position: relative;\\n}\\n.cpp-properties-panel button.add:before {\\n  content: '\\\\E803';\\n}\\n.cpp-properties-panel button.clear:before {\\n  content: '\\\\E802';\\n}\\n.cpp-properties-panel button:hover {\\n  color: #52B415;\\n}\\n.cpp-warning-message {\\n  color: #ec971f;\\n}\\n.cpp-error-message,\\n.cpp-error-message.cpp-entry-link {\\n  color: #cc3333;\\n}\\n.cpp-row {\\n  margin-top: 10px;\\n  margin-bottom: 10px;\\n}\\n.cpp-row:first-of-type {\\n  margin-top: 0;\\n}\\n.cpp-row:last-of-type {\\n  margin-bottom: 0;\\n}\\n.cpp-action button {\\n  position: relative;\\n  margin-left: 10px;\\n}\\n.cpp-textfield,\\n.cpp-textbox {\\n  margin-bottom: 3px;\\n}\\n.cpp-radios-group {\\n  list-style: none;\\n  padding: 0;\\n  margin: 0 0 9px 0;\\n}\\n.cpp-radios-group .cpp-radio-wrapper {\\n  margin: 6px 0;\\n}\\n.cpp-radios-group input,\\n.cpp-radios-group label {\\n  vertical-align: middle;\\n}\\n.cpp-radios-group input {\\n  margin-top: 0;\\n  margin-left: 0;\\n}\\n.cpp-radios-group input,\\n.cpp-checkbox input {\\n  margin-left: 0;\\n}\\n.cpp-radios-group label:after,\\n.cpp-checkbox label:after {\\n  display: none;\\n}\\n.cpp-textfield input {\\n  padding-right: 28px;\\n}\\n.cpp-textfield .clear {\\n  background: transparent;\\n  border: none;\\n  top: 0;\\n  right: 0;\\n}\\n.cpp-combo-input {\\n  margin-top: 7px;\\n}\\n.cpp-select select {\\n  height: 23px;\\n}\\n.cpp-select button.add {\\n  top: -22px;\\n  right: 0;\\n}\\n.cpp-select button.add,\\n.cpp-element-list button.add,\\n.cpp-select button.clear,\\n.cpp-element-list button.clear {\\n  top: -23px;\\n  border-bottom: none;\\n}\\n.cpp-select button.add,\\n.cpp-element-list button.add {\\n  right: 0px;\\n}\\n.cpp-select button.clear,\\n.cpp-element-list button.clear {\\n  right: 23px;\\n}\\n.cpp-properties-entry {\\n  margin-bottom: 9px;\\n}\\n.cpp-properties-entry .cpp-field-wrapper {\\n  position: relative;\\n}\\n.cpp-properties-entry .cpp-field-wrapper input[readonly] + .clear {\\n  display: none;\\n}\\n.cpp-hidden {\\n  display: none;\\n}\\nlabel.cpp-hidden {\\n  display: none;\\n}\\n.cpp-table-add-row > button {\\n  position: relative;\\n  margin-left: 10px;\\n}\\n.cpp-table {\\n  margin-top: 10px;\\n}\\n.cpp-table-row {\\n  margin-bottom: 2px;\\n  overflow: hidden;\\n}\\n.cpp-table-row > input,\\n.cpp-table-row > button {\\n  float: left;\\n}\\n.cpp-table-row > label {\\n  padding-left: 5px;\\n}\\n.cpp-table-row > label.cpp-table-row-columns-1,\\n.cpp-table-row > input.cpp-table-row-columns-1 {\\n  width: 100%;\\n}\\n.cpp-table-row > label.cpp-table-row-columns-1.cpp-table-row-removable,\\n.cpp-table-row > input.cpp-table-row-columns-1.cpp-table-row-removable {\\n  width: calc(100% - 24px);\\n}\\n.cpp-table-row > label.cpp-table-row-columns-2,\\n.cpp-table-row > input.cpp-table-row-columns-2 {\\n  width: 50%;\\n}\\n.cpp-table-row > label.cpp-table-row-columns-2.cpp-table-row-removable,\\n.cpp-table-row > input.cpp-table-row-columns-2.cpp-table-row-removable {\\n  width: calc(50% - 12px);\\n}\\n.cpp-table-row > label.cpp-table-row-columns-2:nth-child(2),\\n.cpp-table-row > input.cpp-table-row-columns-2:nth-child(2) {\\n  border-left: none;\\n}\\n.cpp-table-row > button {\\n  border-left: none;\\n  position: static;\\n}\\n.cpp-properties-static {\\n  margin-bottom: 0;\\n  margin-top: 0;\\n  border: 1px solid #ccc;\\n  background-color: white;\\n  padding: 3px 6px;\\n  font: 13.3333px Arial;\\n  width: 100%;\\n}\\n.cpp-entry-hint,\\n.cpp-entry-link {\\n  cursor: pointer;\\n  color: #52B415;\\n}\\n.cpp-icon-warning:before {\\n  font-family: \\\"cmmn-js-pp\\\";\\n  font-style: normal;\\n  font-weight: normal;\\n  speak: none;\\n  display: inline-block;\\n  text-decoration: inherit;\\n  text-align: center;\\n  font-variant: normal;\\n  text-transform: none;\\n  line-height: 1em;\\n  -webkit-font-smoothing: antialiased;\\n  -moz-osx-font-smoothing: grayscale;\\n  content: '\\\\E806';\\n}\\n.cpp-field-description {\\n  margin-top: 5px;\\n  color: #999;\\n}\\n.cpp-field-description a {\\n  color: #3d8610;\\n  text-decoration: none;\\n}\\n.cpp-field-description a:hover {\\n  color: #52B415;\\n}\\n.cpp-properties-header {\\n  padding: 15px;\\n  padding-bottom: 5px;\\n}\\n.cpp-properties-header > .label {\\n  font-size: 120%;\\n  font-weight: bolder;\\n}\\n.cpp-properties-header > .search {\\n  display: none;\\n  margin-top: 5px;\\n  position: relative;\\n}\\n.cpp-properties-header > .search input {\\n  position: relative;\\n  border-radius: 15px;\\n  width: 100%;\\n  z-index: 1;\\n}\\n.cpp-properties-header > .search button {\\n  position: absolute;\\n  top: 0;\\n  bottom: 0;\\n  right: 0;\\n  border: none;\\n  background-color: transparent;\\n  z-index: 2;\\n}\\n.cpp-properties-header > .search button:before {\\n  content: '\\\\E805';\\n}\\n.cpp-properties-group {\\n  padding: 6px 15px 6px 15px;\\n  position: relative;\\n  overflow: hidden;\\n  transition: max-height 0.218s ease-in-out, padding-top 0.218s ease-in-out, padding-bottom 0.218s ease-in-out;\\n}\\n.cpp-properties-group:empty {\\n  display: none;\\n}\\n.cpp-properties-group > .group-toggle {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  bottom: 0;\\n  width: 4px;\\n  cursor: pointer;\\n  transition: background-color 0.218s linear;\\n}\\n.cpp-properties-group > .group-toggle:hover {\\n  background-color: #8fc071;\\n}\\n.cpp-properties-group > .group-label {\\n  font-weight: bolder;\\n  display: inline-block;\\n  vertical-align: middle;\\n  color: #666;\\n  font-size: 120%;\\n  margin-top: 5px;\\n  margin-bottom: 10px;\\n  transition: margin 0.218s linear;\\n  font-style: italic;\\n}\\n.cpp-properties-group > .group-label[for] {\\n  cursor: pointer;\\n}\\n.cpp-properties-group > .group-label.cpp-hidden {\\n  display: none;\\n}\\n.cpp-properties-group:hover > .group-toggle {\\n  background-color: #ccc;\\n}\\n.cpp-properties-group:hover > .group-toggle:hover {\\n  background-color: #8fc071;\\n}\\n.cpp-properties-group.group-closed {\\n  max-height: 20px;\\n  border-top: none;\\n  cursor: pointer;\\n  background-color: rgba(143, 192, 113, 0.2);\\n  padding-top: 0;\\n  padding-bottom: 0;\\n}\\n.cpp-properties-group.group-closed > div {\\n  visibility: hidden;\\n}\\n.cpp-properties-group.group-closed > .group-label {\\n  margin-top: 2px;\\n  margin-bottom: 2px;\\n}\\n.cpp-properties-group.group-closed:hover > .group-label {\\n  color: #52B415;\\n}\\n.cpp-properties-group + .cpp-properties-group {\\n  border-top: 1px dotted #ccc;\\n}\\n.cpp-properties-group:last-child {\\n  padding-bottom: 9px;\\n}\\n.cpp-properties-tab-bar {\\n  border-bottom: 1px solid #ccc;\\n  padding: 0 15px;\\n}\\n.cpp-properties-tab-bar .scroll-tabs-button {\\n  cursor: pointer;\\n  font-size: 16px;\\n  padding: 3px 4px 3px 4px;\\n  color: #666;\\n}\\n.cpp-properties-tab-bar .scroll-tabs-button:hover {\\n  font-weight: bold;\\n}\\n.cpp-properties-tab-bar .scroll-tabs-button.scroll-tabs-left {\\n  float: left;\\n  margin-left: -15px;\\n}\\n.cpp-properties-tab-bar .scroll-tabs-button.scroll-tabs-right {\\n  float: right;\\n  margin-right: -15px;\\n}\\n.cpp-properties-tab-bar:not(.scroll-tabs-overflow) .scroll-tabs-button {\\n  display: none;\\n}\\nul.cpp-properties-tabs-links {\\n  margin: 5px 0 -1px 0;\\n  padding: 0;\\n  white-space: nowrap;\\n  overflow: hidden;\\n}\\nul.cpp-properties-tabs-links > li {\\n  display: inline-block;\\n  margin: 0;\\n}\\nul.cpp-properties-tabs-links > li.cpp-hidden {\\n  display: none;\\n}\\nul.cpp-properties-tabs-links > li > a {\\n  display: inline-block;\\n  font-size: 12px;\\n  padding: 4px 7px;\\n  border: 1px solid #ccc;\\n  border-radius: 3px 3px 0 0;\\n  border-bottom: transparent;\\n  background-color: #f8f8f8;\\n  color: #666;\\n  text-decoration: none;\\n}\\nul.cpp-properties-tabs-links > li > a:hover {\\n  color: #4d4d4d;\\n}\\nul.cpp-properties-tabs-links > li + li {\\n  margin-left: 4px;\\n}\\nul.cpp-properties-tabs-links > li.cpp-active a {\\n  padding-bottom: 5px;\\n  border-top: 2px solid #52B415;\\n  border-bottom: none;\\n}\\n.cpp-properties-tab,\\n.cpp-properties-tab.cpp-hidden {\\n  display: none;\\n}\\n.cpp-properties-tab.cpp-active {\\n  display: block;\\n}\\n\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../css-loader/index.js!./diagram-js.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../css-loader/index.js!./diagram-js.css\", function() {\n\t\tvar newContent = require(\"!!../../../css-loader/index.js!./diagram-js.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"/**\\n * outline styles\\n */\\n\\n.djs-outline {\\n  fill: none;\\n  visibility: hidden;\\n}\\n\\n.djs-element.hover .djs-outline,\\n.djs-element.selected .djs-outline {\\n  visibility: visible;\\n  shape-rendering: crispEdges;\\n  stroke-dasharray: 3,3;\\n}\\n\\n.djs-element.selected .djs-outline {\\n  stroke: #8888FF;\\n  stroke-width: 1px;\\n}\\n\\n.djs-element.hover .djs-outline {\\n  stroke: #FF8888;\\n  stroke-width: 1px;\\n}\\n\\n.djs-shape.connect-ok .djs-visual > :nth-child(1) {\\n  fill: #DCFECC /* light-green */ !important;\\n}\\n\\n.djs-shape.connect-not-ok .djs-visual > :nth-child(1),\\n.djs-shape.drop-not-ok .djs-visual > :nth-child(1) {\\n  fill: #f9dee5 /* light-red */ !important;\\n}\\n\\n.djs-shape.new-parent .djs-visual > :nth-child(1) {\\n  fill: #F7F9FF !important;\\n}\\n\\nsvg.drop-not-ok {\\n  background: #f9dee5 /* light-red */ !important;\\n}\\n\\nsvg.new-parent {\\n  background: #F7F9FF /* light-blue */ !important;\\n}\\n\\n.djs-connection.connect-ok .djs-visual > :nth-child(1),\\n.djs-connection.drop-ok .djs-visual > :nth-child(1) {\\n  stroke: #90DD5F /* light-green */ !important;\\n}\\n\\n.djs-connection.connect-not-ok .djs-visual > :nth-child(1),\\n.djs-connection.drop-not-ok .djs-visual > :nth-child(1) {\\n  stroke: #E56283 /* light-red */ !important;\\n}\\n\\n.drop-not-ok,\\n.connect-not-ok {\\n  cursor: not-allowed;\\n}\\n\\n.djs-element.attach-ok .djs-visual > :nth-child(1) {\\n  stroke-width: 5px !important;\\n  stroke: rgba(255, 116, 0, 0.7) !important;\\n}\\n\\n.djs-frame.connect-not-ok .djs-visual > :nth-child(1),\\n.djs-frame.drop-not-ok .djs-visual > :nth-child(1) {\\n  stroke-width: 3px !important;\\n  stroke: #E56283 /* light-red */ !important;\\n  fill: none !important;\\n}\\n\\n/**\\n* Selection box style\\n*\\n*/\\n.djs-lasso-overlay {\\n  fill: rgb(255, 116, 0);\\n  fill-opacity: 0.1;\\n\\n  stroke-dasharray: 5 1 3 1;\\n  stroke: rgb(255, 116, 0);\\n\\n  shape-rendering: crispEdges;\\n  pointer-events: none;\\n}\\n\\n/**\\n * Resize styles\\n */\\n.djs-resize-overlay {\\n  fill: none;\\n\\n  stroke-dasharray: 5 1 3 1;\\n  stroke: rgb(255, 116, 0);\\n\\n  pointer-events: none;\\n}\\n\\n.djs-resizer-hit {\\n  fill: none;\\n  pointer-events: all;\\n}\\n\\n.djs-resizer-visual {\\n  fill: white;\\n  stroke-width: 1px;\\n  stroke: black;\\n  shape-rendering: crispEdges;\\n  stroke-opacity: 0.2;\\n}\\n\\n.djs-cursor-resize-nwse,\\n.djs-resizer-nw,\\n.djs-resizer-se {\\n  cursor: nwse-resize;\\n}\\n\\n.djs-cursor-resize-nesw,\\n.djs-resizer-ne,\\n.djs-resizer-sw {\\n  cursor: nesw-resize;\\n}\\n\\n.djs-shape.djs-resizing > .djs-outline {\\n  visibility: hidden !important;\\n}\\n\\n.djs-shape.djs-resizing > .djs-resizer {\\n  visibility: hidden;\\n}\\n\\n.djs-dragger > .djs-resizer {\\n  visibility: hidden;\\n}\\n\\n/**\\n * drag styles\\n */\\n.djs-dragger * {\\n  fill: none !important;\\n  stroke: rgb(255, 116, 0) !important;\\n}\\n\\n.djs-dragger tspan,\\n.djs-dragger text {\\n  fill: rgb(255, 116, 0) !important;\\n  stroke: none !important;\\n}\\n\\nmarker.djs-dragger circle,\\nmarker.djs-dragger path,\\nmarker.djs-dragger polygon,\\nmarker.djs-dragger polyline,\\nmarker.djs-dragger rect {\\n  fill: rgb(255, 116, 0) !important;\\n  stroke: none !important;\\n}\\n\\nmarker.djs-dragger text,\\nmarker.djs-dragger tspan {\\n  fill: none !important;\\n  stroke: rgb(255, 116, 0) !important;\\n}\\n\\n.djs-dragging {\\n  opacity: 0.3;\\n}\\n\\n.djs-dragging,\\n.djs-dragging > * {\\n  pointer-events: none !important;\\n}\\n\\n.djs-dragging .djs-context-pad,\\n.djs-dragging .djs-outline {\\n  display: none !important;\\n}\\n\\n/**\\n * no pointer events for visual\\n */\\n.djs-visual,\\n.djs-outline {\\n  pointer-events: none;\\n}\\n\\n.djs-element.attach-ok .djs-hit {\\n  stroke-width: 60px !important;\\n}\\n\\n/**\\n * all pointer events for hit shape\\n */\\n.djs-shape .djs-hit {\\n  pointer-events: all;\\n}\\n\\n.djs-connection .djs-hit {\\n  pointer-events: stroke;\\n}\\n\\n.djs-frame .djs-hit {\\n  pointer-events: stroke;\\n}\\n\\n/**\\n * shape / connection basic styles\\n */\\n.djs-connection .djs-visual {\\n  stroke-width: 2px;\\n  fill: none;\\n}\\n\\n.djs-cursor-grab {\\n  cursor: -webkit-grab;\\n  cursor: -moz-grab;\\n  cursor: grab;\\n}\\n\\n.djs-cursor-grabbing {\\n  cursor: -webkit-grabbing;\\n  cursor: -moz-grabbing;\\n  cursor: grabbing;\\n}\\n\\n.djs-cursor-crosshair {\\n  cursor: crosshair;\\n}\\n\\n.djs-cursor-move {\\n  cursor: move;\\n}\\n\\n.djs-cursor-resize-ns {\\n  cursor: ns-resize;\\n}\\n\\n.djs-cursor-resize-ew {\\n  cursor: ew-resize;\\n}\\n\\n\\n/**\\n * snapping\\n */\\n.djs-snap-line {\\n  stroke: rgb(255, 195, 66);\\n  stroke: rgba(255, 195, 66, 0.50);\\n  stroke-linecap: round;\\n  stroke-width: 2px;\\n  pointer-events: none;\\n}\\n\\n/**\\n * snapping\\n */\\n.djs-crosshair {\\n  stroke: #555;\\n  stroke-linecap: round;\\n  stroke-width: 1px;\\n  pointer-events: none;\\n  shape-rendering: crispEdges;\\n  stroke-dasharray: 5, 5;\\n}\\n\\n/**\\n * palette\\n */\\n\\n.djs-palette {\\n  position: absolute;\\n  left: 20px;\\n  top: 20px;\\n\\n  box-sizing: border-box;\\n  width: 48px;\\n}\\n\\n.djs-palette .separator {\\n  margin: 0 5px;\\n  padding-top: 5px;\\n\\n  border: none;\\n  border-bottom: solid 1px #DDD;\\n\\n  clear: both;\\n}\\n\\n.djs-palette .entry:before {\\n  vertical-align: text-bottom;\\n}\\n\\n.djs-palette .djs-palette-toggle {\\n  cursor: pointer;\\n}\\n\\n.djs-palette .entry,\\n.djs-palette .djs-palette-toggle {\\n  color: #333;\\n  font-size: 30px;\\n\\n  text-align: center;\\n}\\n\\n.djs-palette .entry {\\n  float: left;\\n}\\n\\n.djs-palette .entry img {\\n  max-width: 100%;\\n}\\n\\n.djs-palette .djs-palette-entries:after {\\n  content: '';\\n  display: table;\\n  clear: both;\\n}\\n\\n.djs-palette .djs-palette-toggle:hover {\\n  background: #666;\\n}\\n\\n.djs-palette .entry:hover {\\n  color: rgb(255, 116, 0);\\n}\\n\\n.djs-palette .highlighted-entry {\\n  color: rgb(255, 116, 0) !important;\\n}\\n\\n.djs-palette .entry,\\n.djs-palette .djs-palette-toggle {\\n  width: 46px;\\n  height: 46px;\\n  line-height: 46px;\\n  cursor: default;\\n}\\n\\n/**\\n * Palette open / two-column layout is controlled via\\n * classes on the palette. Events to hook into palette\\n * changed life-cycle are available in addition.\\n */\\n.djs-palette.two-column.open {\\n  width: 94px;\\n}\\n\\n.djs-palette:not(.open) .djs-palette-entries {\\n  display: none;\\n}\\n\\n.djs-palette:not(.open) {\\n  overflow: hidden;\\n}\\n\\n.djs-palette.open .djs-palette-toggle {\\n  display: none;\\n}\\n\\n/**\\n * context-pad\\n */\\n.djs-overlay-context-pad {\\n  width: 72px;\\n}\\n\\n.djs-context-pad {\\n  position: absolute;\\n  display: none;\\n  pointer-events: none;\\n}\\n\\n.djs-context-pad .entry {\\n  width: 22px;\\n  height: 22px;\\n  text-align: center;\\n  display: inline-block;\\n  font-size: 22px;\\n  margin: 0 2px 2px 0;\\n\\n  border-radius: 3px;\\n\\n  cursor: default;\\n\\n  background-color: #FEFEFE;\\n  box-shadow: 0 0 2px 1px #FEFEFE;\\n  pointer-events: all;\\n}\\n\\n.djs-context-pad .entry:before {\\n  vertical-align: top;\\n}\\n\\n.djs-context-pad .entry:hover {\\n  background: rgb(255, 252, 176);\\n}\\n\\n.djs-context-pad.open {\\n  display: block;\\n}\\n\\n/**\\n * popup styles\\n */\\n.djs-popup .entry {\\n  line-height: 20px;\\n  white-space: nowrap;\\n  cursor: default;\\n}\\n\\n/* larger font for prefixed icons */\\n.djs-popup .entry:before {\\n  vertical-align: middle;\\n  font-size: 20px;\\n}\\n\\n.djs-popup .entry > span {\\n  vertical-align: middle;\\n  font-size: 14px;\\n}\\n\\n.djs-popup .entry:hover,\\n.djs-popup .entry.active:hover {\\n  background: rgb(255, 252, 176);\\n}\\n\\n.djs-popup .entry.disabled {\\n  background: inherit;\\n}\\n\\n.djs-popup .djs-popup-header .entry {\\n  display: inline-block;\\n  padding: 2px 3px 2px 3px;\\n\\n  border: solid 1px transparent;\\n  border-radius: 3px;\\n}\\n\\n.djs-popup .djs-popup-header .entry.active {\\n  color: rgb(255, 116, 0);\\n  border: solid 1px rgb(255, 116, 0);\\n  background-color: #F6F6F6;\\n}\\n\\n.djs-popup-body .entry {\\n  padding: 4px 10px 4px 5px;\\n}\\n\\n.djs-popup-body .entry > span {\\n  margin-left: 5px;\\n}\\n\\n.djs-popup-body {\\n  background-color: #FEFEFE;\\n}\\n\\n.djs-popup-header {\\n  border-bottom: 1px solid #DDD;\\n}\\n\\n.djs-popup-header .entry {\\n  margin: 1px;\\n  margin-left: 3px;\\n}\\n\\n.djs-popup-header .entry:last-child {\\n  margin-right: 3px;\\n}\\n\\n/**\\n * popup / palette styles\\n */\\n.djs-popup, .djs-palette {\\n  background: #FAFAFA;\\n  border: solid 1px #CCC;\\n  border-radius: 2px;\\n}\\n\\n/**\\n * touch\\n */\\n\\n.djs-shape,\\n.djs-connection {\\n  touch-action: none;\\n}\\n\\n.djs-segment-dragger,\\n.djs-bendpoint {\\n  display: none;\\n}\\n\\n/**\\n * bendpoints\\n */\\n.djs-segment-dragger .djs-visual {\\n  fill: rgba(255, 255, 121, 0.2);\\n  stroke-width: 1px;\\n  stroke-opacity: 1;\\n  stroke: rgba(255, 255, 121, 0.3);\\n}\\n\\n.djs-bendpoint .djs-visual {\\n  fill: rgba(255, 255, 121, 0.8);\\n  stroke-width: 1px;\\n  stroke-opacity: 0.5;\\n  stroke: black;\\n}\\n\\n.djs-segment-dragger:hover,\\n.djs-bendpoints.hover .djs-segment-dragger,\\n.djs-bendpoints.selected .djs-segment-dragger,\\n.djs-bendpoint:hover,\\n.djs-bendpoints.hover .djs-bendpoint,\\n.djs-bendpoints.selected .djs-bendpoint {\\n  display: block;\\n}\\n\\n.djs-drag-active .djs-bendpoints * {\\n  display: none;\\n}\\n\\n.djs-bendpoints:not(.hover) .floating {\\n  display: none;\\n}\\n\\n.djs-segment-dragger:hover .djs-visual,\\n.djs-segment-dragger.djs-dragging .djs-visual,\\n.djs-bendpoint:hover .djs-visual,\\n.djs-bendpoint.floating .djs-visual {\\n  fill: yellow;\\n  stroke-opacity: 0.5;\\n  stroke: black;\\n}\\n\\n.djs-bendpoint.floating .djs-hit {\\n  pointer-events: none;\\n}\\n\\n.djs-segment-dragger .djs-hit,\\n.djs-bendpoint .djs-hit {\\n  pointer-events: all;\\n  fill: none;\\n}\\n\\n.djs-segment-dragger.horizontal .djs-hit {\\n  cursor: ns-resize;\\n}\\n\\n.djs-segment-dragger.vertical .djs-hit {\\n  cursor: ew-resize;\\n}\\n\\n.djs-segment-dragger.djs-dragging .djs-hit {\\n  pointer-events: none;\\n}\\n\\n.djs-updating,\\n.djs-updating > * {\\n  pointer-events: none !important;\\n}\\n\\n.djs-updating .djs-context-pad,\\n.djs-updating .djs-outline,\\n.djs-updating .djs-bendpoint,\\n.connect-ok .djs-bendpoint,\\n.connect-not-ok .djs-bendpoint,\\n.drop-ok .djs-bendpoint,\\n.drop-not-ok .djs-bendpoint {\\n  display: none !important;\\n}\\n\\n.djs-segment-dragger.djs-dragging,\\n.djs-bendpoint.djs-dragging {\\n  display: block;\\n  opacity: 1.0;\\n}\\n\\n.djs-segment-dragger.djs-dragging .djs-visual,\\n.djs-bendpoint.djs-dragging .djs-visual {\\n  fill: yellow;\\n  stroke-opacity: 0.5;\\n}\\n\\n\\n/**\\n * tooltips\\n */\\n.djs-tooltip-error {\\n  font-size: 11px;\\n  line-height: 18px;\\n  text-align: left;\\n\\n  padding: 5px;\\n\\n  opacity: 0.7;\\n}\\n\\n.djs-tooltip-error > * {\\n  width: 160px;\\n\\n  background: rgb(252, 236, 240);\\n  color: rgb(158, 76, 76);\\n  padding: 3px 7px;\\n  border-radius: 5px;\\n  border-left: solid 5px rgb(174, 73, 73);\\n}\\n\\n.djs-tooltip-error:hover {\\n  opacity: 1;\\n}\\n\\n\\n/**\\n * search pad\\n */\\n.djs-search-container {\\n  position: absolute;\\n  top: 20px;\\n  left: 0;\\n  right: 0;\\n  margin-left: auto;\\n  margin-right: auto;\\n\\n  width: 25%;\\n  min-width: 300px;\\n  max-width: 400px;\\n  z-index: 10;\\n\\n  font-size: 1.05em;\\n  opacity: 0.9;\\n  background: #FAFAFA;\\n  border: solid 1px #CCC;\\n  border-radius: 2px;\\n}\\n\\n.djs-search-container:not(.open) {\\n  display: none;\\n}\\n\\n.djs-search-input input {\\n  font-size: 1.05em;\\n  width: 100%;\\n  padding: 6px 10px;\\n  border: 1px solid #ccc;\\n}\\n\\n.djs-search-input input:focus {\\n  outline: none;\\n  border-color: #52B415;\\n}\\n\\n.djs-search-results {\\n  position: relative;\\n  overflow-y: auto;\\n  max-height: 200px;\\n}\\n\\n.djs-search-results:hover {\\n  /*background: #fffdd7;*/\\n  cursor: pointer;\\n}\\n\\n.djs-search-result {\\n  width: 100%;\\n  padding: 6px 10px;\\n  background: white;\\n  border-bottom: solid 1px #AAA;\\n  border-radius: 1px;\\n}\\n\\n.djs-search-highlight {\\n  color: black;\\n}\\n\\n.djs-search-result-primary {\\n  margin: 0 0 10px;\\n}\\n\\n.djs-search-result-secondary {\\n  font-family: monospace;\\n  margin: 0;\\n}\\n\\n.djs-search-result:hover {\\n  background: #fdffd6;\\n}\\n\\n.djs-search-result-selected {\\n  background: #fffcb0;\\n}\\n\\n.djs-search-result-selected:hover {\\n  background: #f7f388;\\n}\\n\\n.djs-search-overlay {\\n  background: yellow;\\n  opacity: 0.3;\\n}\\n\\n/**\\n * hidden styles\\n */\\n.djs-element-hidden,\\n.djs-element-hidden .djs-hit,\\n.djs-element-hidden .djs-outline,\\n.djs-label-hidden .djs-label {\\n  display: none !important;\\n}\\n\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../../../css-loader/index.js!./cmmn-embedded.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../css-loader/index.js!./cmmn-embedded.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../css-loader/index.js!./cmmn-embedded.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","var escape = require(\"../../../../../css-loader/lib/url/escape.js\");\nexports = module.exports = require(\"../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@font-face {\\n  font-family: 'cmmn';\\n  src: url(\" + escape(require(\"../font/cmmn.eot?3835444\")) + \");\\n  src: url(\" + escape(require(\"../font/cmmn.eot?3835444\")) + \"#iefix) format('embedded-opentype'),\\n       url(\" + escape(require(\"../font/cmmn.svg?3835444\")) + \"#cmmn) format('svg');\\n  font-weight: normal;\\n  font-style: normal;\\n}\\n@font-face {\\n  font-family: 'cmmn';\\n  src: url('data:application/octet-stream;base64,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') format('woff'),\\n       url('data:application/octet-stream;base64,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c3BhY2UtdG9vbAloYW5kLXRvb2wPY2FzZS1wbGFuLW1vZGVsDnN0YWdlLWV4cGFuZGVkCW1pbGVzdG9uZQ90ZXh0LWFubm90YXRpb24EdGFzawljYXNlLXRhc2sXY2FzZS10YXNrLWRpc2NyZXRpb25hcnkNZGVjaXNpb24tdGFzaxtkZWNpc2lvbi10YXNrLWRpc2NyZXRpb25hcnkTaHVtYW4tYmxvY2tpbmctdGFzayFodW1hbi1ibG9ja2luZy10YXNrLWRpc2NyZXRpb25hcnkXaHVtYW4tbm9uLWJsb2NraW5nLXRhc2slaHVtYW4tbm9uLWJsb2NraW5nLXRhc2stZGlzY3JldGlvbmFyeQxwcm9jZXNzLXRhc2sacHJvY2Vzcy10YXNrLWRpc2NyZXRpb25hcnkSdGFzay1kaXNjcmV0aW9uYXJ5CXRhc2stbm9uZQ9lbnRyeS1jcml0ZXJpb24OZXhpdC1jcml0ZXJpb24OY2FzZS1maWxlLWl0ZW0KY29ubmVjdGlvbg5ldmVudC1saXN0ZW5lchR0aW1lci1ldmVudC1saXN0ZW5lchN1c2VyLWV2ZW50LWxpc3RlbmVyFGF1dG8tY29tcGxldGUtbWFya2VyGG1hbnVhbC1hY3RpdmF0aW9uLW1hcmtlchFyZXBldGl0aW9uLW1hcmtlcghibG9ja2luZw9yZXF1aXJlZC1tYXJrZXIlcGxhbi1mcmFnbWVudC1jb2xsYXBzZWQtZGlzY3JldGlvbmFyeSRwbGFuLWZyYWdtZW50LWV4cGFuZGVkLWRpc2NyZXRpb25hcnkPc3RhZ2UtY29sbGFwc2VkHXN0YWdlLWNvbGxhcHNlZC1kaXNjcmV0aW9uYXJ5HHN0YWdlLWV4cGFuZGVkLWRpc2NyZXRpb25hcnkAAAAAAAABAAH//wAPAAAAAAAAAAAAAAAAAAAAAAAYABgAGAAYA1L/agNS/2qwACwgsABVWEVZICBLuAAOUUuwBlNaWLA0G7AoWWBmIIpVWLACJWG5CAAIAGNjI2IbISGwAFmwAEMjRLIAAQBDYEItsAEssCBgZi2wAiwgZCCwwFCwBCZasigBCkNFY0VSW1ghIyEbilggsFBQWCGwQFkbILA4UFghsDhZWSCxAQpDRWNFYWSwKFBYIbEBCkNFY0UgsDBQWCGwMFkbILDA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') format('truetype');\\n}\\n/* Chrome hack: SVG is rendered more smooth in Windozze. 100% magic, uncomment if you need it. */\\n/* Note, that will break hinting! In other OS-es font will be not as sharp as it could be */\\n/*\\n@media screen and (-webkit-min-device-pixel-ratio:0) {\\n  @font-face {\\n    font-family: 'cmmn';\\n    src: url('../font/cmmn.svg?3835444#cmmn') format('svg');\\n  }\\n}\\n*/\\n\\n [class^=\\\"cmmn-icon-\\\"]:before, [class*=\\\" cmmn-icon-\\\"]:before {\\n  font-family: \\\"cmmn\\\";\\n  font-style: normal;\\n  font-weight: normal;\\n  speak: none;\\n\\n  display: inline-block;\\n  text-decoration: inherit;\\n  width: 1em;\\n  /* margin-right: .2em; */\\n  text-align: center;\\n  /* opacity: .8; */\\n\\n  /* For safety - reset parent styles, that can break glyph codes*/\\n  font-variant: normal;\\n  text-transform: none;\\n\\n  /* fix buttons height, for twitter bootstrap */\\n  line-height: 1em;\\n\\n  /* Animation center compensation - margins should be symmetric */\\n  /* remove if not needed */\\n  /* margin-left: .2em; */\\n\\n  /* you can be more comfortable with increased icons size */\\n  /* font-size: 120%; */\\n\\n  /* Uncomment for 3D effect */\\n  /* text-shadow: 1px 1px 1px rgba(127, 127, 127, 0.3); */\\n}\\n.cmmn-icon-bpmn-io:before { content: '\\\\E800'; } /* '' */\\n.cmmn-icon-screw-wrench:before { content: '\\\\E801'; } /* '' */\\n.cmmn-icon-trash:before { content: '\\\\E802'; } /* '' */\\n.cmmn-icon-lasso-tool:before { content: '\\\\E803'; } /* '' */\\n.cmmn-icon-space-tool:before { content: '\\\\E804'; } /* '' */\\n.cmmn-icon-hand-tool:before { content: '\\\\E805'; } /* '' */\\n.cmmn-icon-case-plan-model:before { content: '\\\\E806'; } /* '' */\\n.cmmn-icon-stage-expanded:before { content: '\\\\E807'; } /* '' */\\n.cmmn-icon-milestone:before { content: '\\\\E808'; } /* '' */\\n.cmmn-icon-text-annotation:before { content: '\\\\E809'; } /* '' */\\n.cmmn-icon-task:before { content: '\\\\E80A'; } /* '' */\\n.cmmn-icon-case-task:before { content: '\\\\E80B'; } /* '' */\\n.cmmn-icon-case-task-discretionary:before { content: '\\\\E80C'; } /* '' */\\n.cmmn-icon-decision-task:before { content: '\\\\E80D'; } /* '' */\\n.cmmn-icon-decision-task-discretionary:before { content: '\\\\E80E'; } /* '' */\\n.cmmn-icon-human-blocking-task:before { content: '\\\\E80F'; } /* '' */\\n.cmmn-icon-human-blocking-task-discretionary:before { content: '\\\\E810'; } /* '' */\\n.cmmn-icon-human-non-blocking-task:before { content: '\\\\E811'; } /* '' */\\n.cmmn-icon-human-non-blocking-task-discretionary:before { content: '\\\\E812'; } /* '' */\\n.cmmn-icon-process-task:before { content: '\\\\E813'; } /* '' */\\n.cmmn-icon-process-task-discretionary:before { content: '\\\\E814'; } /* '' */\\n.cmmn-icon-task-discretionary:before { content: '\\\\E815'; } /* '' */\\n.cmmn-icon-task-none:before { content: '\\\\E816'; } /* '' */\\n.cmmn-icon-entry-criterion:before { content: '\\\\E817'; } /* '' */\\n.cmmn-icon-exit-criterion:before { content: '\\\\E818'; } /* '' */\\n.cmmn-icon-case-file-item:before { content: '\\\\E819'; } /* '' */\\n.cmmn-icon-connection:before { content: '\\\\E81A'; } /* '' */\\n.cmmn-icon-event-listener:before { content: '\\\\E81B'; } /* '' */\\n.cmmn-icon-timer-event-listener:before { content: '\\\\E81C'; } /* '' */\\n.cmmn-icon-user-event-listener:before { content: '\\\\E81D'; } /* '' */\\n.cmmn-icon-auto-complete-marker:before { content: '\\\\E81E'; } /* '' */\\n.cmmn-icon-manual-activation-marker:before { content: '\\\\E81F'; } /* '' */\\n.cmmn-icon-repetition-marker:before { content: '\\\\E820'; } /* '' */\\n.cmmn-icon-blocking:before { content: '\\\\E821'; } /* '' */\\n.cmmn-icon-required-marker:before { content: '\\\\E822'; } /* '' */\\n.cmmn-icon-plan-fragment-collapsed-discretionary:before { content: '\\\\E823'; } /* '' */\\n.cmmn-icon-plan-fragment-expanded-discretionary:before { content: '\\\\E824'; } /* '' */\\n.cmmn-icon-stage-collapsed:before { content: '\\\\E825'; } /* '' */\\n.cmmn-icon-stage-collapsed-discretionary:before { content: '\\\\E826'; } /* '' */\\n.cmmn-icon-stage-expanded-discretionary:before { content: '\\\\E827'; } /* '' */\", \"\"]);\n\n// exports\n","module.exports = __webpack_public_path__ + \"static/media/cmmn.9f6d95c9.svg\";","import { assign } from 'min-dash';\n\nvar round = Math.round;\n\n\n/**\n * A handler that implements reversible addition of shapes.\n *\n * @param {canvas} Canvas\n */\nexport default function CreateShapeHandler(canvas) {\n  this._canvas = canvas;\n}\n\nCreateShapeHandler.$inject = [ 'canvas' ];\n\n\n// api //////////////////////\n\n\n/**\n * Appends a shape to a target shape\n *\n * @param {Object} context\n * @param {djs.model.Base} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nCreateShapeHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      positionOrBounds = context.position,\n      parent = context.parent,\n      parentIndex = context.parentIndex;\n\n  if (!parent) {\n    throw new Error('parent required');\n  }\n\n  if (!positionOrBounds) {\n    throw new Error('position required');\n  }\n\n  // (1) add at event center position _or_ at given bounds\n  if (positionOrBounds.width !== undefined) {\n    assign(shape, positionOrBounds);\n  } else {\n    assign(shape, {\n      x: positionOrBounds.x - round(shape.width / 2),\n      y: positionOrBounds.y - round(shape.height / 2)\n    });\n  }\n\n  // (2) add to canvas\n  this._canvas.addShape(shape, parent, parentIndex);\n\n  return shape;\n};\n\n\n/**\n * Undo append by removing the shape\n */\nCreateShapeHandler.prototype.revert = function(context) {\n\n  // (3) remove form canvas\n  this._canvas.removeShape(context.shape);\n};","import {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../../util/Collections';\n\nimport { saveClear } from '../../../util/Removal';\n\n\n/**\n * A handler that implements reversible deletion of shapes.\n *\n */\nexport default function DeleteShapeHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nDeleteShapeHandler.$inject = [ 'canvas', 'modeling' ];\n\n\n/**\n * - Remove connections\n * - Remove all direct children\n */\nDeleteShapeHandler.prototype.preExecute = function(context) {\n\n  var modeling = this._modeling;\n\n  var shape = context.shape;\n\n  // remove connections\n  saveClear(shape.incoming, function(connection) {\n    // To make sure that the connection isn't removed twice\n    // For example if a container is removed\n    modeling.removeConnection(connection, { nested: true });\n  });\n\n  saveClear(shape.outgoing, function(connection) {\n    modeling.removeConnection(connection, { nested: true });\n  });\n\n  // remove child shapes and connections\n  saveClear(shape.children, function(child) {\n    if (isConnection(child)) {\n      modeling.removeConnection(child, { nested: true });\n    } else {\n      modeling.removeShape(child, { nested: true });\n    }\n  });\n};\n\n/**\n * Remove shape and remember the parent\n */\nDeleteShapeHandler.prototype.execute = function(context) {\n  var canvas = this._canvas;\n\n  var shape = context.shape,\n      oldParent = shape.parent;\n\n  context.oldParent = oldParent;\n\n  // remove containment\n  context.oldParentIndex = collectionIdx(oldParent.children, shape);\n\n  // remove shape\n  canvas.removeShape(shape);\n\n  return shape;\n};\n\n\n/**\n * Command revert implementation\n */\nDeleteShapeHandler.prototype.revert = function(context) {\n\n  var canvas = this._canvas;\n\n  var shape = context.shape,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex;\n\n  // restore containment\n  collectionAdd(oldParent.children, shape, oldParentIndex);\n\n  canvas.addShape(shape, oldParent);\n\n  return shape;\n};\n\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import {\n  getNewAttachPoint\n} from '../../../../util/AttachUtil';\n\n\nexport function getResizedSourceAnchor(connection, shape, oldBounds) {\n\n  var waypoints = safeGetWaypoints(connection),\n      oldAnchor = waypoints[0];\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, shape);\n}\n\n\nexport function getResizedTargetAnchor(connection, shape, oldBounds) {\n\n  var waypoints = safeGetWaypoints(connection),\n      oldAnchor = waypoints[waypoints.length - 1];\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, shape);\n}\n\n\nexport function getMovedSourceAnchor(connection, source, moveDelta) {\n  return getResizedSourceAnchor(connection, source, substractPosition(source, moveDelta));\n}\n\n\nexport function getMovedTargetAnchor(connection, target, moveDelta) {\n  return getResizedTargetAnchor(connection, target, substractPosition(target, moveDelta));\n}\n\n\n// helpers //////////////////////\n\nfunction substractPosition(bounds, delta) {\n  return {\n    x: bounds.x - delta.x,\n    y: bounds.y - delta.y,\n    width: bounds.width,\n    height: bounds.height\n  };\n}\n\n\n/**\n * Return waypoints of given connection; throw if non exists (should not happen!!).\n *\n * @param {Connection} connection\n *\n * @return {Array<Point>}\n */\nfunction safeGetWaypoints(connection) {\n\n  var waypoints = connection.waypoints;\n\n  if (!waypoints.length) {\n    throw new Error('connection#' + connection.id + ': no waypoints');\n  }\n\n  return waypoints;\n}\n","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getClosure\n} from '../../../../util/Elements';\n\n\nexport default function MoveClosure() {\n\n  this.allShapes = {};\n  this.allConnections = {};\n\n  this.enclosedElements = {};\n  this.enclosedConnections = {};\n\n  this.topLevel = {};\n}\n\n\nMoveClosure.prototype.add = function(element, isTopLevel) {\n  return this.addAll([ element ], isTopLevel);\n};\n\n\nMoveClosure.prototype.addAll = function(elements, isTopLevel) {\n\n  var newClosure = getClosure(elements, !!isTopLevel, this);\n\n  assign(this, newClosure);\n\n  return this;\n};","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './AnchorsHelper';\n\nimport MoveClosure from './MoveClosure';\n\n\n/**\n * A helper that is able to carry out serialized move\n * operations on multiple elements.\n *\n * @param {Modeling} modeling\n */\nexport default function MoveHelper(modeling) {\n  this._modeling = modeling;\n}\n\n/**\n * Move the specified elements and all children by the given delta.\n *\n * This moves all enclosed connections, too and layouts all affected\n * external connections.\n *\n * @param  {Array<djs.model.Base>} elements\n * @param  {Point} delta\n * @param  {djs.model.Base} newParent applied to the first level of shapes\n *\n * @return {Array<djs.model.Base>} list of touched elements\n */\nMoveHelper.prototype.moveRecursive = function(elements, delta, newParent) {\n  if (!elements) {\n    return [];\n  } else {\n    return this.moveClosure(this.getClosure(elements), delta, newParent);\n  }\n};\n\n/**\n * Move the given closure of elmements.\n *\n * @param {Object} closure\n * @param {Point} delta\n * @param {djs.model.Base} [newParent]\n * @param {djs.model.Base} [newHost]\n */\nMoveHelper.prototype.moveClosure = function(closure, delta, newParent, newHost, primaryShape) {\n  var modeling = this._modeling;\n\n  var allShapes = closure.allShapes,\n      allConnections = closure.allConnections,\n      enclosedConnections = closure.enclosedConnections,\n      topLevel = closure.topLevel,\n      keepParent = false;\n\n  if (primaryShape && primaryShape.parent === newParent) {\n    keepParent = true;\n  }\n\n  // move all shapes\n  forEach(allShapes, function(shape) {\n\n    // move the element according to the given delta\n    modeling.moveShape(shape, delta, topLevel[shape.id] && !keepParent && newParent, {\n      recurse: false,\n      layout: false\n    });\n  });\n\n  // move all child connections / layout external connections\n  forEach(allConnections, function(c) {\n\n    var sourceMoved = !!allShapes[c.source.id],\n        targetMoved = !!allShapes[c.target.id];\n\n    if (enclosedConnections[c.id] && sourceMoved && targetMoved) {\n      modeling.moveConnection(c, delta, topLevel[c.id] && !keepParent && newParent);\n    } else {\n      modeling.layoutConnection(c, {\n        connectionStart: sourceMoved && getMovedSourceAnchor(c, c.source, delta),\n        connectionEnd: targetMoved && getMovedTargetAnchor(c, c.target, delta)\n      });\n    }\n  });\n};\n\n/**\n * Returns the closure for the selected elements\n *\n * @param  {Array<djs.model.Base>} elements\n * @return {MoveClosure} closure\n */\nMoveHelper.prototype.getClosure = function(elements) {\n  return new MoveClosure().addAll(elements, true);\n};","import {\n  assign,\n  forEach,\n  pick\n} from 'min-dash';\n\nimport MoveHelper from './helper/MoveHelper';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function MoveShapeHandler(modeling) {\n  this._modeling = modeling;\n\n  this._helper = new MoveHelper(modeling);\n}\n\nMoveShapeHandler.$inject = [ 'modeling' ];\n\n\nMoveShapeHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      delta = context.delta,\n      newParent = context.newParent || shape.parent,\n      newParentIndex = context.newParentIndex,\n      oldParent = shape.parent;\n\n  context.oldBounds = pick(shape, [ 'x', 'y', 'width', 'height']);\n\n  // save old parent in context\n  context.oldParent = oldParent;\n  context.oldParentIndex = collectionRemove(oldParent.children, shape);\n\n  // add to new parent at position\n  collectionAdd(newParent.children, shape, newParentIndex);\n\n  // update shape parent + position\n  assign(shape, {\n    parent: newParent,\n    x: shape.x + delta.x,\n    y: shape.y + delta.y\n  });\n\n  return shape;\n};\n\nMoveShapeHandler.prototype.postExecute = function(context) {\n\n  var shape = context.shape,\n      delta = context.delta,\n      hints = context.hints;\n\n  var modeling = this._modeling;\n\n  if (hints.layout !== false) {\n\n    forEach(shape.incoming, function(c) {\n      modeling.layoutConnection(c, {\n        connectionEnd: getMovedTargetAnchor(c, shape, delta)\n      });\n    });\n\n    forEach(shape.outgoing, function(c) {\n      modeling.layoutConnection(c, {\n        connectionStart: getMovedSourceAnchor(c, shape, delta)\n      });\n    });\n  }\n\n  if (hints.recurse !== false) {\n    this.moveChildren(context);\n  }\n};\n\nMoveShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex,\n      delta = context.delta;\n\n  // restore previous location in old parent\n  collectionAdd(oldParent.children, shape, oldParentIndex);\n\n  // revert to old position and parent\n  assign(shape, {\n    parent: oldParent,\n    x: shape.x - delta.x,\n    y: shape.y - delta.y\n  });\n\n  return shape;\n};\n\nMoveShapeHandler.prototype.moveChildren = function(context) {\n\n  var delta = context.delta,\n      shape = context.shape;\n\n  this._helper.moveRecursive(shape.children, delta, null);\n};\n\nMoveShapeHandler.prototype.getNewParent = function(context) {\n  return context.newParent || context.shape.parent;\n};\n","import {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  getResizedSourceAnchor,\n  getResizedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * A handler that implements reversible resizing of shapes.\n *\n * @param {Modeling} modeling\n */\nexport default function ResizeShapeHandler(modeling) {\n  this._modeling = modeling;\n}\n\nResizeShapeHandler.$inject = [ 'modeling' ];\n\n/**\n * {\n *   shape: {....}\n *   newBounds: {\n *     width:  20,\n *     height: 40,\n *     x:       5,\n *     y:      10\n *   }\n *\n * }\n */\nResizeShapeHandler.prototype.execute = function(context) {\n  var shape = context.shape,\n      newBounds = context.newBounds,\n      minBounds = context.minBounds;\n\n  if (newBounds.x === undefined || newBounds.y === undefined ||\n      newBounds.width === undefined || newBounds.height === undefined) {\n    throw new Error('newBounds must have {x, y, width, height} properties');\n  }\n\n  if (minBounds && (newBounds.width < minBounds.width\n    || newBounds.height < minBounds.height)) {\n    throw new Error('width and height cannot be less than minimum height and width');\n  } else if (!minBounds\n    && newBounds.width < 10 || newBounds.height < 10) {\n    throw new Error('width and height cannot be less than 10px');\n  }\n\n  // save old bbox in context\n  context.oldBounds = {\n    width:  shape.width,\n    height: shape.height,\n    x:      shape.x,\n    y:      shape.y\n  };\n\n  // update shape\n  assign(shape, {\n    width:  newBounds.width,\n    height: newBounds.height,\n    x:      newBounds.x,\n    y:      newBounds.y\n  });\n\n  return shape;\n};\n\nResizeShapeHandler.prototype.postExecute = function(context) {\n\n  var shape = context.shape,\n      oldBounds = context.oldBounds;\n\n  var modeling = this._modeling;\n\n  forEach(shape.incoming, function(c) {\n    modeling.layoutConnection(c, {\n      connectionEnd: getResizedTargetAnchor(c, shape, oldBounds)\n    });\n  });\n\n  forEach(shape.outgoing, function(c) {\n    modeling.layoutConnection(c, {\n      connectionStart: getResizedSourceAnchor(c, shape, oldBounds)\n    });\n  });\n\n};\n\nResizeShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldBounds = context.oldBounds;\n\n  // restore previous bbox\n  assign(shape, {\n    width:  oldBounds.width,\n    height: oldBounds.height,\n    x:      oldBounds.x,\n    y:      oldBounds.y\n  });\n\n  return shape;\n};\n","/**\n * A handler that toggles the collapsed state of an element\n * and the visibility of all its children.\n *\n * @param {Modeling} modeling\n */\nexport default function ToggleShapeCollapseHandler(modeling) {\n  this._modeling = modeling;\n}\n\nToggleShapeCollapseHandler.$inject = [ 'modeling' ];\n\n\nToggleShapeCollapseHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      children = shape.children;\n\n  // remember previous visibility of children\n  context.oldChildrenVisibility = getElementsVisibility(children);\n\n  // toggle state\n  shape.collapsed = !shape.collapsed;\n\n  // hide/show children\n  setHidden(children, shape.collapsed);\n\n  return [shape].concat(children);\n};\n\n\nToggleShapeCollapseHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldChildrenVisibility = context.oldChildrenVisibility;\n\n  var children = shape.children;\n\n  // set old visability of children\n  restoreVisibility(children, oldChildrenVisibility);\n\n  // retoggle state\n  shape.collapsed = !shape.collapsed;\n\n  return [shape].concat(children);\n};\n\n\n// helpers //////////////////////\n\n/**\n * Return a map { elementId -> hiddenState}.\n *\n * @param {Array<djs.model.Shape>} elements\n *\n * @return {Object}\n */\nfunction getElementsVisibility(elements) {\n\n  var result = {};\n\n  elements.forEach(function(e) {\n    result[e.id] = e.hidden;\n  });\n\n  return result;\n}\n\n\nfunction setHidden(elements, newHidden) {\n  elements.forEach(function(element) {\n    element.hidden = newHidden;\n  });\n}\n\nfunction restoreVisibility(elements, lastState) {\n  elements.forEach(function(e) {\n    e.hidden = lastState[e.id];\n  });\n}\n","import { forEach } from 'min-dash';\n\nimport {\n  resizeBounds\n} from '../../space-tool/SpaceUtil';\n\n\n/**\n * A handler that implements reversible creating and removing of space.\n *\n * It executes in two phases:\n *\n *  (1) resize all affected resizeShapes\n *  (2) move all affected moveElements\n */\nexport default function SpaceToolHandler(modeling) {\n  this._modeling = modeling;\n}\n\nSpaceToolHandler.$inject = [ 'modeling' ];\n\n\nSpaceToolHandler.prototype.preExecute = function(context) {\n\n  // resize\n  var modeling = this._modeling,\n      resizingShapes = context.resizingShapes,\n      delta = context.delta,\n      direction = context.direction;\n\n  forEach(resizingShapes, function(shape) {\n    var newBounds = resizeBounds(shape, direction, delta);\n\n    modeling.resizeShape(shape, newBounds);\n  });\n};\n\nSpaceToolHandler.prototype.postExecute = function(context) {\n  // move\n  var modeling = this._modeling,\n      movingShapes = context.movingShapes,\n      delta = context.delta;\n\n  modeling.moveElements(movingShapes, delta, undefined, { autoResize: false, attach: false });\n};\n\nSpaceToolHandler.prototype.execute = function(context) {};\nSpaceToolHandler.prototype.revert = function(context) {};\n","import inherits from 'inherits';\n\nimport CreateShapeHandler from './CreateShapeHandler';\n\n\n/**\n * A handler that attaches a label to a given target shape.\n *\n * @param {Canvas} canvas\n */\nexport default function CreateLabelHandler(canvas) {\n  CreateShapeHandler.call(this, canvas);\n}\n\ninherits(CreateLabelHandler, CreateShapeHandler);\n\nCreateLabelHandler.$inject = [ 'canvas' ];\n\n\n// api //////////////////////\n\n\nvar originalExecute = CreateShapeHandler.prototype.execute;\n\n/**\n * Appends a label to a target shape.\n *\n * @method CreateLabelHandler#execute\n *\n * @param {Object} context\n * @param {ElementDescriptor} context.target the element the label is attached to\n * @param {ElementDescriptor} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nCreateLabelHandler.prototype.execute = function(context) {\n\n  var label = context.shape;\n\n  ensureValidDimensions(label);\n\n  label.labelTarget = context.labelTarget;\n\n  return originalExecute.call(this, context);\n};\n\nvar originalRevert = CreateShapeHandler.prototype.revert;\n\n/**\n * Undo append by removing the shape\n */\nCreateLabelHandler.prototype.revert = function(context) {\n  context.shape.labelTarget = null;\n\n  return originalRevert.call(this, context);\n};\n\n\n// helpers //////////////////////\n\nfunction ensureValidDimensions(label) {\n  // make sure a label has valid { width, height } dimensions\n  [ 'width', 'height' ].forEach(function(prop) {\n    if (typeof label[prop] === 'undefined') {\n      label[prop] = 0;\n    }\n  });\n}","export default function CreateConnectionHandler(canvas, layouter) {\n  this._canvas = canvas;\n  this._layouter = layouter;\n}\n\nCreateConnectionHandler.$inject = [ 'canvas', 'layouter' ];\n\n\n// api //////////////////////\n\n\n/**\n * Appends a shape to a target shape\n *\n * @param {Object} context\n * @param {djs.element.Base} context.source the source object\n * @param {djs.element.Base} context.target the parent object\n * @param {Point} context.position position of the new element\n */\nCreateConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      source = context.source,\n      target = context.target,\n      parent = context.parent,\n      parentIndex = context.parentIndex,\n      hints = context.hints;\n\n  if (!source || !target) {\n    throw new Error('source and target required');\n  }\n\n  if (!parent) {\n    throw new Error('parent required');\n  }\n\n  connection.source = source;\n  connection.target = target;\n\n  if (!connection.waypoints) {\n    connection.waypoints = this._layouter.layoutConnection(connection, hints);\n  }\n\n  // add connection\n  this._canvas.addConnection(connection, parent, parentIndex);\n\n  return connection;\n};\n\nCreateConnectionHandler.prototype.revert = function(context) {\n  var connection = context.connection;\n\n  this._canvas.removeConnection(connection);\n\n  connection.source = null;\n  connection.target = null;\n};","import {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../../util/Collections';\n\n\n/**\n * A handler that implements reversible deletion of Connections.\n */\nexport default function DeleteConnectionHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nDeleteConnectionHandler.$inject = [\n  'canvas',\n  'modeling'\n];\n\n\nDeleteConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      parent = connection.parent;\n\n  context.parent = parent;\n\n  // remember containment\n  context.parentIndex = collectionIdx(parent.children, connection);\n\n  context.source = connection.source;\n  context.target = connection.target;\n\n  this._canvas.removeConnection(connection);\n\n  connection.source = null;\n  connection.target = null;\n\n  return connection;\n};\n\n/**\n * Command revert implementation.\n */\nDeleteConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      parent = context.parent,\n      parentIndex = context.parentIndex;\n\n  connection.source = context.source;\n  connection.target = context.target;\n\n  // restore containment\n  collectionAdd(parent.children, connection, parentIndex);\n\n  this._canvas.addConnection(connection, parent);\n\n  return connection;\n};\n","import { forEach } from 'min-dash';\n\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\n\n/**\n * A handler that implements reversible moving of connections.\n *\n * The handler differs from the layout connection handler in a sense\n * that it preserves the connection layout.\n */\nexport default function MoveConnectionHandler() { }\n\n\nMoveConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      delta = context.delta;\n\n  var newParent = context.newParent || connection.parent,\n      newParentIndex = context.newParentIndex,\n      oldParent = connection.parent;\n\n  // save old parent in context\n  context.oldParent = oldParent;\n  context.oldParentIndex = collectionRemove(oldParent.children, connection);\n\n  // add to new parent at position\n  collectionAdd(newParent.children, connection, newParentIndex);\n\n  // update parent\n  connection.parent = newParent;\n\n  // update waypoint positions\n  forEach(connection.waypoints, function(p) {\n    p.x += delta.x;\n    p.y += delta.y;\n\n    if (p.original) {\n      p.original.x += delta.x;\n      p.original.y += delta.y;\n    }\n  });\n\n  return connection;\n};\n\nMoveConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      newParent = connection.parent,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex,\n      delta = context.delta;\n\n  // remove from newParent\n  collectionRemove(newParent.children, connection);\n\n  // restore previous location in old parent\n  collectionAdd(oldParent.children, connection, oldParentIndex);\n\n  // restore parent\n  connection.parent = oldParent;\n\n  // revert to old waypoint positions\n  forEach(connection.waypoints, function(p) {\n    p.x -= delta.x;\n    p.y -= delta.y;\n\n    if (p.original) {\n      p.original.x -= delta.x;\n      p.original.y -= delta.y;\n    }\n  });\n\n  return connection;\n};","import { assign } from 'min-dash';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function LayoutConnectionHandler(layouter, canvas) {\n  this._layouter = layouter;\n  this._canvas = canvas;\n}\n\nLayoutConnectionHandler.$inject = [ 'layouter', 'canvas' ];\n\nLayoutConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection;\n\n  var oldWaypoints = connection.waypoints;\n\n  assign(context, {\n    oldWaypoints: oldWaypoints\n  });\n\n  connection.waypoints = this._layouter.layoutConnection(connection, context.hints);\n\n  return connection;\n};\n\nLayoutConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection;\n\n  connection.waypoints = context.oldWaypoints;\n\n  return connection;\n};\n","export default function UpdateWaypointsHandler() { }\n\nUpdateWaypointsHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      newWaypoints = context.newWaypoints;\n\n  context.oldWaypoints = connection.waypoints;\n\n  connection.waypoints = newWaypoints;\n\n  return connection;\n};\n\nUpdateWaypointsHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      oldWaypoints = context.oldWaypoints;\n\n  connection.waypoints = oldWaypoints;\n\n  return connection;\n};","import MoveHelper from './helper/MoveHelper';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function MoveElementsHandler(modeling) {\n  this._helper = new MoveHelper(modeling);\n}\n\nMoveElementsHandler.$inject = [ 'modeling' ];\n\nMoveElementsHandler.prototype.preExecute = function(context) {\n  context.closure = this._helper.getClosure(context.shapes);\n};\n\nMoveElementsHandler.prototype.postExecute = function(context) {\n\n  var hints = context.hints,\n      primaryShape;\n\n  if (hints && hints.primaryShape) {\n    primaryShape = hints.primaryShape;\n    hints.oldParent = primaryShape.parent;\n  }\n\n  this._helper.moveClosure(\n    context.closure,\n    context.delta,\n    context.newParent,\n    context.newHost,\n    primaryShape\n  );\n};","import { forEach } from 'min-dash';\n\n\nexport default function DeleteElementsHandler(modeling, elementRegistry) {\n  this._modeling = modeling;\n  this._elementRegistry = elementRegistry;\n}\n\nDeleteElementsHandler.$inject = [\n  'modeling',\n  'elementRegistry'\n];\n\n\nDeleteElementsHandler.prototype.postExecute = function(context) {\n\n  var modeling = this._modeling,\n      elementRegistry = this._elementRegistry,\n      elements = context.elements;\n\n  forEach(elements, function(element) {\n\n    // element may have been removed with previous\n    // remove operations already (e.g. in case of nesting)\n    if (!elementRegistry.get(element.id)) {\n      return;\n    }\n\n    if (element.waypoints) {\n      modeling.removeConnection(element);\n    } else {\n      modeling.removeShape(element);\n    }\n  });\n};","import {\n  forEach,\n  sortBy\n} from 'min-dash';\n\n\n/**\n * A handler that distributes elements evenly.\n */\nexport default function DistributeElements(modeling) {\n  this._modeling = modeling;\n}\n\nDistributeElements.$inject = [ 'modeling' ];\n\nvar OFF_AXIS = {\n  x: 'y',\n  y: 'x'\n};\n\nDistributeElements.prototype.preExecute = function(context) {\n  var modeling = this._modeling;\n\n  var groups = context.groups,\n      axis = context.axis,\n      dimension = context.dimension;\n\n  function updateRange(group, element) {\n    group.range.min = Math.min(element[axis], group.range.min);\n    group.range.max = Math.max(element[axis] + element[dimension], group.range.max);\n  }\n\n  function center(element) {\n    return element[axis] + element[dimension] / 2;\n  }\n\n  function lastIdx(arr) {\n    return arr.length - 1;\n  }\n\n  function rangeDiff(range) {\n    return range.max - range.min;\n  }\n\n  function centerElement(refCenter, element) {\n    var delta = { y: 0 };\n\n    delta[axis] = refCenter - center(element);\n\n    if (delta[axis]) {\n\n      delta[OFF_AXIS[axis]] = 0;\n\n      modeling.moveElements([ element ], delta, element.parent);\n    }\n  }\n\n  var firstGroup = groups[0],\n      lastGroupIdx = lastIdx(groups),\n      lastGroup = groups[ lastGroupIdx ];\n\n  var margin,\n      spaceInBetween,\n      groupsSize = 0; // the size of each range\n\n  forEach(groups, function(group, idx) {\n    var sortedElements,\n        refElem,\n        refCenter;\n\n    if (group.elements.length < 2) {\n      if (idx && idx !== groups.length - 1) {\n        updateRange(group, group.elements[0]);\n\n        groupsSize += rangeDiff(group.range);\n      }\n      return;\n    }\n\n    sortedElements = sortBy(group.elements, axis);\n\n    refElem = sortedElements[0];\n\n    if (idx === lastGroupIdx) {\n      refElem = sortedElements[lastIdx(sortedElements)];\n    }\n\n    refCenter = center(refElem);\n\n    // wanna update the ranges after the shapes have been centered\n    group.range = null;\n\n    forEach(sortedElements, function(element) {\n\n      centerElement(refCenter, element);\n\n      if (group.range === null) {\n        group.range = {\n          min: element[axis],\n          max: element[axis] + element[dimension]\n        };\n\n        return;\n      }\n\n      // update group's range after centering the range elements\n      updateRange(group, element);\n    });\n\n    if (idx && idx !== groups.length - 1) {\n      groupsSize += rangeDiff(group.range);\n    }\n  });\n\n  spaceInBetween = Math.abs(lastGroup.range.min - firstGroup.range.max);\n\n  margin = Math.round((spaceInBetween - groupsSize) / (groups.length - 1));\n\n  if (margin < groups.length - 1) {\n    return;\n  }\n\n  forEach(groups, function(group, groupIdx) {\n    var delta = {},\n        prevGroup;\n\n    if (group === firstGroup || group === lastGroup) {\n      return;\n    }\n\n    prevGroup = groups[groupIdx - 1];\n\n    group.range.max = 0;\n\n    forEach(group.elements, function(element, idx) {\n      delta[OFF_AXIS[axis]] = 0;\n      delta[axis] = (prevGroup.range.max - element[axis]) + margin;\n\n      if (group.range.min !== element[axis]) {\n        delta[axis] += element[axis] - group.range.min;\n      }\n\n      if (delta[axis]) {\n        modeling.moveElements([ element ], delta, element.parent);\n      }\n\n      group.range.max = Math.max(element[axis] + element[dimension], idx ? group.range.max : 0);\n    });\n  });\n};\n\nDistributeElements.prototype.postExecute = function(context) {\n\n};\n","import { forEach } from 'min-dash';\n\n/**\n * A handler that align elements in a certain way.\n *\n */\nexport default function AlignElements(modeling, canvas) {\n  this._modeling = modeling;\n  this._canvas = canvas;\n}\n\nAlignElements.$inject = [ 'modeling', 'canvas' ];\n\n\nAlignElements.prototype.preExecute = function(context) {\n  var modeling = this._modeling;\n\n  var elements = context.elements,\n      alignment = context.alignment;\n\n\n  forEach(elements, function(element) {\n    var delta = {\n      x: 0,\n      y: 0\n    };\n\n    if (alignment.left) {\n      delta.x = alignment.left - element.x;\n\n    } else if (alignment.right) {\n      delta.x = (alignment.right - element.width) - element.x;\n\n    } else if (alignment.center) {\n      delta.x = (alignment.center - Math.round(element.width / 2)) - element.x;\n\n    } else if (alignment.top) {\n      delta.y = alignment.top - element.y;\n\n    } else if (alignment.bottom) {\n      delta.y = (alignment.bottom - element.height) - element.y;\n\n    } else if (alignment.middle) {\n      delta.y = (alignment.middle - Math.round(element.height / 2)) - element.y;\n    }\n\n    modeling.moveElements([ element ], delta, element.parent);\n  });\n};\n\nAlignElements.prototype.postExecute = function(context) {\n\n};\n","import {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\n/**\n * A handler that implements reversible attaching/detaching of shapes.\n */\nexport default function UpdateAttachmentHandler(modeling) {\n  this._modeling = modeling;\n}\n\nUpdateAttachmentHandler.$inject = [ 'modeling' ];\n\n\nUpdateAttachmentHandler.prototype.execute = function(context) {\n  var shape = context.shape,\n      newHost = context.newHost,\n      oldHost = shape.host;\n\n  // (0) detach from old host\n  context.oldHost = oldHost;\n  context.attacherIdx = removeAttacher(oldHost, shape);\n\n  // (1) attach to new host\n  addAttacher(newHost, shape);\n\n  // (2) update host\n  shape.host = newHost;\n\n  return shape;\n};\n\nUpdateAttachmentHandler.prototype.revert = function(context) {\n  var shape = context.shape,\n      newHost = context.newHost,\n      oldHost = context.oldHost,\n      attacherIdx = context.attacherIdx;\n\n  // (2) update host\n  shape.host = oldHost;\n\n  // (1) attach to new host\n  removeAttacher(newHost, shape);\n\n  // (0) detach from old host\n  addAttacher(oldHost, shape, attacherIdx);\n\n  return shape;\n};\n\n\nfunction removeAttacher(host, attacher) {\n  // remove attacher from host\n  return collectionRemove(host && host.attachers, attacher);\n}\n\nfunction addAttacher(host, attacher, idx) {\n\n  if (!host) {\n    return;\n  }\n\n  var attachers = host.attachers;\n\n  if (!attachers) {\n    host.attachers = attachers = [];\n  }\n\n  collectionAdd(attachers, attacher, idx);\n}\n","import {\n  forEach,\n  map,\n  sortBy,\n  assign,\n} from 'min-dash';\n\nfunction removeProperties(element, properties) {\n  forEach(properties, function(prop) {\n    if (element[prop]) {\n      delete element[prop];\n    }\n  });\n}\n\n/**\n * A handler that implements pasting of elements onto the diagram.\n *\n * @param {eventBus} EventBus\n * @param {canvas} Canvas\n * @param {selection} Selection\n * @param {elementFactory} ElementFactory\n * @param {modeling} Modeling\n * @param {rules} Rules\n */\nexport default function PasteHandler(\n    eventBus, canvas, selection,\n    elementFactory, modeling, rules) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._selection = selection;\n  this._elementFactory = elementFactory;\n  this._modeling = modeling;\n  this._rules = rules;\n}\n\n\nPasteHandler.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'elementFactory',\n  'modeling',\n  'rules'\n];\n\n\n// api //////////////////////\n\n/**\n * Creates a new shape\n *\n * @param {Object} context\n * @param {Object} context.tree the new shape\n * @param {Element} context.topParent the paste target\n */\nPasteHandler.prototype.preExecute = function(context) {\n  var eventBus = this._eventBus,\n      self = this;\n\n  var tree = context.tree,\n      topParent = context.topParent,\n      position = context.position;\n\n  tree.createdElements = {};\n\n  tree.labels = [];\n\n  forEach(tree, function(elements, depthStr) {\n    var depth = parseInt(depthStr, 10);\n\n    if (isNaN(depth)) {\n      return;\n    }\n\n    // set the parent on the top level elements\n    if (!depth) {\n      elements = map(elements, function(descriptor) {\n        descriptor.parent = topParent;\n\n        return descriptor;\n      });\n    }\n\n    // Order by priority for element creation\n    elements = sortBy(elements, 'priority');\n\n    forEach(elements, function(descriptor) {\n      var id = descriptor.id,\n          parent = descriptor.parent,\n          hints = {},\n          newPosition;\n\n      var element = assign({}, descriptor);\n\n      if (depth) {\n        element.parent = self._getCreatedElement(parent, tree);\n      }\n\n      // this happens when shapes have not been created due to rules\n      if (!parent) {\n        return;\n      }\n\n      eventBus.fire('element.paste', {\n        createdElements: tree.createdElements,\n        descriptor: element\n      });\n\n      // in case the parent changed during 'element.paste'\n      parent = element.parent;\n\n      if (element.waypoints) {\n        element = self._createConnection(element, parent, position, tree);\n\n        if (element) {\n          tree.createdElements[id] = {\n            element: element,\n            descriptor: descriptor\n          };\n        }\n\n        return;\n      }\n\n\n      // supply not-root information as hint\n      if (element.parent !== topParent) {\n        hints.root = false;\n      }\n\n      // set host\n      if (element.host) {\n        hints.attach = true;\n\n        parent = self._getCreatedElement(element.host, tree);\n      }\n\n      // handle labels\n      if (element.labelTarget) {\n        return tree.labels.push(element);\n      }\n\n      newPosition = {\n        x: Math.round(position.x + element.delta.x + (element.width / 2)),\n        y: Math.round(position.y + element.delta.y + (element.height / 2))\n      };\n\n      removeProperties(element, [\n        'id',\n        'parent',\n        'delta',\n        'host',\n        'priority'\n      ]);\n\n      element = self._createShape(element, parent, newPosition, hints);\n\n      if (element) {\n        tree.createdElements[id] = {\n          element: element,\n          descriptor: descriptor\n        };\n      }\n    });\n  });\n};\n\n// move label's to their relative position\nPasteHandler.prototype.postExecute = function(context) {\n  var modeling = this._modeling,\n      selection = this._selection,\n      self = this;\n\n  var tree = context.tree,\n      labels = tree.labels,\n      topLevelElements = [];\n\n  forEach(labels, function(labelDescriptor) {\n    var labelTarget = self._getCreatedElement(labelDescriptor.labelTarget, tree),\n        labels, labelTargetPos, newPosition;\n\n    if (!labelTarget) {\n      return;\n    }\n\n    labels = labelTarget.labels;\n\n    if (!labels || !labels.length) {\n      return;\n    }\n\n    labelTargetPos = {\n      x: labelTarget.x,\n      y: labelTarget.y\n    };\n\n    if (labelTarget.waypoints) {\n      labelTargetPos = labelTarget.waypoints[0];\n    }\n\n    forEach(labels, function(label) {\n      newPosition = {\n        x: Math.round((labelTargetPos.x - label.x) + labelDescriptor.delta.x),\n        y: Math.round((labelTargetPos.y - label.y) + labelDescriptor.delta.y)\n      };\n\n      modeling.moveShape(label, newPosition, labelTarget.parent);\n    });\n  });\n\n  forEach(tree[0], function(descriptor) {\n    var id = descriptor.id,\n        toplevel = tree.createdElements[id];\n\n    if (toplevel) {\n      topLevelElements.push(toplevel.element);\n    }\n  });\n\n  selection.select(topLevelElements);\n};\n\n\nPasteHandler.prototype._createConnection = function(element, parent, parentCenter, tree) {\n  var modeling = this._modeling,\n      rules = this._rules;\n\n  var connection, source, target, canPaste;\n\n  element.waypoints = map(element.waypoints, function(waypoint, idx) {\n    return {\n      x: Math.round(parentCenter.x + element.delta[idx].x),\n      y: Math.round(parentCenter.y + element.delta[idx].y)\n    };\n  });\n\n  source = this._getCreatedElement(element.source, tree);\n  target = this._getCreatedElement(element.target, tree);\n\n  if (!source || !target) {\n    return null;\n  }\n\n  canPaste = rules.allowed('element.paste', {\n    source: source,\n    target: target\n  });\n\n  if (!canPaste) {\n    return null;\n  }\n\n  removeProperties(element, [\n    'id',\n    'parent',\n    'delta',\n    'source',\n    'target',\n    'width',\n    'height',\n    'priority'\n  ]);\n\n  connection = modeling.createConnection(source, target, element, parent);\n\n  return connection;\n};\n\n\nPasteHandler.prototype._createShape = function(element, parent, position, isAttach, hints) {\n  var modeling = this._modeling,\n      elementFactory = this._elementFactory,\n      rules = this._rules;\n\n  var canPaste = rules.allowed('element.paste', {\n    element: element,\n    position: position,\n    parent: parent\n  });\n\n  if (!canPaste) {\n    return null;\n  }\n\n  var shape = elementFactory.createShape(element);\n\n  modeling.createShape(shape, position, parent, isAttach, hints);\n\n  return shape;\n};\n\n\nPasteHandler.prototype._getCreatedElement = function(id, tree) {\n  return tree.createdElements[id] && tree.createdElements[id].element;\n};\n","import { forEach } from 'min-dash';\n\nimport {\n  Base\n} from '../../model';\n\nimport AppendShapeHandler from './cmd/AppendShapeHandler';\nimport CreateShapeHandler from './cmd/CreateShapeHandler';\nimport DeleteShapeHandler from './cmd/DeleteShapeHandler';\nimport MoveShapeHandler from './cmd/MoveShapeHandler';\nimport ResizeShapeHandler from './cmd/ResizeShapeHandler';\nimport ReplaceShapeHandler from './cmd/ReplaceShapeHandler';\nimport ToggleShapeCollapseHandler from './cmd/ToggleShapeCollapseHandler';\nimport SpaceToolHandler from './cmd/SpaceToolHandler';\nimport CreateLabelHandler from './cmd/CreateLabelHandler';\nimport CreateConnectionHandler from './cmd/CreateConnectionHandler';\nimport DeleteConnectionHandler from './cmd/DeleteConnectionHandler';\nimport MoveConnectionHandler from './cmd/MoveConnectionHandler';\nimport LayoutConnectionHandler from './cmd/LayoutConnectionHandler';\nimport UpdateWaypointsHandler from './cmd/UpdateWaypointsHandler';\nimport ReconnectConnectionHandler from './cmd/ReconnectConnectionHandler';\nimport MoveElementsHandler from './cmd/MoveElementsHandler';\nimport DeleteElementsHandler from './cmd/DeleteElementsHandler';\nimport DistributeElementsHandler from './cmd/DistributeElementsHandler';\nimport AlignElementsHandler from './cmd/AlignElementsHandler';\nimport UpdateAttachmentHandler from './cmd/UpdateAttachmentHandler';\nimport PasteHandler from './cmd/PasteHandler';\n\n\n/**\n * The basic modeling entry point.\n *\n * @param {EventBus} eventBus\n * @param {ElementFactory} elementFactory\n * @param {CommandStack} commandStack\n */\nexport default function Modeling(eventBus, elementFactory, commandStack) {\n  this._eventBus = eventBus;\n  this._elementFactory = elementFactory;\n  this._commandStack = commandStack;\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n    // register modeling handlers\n    self.registerHandlers(commandStack);\n  });\n}\n\nModeling.$inject = [ 'eventBus', 'elementFactory', 'commandStack' ];\n\n\nModeling.prototype.getHandlers = function() {\n  return {\n    'shape.append': AppendShapeHandler,\n    'shape.create': CreateShapeHandler,\n    'shape.delete': DeleteShapeHandler,\n    'shape.move': MoveShapeHandler,\n    'shape.resize': ResizeShapeHandler,\n    'shape.replace': ReplaceShapeHandler,\n    'shape.toggleCollapse': ToggleShapeCollapseHandler,\n\n    'spaceTool': SpaceToolHandler,\n\n    'label.create': CreateLabelHandler,\n\n    'connection.create': CreateConnectionHandler,\n    'connection.delete': DeleteConnectionHandler,\n    'connection.move': MoveConnectionHandler,\n    'connection.layout': LayoutConnectionHandler,\n\n    'connection.updateWaypoints': UpdateWaypointsHandler,\n\n    'connection.reconnectStart': ReconnectConnectionHandler,\n    'connection.reconnectEnd': ReconnectConnectionHandler,\n\n    'elements.move': MoveElementsHandler,\n    'elements.delete': DeleteElementsHandler,\n\n    'elements.distribute': DistributeElementsHandler,\n    'elements.align': AlignElementsHandler,\n\n    'element.updateAttachment': UpdateAttachmentHandler,\n\n    'elements.paste': PasteHandler\n  };\n};\n\n/**\n * Register handlers with the command stack\n *\n * @param {CommandStack} commandStack\n */\nModeling.prototype.registerHandlers = function(commandStack) {\n  forEach(this.getHandlers(), function(handler, id) {\n    commandStack.registerHandler(id, handler);\n  });\n};\n\n\n// modeling helpers //////////////////////\n\nModeling.prototype.moveShape = function(shape, delta, newParent, newParentIndex, hints) {\n\n  if (typeof newParentIndex === 'object') {\n    hints = newParentIndex;\n    newParentIndex = null;\n  }\n\n  var context = {\n    shape: shape,\n    delta:  delta,\n    newParent: newParent,\n    newParentIndex: newParentIndex,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.move', context);\n};\n\n\n/**\n * Update the attachment of the given shape.\n *\n * @param {djs.mode.Base} shape\n * @param {djs.model.Base} [newHost]\n */\nModeling.prototype.updateAttachment = function(shape, newHost) {\n  var context = {\n    shape: shape,\n    newHost: newHost\n  };\n\n  this._commandStack.execute('element.updateAttachment', context);\n};\n\n\n/**\n * Move a number of shapes to a new target, either setting it as\n * the new parent or attaching it.\n *\n * @param {Array<djs.mode.Base>} shapes\n * @param {Point} delta\n * @param {djs.model.Base} [target]\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach=false]\n */\nModeling.prototype.moveElements = function(shapes, delta, target, hints) {\n\n  hints = hints || {};\n\n  var attach = hints.attach;\n\n  var newParent = target,\n      newHost;\n\n  if (attach === true) {\n    newHost = target;\n    newParent = target.parent;\n  } else\n\n  if (attach === false) {\n    newHost = null;\n  }\n\n  var context = {\n    shapes: shapes,\n    delta: delta,\n    newParent: newParent,\n    newHost: newHost,\n    hints: hints\n  };\n\n  this._commandStack.execute('elements.move', context);\n};\n\n\nModeling.prototype.moveConnection = function(connection, delta, newParent, newParentIndex, hints) {\n\n  if (typeof newParentIndex === 'object') {\n    hints = newParentIndex;\n    newParentIndex = undefined;\n  }\n\n  var context = {\n    connection: connection,\n    delta: delta,\n    newParent: newParent,\n    newParentIndex: newParentIndex,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.move', context);\n};\n\n\nModeling.prototype.layoutConnection = function(connection, hints) {\n  var context = {\n    connection: connection,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.layout', context);\n};\n\n\n/**\n * Create connection.\n *\n * @param {djs.model.Base} source\n * @param {djs.model.Base} target\n * @param {Number} [targetIndex]\n * @param {Object|djs.model.Connection} connection\n * @param {djs.model.Base} parent\n * @param {Object} hints\n *\n * @return {djs.model.Connection} the created connection.\n */\nModeling.prototype.createConnection = function(source, target, parentIndex, connection, parent, hints) {\n\n  if (typeof parentIndex === 'object') {\n    hints = parent;\n    parent = connection;\n    connection = parentIndex;\n    parentIndex = undefined;\n  }\n\n  connection = this._create('connection', connection);\n\n  var context = {\n    source: source,\n    target: target,\n    parent: parent,\n    parentIndex: parentIndex,\n    connection: connection,\n    hints: hints\n  };\n\n  this._commandStack.execute('connection.create', context);\n\n  return context.connection;\n};\n\n\n/**\n * Create a shape at the specified position.\n *\n * @param {djs.model.Shape|Object} shape\n * @param {Point} position\n * @param {djs.model.Shape|djs.model.Root} target\n * @param {Number} [parentIndex] position in parents children list\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach] whether to attach to target or become a child\n *\n * @return {djs.model.Shape} the created shape\n */\nModeling.prototype.createShape = function(shape, position, target, parentIndex, hints) {\n\n  if (typeof parentIndex !== 'number') {\n    hints = parentIndex;\n    parentIndex = undefined;\n  }\n\n  hints = hints || {};\n\n  var attach = hints.attach,\n      parent,\n      host;\n\n  shape = this._create('shape', shape);\n\n  if (attach) {\n    parent = target.parent;\n    host = target;\n  } else {\n    parent = target;\n  }\n\n  var context = {\n    position: position,\n    shape: shape,\n    parent: parent,\n    parentIndex: parentIndex,\n    host: host,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.create', context);\n\n  return context.shape;\n};\n\n\nModeling.prototype.createLabel = function(labelTarget, position, label, parent) {\n\n  label = this._create('label', label);\n\n  var context = {\n    labelTarget: labelTarget,\n    position: position,\n    parent: parent || labelTarget.parent,\n    shape: label\n  };\n\n  this._commandStack.execute('label.create', context);\n\n  return context.shape;\n};\n\n\n/**\n * Append shape to given source, drawing a connection\n * between source and the newly created shape.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape|Object} shape\n * @param {Point} position\n * @param {djs.model.Shape} target\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach]\n * @param {djs.model.Connection|Object} [hints.connection]\n * @param {djs.model.Base} [hints.connectionParent]\n *\n * @return {djs.model.Shape} the newly created shape\n */\nModeling.prototype.appendShape = function(source, shape, position, target, hints) {\n\n  hints = hints || {};\n\n  shape = this._create('shape', shape);\n\n  var context = {\n    source: source,\n    position: position,\n    target: target,\n    shape: shape,\n    connection: hints.connection,\n    connectionParent: hints.connectionParent,\n    attach: hints.attach\n  };\n\n  this._commandStack.execute('shape.append', context);\n\n  return context.shape;\n};\n\n\nModeling.prototype.removeElements = function(elements) {\n  var context = {\n    elements: elements\n  };\n\n  this._commandStack.execute('elements.delete', context);\n};\n\n\nModeling.prototype.distributeElements = function(groups, axis, dimension) {\n  var context = {\n    groups: groups,\n    axis: axis,\n    dimension: dimension\n  };\n\n  this._commandStack.execute('elements.distribute', context);\n};\n\n\nModeling.prototype.removeShape = function(shape, hints) {\n  var context = {\n    shape: shape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.delete', context);\n};\n\n\nModeling.prototype.removeConnection = function(connection, hints) {\n  var context = {\n    connection: connection,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.delete', context);\n};\n\nModeling.prototype.replaceShape = function(oldShape, newShape, hints) {\n  var context = {\n    oldShape: oldShape,\n    newData: newShape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.replace', context);\n\n  return context.newShape;\n};\n\nModeling.prototype.pasteElements = function(tree, topParent, position) {\n  var context = {\n    tree: tree,\n    topParent: topParent,\n    position: position\n  };\n\n  this._commandStack.execute('elements.paste', context);\n};\n\nModeling.prototype.alignElements = function(elements, alignment) {\n  var context = {\n    elements: elements,\n    alignment: alignment\n  };\n\n  this._commandStack.execute('elements.align', context);\n};\n\nModeling.prototype.resizeShape = function(shape, newBounds, minBounds, hints) {\n  var context = {\n    shape: shape,\n    newBounds: newBounds,\n    minBounds: minBounds,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.resize', context);\n};\n\nModeling.prototype.createSpace = function(movingShapes, resizingShapes, delta, direction) {\n  var context = {\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes,\n    delta: delta,\n    direction: direction\n  };\n\n  this._commandStack.execute('spaceTool', context);\n};\n\nModeling.prototype.updateWaypoints = function(connection, newWaypoints, hints) {\n  var context = {\n    connection: connection,\n    newWaypoints: newWaypoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.updateWaypoints', context);\n};\n\nModeling.prototype.reconnectStart = function(connection, newSource, dockingOrPoints, hints) {\n  var context = {\n    connection: connection,\n    newSource: newSource,\n    dockingOrPoints: dockingOrPoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.reconnectStart', context);\n};\n\nModeling.prototype.reconnectEnd = function(connection, newTarget, dockingOrPoints, hints) {\n  var context = {\n    connection: connection,\n    newTarget: newTarget,\n    dockingOrPoints: dockingOrPoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.reconnectEnd', context);\n};\n\nModeling.prototype.connect = function(source, target, attrs, hints) {\n  return this.createConnection(source, target, attrs || {}, source.parent, hints);\n};\n\nModeling.prototype._create = function(type, attrs) {\n  if (attrs instanceof Base) {\n    return attrs;\n  } else {\n    return this._elementFactory.create(type, attrs);\n  }\n};\n\nModeling.prototype.toggleCollapse = function(shape, hints) {\n  var context = {\n    shape: shape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.toggleCollapse', context);\n};\n","/**\n * Moddle base element.\n */\nexport default function Base() { }\n\nBase.prototype.get = function(name) {\n  return this.$model.properties.get(this, name);\n};\n\nBase.prototype.set = function(name, value) {\n  this.$model.properties.set(this, name, value);\n};","import {\n  forEach,\n  bind\n} from 'min-dash';\n\nimport Base from './base';\n\n/**\n * A model element factory.\n *\n * @param {Moddle} model\n * @param {Properties} properties\n */\nexport default function Factory(model, properties) {\n  this.model = model;\n  this.properties = properties;\n}\n\n\nFactory.prototype.createType = function(descriptor) {\n\n  var model = this.model;\n\n  var props = this.properties,\n      prototype = Object.create(Base.prototype);\n\n  // initialize default values\n  forEach(descriptor.properties, function(p) {\n    if (!p.isMany && p.default !== undefined) {\n      prototype[p.name] = p.default;\n    }\n  });\n\n  props.defineModel(prototype, model);\n  props.defineDescriptor(prototype, descriptor);\n\n  var name = descriptor.ns.name;\n\n  /**\n   * The new type constructor\n   */\n  function ModdleElement(attrs) {\n    props.define(this, '$type', { value: name, enumerable: true });\n    props.define(this, '$attrs', { value: {} });\n    props.define(this, '$parent', { writable: true });\n\n    forEach(attrs, bind(function(val, key) {\n      this.set(key, val);\n    }, this));\n  }\n\n  ModdleElement.prototype = prototype;\n\n  ModdleElement.hasType = prototype.$instanceOf = this.model.hasType;\n\n  // static links\n  props.defineModel(ModdleElement, model);\n  props.defineDescriptor(ModdleElement, descriptor);\n\n  return ModdleElement;\n};","/**\n * Built-in moddle types\n */\nvar BUILTINS = {\n  String: true,\n  Boolean: true,\n  Integer: true,\n  Real: true,\n  Element: true\n};\n\n/**\n * Converters for built in types from string representations\n */\nvar TYPE_CONVERTERS = {\n  String: function(s) { return s; },\n  Boolean: function(s) { return s === 'true'; },\n  Integer: function(s) { return parseInt(s, 10); },\n  Real: function(s) { return parseFloat(s, 10); }\n};\n\n/**\n * Convert a type to its real representation\n */\nexport function coerceType(type, value) {\n\n  var converter = TYPE_CONVERTERS[type];\n\n  if (converter) {\n    return converter(value);\n  } else {\n    return value;\n  }\n}\n\n/**\n * Return whether the given type is built-in\n */\nexport function isBuiltIn(type) {\n  return !!BUILTINS[type];\n}\n\n/**\n * Return whether the given type is simple\n */\nexport function isSimple(type) {\n  return !!TYPE_CONVERTERS[type];\n}","/**\n * Parses a namespaced attribute name of the form (ns:)localName to an object,\n * given a default prefix to assume in case no explicit namespace is given.\n *\n * @param {String} name\n * @param {String} [defaultPrefix] the default prefix to take, if none is present.\n *\n * @return {Object} the parsed name\n */\nexport function parseName(name, defaultPrefix) {\n  var parts = name.split(/:/),\n      localName, prefix;\n\n  // no prefix (i.e. only local name)\n  if (parts.length === 1) {\n    localName = name;\n    prefix = defaultPrefix;\n  } else\n  // prefix + local name\n  if (parts.length === 2) {\n    localName = parts[1];\n    prefix = parts[0];\n  } else {\n    throw new Error('expected <prefix:localName> or <localName>, got ' + name);\n  }\n\n  name = (prefix ? prefix + ':' : '') + localName;\n\n  return {\n    name: name,\n    prefix: prefix,\n    localName: localName\n  };\n}","import {\n  pick,\n  assign,\n  forEach,\n  bind\n} from 'min-dash';\n\nimport {\n  parseName as parseNameNs\n} from './ns';\n\n\n/**\n * A utility to build element descriptors.\n */\nexport default function DescriptorBuilder(nameNs) {\n  this.ns = nameNs;\n  this.name = nameNs.name;\n  this.allTypes = [];\n  this.allTypesByName = {};\n  this.properties = [];\n  this.propertiesByName = {};\n}\n\n\nDescriptorBuilder.prototype.build = function() {\n  return pick(this, [\n    'ns',\n    'name',\n    'allTypes',\n    'allTypesByName',\n    'properties',\n    'propertiesByName',\n    'bodyProperty',\n    'idProperty'\n  ]);\n};\n\n/**\n * Add property at given index.\n *\n * @param {Object} p\n * @param {Number} [idx]\n * @param {Boolean} [validate=true]\n */\nDescriptorBuilder.prototype.addProperty = function(p, idx, validate) {\n\n  if (typeof idx === 'boolean') {\n    validate = idx;\n    idx = undefined;\n  }\n\n  this.addNamedProperty(p, validate !== false);\n\n  var properties = this.properties;\n\n  if (idx !== undefined) {\n    properties.splice(idx, 0, p);\n  } else {\n    properties.push(p);\n  }\n};\n\n\nDescriptorBuilder.prototype.replaceProperty = function(oldProperty, newProperty, replace) {\n  var oldNameNs = oldProperty.ns;\n\n  var props = this.properties,\n      propertiesByName = this.propertiesByName,\n      rename = oldProperty.name !== newProperty.name;\n\n  if (oldProperty.isId) {\n    if (!newProperty.isId) {\n      throw new Error(\n        'property <' + newProperty.ns.name + '> must be id property ' +\n        'to refine <' + oldProperty.ns.name + '>');\n    }\n\n    this.setIdProperty(newProperty, false);\n  }\n\n  if (oldProperty.isBody) {\n\n    if (!newProperty.isBody) {\n      throw new Error(\n        'property <' + newProperty.ns.name + '> must be body property ' +\n        'to refine <' + oldProperty.ns.name + '>');\n    }\n\n    // TODO: Check compatibility\n    this.setBodyProperty(newProperty, false);\n  }\n\n  // validate existence and get location of old property\n  var idx = props.indexOf(oldProperty);\n  if (idx === -1) {\n    throw new Error('property <' + oldNameNs.name + '> not found in property list');\n  }\n\n  // remove old property\n  props.splice(idx, 1);\n\n  // replacing the named property is intentional\n  //\n  //  * validate only if this is a \"rename\" operation\n  //  * add at specific index unless we \"replace\"\n  //\n  this.addProperty(newProperty, replace ? undefined : idx, rename);\n\n  // make new property available under old name\n  propertiesByName[oldNameNs.name] = propertiesByName[oldNameNs.localName] = newProperty;\n};\n\n\nDescriptorBuilder.prototype.redefineProperty = function(p, targetPropertyName, replace) {\n\n  var nsPrefix = p.ns.prefix;\n  var parts = targetPropertyName.split('#');\n\n  var name = parseNameNs(parts[0], nsPrefix);\n  var attrName = parseNameNs(parts[1], name.prefix).name;\n\n  var redefinedProperty = this.propertiesByName[attrName];\n  if (!redefinedProperty) {\n    throw new Error('refined property <' + attrName + '> not found');\n  } else {\n    this.replaceProperty(redefinedProperty, p, replace);\n  }\n\n  delete p.redefines;\n};\n\nDescriptorBuilder.prototype.addNamedProperty = function(p, validate) {\n  var ns = p.ns,\n      propsByName = this.propertiesByName;\n\n  if (validate) {\n    this.assertNotDefined(p, ns.name);\n    this.assertNotDefined(p, ns.localName);\n  }\n\n  propsByName[ns.name] = propsByName[ns.localName] = p;\n};\n\nDescriptorBuilder.prototype.removeNamedProperty = function(p) {\n  var ns = p.ns,\n      propsByName = this.propertiesByName;\n\n  delete propsByName[ns.name];\n  delete propsByName[ns.localName];\n};\n\nDescriptorBuilder.prototype.setBodyProperty = function(p, validate) {\n\n  if (validate && this.bodyProperty) {\n    throw new Error(\n      'body property defined multiple times ' +\n      '(<' + this.bodyProperty.ns.name + '>, <' + p.ns.name + '>)');\n  }\n\n  this.bodyProperty = p;\n};\n\nDescriptorBuilder.prototype.setIdProperty = function(p, validate) {\n\n  if (validate && this.idProperty) {\n    throw new Error(\n      'id property defined multiple times ' +\n      '(<' + this.idProperty.ns.name + '>, <' + p.ns.name + '>)');\n  }\n\n  this.idProperty = p;\n};\n\nDescriptorBuilder.prototype.assertNotDefined = function(p, name) {\n  var propertyName = p.name,\n      definedProperty = this.propertiesByName[propertyName];\n\n  if (definedProperty) {\n    throw new Error(\n      'property <' + propertyName + '> already defined; ' +\n      'override of <' + definedProperty.definedBy.ns.name + '#' + definedProperty.ns.name + '> by ' +\n      '<' + p.definedBy.ns.name + '#' + p.ns.name + '> not allowed without redefines');\n  }\n};\n\nDescriptorBuilder.prototype.hasProperty = function(name) {\n  return this.propertiesByName[name];\n};\n\nDescriptorBuilder.prototype.addTrait = function(t, inherited) {\n\n  var typesByName = this.allTypesByName,\n      types = this.allTypes;\n\n  var typeName = t.name;\n\n  if (typeName in typesByName) {\n    return;\n  }\n\n  forEach(t.properties, bind(function(p) {\n\n    // clone property to allow extensions\n    p = assign({}, p, {\n      name: p.ns.localName,\n      inherited: inherited\n    });\n\n    Object.defineProperty(p, 'definedBy', {\n      value: t\n    });\n\n    var replaces = p.replaces,\n        redefines = p.redefines;\n\n    // add replace/redefine support\n    if (replaces || redefines) {\n      this.redefineProperty(p, replaces || redefines, replaces);\n    } else {\n      if (p.isBody) {\n        this.setBodyProperty(p);\n      }\n      if (p.isId) {\n        this.setIdProperty(p);\n      }\n      this.addProperty(p);\n    }\n  }, this));\n\n  types.push(t);\n  typesByName[typeName] = t;\n};","import {\n  assign,\n  forEach,\n  bind\n} from 'min-dash';\n\nimport {\n  isBuiltIn as isBuiltInType\n} from './types';\n\nimport DescriptorBuilder from './descriptor-builder';\n\nimport {\n  parseName as parseNameNs\n} from './ns';\n\n\n/**\n * A registry of Moddle packages.\n *\n * @param {Array<Package>} packages\n * @param {Properties} properties\n */\nexport default function Registry(packages, properties) {\n  this.packageMap = {};\n  this.typeMap = {};\n\n  this.packages = [];\n\n  this.properties = properties;\n\n  forEach(packages, bind(this.registerPackage, this));\n}\n\n\nRegistry.prototype.getPackage = function(uriOrPrefix) {\n  return this.packageMap[uriOrPrefix];\n};\n\nRegistry.prototype.getPackages = function() {\n  return this.packages;\n};\n\n\nRegistry.prototype.registerPackage = function(pkg) {\n\n  // copy package\n  pkg = assign({}, pkg);\n\n  var pkgMap = this.packageMap;\n\n  ensureAvailable(pkgMap, pkg, 'prefix');\n  ensureAvailable(pkgMap, pkg, 'uri');\n\n  // register types\n  forEach(pkg.types, bind(function(descriptor) {\n    this.registerType(descriptor, pkg);\n  }, this));\n\n  pkgMap[pkg.uri] = pkgMap[pkg.prefix] = pkg;\n  this.packages.push(pkg);\n};\n\n\n/**\n * Register a type from a specific package with us\n */\nRegistry.prototype.registerType = function(type, pkg) {\n\n  type = assign({}, type, {\n    superClass: (type.superClass || []).slice(),\n    extends: (type.extends || []).slice(),\n    properties: (type.properties || []).slice(),\n    meta: assign(({}, type.meta || {}))\n  });\n\n  var ns = parseNameNs(type.name, pkg.prefix),\n      name = ns.name,\n      propertiesByName = {};\n\n  // parse properties\n  forEach(type.properties, bind(function(p) {\n\n    // namespace property names\n    var propertyNs = parseNameNs(p.name, ns.prefix),\n        propertyName = propertyNs.name;\n\n    // namespace property types\n    if (!isBuiltInType(p.type)) {\n      p.type = parseNameNs(p.type, propertyNs.prefix).name;\n    }\n\n    assign(p, {\n      ns: propertyNs,\n      name: propertyName\n    });\n\n    propertiesByName[propertyName] = p;\n  }, this));\n\n  // update ns + name\n  assign(type, {\n    ns: ns,\n    name: name,\n    propertiesByName: propertiesByName\n  });\n\n  forEach(type.extends, bind(function(extendsName) {\n    var extended = this.typeMap[extendsName];\n\n    extended.traits = extended.traits || [];\n    extended.traits.push(name);\n  }, this));\n\n  // link to package\n  this.definePackage(type, pkg);\n\n  // register\n  this.typeMap[name] = type;\n};\n\n\n/**\n * Traverse the type hierarchy from bottom to top,\n * calling iterator with (type, inherited) for all elements in\n * the inheritance chain.\n *\n * @param {Object} nsName\n * @param {Function} iterator\n * @param {Boolean} [trait=false]\n */\nRegistry.prototype.mapTypes = function(nsName, iterator, trait) {\n\n  var type = isBuiltInType(nsName.name) ? { name: nsName.name } : this.typeMap[nsName.name];\n\n  var self = this;\n\n  /**\n   * Traverse the selected trait.\n   *\n   * @param {String} cls\n   */\n  function traverseTrait(cls) {\n    return traverseSuper(cls, true);\n  }\n\n  /**\n   * Traverse the selected super type or trait\n   *\n   * @param {String} cls\n   * @param {Boolean} [trait=false]\n   */\n  function traverseSuper(cls, trait) {\n    var parentNs = parseNameNs(cls, isBuiltInType(cls) ? '' : nsName.prefix);\n    self.mapTypes(parentNs, iterator, trait);\n  }\n\n  if (!type) {\n    throw new Error('unknown type <' + nsName.name + '>');\n  }\n\n  forEach(type.superClass, trait ? traverseTrait : traverseSuper);\n\n  // call iterator with (type, inherited=!trait)\n  iterator(type, !trait);\n\n  forEach(type.traits, traverseTrait);\n};\n\n\n/**\n * Returns the effective descriptor for a type.\n *\n * @param  {String} type the namespaced name (ns:localName) of the type\n *\n * @return {Descriptor} the resulting effective descriptor\n */\nRegistry.prototype.getEffectiveDescriptor = function(name) {\n\n  var nsName = parseNameNs(name);\n\n  var builder = new DescriptorBuilder(nsName);\n\n  this.mapTypes(nsName, function(type, inherited) {\n    builder.addTrait(type, inherited);\n  });\n\n  var descriptor = builder.build();\n\n  // define package link\n  this.definePackage(descriptor, descriptor.allTypes[descriptor.allTypes.length - 1].$pkg);\n\n  return descriptor;\n};\n\n\nRegistry.prototype.definePackage = function(target, pkg) {\n  this.properties.define(target, '$pkg', { value: pkg });\n};\n\n\n\n///////// helpers ////////////////////////////\n\nfunction ensureAvailable(packageMap, pkg, identifierKey) {\n\n  var value = pkg[identifierKey];\n\n  if (value in packageMap) {\n    throw new Error('package with ' + identifierKey + ' <' + value + '> already defined');\n  }\n}\n","/**\n * A utility that gets and sets properties of model elements.\n *\n * @param {Model} model\n */\nexport default function Properties(model) {\n  this.model = model;\n}\n\n\n/**\n * Sets a named property on the target element.\n * If the value is undefined, the property gets deleted.\n *\n * @param {Object} target\n * @param {String} name\n * @param {Object} value\n */\nProperties.prototype.set = function(target, name, value) {\n\n  var property = this.model.getPropertyDescriptor(target, name);\n\n  var propertyName = property && property.name;\n\n  if (isUndefined(value)) {\n    // unset the property, if the specified value is undefined;\n    // delete from $attrs (for extensions) or the target itself\n    if (property) {\n      delete target[propertyName];\n    } else {\n      delete target.$attrs[name];\n    }\n  } else {\n    // set the property, defining well defined properties on the fly\n    // or simply updating them in target.$attrs (for extensions)\n    if (property) {\n      if (propertyName in target) {\n        target[propertyName] = value;\n      } else {\n        defineProperty(target, property, value);\n      }\n    } else {\n      target.$attrs[name] = value;\n    }\n  }\n};\n\n/**\n * Returns the named property of the given element\n *\n * @param  {Object} target\n * @param  {String} name\n *\n * @return {Object}\n */\nProperties.prototype.get = function(target, name) {\n\n  var property = this.model.getPropertyDescriptor(target, name);\n\n  if (!property) {\n    return target.$attrs[name];\n  }\n\n  var propertyName = property.name;\n\n  // check if access to collection property and lazily initialize it\n  if (!target[propertyName] && property.isMany) {\n    defineProperty(target, property, []);\n  }\n\n  return target[propertyName];\n};\n\n\n/**\n * Define a property on the target element\n *\n * @param  {Object} target\n * @param  {String} name\n * @param  {Object} options\n */\nProperties.prototype.define = function(target, name, options) {\n  Object.defineProperty(target, name, options);\n};\n\n\n/**\n * Define the descriptor for an element\n */\nProperties.prototype.defineDescriptor = function(target, descriptor) {\n  this.define(target, '$descriptor', { value: descriptor });\n};\n\n/**\n * Define the model for an element\n */\nProperties.prototype.defineModel = function(target, model) {\n  this.define(target, '$model', { value: model });\n};\n\n\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\nfunction defineProperty(target, property, value) {\n  Object.defineProperty(target, property.name, {\n    enumerable: !property.isReference,\n    writable: true,\n    value: value,\n    configurable: true\n  });\n}","import {\n  isString,\n  isObject,\n  forEach\n} from 'min-dash';\n\nimport Factory from './factory';\nimport Registry from './registry';\nimport Properties from './properties';\n\nimport {\n  parseName as parseNameNs\n} from './ns';\n\n\n//// Moddle implementation /////////////////////////////////////////////////\n\n/**\n * @class Moddle\n *\n * A model that can be used to create elements of a specific type.\n *\n * @example\n *\n * var Moddle = require('moddle');\n *\n * var pkg = {\n *   name: 'mypackage',\n *   prefix: 'my',\n *   types: [\n *     { name: 'Root' }\n *   ]\n * };\n *\n * var moddle = new Moddle([pkg]);\n *\n * @param {Array<Package>} packages the packages to contain\n */\nexport default function Moddle(packages) {\n\n  this.properties = new Properties(this);\n\n  this.factory = new Factory(this, this.properties);\n  this.registry = new Registry(packages, this.properties);\n\n  this.typeCache = {};\n}\n\n\n/**\n * Create an instance of the specified type.\n *\n * @method Moddle#create\n *\n * @example\n *\n * var foo = moddle.create('my:Foo');\n * var bar = moddle.create('my:Bar', { id: 'BAR_1' });\n *\n * @param  {String|Object} descriptor the type descriptor or name know to the model\n * @param  {Object} attrs   a number of attributes to initialize the model instance with\n * @return {Object}         model instance\n */\nModdle.prototype.create = function(descriptor, attrs) {\n  var Type = this.getType(descriptor);\n\n  if (!Type) {\n    throw new Error('unknown type <' + descriptor + '>');\n  }\n\n  return new Type(attrs);\n};\n\n\n/**\n * Returns the type representing a given descriptor\n *\n * @method Moddle#getType\n *\n * @example\n *\n * var Foo = moddle.getType('my:Foo');\n * var foo = new Foo({ 'id' : 'FOO_1' });\n *\n * @param  {String|Object} descriptor the type descriptor or name know to the model\n * @return {Object}         the type representing the descriptor\n */\nModdle.prototype.getType = function(descriptor) {\n\n  var cache = this.typeCache;\n\n  var name = isString(descriptor) ? descriptor : descriptor.ns.name;\n\n  var type = cache[name];\n\n  if (!type) {\n    descriptor = this.registry.getEffectiveDescriptor(name);\n    type = cache[name] = this.factory.createType(descriptor);\n  }\n\n  return type;\n};\n\n\n/**\n * Creates an any-element type to be used within model instances.\n *\n * This can be used to create custom elements that lie outside the meta-model.\n * The created element contains all the meta-data required to serialize it\n * as part of meta-model elements.\n *\n * @method Moddle#createAny\n *\n * @example\n *\n * var foo = moddle.createAny('vendor:Foo', 'http://vendor', {\n *   value: 'bar'\n * });\n *\n * var container = moddle.create('my:Container', 'http://my', {\n *   any: [ foo ]\n * });\n *\n * // go ahead and serialize the stuff\n *\n *\n * @param  {String} name  the name of the element\n * @param  {String} nsUri the namespace uri of the element\n * @param  {Object} [properties] a map of properties to initialize the instance with\n * @return {Object} the any type instance\n */\nModdle.prototype.createAny = function(name, nsUri, properties) {\n\n  var nameNs = parseNameNs(name);\n\n  var element = {\n    $type: name,\n    $instanceOf: function(type) {\n      return type === this.$type;\n    }\n  };\n\n  var descriptor = {\n    name: name,\n    isGeneric: true,\n    ns: {\n      prefix: nameNs.prefix,\n      localName: nameNs.localName,\n      uri: nsUri\n    }\n  };\n\n  this.properties.defineDescriptor(element, descriptor);\n  this.properties.defineModel(element, this);\n  this.properties.define(element, '$parent', { enumerable: false, writable: true });\n\n  forEach(properties, function(a, key) {\n    if (isObject(a) && a.value !== undefined) {\n      element[a.name] = a.value;\n    } else {\n      element[key] = a;\n    }\n  });\n\n  return element;\n};\n\n/**\n * Returns a registered package by uri or prefix\n *\n * @return {Object} the package\n */\nModdle.prototype.getPackage = function(uriOrPrefix) {\n  return this.registry.getPackage(uriOrPrefix);\n};\n\n/**\n * Returns a snapshot of all known packages\n *\n * @return {Object} the package\n */\nModdle.prototype.getPackages = function() {\n  return this.registry.getPackages();\n};\n\n/**\n * Returns the descriptor for an element\n */\nModdle.prototype.getElementDescriptor = function(element) {\n  return element.$descriptor;\n};\n\n/**\n * Returns true if the given descriptor or instance\n * represents the given type.\n *\n * May be applied to this, if element is omitted.\n */\nModdle.prototype.hasType = function(element, type) {\n  if (type === undefined) {\n    type = element;\n    element = this;\n  }\n\n  var descriptor = element.$model.getElementDescriptor(element);\n\n  return (type in descriptor.allTypesByName);\n};\n\n/**\n * Returns the descriptor of an elements named property\n */\nModdle.prototype.getPropertyDescriptor = function(element, property) {\n  return this.getElementDescriptor(element).propertiesByName[property];\n};\n\n/**\n * Returns a mapped type's descriptor\n */\nModdle.prototype.getTypeDescriptor = function(type) {\n  return this.registry.typeMap[type];\n};","export function hasLowerCaseAlias(pkg) {\n  return pkg.xml && pkg.xml.tagAlias === 'lowerCase';\n}\n\nexport var DEFAULT_NS_MAP = {\n  'xsi': 'http://www.w3.org/2001/XMLSchema-instance'\n};\n\nexport var XSI_TYPE = 'xsi:type';\n\nfunction serializeFormat(element) {\n  return element.xml && element.xml.serialize;\n}\n\nexport function serializeAsType(element) {\n  return serializeFormat(element) === XSI_TYPE;\n}\n\nexport function serializeAsProperty(element) {\n  return serializeFormat(element) === 'property';\n}","import {\n  forEach,\n  find,\n  assign\n} from 'min-dash';\n\nimport {\n  Parser as SaxParser\n} from 'saxen';\n\nimport Moddle from 'moddle';\nimport {\n  parseName as parseNameNs\n} from 'moddle/lib/ns';\n\nimport {\n  coerceType,\n  isSimple as isSimpleType\n} from 'moddle/lib/types';\n\nimport {\n  XSI_TYPE,\n  serializeAsType,\n  hasLowerCaseAlias\n} from './common';\n\nfunction capitalize(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nfunction aliasToName(aliasNs, pkg) {\n\n  if (!hasLowerCaseAlias(pkg)) {\n    return aliasNs.name;\n  }\n\n  return aliasNs.prefix + ':' + capitalize(aliasNs.localName);\n}\n\nfunction prefixedToName(nameNs, pkg) {\n\n  var name = nameNs.name,\n      localName = nameNs.localName;\n\n  var typePrefix = pkg.xml && pkg.xml.typePrefix;\n\n  if (typePrefix && localName.indexOf(typePrefix) === 0) {\n    return nameNs.prefix + ':' + localName.slice(typePrefix.length);\n  } else {\n    return name;\n  }\n}\n\nfunction normalizeXsiTypeName(name, model) {\n\n  var nameNs = parseNameNs(name);\n  var pkg = model.getPackage(nameNs.prefix);\n\n  return prefixedToName(nameNs, pkg);\n}\n\nfunction error(message) {\n  return new Error(message);\n}\n\n/**\n * Get the moddle descriptor for a given instance or type.\n *\n * @param  {ModdleElement|Function} element\n *\n * @return {Object} the moddle descriptor\n */\nfunction getModdleDescriptor(element) {\n  return element.$descriptor;\n}\n\nfunction defer(fn) {\n  setTimeout(fn, 0);\n}\n\n/**\n * A parse context.\n *\n * @class\n *\n * @param {Object} options\n * @param {ElementHandler} options.rootHandler the root handler for parsing a document\n * @param {boolean} [options.lax=false] whether or not to ignore invalid elements\n */\nexport function Context(options) {\n\n  /**\n   * @property {ElementHandler} rootHandler\n   */\n\n  /**\n   * @property {Boolean} lax\n   */\n\n  assign(this, options);\n\n  this.elementsById = {};\n  this.references = [];\n  this.warnings = [];\n\n  /**\n   * Add an unresolved reference.\n   *\n   * @param {Object} reference\n   */\n  this.addReference = function(reference) {\n    this.references.push(reference);\n  };\n\n  /**\n   * Add a processed element.\n   *\n   * @param {ModdleElement} element\n   */\n  this.addElement = function(element) {\n\n    if (!element) {\n      throw error('expected element');\n    }\n\n    var elementsById = this.elementsById;\n\n    var descriptor = getModdleDescriptor(element);\n\n    var idProperty = descriptor.idProperty,\n        id;\n\n    if (idProperty) {\n      id = element.get(idProperty.name);\n\n      if (id) {\n        // for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\n        if (!/^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i.test(id)) {\n          throw new Error('illegal ID <' + id + '>');\n        }\n\n        if (elementsById[id]) {\n          throw error('duplicate ID <' + id + '>');\n        }\n\n        elementsById[id] = element;\n      }\n    }\n  };\n\n  /**\n   * Add an import warning.\n   *\n   * @param {Object} warning\n   * @param {String} warning.message\n   * @param {Error} [warning.error]\n   */\n  this.addWarning = function(warning) {\n    this.warnings.push(warning);\n  };\n}\n\nfunction BaseHandler() {}\n\nBaseHandler.prototype.handleEnd = function() {};\nBaseHandler.prototype.handleText = function() {};\nBaseHandler.prototype.handleNode = function() {};\n\n\n/**\n * A simple pass through handler that does nothing except for\n * ignoring all input it receives.\n *\n * This is used to ignore unknown elements and\n * attributes.\n */\nfunction NoopHandler() { }\n\nNoopHandler.prototype = Object.create(BaseHandler.prototype);\n\nNoopHandler.prototype.handleNode = function() {\n  return this;\n};\n\nfunction BodyHandler() {}\n\nBodyHandler.prototype = Object.create(BaseHandler.prototype);\n\nBodyHandler.prototype.handleText = function(text) {\n  this.body = (this.body || '') + text;\n};\n\nfunction ReferenceHandler(property, context) {\n  this.property = property;\n  this.context = context;\n}\n\nReferenceHandler.prototype = Object.create(BodyHandler.prototype);\n\nReferenceHandler.prototype.handleNode = function(node) {\n\n  if (this.element) {\n    throw error('expected no sub nodes');\n  } else {\n    this.element = this.createReference(node);\n  }\n\n  return this;\n};\n\nReferenceHandler.prototype.handleEnd = function() {\n  this.element.id = this.body;\n};\n\nReferenceHandler.prototype.createReference = function(node) {\n  return {\n    property: this.property.ns.name,\n    id: ''\n  };\n};\n\nfunction ValueHandler(propertyDesc, element) {\n  this.element = element;\n  this.propertyDesc = propertyDesc;\n}\n\nValueHandler.prototype = Object.create(BodyHandler.prototype);\n\nValueHandler.prototype.handleEnd = function() {\n\n  var value = this.body || '',\n      element = this.element,\n      propertyDesc = this.propertyDesc;\n\n  value = coerceType(propertyDesc.type, value);\n\n  if (propertyDesc.isMany) {\n    element.get(propertyDesc.name).push(value);\n  } else {\n    element.set(propertyDesc.name, value);\n  }\n};\n\n\nfunction BaseElementHandler() {}\n\nBaseElementHandler.prototype = Object.create(BodyHandler.prototype);\n\nBaseElementHandler.prototype.handleNode = function(node) {\n  var parser = this,\n      element = this.element;\n\n  if (!element) {\n    element = this.element = this.createElement(node);\n\n    this.context.addElement(element);\n  } else {\n    parser = this.handleChild(node);\n  }\n\n  return parser;\n};\n\n/**\n * @class Reader.ElementHandler\n *\n */\nexport function ElementHandler(model, typeName, context) {\n  this.model = model;\n  this.type = model.getType(typeName);\n  this.context = context;\n}\n\nElementHandler.prototype = Object.create(BaseElementHandler.prototype);\n\nElementHandler.prototype.addReference = function(reference) {\n  this.context.addReference(reference);\n};\n\nElementHandler.prototype.handleText = function(text) {\n\n  var element = this.element,\n      descriptor = getModdleDescriptor(element),\n      bodyProperty = descriptor.bodyProperty;\n\n  if (!bodyProperty) {\n    throw error('unexpected body text <' + text + '>');\n  }\n\n  BodyHandler.prototype.handleText.call(this, text);\n};\n\nElementHandler.prototype.handleEnd = function() {\n\n  var value = this.body,\n      element = this.element,\n      descriptor = getModdleDescriptor(element),\n      bodyProperty = descriptor.bodyProperty;\n\n  if (bodyProperty && value !== undefined) {\n    value = coerceType(bodyProperty.type, value);\n    element.set(bodyProperty.name, value);\n  }\n};\n\n/**\n * Create an instance of the model from the given node.\n *\n * @param  {Element} node the xml node\n */\nElementHandler.prototype.createElement = function(node) {\n  var attributes = node.attributes,\n      Type = this.type,\n      descriptor = getModdleDescriptor(Type),\n      context = this.context,\n      instance = new Type({}),\n      model = this.model,\n      propNameNs;\n\n  forEach(attributes, function(value, name) {\n\n    var prop = descriptor.propertiesByName[name],\n        values;\n\n    if (prop && prop.isReference) {\n\n      if (!prop.isMany) {\n        context.addReference({\n          element: instance,\n          property: prop.ns.name,\n          id: value\n        });\n      } else {\n        // IDREFS: parse references as whitespace-separated list\n        values = value.split(' ');\n\n        forEach(values, function(v) {\n          context.addReference({\n            element: instance,\n            property: prop.ns.name,\n            id: v\n          });\n        });\n      }\n\n    } else {\n      if (prop) {\n        value = coerceType(prop.type, value);\n      } else\n      if (name !== 'xmlns') {\n        propNameNs = parseNameNs(name, descriptor.ns.prefix);\n\n        // check whether attribute is defined in a well-known namespace\n        // if that is the case we emit a warning to indicate potential misuse\n        if (model.getPackage(propNameNs.prefix)) {\n\n          context.addWarning({\n            message: 'unknown attribute <' + name + '>',\n            element: instance,\n            property: name,\n            value: value\n          });\n        }\n      }\n\n      instance.set(name, value);\n    }\n  });\n\n  return instance;\n};\n\nElementHandler.prototype.getPropertyForNode = function(node) {\n\n  var name = node.name;\n  var nameNs = parseNameNs(name);\n\n  var type = this.type,\n      model = this.model,\n      descriptor = getModdleDescriptor(type);\n\n  var propertyName = nameNs.name,\n      property = descriptor.propertiesByName[propertyName],\n      elementTypeName,\n      elementType;\n\n  // search for properties by name first\n\n  if (property) {\n\n    if (serializeAsType(property)) {\n      elementTypeName = node.attributes[XSI_TYPE];\n\n      // xsi type is optional, if it does not exists the\n      // default type is assumed\n      if (elementTypeName) {\n\n        // take possible type prefixes from XML\n        // into account, i.e.: xsi:type=\"t{ActualType}\"\n        elementTypeName = normalizeXsiTypeName(elementTypeName, model);\n\n        elementType = model.getType(elementTypeName);\n\n        return assign({}, property, {\n          effectiveType: getModdleDescriptor(elementType).name\n        });\n      }\n    }\n\n    // search for properties by name first\n    return property;\n  }\n\n  var pkg = model.getPackage(nameNs.prefix);\n\n  if (pkg) {\n    elementTypeName = aliasToName(nameNs, pkg);\n    elementType = model.getType(elementTypeName);\n\n    // search for collection members later\n    property = find(descriptor.properties, function(p) {\n      return !p.isVirtual && !p.isReference && !p.isAttribute && elementType.hasType(p.type);\n    });\n\n    if (property) {\n      return assign({}, property, {\n        effectiveType: getModdleDescriptor(elementType).name\n      });\n    }\n  } else {\n    // parse unknown element (maybe extension)\n    property = find(descriptor.properties, function(p) {\n      return !p.isReference && !p.isAttribute && p.type === 'Element';\n    });\n\n    if (property) {\n      return property;\n    }\n  }\n\n  throw error('unrecognized element <' + nameNs.name + '>');\n};\n\nElementHandler.prototype.toString = function() {\n  return 'ElementDescriptor[' + getModdleDescriptor(this.type).name + ']';\n};\n\nElementHandler.prototype.valueHandler = function(propertyDesc, element) {\n  return new ValueHandler(propertyDesc, element);\n};\n\nElementHandler.prototype.referenceHandler = function(propertyDesc) {\n  return new ReferenceHandler(propertyDesc, this.context);\n};\n\nElementHandler.prototype.handler = function(type) {\n  if (type === 'Element') {\n    return new GenericElementHandler(this.model, type, this.context);\n  } else {\n    return new ElementHandler(this.model, type, this.context);\n  }\n};\n\n/**\n * Handle the child element parsing\n *\n * @param  {Element} node the xml node\n */\nElementHandler.prototype.handleChild = function(node) {\n  var propertyDesc, type, element, childHandler;\n\n  propertyDesc = this.getPropertyForNode(node);\n  element = this.element;\n\n  type = propertyDesc.effectiveType || propertyDesc.type;\n\n  if (isSimpleType(type)) {\n    return this.valueHandler(propertyDesc, element);\n  }\n\n  if (propertyDesc.isReference) {\n    childHandler = this.referenceHandler(propertyDesc).handleNode(node);\n  } else {\n    childHandler = this.handler(type).handleNode(node);\n  }\n\n  var newElement = childHandler.element;\n\n  // child handles may decide to skip elements\n  // by not returning anything\n  if (newElement !== undefined) {\n\n    if (propertyDesc.isMany) {\n      element.get(propertyDesc.name).push(newElement);\n    } else {\n      element.set(propertyDesc.name, newElement);\n    }\n\n    if (propertyDesc.isReference) {\n      assign(newElement, {\n        element: element\n      });\n\n      this.context.addReference(newElement);\n    } else {\n      // establish child -> parent relationship\n      newElement.$parent = element;\n    }\n  }\n\n  return childHandler;\n};\n\n/**\n * An element handler that performs special validation\n * to ensure the node it gets initialized with matches\n * the handlers type (namespace wise).\n *\n * @param {Moddle} model\n * @param {String} typeName\n * @param {Context} context\n */\nfunction RootElementHandler(model, typeName, context) {\n  ElementHandler.call(this, model, typeName, context);\n}\n\nRootElementHandler.prototype = Object.create(ElementHandler.prototype);\n\nRootElementHandler.prototype.createElement = function(node) {\n\n  var name = node.name,\n      nameNs = parseNameNs(name),\n      model = this.model,\n      type = this.type,\n      pkg = model.getPackage(nameNs.prefix),\n      typeName = pkg && aliasToName(nameNs, pkg) || name;\n\n  // verify the correct namespace if we parse\n  // the first element in the handler tree\n  //\n  // this ensures we don't mistakenly import wrong namespace elements\n  if (!type.hasType(typeName)) {\n    throw error('unexpected element <' + node.originalName + '>');\n  }\n\n  return ElementHandler.prototype.createElement.call(this, node);\n};\n\n\nfunction GenericElementHandler(model, typeName, context) {\n  this.model = model;\n  this.context = context;\n}\n\nGenericElementHandler.prototype = Object.create(BaseElementHandler.prototype);\n\nGenericElementHandler.prototype.createElement = function(node) {\n\n  var name = node.name,\n      ns = parseNameNs(name),\n      prefix = ns.prefix,\n      uri = node.ns[prefix + '$uri'],\n      attributes = node.attributes;\n\n  return this.model.createAny(name, uri, attributes);\n};\n\nGenericElementHandler.prototype.handleChild = function(node) {\n\n  var handler = new GenericElementHandler(this.model, 'Element', this.context).handleNode(node),\n      element = this.element;\n\n  var newElement = handler.element,\n      children;\n\n  if (newElement !== undefined) {\n    children = element.$children = element.$children || [];\n    children.push(newElement);\n\n    // establish child -> parent relationship\n    newElement.$parent = element;\n  }\n\n  return handler;\n};\n\nGenericElementHandler.prototype.handleEnd = function() {\n  if (this.body) {\n    this.element.$body = this.body;\n  }\n};\n\n/**\n * A reader for a meta-model\n *\n * @param {Object} options\n * @param {Model} options.model used to read xml files\n * @param {Boolean} options.lax whether to make parse errors warnings\n */\nexport function Reader(options) {\n\n  if (options instanceof Moddle) {\n    options = {\n      model: options\n    };\n  }\n\n  assign(this, { lax: false }, options);\n}\n\n\n/**\n * Parse the given XML into a moddle document tree.\n *\n * @param {String} xml\n * @param {ElementHandler|Object} options or rootHandler\n * @param  {Function} done\n */\nReader.prototype.fromXML = function(xml, options, done) {\n\n  var rootHandler = options.rootHandler;\n\n  if (options instanceof ElementHandler) {\n    // root handler passed via (xml, { rootHandler: ElementHandler }, ...)\n    rootHandler = options;\n    options = {};\n  } else {\n    if (typeof options === 'string') {\n      // rootHandler passed via (xml, 'someString', ...)\n      rootHandler = this.handler(options);\n      options = {};\n    } else if (typeof rootHandler === 'string') {\n      // rootHandler passed via (xml, { rootHandler: 'someString' }, ...)\n      rootHandler = this.handler(rootHandler);\n    }\n  }\n\n  var model = this.model,\n      lax = this.lax;\n\n  var context = new Context(assign({}, options, { rootHandler: rootHandler })),\n      parser = new SaxParser({ proxy: true }),\n      stack = createStack();\n\n  rootHandler.context = context;\n\n  // push root handler\n  stack.push(rootHandler);\n\n\n  /**\n   * Handle error.\n   *\n   * @param  {Error} err\n   * @param  {Function} getContext\n   * @param  {boolean} lax\n   *\n   * @return {boolean} true if handled\n   */\n  function handleError(err, getContext, lax) {\n\n    var ctx = getContext();\n\n    var line = ctx.line,\n        column = ctx.column,\n        data = ctx.data;\n\n    // we receive the full context data here,\n    // for elements trim down the information\n    // to the tag name, only\n    if (data.charAt(0) === '<' && data.indexOf(' ') !== -1) {\n      data = data.slice(0, data.indexOf(' ')) + '>';\n    }\n\n    var message =\n      'unparsable content ' + (data ? data + ' ' : '') + 'detected\\n\\t' +\n        'line: ' + line + '\\n\\t' +\n        'column: ' + column + '\\n\\t' +\n        'nested error: ' + err.message;\n\n    if (lax) {\n      context.addWarning({\n        message: message,\n        error: err\n      });\n\n      return true;\n    } else {\n      throw error(message);\n    }\n  }\n\n  function handleWarning(err, getContext) {\n    // just like handling errors in <lax=true> mode\n    return handleError(err, getContext, true);\n  }\n\n  /**\n   * Resolve collected references on parse end.\n   */\n  function resolveReferences() {\n\n    var elementsById = context.elementsById;\n    var references = context.references;\n\n    var i, r;\n\n    for (i = 0; (r = references[i]); i++) {\n      var element = r.element;\n      var reference = elementsById[r.id];\n      var property = getModdleDescriptor(element).propertiesByName[r.property];\n\n      if (!reference) {\n        context.addWarning({\n          message: 'unresolved reference <' + r.id + '>',\n          element: r.element,\n          property: r.property,\n          value: r.id\n        });\n      }\n\n      if (property.isMany) {\n        var collection = element.get(property.name),\n            idx = collection.indexOf(r);\n\n        // we replace an existing place holder (idx != -1) or\n        // append to the collection instead\n        if (idx === -1) {\n          idx = collection.length;\n        }\n\n        if (!reference) {\n          // remove unresolvable reference\n          collection.splice(idx, 1);\n        } else {\n          // add or update reference in collection\n          collection[idx] = reference;\n        }\n      } else {\n        element.set(property.name, reference);\n      }\n    }\n  }\n\n  function handleClose() {\n    stack.pop().handleEnd();\n  }\n\n  var PREAMBLE_START_PATTERN = /^<\\?xml /i;\n\n  var ENCODING_PATTERN = / encoding=\"([^\"]+)\"/i;\n\n  var UTF_8_PATTERN = /^utf-8$/i;\n\n  function handleQuestion(question) {\n\n    if (!PREAMBLE_START_PATTERN.test(question)) {\n      return;\n    }\n\n    var match = ENCODING_PATTERN.exec(question);\n    var encoding = match && match[1];\n\n    if (!encoding || UTF_8_PATTERN.test(encoding)) {\n      return;\n    }\n\n    context.addWarning({\n      message:\n        'unsupported document encoding <' + encoding + '>, ' +\n        'falling back to UTF-8'\n    });\n  }\n\n  function handleOpen(node, getContext) {\n    var handler = stack.peek();\n\n    try {\n      stack.push(handler.handleNode(node));\n    } catch (err) {\n\n      if (handleError(err, getContext, lax)) {\n        stack.push(new NoopHandler());\n      }\n    }\n  }\n\n  function handleCData(text, getContext) {\n\n    try {\n      stack.peek().handleText(text);\n    } catch (err) {\n      handleWarning(err, getContext);\n    }\n  }\n\n  function handleText(text, getContext) {\n    // strip whitespace only nodes, i.e. before\n    // <!CDATA[ ... ]> sections and in between tags\n    text = text.trim();\n\n    if (!text) {\n      return;\n    }\n\n    handleCData(text, getContext);\n  }\n\n  var uriMap = model.getPackages().reduce(function(uriMap, p) {\n    uriMap[p.uri] = p.prefix;\n\n    return uriMap;\n  }, {});\n\n  parser\n    .ns(uriMap)\n    .on('openTag', function(obj, decodeStr, selfClosing, getContext) {\n\n      // gracefully handle unparsable attributes (attrs=false)\n      var attrs = obj.attrs || {};\n\n      var decodedAttrs = Object.keys(attrs).reduce(function(d, key) {\n        var value = decodeStr(attrs[key]);\n\n        d[key] = value;\n\n        return d;\n      }, {});\n\n      var node = {\n        name: obj.name,\n        originalName: obj.originalName,\n        attributes: decodedAttrs,\n        ns: obj.ns\n      };\n\n      handleOpen(node, getContext);\n    })\n    .on('question', handleQuestion)\n    .on('closeTag', handleClose)\n    .on('cdata', handleCData)\n    .on('text', function(text, decodeEntities, getContext) {\n      handleText(decodeEntities(text), getContext);\n    })\n    .on('error', handleError)\n    .on('warn', handleWarning);\n\n  // deferred parse XML to make loading really ascnchronous\n  // this ensures the execution environment (node or browser)\n  // is kept responsive and that certain optimization strategies\n  // can kick in\n  defer(function() {\n    var err;\n\n    try {\n      parser.parse(xml);\n\n      resolveReferences();\n    } catch (e) {\n      err = e;\n    }\n\n    var element = rootHandler.element;\n\n    // handle the situation that we could not extract\n    // the desired root element from the document\n    if (!err && !element) {\n      err = error('failed to parse document as <' + rootHandler.type.$descriptor.name + '>');\n    }\n\n    done(err, err ? undefined : element, context);\n  });\n};\n\nReader.prototype.handler = function(name) {\n  return new RootElementHandler(this.model, name);\n};\n\n\n// helpers //////////////////////////\n\nfunction createStack() {\n  var stack = [];\n\n  Object.defineProperty(stack, 'peek', {\n    value: function() {\n      return this[this.length - 1];\n    }\n  });\n\n  return stack;\n}","import {\n  map,\n  forEach,\n  isString,\n  filter,\n  assign\n} from 'min-dash';\n\nimport {\n  isSimple as isSimpleType\n} from 'moddle/lib/types';\n\nimport {\n  parseName as parseNameNs\n} from 'moddle/lib/ns';\n\nimport {\n  hasLowerCaseAlias,\n  serializeAsType,\n  serializeAsProperty,\n  DEFAULT_NS_MAP,\n  XSI_TYPE\n} from './common';\n\nvar XML_PREAMBLE = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n';\n\nvar ESCAPE_ATTR_CHARS = /<|>|'|\"|&|\\n\\r|\\n/g;\nvar ESCAPE_CHARS =  /<|>|&/g;\n\n\nexport function Namespaces(parent) {\n\n  var prefixMap = {};\n  var uriMap = {};\n  var used = {};\n\n  var wellknown = [];\n  var custom = [];\n\n  // API\n\n  this.byUri = function(uri) {\n    return uriMap[uri] || (\n      parent && parent.byUri(uri)\n    );\n  };\n\n  this.add = function(ns, isWellknown) {\n\n    uriMap[ns.uri] = ns;\n\n    if (isWellknown) {\n      wellknown.push(ns);\n    } else {\n      custom.push(ns);\n    }\n\n    this.mapPrefix(ns.prefix, ns.uri);\n  };\n\n  this.uriByPrefix = function(prefix) {\n    return prefixMap[prefix || 'xmlns'];\n  };\n\n  this.mapPrefix = function(prefix, uri) {\n    prefixMap[prefix || 'xmlns'] = uri;\n  };\n\n  this.logUsed = function(ns) {\n    var uri = ns.uri;\n\n    used[uri] = this.byUri(uri);\n  };\n\n  this.getUsed = function(ns) {\n\n    function isUsed(ns) {\n      return used[ns.uri];\n    }\n\n    var allNs = [].concat(wellknown, custom);\n\n    return allNs.filter(isUsed);\n  };\n\n}\n\nfunction lower(string) {\n  return string.charAt(0).toLowerCase() + string.slice(1);\n}\n\nfunction nameToAlias(name, pkg) {\n  if (hasLowerCaseAlias(pkg)) {\n    return lower(name);\n  } else {\n    return name;\n  }\n}\n\nfunction inherits(ctor, superCtor) {\n  ctor.super_ = superCtor;\n  ctor.prototype = Object.create(superCtor.prototype, {\n    constructor: {\n      value: ctor,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n}\n\nfunction nsName(ns) {\n  if (isString(ns)) {\n    return ns;\n  } else {\n    return (ns.prefix ? ns.prefix + ':' : '') + ns.localName;\n  }\n}\n\nfunction getNsAttrs(namespaces) {\n\n  return map(namespaces.getUsed(), function(ns) {\n    var name = 'xmlns' + (ns.prefix ? ':' + ns.prefix : '');\n    return { name: name, value: ns.uri };\n  });\n\n}\n\nfunction getElementNs(ns, descriptor) {\n  if (descriptor.isGeneric) {\n    return assign({ localName: descriptor.ns.localName }, ns);\n  } else {\n    return assign({ localName: nameToAlias(descriptor.ns.localName, descriptor.$pkg) }, ns);\n  }\n}\n\nfunction getPropertyNs(ns, descriptor) {\n  return assign({ localName: descriptor.ns.localName }, ns);\n}\n\nfunction getSerializableProperties(element) {\n  var descriptor = element.$descriptor;\n\n  return filter(descriptor.properties, function(p) {\n    var name = p.name;\n\n    if (p.isVirtual) {\n      return false;\n    }\n\n    // do not serialize defaults\n    if (!element.hasOwnProperty(name)) {\n      return false;\n    }\n\n    var value = element[name];\n\n    // do not serialize default equals\n    if (value === p.default) {\n      return false;\n    }\n\n    // do not serialize null properties\n    if (value === null) {\n      return false;\n    }\n\n    return p.isMany ? value.length : true;\n  });\n}\n\nvar ESCAPE_ATTR_MAP = {\n  '\\n': '#10',\n  '\\n\\r': '#10',\n  '\"': '#34',\n  '\\'': '#39',\n  '<': '#60',\n  '>': '#62',\n  '&': '#38'\n};\n\nvar ESCAPE_MAP = {\n  '<': 'lt',\n  '>': 'gt',\n  '&': 'amp'\n};\n\nfunction escape(str, charPattern, replaceMap) {\n\n  // ensure we are handling strings here\n  str = isString(str) ? str : '' + str;\n\n  return str.replace(charPattern, function(s) {\n    return '&' + replaceMap[s] + ';';\n  });\n}\n\n/**\n * Escape a string attribute to not contain any bad values (line breaks, '\"', ...)\n *\n * @param {String} str the string to escape\n * @return {String} the escaped string\n */\nfunction escapeAttr(str) {\n  return escape(str, ESCAPE_ATTR_CHARS, ESCAPE_ATTR_MAP);\n}\n\nfunction escapeBody(str) {\n  return escape(str, ESCAPE_CHARS, ESCAPE_MAP);\n}\n\nfunction filterAttributes(props) {\n  return filter(props, function(p) { return p.isAttr; });\n}\n\nfunction filterContained(props) {\n  return filter(props, function(p) { return !p.isAttr; });\n}\n\n\nfunction ReferenceSerializer(tagName) {\n  this.tagName = tagName;\n}\n\nReferenceSerializer.prototype.build = function(element) {\n  this.element = element;\n  return this;\n};\n\nReferenceSerializer.prototype.serializeTo = function(writer) {\n  writer\n    .appendIndent()\n    .append('<' + this.tagName + '>' + this.element.id + '</' + this.tagName + '>')\n    .appendNewLine();\n};\n\nfunction BodySerializer() {}\n\nBodySerializer.prototype.serializeValue =\nBodySerializer.prototype.serializeTo = function(writer) {\n  writer.append(\n    this.escape\n      ? escapeBody(this.value)\n      : this.value\n  );\n};\n\nBodySerializer.prototype.build = function(prop, value) {\n  this.value = value;\n\n  if (prop.type === 'String' && value.search(ESCAPE_CHARS) !== -1) {\n    this.escape = true;\n  }\n\n  return this;\n};\n\nfunction ValueSerializer(tagName) {\n  this.tagName = tagName;\n}\n\ninherits(ValueSerializer, BodySerializer);\n\nValueSerializer.prototype.serializeTo = function(writer) {\n\n  writer\n    .appendIndent()\n    .append('<' + this.tagName + '>');\n\n  this.serializeValue(writer);\n\n  writer\n    .append('</' + this.tagName + '>')\n    .appendNewLine();\n};\n\nfunction ElementSerializer(parent, propertyDescriptor) {\n  this.body = [];\n  this.attrs = [];\n\n  this.parent = parent;\n  this.propertyDescriptor = propertyDescriptor;\n}\n\nElementSerializer.prototype.build = function(element) {\n  this.element = element;\n\n  var elementDescriptor = element.$descriptor,\n      propertyDescriptor = this.propertyDescriptor;\n\n  var otherAttrs,\n      properties;\n\n  var isGeneric = elementDescriptor.isGeneric;\n\n  if (isGeneric) {\n    otherAttrs = this.parseGeneric(element);\n  } else {\n    otherAttrs = this.parseNsAttributes(element);\n  }\n\n  if (propertyDescriptor) {\n    this.ns = this.nsPropertyTagName(propertyDescriptor);\n  } else {\n    this.ns = this.nsTagName(elementDescriptor);\n  }\n\n  // compute tag name\n  this.tagName = this.addTagName(this.ns);\n\n  if (!isGeneric) {\n    properties = getSerializableProperties(element);\n\n    this.parseAttributes(filterAttributes(properties));\n    this.parseContainments(filterContained(properties));\n  }\n\n  this.parseGenericAttributes(element, otherAttrs);\n\n  return this;\n};\n\nElementSerializer.prototype.nsTagName = function(descriptor) {\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\n  return getElementNs(effectiveNs, descriptor);\n};\n\nElementSerializer.prototype.nsPropertyTagName = function(descriptor) {\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\n  return getPropertyNs(effectiveNs, descriptor);\n};\n\nElementSerializer.prototype.isLocalNs = function(ns) {\n  return ns.uri === this.ns.uri;\n};\n\n/**\n * Get the actual ns attribute name for the given element.\n *\n * @param {Object} element\n * @param {Boolean} [element.inherited=false]\n *\n * @return {Object} nsName\n */\nElementSerializer.prototype.nsAttributeName = function(element) {\n\n  var ns;\n\n  if (isString(element)) {\n    ns = parseNameNs(element);\n  } else {\n    ns = element.ns;\n  }\n\n  // return just local name for inherited attributes\n  if (element.inherited) {\n    return { localName: ns.localName };\n  }\n\n  // parse + log effective ns\n  var effectiveNs = this.logNamespaceUsed(ns);\n\n  // LOG ACTUAL namespace use\n  this.getNamespaces().logUsed(effectiveNs);\n\n  // strip prefix if same namespace like parent\n  if (this.isLocalNs(effectiveNs)) {\n    return { localName: ns.localName };\n  } else {\n    return assign({ localName: ns.localName }, effectiveNs);\n  }\n};\n\nElementSerializer.prototype.parseGeneric = function(element) {\n\n  var self = this,\n      body = this.body;\n\n  var attributes = [];\n\n  forEach(element, function(val, key) {\n\n    var nonNsAttr;\n\n    if (key === '$body') {\n      body.push(new BodySerializer().build({ type: 'String' }, val));\n    } else\n    if (key === '$children') {\n      forEach(val, function(child) {\n        body.push(new ElementSerializer(self).build(child));\n      });\n    } else\n    if (key.indexOf('$') !== 0) {\n      nonNsAttr = self.parseNsAttribute(element, key, val);\n\n      if (nonNsAttr) {\n        attributes.push({ name: key, value: val });\n      }\n    }\n  });\n\n  return attributes;\n};\n\nElementSerializer.prototype.parseNsAttribute = function(element, name, value) {\n  var model = element.$model;\n\n  var nameNs = parseNameNs(name);\n\n  var ns;\n\n  // parse xmlns:foo=\"http://foo.bar\"\n  if (nameNs.prefix === 'xmlns') {\n    ns = { prefix: nameNs.localName, uri: value };\n  }\n\n  // parse xmlns=\"http://foo.bar\"\n  if (!nameNs.prefix && nameNs.localName === 'xmlns') {\n    ns = { uri: value };\n  }\n\n  if (!ns) {\n    return {\n      name: name,\n      value: value\n    };\n  }\n\n  if (model && model.getPackage(value)) {\n    // register well known namespace\n    this.logNamespace(ns, true, true);\n  } else {\n    // log custom namespace directly as used\n    var actualNs = this.logNamespaceUsed(ns, true);\n\n    this.getNamespaces().logUsed(actualNs);\n  }\n};\n\n\n/**\n * Parse namespaces and return a list of left over generic attributes\n *\n * @param  {Object} element\n * @return {Array<Object>}\n */\nElementSerializer.prototype.parseNsAttributes = function(element, attrs) {\n  var self = this;\n\n  var genericAttrs = element.$attrs;\n\n  var attributes = [];\n\n  // parse namespace attributes first\n  // and log them. push non namespace attributes to a list\n  // and process them later\n  forEach(genericAttrs, function(value, name) {\n\n    var nonNsAttr = self.parseNsAttribute(element, name, value);\n\n    if (nonNsAttr) {\n      attributes.push(nonNsAttr);\n    }\n  });\n\n  return attributes;\n};\n\nElementSerializer.prototype.parseGenericAttributes = function(element, attributes) {\n\n  var self = this;\n\n  forEach(attributes, function(attr) {\n\n    // do not serialize xsi:type attribute\n    // it is set manually based on the actual implementation type\n    if (attr.name === XSI_TYPE) {\n      return;\n    }\n\n    try {\n      self.addAttribute(self.nsAttributeName(attr.name), attr.value);\n    } catch (e) {\n      console.warn(\n        'missing namespace information for ',\n        attr.name, '=', attr.value, 'on', element,\n        e);\n    }\n  });\n};\n\nElementSerializer.prototype.parseContainments = function(properties) {\n\n  var self = this,\n      body = this.body,\n      element = this.element;\n\n  forEach(properties, function(p) {\n    var value = element.get(p.name),\n        isReference = p.isReference,\n        isMany = p.isMany;\n\n    if (!isMany) {\n      value = [ value ];\n    }\n\n    if (p.isBody) {\n      body.push(new BodySerializer().build(p, value[0]));\n    } else\n    if (isSimpleType(p.type)) {\n      forEach(value, function(v) {\n        body.push(new ValueSerializer(self.addTagName(self.nsPropertyTagName(p))).build(p, v));\n      });\n    } else\n    if (isReference) {\n      forEach(value, function(v) {\n        body.push(new ReferenceSerializer(self.addTagName(self.nsPropertyTagName(p))).build(v));\n      });\n    } else {\n      // allow serialization via type\n      // rather than element name\n      var asType = serializeAsType(p),\n          asProperty = serializeAsProperty(p);\n\n      forEach(value, function(v) {\n        var serializer;\n\n        if (asType) {\n          serializer = new TypeSerializer(self, p);\n        } else\n        if (asProperty) {\n          serializer = new ElementSerializer(self, p);\n        } else {\n          serializer = new ElementSerializer(self);\n        }\n\n        body.push(serializer.build(v));\n      });\n    }\n  });\n};\n\nElementSerializer.prototype.getNamespaces = function(local) {\n\n  var namespaces = this.namespaces,\n      parent = this.parent,\n      parentNamespaces;\n\n  if (!namespaces) {\n    parentNamespaces = parent && parent.getNamespaces();\n\n    if (local || !parentNamespaces) {\n      this.namespaces = namespaces = new Namespaces(parentNamespaces);\n    } else {\n      namespaces = parentNamespaces;\n    }\n  }\n\n  return namespaces;\n};\n\nElementSerializer.prototype.logNamespace = function(ns, wellknown, local) {\n  var namespaces = this.getNamespaces(local);\n\n  var nsUri = ns.uri,\n      nsPrefix = ns.prefix;\n\n  var existing = namespaces.byUri(nsUri);\n\n  if (!existing) {\n    namespaces.add(ns, wellknown);\n  }\n\n  namespaces.mapPrefix(nsPrefix, nsUri);\n\n  return ns;\n};\n\nElementSerializer.prototype.logNamespaceUsed = function(ns, local) {\n  var element = this.element,\n      model = element.$model,\n      namespaces = this.getNamespaces(local);\n\n  // ns may be\n  //\n  //   * prefix only\n  //   * prefix:uri\n  //   * localName only\n\n  var prefix = ns.prefix,\n      uri = ns.uri,\n      newPrefix, idx,\n      wellknownUri;\n\n  // handle anonymous namespaces (elementForm=unqualified), cf. #23\n  if (!prefix && !uri) {\n    return { localName: ns.localName };\n  }\n\n  wellknownUri = DEFAULT_NS_MAP[prefix] || model && (model.getPackage(prefix) || {}).uri;\n\n  uri = uri || wellknownUri || namespaces.uriByPrefix(prefix);\n\n  if (!uri) {\n    throw new Error('no namespace uri given for prefix <' + prefix + '>');\n  }\n\n  ns = namespaces.byUri(uri);\n\n  if (!ns) {\n    newPrefix = prefix;\n    idx = 1;\n\n    // find a prefix that is not mapped yet\n    while (namespaces.uriByPrefix(newPrefix)) {\n      newPrefix = prefix + '_' + idx++;\n    }\n\n    ns = this.logNamespace({ prefix: newPrefix, uri: uri }, wellknownUri === uri);\n  }\n\n  if (prefix) {\n    namespaces.mapPrefix(prefix, uri);\n  }\n\n  return ns;\n};\n\nElementSerializer.prototype.parseAttributes = function(properties) {\n  var self = this,\n      element = this.element;\n\n  forEach(properties, function(p) {\n\n    var value = element.get(p.name);\n\n    if (p.isReference) {\n\n      if (!p.isMany) {\n        value = value.id;\n      }\n      else {\n        var values = [];\n        forEach(value, function(v) {\n          values.push(v.id);\n        });\n        // IDREFS is a whitespace-separated list of references.\n        value = values.join(' ');\n      }\n\n    }\n\n    self.addAttribute(self.nsAttributeName(p), value);\n  });\n};\n\nElementSerializer.prototype.addTagName = function(nsTagName) {\n  var actualNs = this.logNamespaceUsed(nsTagName);\n\n  this.getNamespaces().logUsed(actualNs);\n\n  return nsName(nsTagName);\n};\n\nElementSerializer.prototype.addAttribute = function(name, value) {\n  var attrs = this.attrs;\n\n  if (isString(value)) {\n    value = escapeAttr(value);\n  }\n\n  attrs.push({ name: name, value: value });\n};\n\nElementSerializer.prototype.serializeAttributes = function(writer) {\n  var attrs = this.attrs,\n      namespaces = this.namespaces;\n\n  if (namespaces) {\n    attrs = getNsAttrs(namespaces).concat(attrs);\n  }\n\n  forEach(attrs, function(a) {\n    writer\n      .append(' ')\n      .append(nsName(a.name)).append('=\"').append(a.value).append('\"');\n  });\n};\n\nElementSerializer.prototype.serializeTo = function(writer) {\n  var firstBody = this.body[0],\n      indent = firstBody && firstBody.constructor !== BodySerializer;\n\n  writer\n    .appendIndent()\n    .append('<' + this.tagName);\n\n  this.serializeAttributes(writer);\n\n  writer.append(firstBody ? '>' : ' />');\n\n  if (firstBody) {\n\n    if (indent) {\n      writer\n        .appendNewLine()\n        .indent();\n    }\n\n    forEach(this.body, function(b) {\n      b.serializeTo(writer);\n    });\n\n    if (indent) {\n      writer\n        .unindent()\n        .appendIndent();\n    }\n\n    writer.append('</' + this.tagName + '>');\n  }\n\n  writer.appendNewLine();\n};\n\n/**\n * A serializer for types that handles serialization of data types\n */\nfunction TypeSerializer(parent, propertyDescriptor) {\n  ElementSerializer.call(this, parent, propertyDescriptor);\n}\n\ninherits(TypeSerializer, ElementSerializer);\n\nTypeSerializer.prototype.parseNsAttributes = function(element) {\n\n  // extracted attributes\n  var attributes = ElementSerializer.prototype.parseNsAttributes.call(this, element);\n\n  var descriptor = element.$descriptor;\n\n  // only serialize xsi:type if necessary\n  if (descriptor.name === this.propertyDescriptor.type) {\n    return attributes;\n  }\n\n  var typeNs = this.typeNs = this.nsTagName(descriptor);\n  this.getNamespaces().logUsed(this.typeNs);\n\n  // add xsi:type attribute to represent the elements\n  // actual type\n\n  var pkg = element.$model.getPackage(typeNs.uri),\n      typePrefix = (pkg.xml && pkg.xml.typePrefix) || '';\n\n  this.addAttribute(\n    this.nsAttributeName(XSI_TYPE),\n    (typeNs.prefix ? typeNs.prefix + ':' : '') + typePrefix + descriptor.ns.localName\n  );\n\n  return attributes;\n};\n\nTypeSerializer.prototype.isLocalNs = function(ns) {\n  return ns.uri === (this.typeNs || this.ns).uri;\n};\n\nfunction SavingWriter() {\n  this.value = '';\n\n  this.write = function(str) {\n    this.value += str;\n  };\n}\n\nfunction FormatingWriter(out, format) {\n\n  var indent = [''];\n\n  this.append = function(str) {\n    out.write(str);\n\n    return this;\n  };\n\n  this.appendNewLine = function() {\n    if (format) {\n      out.write('\\n');\n    }\n\n    return this;\n  };\n\n  this.appendIndent = function() {\n    if (format) {\n      out.write(indent.join('  '));\n    }\n\n    return this;\n  };\n\n  this.indent = function() {\n    indent.push('');\n    return this;\n  };\n\n  this.unindent = function() {\n    indent.pop();\n    return this;\n  };\n}\n\n/**\n * A writer for meta-model backed document trees\n *\n * @param {Object} options output options to pass into the writer\n */\nexport function Writer(options) {\n\n  options = assign({ format: false, preamble: true }, options || {});\n\n  function toXML(tree, writer) {\n    var internalWriter = writer || new SavingWriter();\n    var formatingWriter = new FormatingWriter(internalWriter, options.format);\n\n    if (options.preamble) {\n      formatingWriter.append(XML_PREAMBLE);\n    }\n\n    new ElementSerializer().build(tree).serializeTo(formatingWriter);\n\n    if (!writer) {\n      return internalWriter.value;\n    }\n  }\n\n  return {\n    toXML: toXML\n  };\n}","import {\n  isString,\n  isFunction,\n  assign\n} from 'min-dash';\n\nimport Moddle from 'moddle';\n\nimport {\n  Reader,\n  Writer\n} from 'moddle-xml';\n\n\n/**\n * A sub class of {@link Moddle} with support for import and export of CMMN 1.1 xml files.\n *\n * @class CmmnModdle\n * @extends Moddle\n *\n * @param {Object|Array} packages to use for instantiating the model\n * @param {Object} [options] additional options to pass over\n */\nexport default function CmmnModdle(packages, options) {\n  Moddle.call(this, packages, options);\n}\n\nCmmnModdle.prototype = Object.create(Moddle.prototype);\n\n\n/**\n * Instantiates a CMMN model tree from a given xml string.\n *\n * @param {String}   xmlStr\n * @param {String}   [typeName='cmmn:Definitions'] name of the root element\n * @param {Object}   [options]  options to pass to the underlying reader\n * @param {Function} done       callback that is invoked with (err, result, parseContext)\n *                              once the import completes\n */\nCmmnModdle.prototype.fromXML = function(xmlStr, typeName, options, done) {\n\n  if (!isString(typeName)) {\n    done = options;\n    options = typeName;\n    typeName = 'cmmn:Definitions';\n  }\n\n  if (isFunction(options)) {\n    done = options;\n    options = {};\n  }\n\n  var reader = new Reader(assign({ model: this, lax: true }, options));\n  var rootHandler = reader.handler(typeName);\n\n  reader.fromXML(xmlStr, rootHandler, done);\n};\n\n\n/**\n * Serializes a CMMN 1.1 object tree to XML.\n *\n * @param {String}   element    the root element, typically an instance of `cmmn:Definitions`\n * @param {Object}   [options]  to pass to the underlying writer\n * @param {Function} done       callback invoked with (err, xmlStr) once the import completes\n */\nCmmnModdle.prototype.toXML = function(element, options, done) {\n\n  if (isFunction(options)) {\n    done = options;\n    options = {};\n  }\n\n  var writer = new Writer(options);\n\n  var result;\n  var err;\n\n  try {\n    result = writer.toXML(element);\n  } catch (e) {\n    err = e;\n  }\n\n  return done(err, result);\n};","import {\n  assign\n} from 'min-dash';\n\nimport CmmnModdle from './cmmn-moddle';\n\nimport CmmnPackage from '../resources/cmmn/json/cmmn.json';\nimport CmmnDiPackage from '../resources/cmmn/json/cmmndi.json';\nimport DcPackage from '../resources/cmmn/json/dc.json';\nimport DiPackage from '../resources/cmmn/json/di.json';\n\nvar packages = {\n  cmmn: CmmnPackage,\n  cmmndi: CmmnDiPackage,\n  dc: DcPackage,\n  di: DiPackage\n};\n\nexport default function(additionalPackages, options) {\n  var pks = assign({}, packages, additionalPackages);\n\n  return new CmmnModdle(pks, options);\n}","export {\n  default\n} from './lib/simple';","var CLASS_PATTERN = /^class /;\n\nfunction isClass(fn) {\n  return CLASS_PATTERN.test(fn.toString());\n}\n\nfunction isArray(obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]';\n}\n\nfunction annotate() {\n  var args = Array.prototype.slice.call(arguments);\n\n  if (args.length === 1 && isArray(args[0])) {\n    args = args[0];\n  }\n\n  var fn = args.pop();\n\n  fn.$inject = args;\n\n  return fn;\n}\n\n// Current limitations:\n// - can't put into \"function arg\" comments\n// function /* (no parenthesis like this) */ (){}\n// function abc( /* xx (no parenthesis like this) */ a, b) {}\n//\n// Just put the comment before function or inside:\n// /* (((this is fine))) */ function(a, b) {}\n// function abc(a) { /* (((this is fine))) */}\n//\n// - can't reliably auto-annotate constructor; we'll match the\n// first constructor(...) pattern found which may be the one\n// of a nested class, too.\n\nvar CONSTRUCTOR_ARGS = /constructor\\s*[^(]*\\(\\s*([^)]*)\\)/m;\nvar FN_ARGS = /^function\\s*[^(]*\\(\\s*([^)]*)\\)/m;\nvar FN_ARG = /\\/\\*([^*]*)\\*\\//m;\n\nfunction parse(fn) {\n\n  if (typeof fn !== 'function') {\n    throw new Error('Cannot annotate \"' + fn + '\". Expected a function!');\n  }\n\n  var match = fn.toString().match(isClass(fn) ? CONSTRUCTOR_ARGS : FN_ARGS);\n\n  // may parse class without constructor\n  if (!match) {\n    return [];\n  }\n\n  return match[1] && match[1].split(',').map(function (arg) {\n    match = arg.match(FN_ARG);\n    return match ? match[1].trim() : arg.trim();\n  }) || [];\n}\n\nfunction Module() {\n  var providers = [];\n\n  this.factory = function (name, factory) {\n    providers.push([name, 'factory', factory]);\n    return this;\n  };\n\n  this.value = function (name, value) {\n    providers.push([name, 'value', value]);\n    return this;\n  };\n\n  this.type = function (name, type) {\n    providers.push([name, 'type', type]);\n    return this;\n  };\n\n  this.forEach = function (iterator) {\n    providers.forEach(iterator);\n  };\n}\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction Injector(modules, parent) {\n  parent = parent || {\n    get: function get(name, strict) {\n      currentlyResolving.push(name);\n\n      if (strict === false) {\n        return null;\n      } else {\n        throw error('No provider for \"' + name + '\"!');\n      }\n    }\n  };\n\n  var currentlyResolving = [];\n  var providers = this._providers = Object.create(parent._providers || null);\n  var instances = this._instances = Object.create(null);\n\n  var self = instances.injector = this;\n\n  var error = function error(msg) {\n    var stack = currentlyResolving.join(' -> ');\n    currentlyResolving.length = 0;\n    return new Error(stack ? msg + ' (Resolving: ' + stack + ')' : msg);\n  };\n\n  /**\n   * Return a named service.\n   *\n   * @param {String} name\n   * @param {Boolean} [strict=true] if false, resolve missing services to null\n   *\n   * @return {Object}\n   */\n  var get = function get(name, strict) {\n    if (!providers[name] && name.indexOf('.') !== -1) {\n      var parts = name.split('.');\n      var pivot = get(parts.shift());\n\n      while (parts.length) {\n        pivot = pivot[parts.shift()];\n      }\n\n      return pivot;\n    }\n\n    if (hasProp(instances, name)) {\n      return instances[name];\n    }\n\n    if (hasProp(providers, name)) {\n      if (currentlyResolving.indexOf(name) !== -1) {\n        currentlyResolving.push(name);\n        throw error('Cannot resolve circular dependency!');\n      }\n\n      currentlyResolving.push(name);\n      instances[name] = providers[name][0](providers[name][1]);\n      currentlyResolving.pop();\n\n      return instances[name];\n    }\n\n    return parent.get(name, strict);\n  };\n\n  var fnDef = function fnDef(fn) {\n    var locals = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if (typeof fn !== 'function') {\n      if (isArray(fn)) {\n        fn = annotate(fn.slice());\n      } else {\n        throw new Error('Cannot invoke \"' + fn + '\". Expected a function!');\n      }\n    }\n\n    var inject = fn.$inject || parse(fn);\n    var dependencies = inject.map(function (dep) {\n      if (hasProp(locals, dep)) {\n        return locals[dep];\n      } else {\n        return get(dep);\n      }\n    });\n\n    return {\n      fn: fn,\n      dependencies: dependencies\n    };\n  };\n\n  var instantiate = function instantiate(Type) {\n    var _fnDef = fnDef(Type),\n        dependencies = _fnDef.dependencies,\n        fn = _fnDef.fn;\n\n    return new (Function.prototype.bind.apply(fn, [null].concat(_toConsumableArray(dependencies))))();\n  };\n\n  var invoke = function invoke(func, context, locals) {\n    var _fnDef2 = fnDef(func, locals),\n        dependencies = _fnDef2.dependencies,\n        fn = _fnDef2.fn;\n\n    return fn.call.apply(fn, [context].concat(_toConsumableArray(dependencies)));\n  };\n\n  var createPrivateInjectorFactory = function createPrivateInjectorFactory(privateChildInjector) {\n    return annotate(function (key) {\n      return privateChildInjector.get(key);\n    });\n  };\n\n  var createChild = function createChild(modules, forceNewInstances) {\n    if (forceNewInstances && forceNewInstances.length) {\n      var fromParentModule = Object.create(null);\n      var matchedScopes = Object.create(null);\n\n      var privateInjectorsCache = [];\n      var privateChildInjectors = [];\n      var privateChildFactories = [];\n\n      var provider;\n      var cacheIdx;\n      var privateChildInjector;\n      var privateChildInjectorFactory;\n      for (var name in providers) {\n        provider = providers[name];\n\n        if (forceNewInstances.indexOf(name) !== -1) {\n          if (provider[2] === 'private') {\n            cacheIdx = privateInjectorsCache.indexOf(provider[3]);\n            if (cacheIdx === -1) {\n              privateChildInjector = provider[3].createChild([], forceNewInstances);\n              privateChildInjectorFactory = createPrivateInjectorFactory(privateChildInjector);\n              privateInjectorsCache.push(provider[3]);\n              privateChildInjectors.push(privateChildInjector);\n              privateChildFactories.push(privateChildInjectorFactory);\n              fromParentModule[name] = [privateChildInjectorFactory, name, 'private', privateChildInjector];\n            } else {\n              fromParentModule[name] = [privateChildFactories[cacheIdx], name, 'private', privateChildInjectors[cacheIdx]];\n            }\n          } else {\n            fromParentModule[name] = [provider[2], provider[1]];\n          }\n          matchedScopes[name] = true;\n        }\n\n        if ((provider[2] === 'factory' || provider[2] === 'type') && provider[1].$scope) {\n          /* jshint -W083 */\n          forceNewInstances.forEach(function (scope) {\n            if (provider[1].$scope.indexOf(scope) !== -1) {\n              fromParentModule[name] = [provider[2], provider[1]];\n              matchedScopes[scope] = true;\n            }\n          });\n        }\n      }\n\n      forceNewInstances.forEach(function (scope) {\n        if (!matchedScopes[scope]) {\n          throw new Error('No provider for \"' + scope + '\". Cannot use provider from the parent!');\n        }\n      });\n\n      modules.unshift(fromParentModule);\n    }\n\n    return new Injector(modules, self);\n  };\n\n  var factoryMap = {\n    factory: invoke,\n    type: instantiate,\n    value: function value(_value) {\n      return _value;\n    }\n  };\n\n  modules.forEach(function (module) {\n\n    function arrayUnwrap(type, value) {\n      if (type !== 'value' && isArray(value)) {\n        value = annotate(value.slice());\n      }\n\n      return value;\n    }\n\n    // TODO(vojta): handle wrong inputs (modules)\n    if (module instanceof Module) {\n      module.forEach(function (provider) {\n        var name = provider[0];\n        var type = provider[1];\n        var value = provider[2];\n\n        providers[name] = [factoryMap[type], arrayUnwrap(type, value), type];\n      });\n    } else if ((typeof module === 'undefined' ? 'undefined' : _typeof(module)) === 'object') {\n      if (module.__exports__) {\n        var clonedModule = Object.keys(module).reduce(function (m, key) {\n          if (key.substring(0, 2) !== '__') {\n            m[key] = module[key];\n          }\n          return m;\n        }, Object.create(null));\n\n        var privateInjector = new Injector((module.__modules__ || []).concat([clonedModule]), self);\n        var getFromPrivateInjector = annotate(function (key) {\n          return privateInjector.get(key);\n        });\n        module.__exports__.forEach(function (key) {\n          providers[key] = [getFromPrivateInjector, key, 'private', privateInjector];\n        });\n      } else {\n        Object.keys(module).forEach(function (name) {\n          if (module[name][2] === 'private') {\n            providers[name] = module[name];\n            return;\n          }\n\n          var type = module[name][0];\n          var value = module[name][1];\n\n          providers[name] = [factoryMap[type], arrayUnwrap(type, value), type];\n        });\n      }\n    }\n  });\n\n  // public API\n  this.get = get;\n  this.invoke = invoke;\n  this.instantiate = instantiate;\n  this.createChild = createChild;\n}\n\n// helpers /////////////////\n\nfunction hasProp(obj, prop) {\n  return Object.hasOwnProperty.call(obj, prop);\n}\n\nexport { annotate, Module, Injector };\n","import inherits from 'inherits';\n\nimport BaseRenderer from './BaseRenderer';\n\nimport {\n  componentsToPath,\n  createLine\n} from '../util/RenderUtil';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  isFrameElement\n} from '../util/Elements';\n\n// apply default renderer with lowest possible priority\n// so that it only kicks in if noone else could render\nvar DEFAULT_RENDER_PRIORITY = 1;\n\n/**\n * The default renderer used for shapes and connections.\n *\n * @param {EventBus} eventBus\n * @param {Styles} styles\n */\nexport default function DefaultRenderer(eventBus, styles) {\n  //\n  BaseRenderer.call(this, eventBus, DEFAULT_RENDER_PRIORITY);\n\n  this.CONNECTION_STYLE = styles.style([ 'no-fill' ], { strokeWidth: 5, stroke: 'fuchsia' });\n  this.SHAPE_STYLE = styles.style({ fill: 'white', stroke: 'fuchsia', strokeWidth: 2 });\n  this.FRAME_STYLE = styles.style([ 'no-fill' ], { stroke: 'fuchsia', strokeDasharray: 4, strokeWidth: 2 });\n}\n\ninherits(DefaultRenderer, BaseRenderer);\n\n\nDefaultRenderer.prototype.canRender = function() {\n  return true;\n};\n\nDefaultRenderer.prototype.drawShape = function drawShape(visuals, element) {\n  var rect = svgCreate('rect');\n\n  svgAttr(rect, {\n    x: 0,\n    y: 0,\n    width: element.width || 0,\n    height: element.height || 0\n  });\n\n  if (isFrameElement(element)) {\n    svgAttr(rect, this.FRAME_STYLE);\n  } else {\n    svgAttr(rect, this.SHAPE_STYLE);\n  }\n\n  svgAppend(visuals, rect);\n\n  return rect;\n};\n\nDefaultRenderer.prototype.drawConnection = function drawConnection(visuals, connection) {\n\n  var line = createLine(connection.waypoints, this.CONNECTION_STYLE);\n  svgAppend(visuals, line);\n\n  return line;\n};\n\nDefaultRenderer.prototype.getShapePath = function getShapePath(shape) {\n\n  var x = shape.x,\n      y = shape.y,\n      width = shape.width,\n      height = shape.height;\n\n  var shapePath = [\n    ['M', x, y],\n    ['l', width, 0],\n    ['l', 0, height],\n    ['l', -width, 0],\n    ['z']\n  ];\n\n  return componentsToPath(shapePath);\n};\n\nDefaultRenderer.prototype.getConnectionPath = function getConnectionPath(connection) {\n  var waypoints = connection.waypoints;\n\n  var idx, point, connectionPath = [];\n\n  for (idx = 0; (point = waypoints[idx]); idx++) {\n\n    // take invisible docking into account\n    // when creating the path\n    point = point.original || point;\n\n    connectionPath.push([ idx === 0 ? 'M' : 'L', point.x, point.y ]);\n  }\n\n  return componentsToPath(connectionPath);\n};\n\n\nDefaultRenderer.$inject = [ 'eventBus', 'styles' ];\n","import DefaultRenderer from './DefaultRenderer';\nimport Styles from './Styles';\n\nexport default {\n  __init__: [ 'defaultRenderer' ],\n  defaultRenderer: [ 'type', DefaultRenderer ],\n  styles: [ 'type', Styles ]\n};\n","import {\n  isArray,\n  assign,\n  reduce\n} from 'min-dash';\n\n\n/**\n * A component that manages shape styles\n */\nexport default function Styles() {\n\n  var defaultTraits = {\n\n    'no-fill': {\n      fill: 'none'\n    },\n    'no-border': {\n      strokeOpacity: 0.0\n    },\n    'no-events': {\n      pointerEvents: 'none'\n    }\n  };\n\n  var self = this;\n\n  /**\n   * Builds a style definition from a className, a list of traits and an object of additional attributes.\n   *\n   * @param  {String} className\n   * @param  {Array<String>} traits\n   * @param  {Object} additionalAttrs\n   *\n   * @return {Object} the style defintion\n   */\n  this.cls = function(className, traits, additionalAttrs) {\n    var attrs = this.style(traits, additionalAttrs);\n\n    return assign(attrs, { 'class': className });\n  };\n\n  /**\n   * Builds a style definition from a list of traits and an object of additional attributes.\n   *\n   * @param  {Array<String>} traits\n   * @param  {Object} additionalAttrs\n   *\n   * @return {Object} the style defintion\n   */\n  this.style = function(traits, additionalAttrs) {\n\n    if (!isArray(traits) && !additionalAttrs) {\n      additionalAttrs = traits;\n      traits = [];\n    }\n\n    var attrs = reduce(traits, function(attrs, t) {\n      return assign(attrs, defaultTraits[t] || {});\n    }, {});\n\n    return additionalAttrs ? assign(attrs, additionalAttrs) : attrs;\n  };\n\n  this.computeStyle = function(custom, traits, defaultStyles) {\n    if (!isArray(traits)) {\n      defaultStyles = traits;\n      traits = [];\n    }\n\n    return self.style(traits || [], assign({}, defaultStyles, custom || {}));\n  };\n}\n","import {\n  isNumber,\n  assign,\n  forEach,\n  every,\n  debounce,\n  bind,\n  reduce\n} from 'min-dash';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../util/Collections';\n\nimport {\n  getType\n} from '../util/Elements';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  transform as svgTransform\n} from 'tiny-svg';\n\nimport { createMatrix as createMatrix } from 'tiny-svg';\n\n\nfunction round(number, resolution) {\n  return Math.round(number * resolution) / resolution;\n}\n\nfunction ensurePx(number) {\n  return isNumber(number) ? number + 'px' : number;\n}\n\n/**\n * Creates a HTML container element for a SVG element with\n * the given configuration\n *\n * @param  {Object} options\n * @return {HTMLElement} the container element\n */\nfunction createContainer(options) {\n\n  options = assign({}, { width: '100%', height: '100%' }, options);\n\n  var container = options.container || document.body;\n\n  // create a <div> around the svg element with the respective size\n  // this way we can always get the correct container size\n  // (this is impossible for <svg> elements at the moment)\n  var parent = document.createElement('div');\n  parent.setAttribute('class', 'djs-container');\n\n  assign(parent.style, {\n    position: 'relative',\n    overflow: 'hidden',\n    width: ensurePx(options.width),\n    height: ensurePx(options.height)\n  });\n\n  container.appendChild(parent);\n\n  return parent;\n}\n\nfunction createGroup(parent, cls, childIndex) {\n  var group = svgCreate('g');\n  svgClasses(group).add(cls);\n\n  var index = childIndex !== undefined ? childIndex : parent.childNodes.length - 1;\n\n  // must ensure second argument is node or _null_\n  // cf. https://developer.mozilla.org/en-US/docs/Web/API/Node/insertBefore\n  parent.insertBefore(group, parent.childNodes[index] || null);\n\n  return group;\n}\n\nvar BASE_LAYER = 'base';\n\n\nvar REQUIRED_MODEL_ATTRS = {\n  shape: [ 'x', 'y', 'width', 'height' ],\n  connection: [ 'waypoints' ]\n};\n\n/**\n * The main drawing canvas.\n *\n * @class\n * @constructor\n *\n * @emits Canvas#canvas.init\n *\n * @param {Object} config\n * @param {EventBus} eventBus\n * @param {GraphicsFactory} graphicsFactory\n * @param {ElementRegistry} elementRegistry\n */\nexport default function Canvas(config, eventBus, graphicsFactory, elementRegistry) {\n\n  this._eventBus = eventBus;\n  this._elementRegistry = elementRegistry;\n  this._graphicsFactory = graphicsFactory;\n\n  this._init(config || {});\n}\n\nCanvas.$inject = [\n  'config.canvas',\n  'eventBus',\n  'graphicsFactory',\n  'elementRegistry'\n];\n\n\nCanvas.prototype._init = function(config) {\n\n  var eventBus = this._eventBus;\n\n  // Creates a <svg> element that is wrapped into a <div>.\n  // This way we are always able to correctly figure out the size of the svg element\n  // by querying the parent node.\n  //\n  // (It is not possible to get the size of a svg element cross browser @ 2014-04-01)\n  //\n  // <div class=\"djs-container\" style=\"width: {desired-width}, height: {desired-height}\">\n  //   <svg width=\"100%\" height=\"100%\">\n  //    ...\n  //   </svg>\n  // </div>\n\n  // html container\n  var container = this._container = createContainer(config);\n\n  var svg = this._svg = svgCreate('svg');\n  svgAttr(svg, { width: '100%', height: '100%' });\n\n  svgAppend(container, svg);\n\n  var viewport = this._viewport = createGroup(svg, 'viewport');\n\n  this._layers = {};\n\n  // debounce canvas.viewbox.changed events\n  // for smoother diagram interaction\n  if (config.deferUpdate !== false) {\n    this._viewboxChanged = debounce(bind(this._viewboxChanged, this), 300);\n  }\n\n  eventBus.on('diagram.init', function() {\n\n    /**\n     * An event indicating that the canvas is ready to be drawn on.\n     *\n     * @memberOf Canvas\n     *\n     * @event canvas.init\n     *\n     * @type {Object}\n     * @property {SVGElement} svg the created svg element\n     * @property {SVGElement} viewport the direct parent of diagram elements and shapes\n     */\n    eventBus.fire('canvas.init', {\n      svg: svg,\n      viewport: viewport\n    });\n\n  }, this);\n\n  // reset viewbox on shape changes to\n  // recompute the viewbox\n  eventBus.on([\n    'shape.added',\n    'connection.added',\n    'shape.removed',\n    'connection.removed',\n    'elements.changed'\n  ], function() {\n    delete this._cachedViewbox;\n  }, this);\n\n  eventBus.on('diagram.destroy', 500, this._destroy, this);\n  eventBus.on('diagram.clear', 500, this._clear, this);\n};\n\nCanvas.prototype._destroy = function(emit) {\n  this._eventBus.fire('canvas.destroy', {\n    svg: this._svg,\n    viewport: this._viewport\n  });\n\n  var parent = this._container.parentNode;\n\n  if (parent) {\n    parent.removeChild(this._container);\n  }\n\n  delete this._svg;\n  delete this._container;\n  delete this._layers;\n  delete this._rootElement;\n  delete this._viewport;\n};\n\nCanvas.prototype._clear = function() {\n\n  var self = this;\n\n  var allElements = this._elementRegistry.getAll();\n\n  // remove all elements\n  allElements.forEach(function(element) {\n    var type = getType(element);\n\n    if (type === 'root') {\n      self.setRootElement(null, true);\n    } else {\n      self._removeElement(element, type);\n    }\n  });\n\n  // force recomputation of view box\n  delete this._cachedViewbox;\n};\n\n/**\n * Returns the default layer on which\n * all elements are drawn.\n *\n * @returns {SVGElement}\n */\nCanvas.prototype.getDefaultLayer = function() {\n  return this.getLayer(BASE_LAYER, 0);\n};\n\n/**\n * Returns a layer that is used to draw elements\n * or annotations on it.\n *\n * Non-existing layers retrieved through this method\n * will be created. During creation, the optional index\n * may be used to create layers below or above existing layers.\n * A layer with a certain index is always created above all\n * existing layers with the same index.\n *\n * @param {String} name\n * @param {Number} index\n *\n * @returns {SVGElement}\n */\nCanvas.prototype.getLayer = function(name, index) {\n\n  if (!name) {\n    throw new Error('must specify a name');\n  }\n\n  var layer = this._layers[name];\n\n  if (!layer) {\n    layer = this._layers[name] = this._createLayer(name, index);\n  }\n\n  // throw an error if layer creation / retrival is\n  // requested on different index\n  if (typeof index !== 'undefined' && layer.index !== index) {\n    throw new Error('layer <' + name + '> already created at index <' + index + '>');\n  }\n\n  return layer.group;\n};\n\n/**\n * Creates a given layer and returns it.\n *\n * @param {String} name\n * @param {Number} [index=0]\n *\n * @return {Object} layer descriptor with { index, group: SVGGroup }\n */\nCanvas.prototype._createLayer = function(name, index) {\n\n  if (!index) {\n    index = 0;\n  }\n\n  var childIndex = reduce(this._layers, function(childIndex, layer) {\n    if (index >= layer.index) {\n      childIndex++;\n    }\n\n    return childIndex;\n  }, 0);\n\n  return {\n    group: createGroup(this._viewport, 'layer-' + name, childIndex),\n    index: index\n  };\n\n};\n\n/**\n * Returns the html element that encloses the\n * drawing canvas.\n *\n * @return {DOMNode}\n */\nCanvas.prototype.getContainer = function() {\n  return this._container;\n};\n\n\n// markers //////////////////////\n\nCanvas.prototype._updateMarker = function(element, marker, add) {\n  var container;\n\n  if (!element.id) {\n    element = this._elementRegistry.get(element);\n  }\n\n  // we need to access all\n  container = this._elementRegistry._elements[element.id];\n\n  if (!container) {\n    return;\n  }\n\n  forEach([ container.gfx, container.secondaryGfx ], function(gfx) {\n    if (gfx) {\n      // invoke either addClass or removeClass based on mode\n      if (add) {\n        svgClasses(gfx).add(marker);\n      } else {\n        svgClasses(gfx).remove(marker);\n      }\n    }\n  });\n\n  /**\n   * An event indicating that a marker has been updated for an element\n   *\n   * @event element.marker.update\n   * @type {Object}\n   * @property {djs.model.Element} element the shape\n   * @property {Object} gfx the graphical representation of the shape\n   * @property {String} marker\n   * @property {Boolean} add true if the marker was added, false if it got removed\n   */\n  this._eventBus.fire('element.marker.update', { element: element, gfx: container.gfx, marker: marker, add: !!add });\n};\n\n\n/**\n * Adds a marker to an element (basically a css class).\n *\n * Fires the element.marker.update event, making it possible to\n * integrate extension into the marker life-cycle, too.\n *\n * @example\n * canvas.addMarker('foo', 'some-marker');\n *\n * var fooGfx = canvas.getGraphics('foo');\n *\n * fooGfx; // <g class=\"... some-marker\"> ... </g>\n *\n * @param {String|djs.model.Base} element\n * @param {String} marker\n */\nCanvas.prototype.addMarker = function(element, marker) {\n  this._updateMarker(element, marker, true);\n};\n\n\n/**\n * Remove a marker from an element.\n *\n * Fires the element.marker.update event, making it possible to\n * integrate extension into the marker life-cycle, too.\n *\n * @param  {String|djs.model.Base} element\n * @param  {String} marker\n */\nCanvas.prototype.removeMarker = function(element, marker) {\n  this._updateMarker(element, marker, false);\n};\n\n/**\n * Check the existence of a marker on element.\n *\n * @param  {String|djs.model.Base} element\n * @param  {String} marker\n */\nCanvas.prototype.hasMarker = function(element, marker) {\n  if (!element.id) {\n    element = this._elementRegistry.get(element);\n  }\n\n  var gfx = this.getGraphics(element);\n\n  return svgClasses(gfx).has(marker);\n};\n\n/**\n * Toggles a marker on an element.\n *\n * Fires the element.marker.update event, making it possible to\n * integrate extension into the marker life-cycle, too.\n *\n * @param  {String|djs.model.Base} element\n * @param  {String} marker\n */\nCanvas.prototype.toggleMarker = function(element, marker) {\n  if (this.hasMarker(element, marker)) {\n    this.removeMarker(element, marker);\n  } else {\n    this.addMarker(element, marker);\n  }\n};\n\nCanvas.prototype.getRootElement = function() {\n  if (!this._rootElement) {\n    this.setRootElement({ id: '__implicitroot', children: [] });\n  }\n\n  return this._rootElement;\n};\n\n\n\n// root element handling //////////////////////\n\n/**\n * Sets a given element as the new root element for the canvas\n * and returns the new root element.\n *\n * @param {Object|djs.model.Root} element\n * @param {Boolean} [override] whether to override the current root element, if any\n *\n * @return {Object|djs.model.Root} new root element\n */\nCanvas.prototype.setRootElement = function(element, override) {\n\n  if (element) {\n    this._ensureValid('root', element);\n  }\n\n  var currentRoot = this._rootElement,\n      elementRegistry = this._elementRegistry,\n      eventBus = this._eventBus;\n\n  if (currentRoot) {\n    if (!override) {\n      throw new Error('rootElement already set, need to specify override');\n    }\n\n    // simulate element remove event sequence\n    eventBus.fire('root.remove', { element: currentRoot });\n    eventBus.fire('root.removed', { element: currentRoot });\n\n    elementRegistry.remove(currentRoot);\n  }\n\n  if (element) {\n    var gfx = this.getDefaultLayer();\n\n    // resemble element add event sequence\n    eventBus.fire('root.add', { element: element });\n\n    elementRegistry.add(element, gfx, this._svg);\n\n    eventBus.fire('root.added', { element: element, gfx: gfx });\n  }\n\n  this._rootElement = element;\n\n  return element;\n};\n\n\n\n// add functionality //////////////////////\n\nCanvas.prototype._ensureValid = function(type, element) {\n  if (!element.id) {\n    throw new Error('element must have an id');\n  }\n\n  if (this._elementRegistry.get(element.id)) {\n    throw new Error('element with id ' + element.id + ' already exists');\n  }\n\n  var requiredAttrs = REQUIRED_MODEL_ATTRS[type];\n\n  var valid = every(requiredAttrs, function(attr) {\n    return typeof element[attr] !== 'undefined';\n  });\n\n  if (!valid) {\n    throw new Error(\n      'must supply { ' + requiredAttrs.join(', ') + ' } with ' + type);\n  }\n};\n\nCanvas.prototype._setParent = function(element, parent, parentIndex) {\n  collectionAdd(parent.children, element, parentIndex);\n  element.parent = parent;\n};\n\n/**\n * Adds an element to the canvas.\n *\n * This wires the parent <-> child relationship between the element and\n * a explicitly specified parent or an implicit root element.\n *\n * During add it emits the events\n *\n *  * <{type}.add> (element, parent)\n *  * <{type}.added> (element, gfx)\n *\n * Extensions may hook into these events to perform their magic.\n *\n * @param {String} type\n * @param {Object|djs.model.Base} element\n * @param {Object|djs.model.Base} [parent]\n * @param {Number} [parentIndex]\n *\n * @return {Object|djs.model.Base} the added element\n */\nCanvas.prototype._addElement = function(type, element, parent, parentIndex) {\n\n  parent = parent || this.getRootElement();\n\n  var eventBus = this._eventBus,\n      graphicsFactory = this._graphicsFactory;\n\n  this._ensureValid(type, element);\n\n  eventBus.fire(type + '.add', { element: element, parent: parent });\n\n  this._setParent(element, parent, parentIndex);\n\n  // create graphics\n  var gfx = graphicsFactory.create(type, element, parentIndex);\n\n  this._elementRegistry.add(element, gfx);\n\n  // update its visual\n  graphicsFactory.update(type, element, gfx);\n\n  eventBus.fire(type + '.added', { element: element, gfx: gfx });\n\n  return element;\n};\n\n/**\n * Adds a shape to the canvas\n *\n * @param {Object|djs.model.Shape} shape to add to the diagram\n * @param {djs.model.Base} [parent]\n * @param {Number} [parentIndex]\n *\n * @return {djs.model.Shape} the added shape\n */\nCanvas.prototype.addShape = function(shape, parent, parentIndex) {\n  return this._addElement('shape', shape, parent, parentIndex);\n};\n\n/**\n * Adds a connection to the canvas\n *\n * @param {Object|djs.model.Connection} connection to add to the diagram\n * @param {djs.model.Base} [parent]\n * @param {Number} [parentIndex]\n *\n * @return {djs.model.Connection} the added connection\n */\nCanvas.prototype.addConnection = function(connection, parent, parentIndex) {\n  return this._addElement('connection', connection, parent, parentIndex);\n};\n\n\n/**\n * Internal remove element\n */\nCanvas.prototype._removeElement = function(element, type) {\n\n  var elementRegistry = this._elementRegistry,\n      graphicsFactory = this._graphicsFactory,\n      eventBus = this._eventBus;\n\n  element = elementRegistry.get(element.id || element);\n\n  if (!element) {\n    // element was removed already\n    return;\n  }\n\n  eventBus.fire(type + '.remove', { element: element });\n\n  graphicsFactory.remove(element);\n\n  // unset parent <-> child relationship\n  collectionRemove(element.parent && element.parent.children, element);\n  element.parent = null;\n\n  eventBus.fire(type + '.removed', { element: element });\n\n  elementRegistry.remove(element);\n\n  return element;\n};\n\n\n/**\n * Removes a shape from the canvas\n *\n * @param {String|djs.model.Shape} shape or shape id to be removed\n *\n * @return {djs.model.Shape} the removed shape\n */\nCanvas.prototype.removeShape = function(shape) {\n\n  /**\n   * An event indicating that a shape is about to be removed from the canvas.\n   *\n   * @memberOf Canvas\n   *\n   * @event shape.remove\n   * @type {Object}\n   * @property {djs.model.Shape} element the shape descriptor\n   * @property {Object} gfx the graphical representation of the shape\n   */\n\n  /**\n   * An event indicating that a shape has been removed from the canvas.\n   *\n   * @memberOf Canvas\n   *\n   * @event shape.removed\n   * @type {Object}\n   * @property {djs.model.Shape} element the shape descriptor\n   * @property {Object} gfx the graphical representation of the shape\n   */\n  return this._removeElement(shape, 'shape');\n};\n\n\n/**\n * Removes a connection from the canvas\n *\n * @param {String|djs.model.Connection} connection or connection id to be removed\n *\n * @return {djs.model.Connection} the removed connection\n */\nCanvas.prototype.removeConnection = function(connection) {\n\n  /**\n   * An event indicating that a connection is about to be removed from the canvas.\n   *\n   * @memberOf Canvas\n   *\n   * @event connection.remove\n   * @type {Object}\n   * @property {djs.model.Connection} element the connection descriptor\n   * @property {Object} gfx the graphical representation of the connection\n   */\n\n  /**\n   * An event indicating that a connection has been removed from the canvas.\n   *\n   * @memberOf Canvas\n   *\n   * @event connection.removed\n   * @type {Object}\n   * @property {djs.model.Connection} element the connection descriptor\n   * @property {Object} gfx the graphical representation of the connection\n   */\n  return this._removeElement(connection, 'connection');\n};\n\n\n/**\n * Return the graphical object underlaying a certain diagram element\n *\n * @param {String|djs.model.Base} element descriptor of the element\n * @param {Boolean} [secondary=false] whether to return the secondary connected element\n *\n * @return {SVGElement}\n */\nCanvas.prototype.getGraphics = function(element, secondary) {\n  return this._elementRegistry.getGraphics(element, secondary);\n};\n\n\n/**\n * Perform a viewbox update via a given change function.\n *\n * @param {Function} changeFn\n */\nCanvas.prototype._changeViewbox = function(changeFn) {\n\n  // notify others of the upcoming viewbox change\n  this._eventBus.fire('canvas.viewbox.changing');\n\n  // perform actual change\n  changeFn.apply(this);\n\n  // reset the cached viewbox so that\n  // a new get operation on viewbox or zoom\n  // triggers a viewbox re-computation\n  this._cachedViewbox = null;\n\n  // notify others of the change; this step\n  // may or may not be debounced\n  this._viewboxChanged();\n};\n\nCanvas.prototype._viewboxChanged = function() {\n  this._eventBus.fire('canvas.viewbox.changed', { viewbox: this.viewbox() });\n};\n\n\n/**\n * Gets or sets the view box of the canvas, i.e. the\n * area that is currently displayed.\n *\n * The getter may return a cached viewbox (if it is currently\n * changing). To force a recomputation, pass `false` as the first argument.\n *\n * @example\n *\n * canvas.viewbox({ x: 100, y: 100, width: 500, height: 500 })\n *\n * // sets the visible area of the diagram to (100|100) -> (600|100)\n * // and and scales it according to the diagram width\n *\n * var viewbox = canvas.viewbox(); // pass `false` to force recomputing the box.\n *\n * console.log(viewbox);\n * // {\n * //   inner: Dimensions,\n * //   outer: Dimensions,\n * //   scale,\n * //   x, y,\n * //   width, height\n * // }\n *\n * // if the current diagram is zoomed and scrolled, you may reset it to the\n * // default zoom via this method, too:\n *\n * var zoomedAndScrolledViewbox = canvas.viewbox();\n *\n * canvas.viewbox({\n *   x: 0,\n *   y: 0,\n *   width: zoomedAndScrolledViewbox.outer.width,\n *   height: zoomedAndScrolledViewbox.outer.height\n * });\n *\n * @param  {Object} [box] the new view box to set\n * @param  {Number} box.x the top left X coordinate of the canvas visible in view box\n * @param  {Number} box.y the top left Y coordinate of the canvas visible in view box\n * @param  {Number} box.width the visible width\n * @param  {Number} box.height\n *\n * @return {Object} the current view box\n */\nCanvas.prototype.viewbox = function(box) {\n\n  if (box === undefined && this._cachedViewbox) {\n    return this._cachedViewbox;\n  }\n\n  var viewport = this._viewport,\n      innerBox,\n      outerBox = this.getSize(),\n      matrix,\n      transform,\n      scale,\n      x, y;\n\n  if (!box) {\n    // compute the inner box based on the\n    // diagrams default layer. This allows us to exclude\n    // external components, such as overlays\n    innerBox = this.getDefaultLayer().getBBox();\n\n    transform = svgTransform(viewport);\n    matrix = transform ? transform.matrix : createMatrix();\n    scale = round(matrix.a, 1000);\n\n    x = round(-matrix.e || 0, 1000);\n    y = round(-matrix.f || 0, 1000);\n\n    box = this._cachedViewbox = {\n      x: x ? x / scale : 0,\n      y: y ? y / scale : 0,\n      width: outerBox.width / scale,\n      height: outerBox.height / scale,\n      scale: scale,\n      inner: {\n        width: innerBox.width,\n        height: innerBox.height,\n        x: innerBox.x,\n        y: innerBox.y\n      },\n      outer: outerBox\n    };\n\n    return box;\n  } else {\n\n    this._changeViewbox(function() {\n      scale = Math.min(outerBox.width / box.width, outerBox.height / box.height);\n\n      var matrix = this._svg.createSVGMatrix()\n        .scale(scale)\n        .translate(-box.x, -box.y);\n\n      svgTransform(viewport, matrix);\n    });\n  }\n\n  return box;\n};\n\n\n/**\n * Gets or sets the scroll of the canvas.\n *\n * @param {Object} [delta] the new scroll to apply.\n *\n * @param {Number} [delta.dx]\n * @param {Number} [delta.dy]\n */\nCanvas.prototype.scroll = function(delta) {\n\n  var node = this._viewport;\n  var matrix = node.getCTM();\n\n  if (delta) {\n    this._changeViewbox(function() {\n      delta = assign({ dx: 0, dy: 0 }, delta || {});\n\n      matrix = this._svg.createSVGMatrix().translate(delta.dx, delta.dy).multiply(matrix);\n\n      setCTM(node, matrix);\n    });\n  }\n\n  return { x: matrix.e, y: matrix.f };\n};\n\n\n/**\n * Gets or sets the current zoom of the canvas, optionally zooming\n * to the specified position.\n *\n * The getter may return a cached zoom level. Call it with `false` as\n * the first argument to force recomputation of the current level.\n *\n * @param {String|Number} [newScale] the new zoom level, either a number, i.e. 0.9,\n *                                   or `fit-viewport` to adjust the size to fit the current viewport\n * @param {String|Point} [center] the reference point { x: .., y: ..} to zoom to, 'auto' to zoom into mid or null\n *\n * @return {Number} the current scale\n */\nCanvas.prototype.zoom = function(newScale, center) {\n\n  if (!newScale) {\n    return this.viewbox(newScale).scale;\n  }\n\n  if (newScale === 'fit-viewport') {\n    return this._fitViewport(center);\n  }\n\n  var outer,\n      matrix;\n\n  this._changeViewbox(function() {\n\n    if (typeof center !== 'object') {\n      outer = this.viewbox().outer;\n\n      center = {\n        x: outer.width / 2,\n        y: outer.height / 2\n      };\n    }\n\n    matrix = this._setZoom(newScale, center);\n  });\n\n  return round(matrix.a, 1000);\n};\n\nfunction setCTM(node, m) {\n  var mstr = 'matrix(' + m.a + ',' + m.b + ',' + m.c + ',' + m.d + ',' + m.e + ',' + m.f + ')';\n  node.setAttribute('transform', mstr);\n}\n\nCanvas.prototype._fitViewport = function(center) {\n\n  var vbox = this.viewbox(),\n      outer = vbox.outer,\n      inner = vbox.inner,\n      newScale,\n      newViewbox;\n\n  // display the complete diagram without zooming in.\n  // instead of relying on internal zoom, we perform a\n  // hard reset on the canvas viewbox to realize this\n  //\n  // if diagram does not need to be zoomed in, we focus it around\n  // the diagram origin instead\n\n  if (inner.x >= 0 &&\n      inner.y >= 0 &&\n      inner.x + inner.width <= outer.width &&\n      inner.y + inner.height <= outer.height &&\n      !center) {\n\n    newViewbox = {\n      x: 0,\n      y: 0,\n      width: Math.max(inner.width + inner.x, outer.width),\n      height: Math.max(inner.height + inner.y, outer.height)\n    };\n  } else {\n\n    newScale = Math.min(1, outer.width / inner.width, outer.height / inner.height);\n    newViewbox = {\n      x: inner.x + (center ? inner.width / 2 - outer.width / newScale / 2 : 0),\n      y: inner.y + (center ? inner.height / 2 - outer.height / newScale / 2 : 0),\n      width: outer.width / newScale,\n      height: outer.height / newScale\n    };\n  }\n\n  this.viewbox(newViewbox);\n\n  return this.viewbox(false).scale;\n};\n\n\nCanvas.prototype._setZoom = function(scale, center) {\n\n  var svg = this._svg,\n      viewport = this._viewport;\n\n  var matrix = svg.createSVGMatrix();\n  var point = svg.createSVGPoint();\n\n  var centerPoint,\n      originalPoint,\n      currentMatrix,\n      scaleMatrix,\n      newMatrix;\n\n  currentMatrix = viewport.getCTM();\n\n  var currentScale = currentMatrix.a;\n\n  if (center) {\n    centerPoint = assign(point, center);\n\n    // revert applied viewport transformations\n    originalPoint = centerPoint.matrixTransform(currentMatrix.inverse());\n\n    // create scale matrix\n    scaleMatrix = matrix\n      .translate(originalPoint.x, originalPoint.y)\n      .scale(1 / currentScale * scale)\n      .translate(-originalPoint.x, -originalPoint.y);\n\n    newMatrix = currentMatrix.multiply(scaleMatrix);\n  } else {\n    newMatrix = matrix.scale(scale);\n  }\n\n  setCTM(this._viewport, newMatrix);\n\n  return newMatrix;\n};\n\n\n/**\n * Returns the size of the canvas\n *\n * @return {Dimensions}\n */\nCanvas.prototype.getSize = function() {\n  return {\n    width: this._container.clientWidth,\n    height: this._container.clientHeight\n  };\n};\n\n\n/**\n * Return the absolute bounding box for the given element\n *\n * The absolute bounding box may be used to display overlays in the\n * callers (browser) coordinate system rather than the zoomed in/out\n * canvas coordinates.\n *\n * @param  {ElementDescriptor} element\n * @return {Bounds} the absolute bounding box\n */\nCanvas.prototype.getAbsoluteBBox = function(element) {\n  var vbox = this.viewbox();\n  var bbox;\n\n  // connection\n  // use svg bbox\n  if (element.waypoints) {\n    var gfx = this.getGraphics(element);\n\n    bbox = gfx.getBBox();\n  }\n  // shapes\n  // use data\n  else {\n    bbox = element;\n  }\n\n  var x = bbox.x * vbox.scale - vbox.x * vbox.scale;\n  var y = bbox.y * vbox.scale - vbox.y * vbox.scale;\n\n  var width = bbox.width * vbox.scale;\n  var height = bbox.height * vbox.scale;\n\n  return {\n    x: x,\n    y: y,\n    width: width,\n    height: height\n  };\n};\n\n/**\n * Fires an event in order other modules can react to the\n * canvas resizing\n */\nCanvas.prototype.resized = function() {\n\n  // force recomputation of view box\n  delete this._cachedViewbox;\n\n  this._eventBus.fire('canvas.resized');\n};\n","var ELEMENT_ID = 'data-element-id';\n\nimport { attr as svgAttr } from 'tiny-svg';\n\n\n/**\n * @class\n *\n * A registry that keeps track of all shapes in the diagram.\n */\nexport default function ElementRegistry(eventBus) {\n  this._elements = {};\n\n  this._eventBus = eventBus;\n}\n\nElementRegistry.$inject = [ 'eventBus' ];\n\n/**\n * Register a pair of (element, gfx, (secondaryGfx)).\n *\n * @param {djs.model.Base} element\n * @param {SVGElement} gfx\n * @param {SVGElement} [secondaryGfx] optional other element to register, too\n */\nElementRegistry.prototype.add = function(element, gfx, secondaryGfx) {\n\n  var id = element.id;\n\n  this._validateId(id);\n\n  // associate dom node with element\n  svgAttr(gfx, ELEMENT_ID, id);\n\n  if (secondaryGfx) {\n    svgAttr(secondaryGfx, ELEMENT_ID, id);\n  }\n\n  this._elements[id] = { element: element, gfx: gfx, secondaryGfx: secondaryGfx };\n};\n\n/**\n * Removes an element from the registry.\n *\n * @param {djs.model.Base} element\n */\nElementRegistry.prototype.remove = function(element) {\n  var elements = this._elements,\n      id = element.id || element,\n      container = id && elements[id];\n\n  if (container) {\n\n    // unset element id on gfx\n    svgAttr(container.gfx, ELEMENT_ID, '');\n\n    if (container.secondaryGfx) {\n      svgAttr(container.secondaryGfx, ELEMENT_ID, '');\n    }\n\n    delete elements[id];\n  }\n};\n\n/**\n * Update the id of an element\n *\n * @param {djs.model.Base} element\n * @param {String} newId\n */\nElementRegistry.prototype.updateId = function(element, newId) {\n\n  this._validateId(newId);\n\n  if (typeof element === 'string') {\n    element = this.get(element);\n  }\n\n  this._eventBus.fire('element.updateId', {\n    element: element,\n    newId: newId\n  });\n\n  var gfx = this.getGraphics(element),\n      secondaryGfx = this.getGraphics(element, true);\n\n  this.remove(element);\n\n  element.id = newId;\n\n  this.add(element, gfx, secondaryGfx);\n};\n\n/**\n * Return the model element for a given id or graphics.\n *\n * @example\n *\n * elementRegistry.get('SomeElementId_1');\n * elementRegistry.get(gfx);\n *\n *\n * @param {String|SVGElement} filter for selecting the element\n *\n * @return {djs.model.Base}\n */\nElementRegistry.prototype.get = function(filter) {\n  var id;\n\n  if (typeof filter === 'string') {\n    id = filter;\n  } else {\n    id = filter && svgAttr(filter, ELEMENT_ID);\n  }\n\n  var container = this._elements[id];\n  return container && container.element;\n};\n\n/**\n * Return all elements that match a given filter function.\n *\n * @param {Function} fn\n *\n * @return {Array<djs.model.Base>}\n */\nElementRegistry.prototype.filter = function(fn) {\n\n  var filtered = [];\n\n  this.forEach(function(element, gfx) {\n    if (fn(element, gfx)) {\n      filtered.push(element);\n    }\n  });\n\n  return filtered;\n};\n\n/**\n * Return all rendered model elements.\n *\n * @return {Array<djs.model.Base>}\n */\nElementRegistry.prototype.getAll = function() {\n  return this.filter(function(e) { return e; });\n};\n\n/**\n * Iterate over all diagram elements.\n *\n * @param {Function} fn\n */\nElementRegistry.prototype.forEach = function(fn) {\n\n  var map = this._elements;\n\n  Object.keys(map).forEach(function(id) {\n    var container = map[id],\n        element = container.element,\n        gfx = container.gfx;\n\n    return fn(element, gfx);\n  });\n};\n\n/**\n * Return the graphical representation of an element or its id.\n *\n * @example\n * elementRegistry.getGraphics('SomeElementId_1');\n * elementRegistry.getGraphics(rootElement); // <g ...>\n *\n * elementRegistry.getGraphics(rootElement, true); // <svg ...>\n *\n *\n * @param {String|djs.model.Base} filter\n * @param {Boolean} [secondary=false] whether to return the secondary connected element\n *\n * @return {SVGElement}\n */\nElementRegistry.prototype.getGraphics = function(filter, secondary) {\n  var id = filter.id || filter;\n\n  var container = this._elements[id];\n  return container && (secondary ? container.secondaryGfx : container.gfx);\n};\n\n/**\n * Validate the suitability of the given id and signals a problem\n * with an exception.\n *\n * @param {String} id\n *\n * @throws {Error} if id is empty or already assigned\n */\nElementRegistry.prototype._validateId = function(id) {\n  if (!id) {\n    throw new Error('element must have an id');\n  }\n\n  if (this._elements[id]) {\n    throw new Error('element with id ' + id + ' already added');\n  }\n};\n","import {\n  isFunction,\n  isArray,\n  isNumber,\n  bind,\n  assign\n} from 'min-dash';\n\nvar FN_REF = '__fn';\n\nvar DEFAULT_PRIORITY = 1000;\n\nvar slice = Array.prototype.slice;\n\n/**\n * A general purpose event bus.\n *\n * This component is used to communicate across a diagram instance.\n * Other parts of a diagram can use it to listen to and broadcast events.\n *\n *\n * ## Registering for Events\n *\n * The event bus provides the {@link EventBus#on} and {@link EventBus#once}\n * methods to register for events. {@link EventBus#off} can be used to\n * remove event registrations. Listeners receive an instance of {@link Event}\n * as the first argument. It allows them to hook into the event execution.\n *\n * ```javascript\n *\n * // listen for event\n * eventBus.on('foo', function(event) {\n *\n *   // access event type\n *   event.type; // 'foo'\n *\n *   // stop propagation to other listeners\n *   event.stopPropagation();\n *\n *   // prevent event default\n *   event.preventDefault();\n * });\n *\n * // listen for event with custom payload\n * eventBus.on('bar', function(event, payload) {\n *   console.log(payload);\n * });\n *\n * // listen for event returning value\n * eventBus.on('foobar', function(event) {\n *\n *   // stop event propagation + prevent default\n *   return false;\n *\n *   // stop event propagation + return custom result\n *   return {\n *     complex: 'listening result'\n *   };\n * });\n *\n *\n * // listen with custom priority (default=1000, higher is better)\n * eventBus.on('priorityfoo', 1500, function(event) {\n *   console.log('invoked first!');\n * });\n *\n *\n * // listen for event and pass the context (`this`)\n * eventBus.on('foobar', function(event) {\n *   this.foo();\n * }, this);\n * ```\n *\n *\n * ## Emitting Events\n *\n * Events can be emitted via the event bus using {@link EventBus#fire}.\n *\n * ```javascript\n *\n * // false indicates that the default action\n * // was prevented by listeners\n * if (eventBus.fire('foo') === false) {\n *   console.log('default has been prevented!');\n * };\n *\n *\n * // custom args + return value listener\n * eventBus.on('sum', function(event, a, b) {\n *   return a + b;\n * });\n *\n * // you can pass custom arguments + retrieve result values.\n * var sum = eventBus.fire('sum', 1, 2);\n * console.log(sum); // 3\n * ```\n */\nexport default function EventBus() {\n  this._listeners = {};\n\n  // cleanup on destroy on lowest priority to allow\n  // message passing until the bitter end\n  this.on('diagram.destroy', 1, this._destroy, this);\n}\n\n\n/**\n * Register an event listener for events with the given name.\n *\n * The callback will be invoked with `event, ...additionalArguments`\n * that have been passed to {@link EventBus#fire}.\n *\n * Returning false from a listener will prevent the events default action\n * (if any is specified). To stop an event from being processed further in\n * other listeners execute {@link Event#stopPropagation}.\n *\n * Returning anything but `undefined` from a listener will stop the listener propagation.\n *\n * @param {String|Array<String>} events\n * @param {Number} [priority=1000] the priority in which this listener is called, larger is higher\n * @param {Function} callback\n * @param {Object} [that] Pass context (`this`) to the callback\n */\nEventBus.prototype.on = function(events, priority, callback, that) {\n\n  events = isArray(events) ? events : [ events ];\n\n  if (isFunction(priority)) {\n    that = callback;\n    callback = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (!isNumber(priority)) {\n    throw new Error('priority must be a number');\n  }\n\n  var actualCallback = callback;\n\n  if (that) {\n    actualCallback = bind(callback, that);\n\n    // make sure we remember and are able to remove\n    // bound callbacks via {@link #off} using the original\n    // callback\n    actualCallback[FN_REF] = callback[FN_REF] || callback;\n  }\n\n  var self = this;\n\n  events.forEach(function(e) {\n    self._addListener(e, {\n      priority: priority,\n      callback: actualCallback,\n      next: null\n    });\n  });\n};\n\n\n/**\n * Register an event listener that is executed only once.\n *\n * @param {String} event the event name to register for\n * @param {Number} [priority=1000] the priority in which this listener is called, larger is higher\n * @param {Function} callback the callback to execute\n * @param {Object} [that] Pass context (`this`) to the callback\n */\nEventBus.prototype.once = function(event, priority, callback, that) {\n  var self = this;\n\n  if (isFunction(priority)) {\n    that = callback;\n    callback = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (!isNumber(priority)) {\n    throw new Error('priority must be a number');\n  }\n\n  function wrappedCallback() {\n    var result = callback.apply(that, arguments);\n\n    self.off(event, wrappedCallback);\n\n    return result;\n  }\n\n  // make sure we remember and are able to remove\n  // bound callbacks via {@link #off} using the original\n  // callback\n  wrappedCallback[FN_REF] = callback;\n\n  this.on(event, priority, wrappedCallback);\n};\n\n\n/**\n * Removes event listeners by event and callback.\n *\n * If no callback is given, all listeners for a given event name are being removed.\n *\n * @param {String|Array<String>} events\n * @param {Function} [callback]\n */\nEventBus.prototype.off = function(events, callback) {\n\n  events = isArray(events) ? events : [ events ];\n\n  var self = this;\n\n  events.forEach(function(event) {\n    self._removeListener(event, callback);\n  });\n\n};\n\n\n/**\n * Create an EventBus event.\n *\n * @param {Object} data\n *\n * @return {Object} event, recognized by the eventBus\n */\nEventBus.prototype.createEvent = function(data) {\n  var event = new InternalEvent();\n\n  event.init(data);\n\n  return event;\n};\n\n\n/**\n * Fires a named event.\n *\n * @example\n *\n * // fire event by name\n * events.fire('foo');\n *\n * // fire event object with nested type\n * var event = { type: 'foo' };\n * events.fire(event);\n *\n * // fire event with explicit type\n * var event = { x: 10, y: 20 };\n * events.fire('element.moved', event);\n *\n * // pass additional arguments to the event\n * events.on('foo', function(event, bar) {\n *   alert(bar);\n * });\n *\n * events.fire({ type: 'foo' }, 'I am bar!');\n *\n * @param {String} [name] the optional event name\n * @param {Object} [event] the event object\n * @param {...Object} additional arguments to be passed to the callback functions\n *\n * @return {Boolean} the events return value, if specified or false if the\n *                   default action was prevented by listeners\n */\nEventBus.prototype.fire = function(type, data) {\n\n  var event,\n      firstListener,\n      returnValue,\n      args;\n\n  args = slice.call(arguments);\n\n  if (typeof type === 'object') {\n    event = type;\n    type = event.type;\n  }\n\n  if (!type) {\n    throw new Error('no event type specified');\n  }\n\n  firstListener = this._listeners[type];\n\n  if (!firstListener) {\n    return;\n  }\n\n  // we make sure we fire instances of our home made\n  // events here. We wrap them only once, though\n  if (data instanceof InternalEvent) {\n    // we are fine, we alread have an event\n    event = data;\n  } else {\n    event = this.createEvent(data);\n  }\n\n  // ensure we pass the event as the first parameter\n  args[0] = event;\n\n  // original event type (in case we delegate)\n  var originalType = event.type;\n\n  // update event type before delegation\n  if (type !== originalType) {\n    event.type = type;\n  }\n\n  try {\n    returnValue = this._invokeListeners(event, args, firstListener);\n  } finally {\n    // reset event type after delegation\n    if (type !== originalType) {\n      event.type = originalType;\n    }\n  }\n\n  // set the return value to false if the event default\n  // got prevented and no other return value exists\n  if (returnValue === undefined && event.defaultPrevented) {\n    returnValue = false;\n  }\n\n  return returnValue;\n};\n\n\nEventBus.prototype.handleError = function(error) {\n  return this.fire('error', { error: error }) === false;\n};\n\n\nEventBus.prototype._destroy = function() {\n  this._listeners = {};\n};\n\nEventBus.prototype._invokeListeners = function(event, args, listener) {\n\n  var returnValue;\n\n  while (listener) {\n\n    // handle stopped propagation\n    if (event.cancelBubble) {\n      break;\n    }\n\n    returnValue = this._invokeListener(event, args, listener);\n\n    listener = listener.next;\n  }\n\n  return returnValue;\n};\n\nEventBus.prototype._invokeListener = function(event, args, listener) {\n\n  var returnValue;\n\n  try {\n    // returning false prevents the default action\n    returnValue = invokeFunction(listener.callback, args);\n\n    // stop propagation on return value\n    if (returnValue !== undefined) {\n      event.returnValue = returnValue;\n      event.stopPropagation();\n    }\n\n    // prevent default on return false\n    if (returnValue === false) {\n      event.preventDefault();\n    }\n  } catch (e) {\n    if (!this.handleError(e)) {\n      console.error('unhandled error in event listener');\n      console.error(e.stack);\n\n      throw e;\n    }\n  }\n\n  return returnValue;\n};\n\n/*\n * Add new listener with a certain priority to the list\n * of listeners (for the given event).\n *\n * The semantics of listener registration / listener execution are\n * first register, first serve: New listeners will always be inserted\n * after existing listeners with the same priority.\n *\n * Example: Inserting two listeners with priority 1000 and 1300\n *\n *    * before: [ 1500, 1500, 1000, 1000 ]\n *    * after: [ 1500, 1500, (new=1300), 1000, 1000, (new=1000) ]\n *\n * @param {String} event\n * @param {Object} listener { priority, callback }\n */\nEventBus.prototype._addListener = function(event, newListener) {\n\n  var listener = this._getListeners(event),\n      previousListener;\n\n  // no prior listeners\n  if (!listener) {\n    this._setListeners(event, newListener);\n\n    return;\n  }\n\n  // ensure we order listeners by priority from\n  // 0 (high) to n > 0 (low)\n  while (listener) {\n\n    if (listener.priority < newListener.priority) {\n\n      newListener.next = listener;\n\n      if (previousListener) {\n        previousListener.next = newListener;\n      } else {\n        this._setListeners(event, newListener);\n      }\n\n      return;\n    }\n\n    previousListener = listener;\n    listener = listener.next;\n  }\n\n  // add new listener to back\n  previousListener.next = newListener;\n};\n\n\nEventBus.prototype._getListeners = function(name) {\n  return this._listeners[name];\n};\n\nEventBus.prototype._setListeners = function(name, listener) {\n  this._listeners[name] = listener;\n};\n\nEventBus.prototype._removeListener = function(event, callback) {\n\n  var listener = this._getListeners(event),\n      nextListener,\n      previousListener,\n      listenerCallback;\n\n  if (!callback) {\n    // clear listeners\n    this._setListeners(event, null);\n\n    return;\n  }\n\n  while (listener) {\n\n    nextListener = listener.next;\n\n    listenerCallback = listener.callback;\n\n    if (listenerCallback === callback || listenerCallback[FN_REF] === callback) {\n      if (previousListener) {\n        previousListener.next = nextListener;\n      } else {\n        // new first listener\n        this._setListeners(event, nextListener);\n      }\n    }\n\n    previousListener = listener;\n    listener = nextListener;\n  }\n};\n\n/**\n * A event that is emitted via the event bus.\n */\nfunction InternalEvent() { }\n\nInternalEvent.prototype.stopPropagation = function() {\n  this.cancelBubble = true;\n};\n\nInternalEvent.prototype.preventDefault = function() {\n  this.defaultPrevented = true;\n};\n\nInternalEvent.prototype.init = function(data) {\n  assign(this, data || {});\n};\n\n\n/**\n * Invoke function. Be fast...\n *\n * @param {Function} fn\n * @param {Array<Object>} args\n *\n * @return {Any}\n */\nfunction invokeFunction(fn, args) {\n  return fn.apply(null, args);\n}\n","import {\n  forEach,\n  reduce\n} from 'min-dash';\n\nimport {\n  getChildren,\n  getVisual\n} from '../util/GraphicsUtil';\n\nimport { translate } from '../util/SvgTransformUtil';\n\nimport { clear as domClear } from 'min-dom';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  isFrameElement\n} from '../util/Elements';\n\n/**\n * A factory that creates graphical elements\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n */\nexport default function GraphicsFactory(eventBus, elementRegistry) {\n  this._eventBus = eventBus;\n  this._elementRegistry = elementRegistry;\n}\n\nGraphicsFactory.$inject = [ 'eventBus' , 'elementRegistry' ];\n\n\nGraphicsFactory.prototype._getChildren = function(element) {\n\n  var gfx = this._elementRegistry.getGraphics(element);\n\n  var childrenGfx;\n\n  // root element\n  if (!element.parent) {\n    childrenGfx = gfx;\n  } else {\n    childrenGfx = getChildren(gfx);\n    if (!childrenGfx) {\n      childrenGfx = svgCreate('g');\n      svgClasses(childrenGfx).add('djs-children');\n\n      svgAppend(gfx.parentNode, childrenGfx);\n    }\n  }\n\n  return childrenGfx;\n};\n\n/**\n * Clears the graphical representation of the element and returns the\n * cleared visual (the <g class=\"djs-visual\" /> element).\n */\nGraphicsFactory.prototype._clear = function(gfx) {\n  var visual = getVisual(gfx);\n\n  domClear(visual);\n\n  return visual;\n};\n\n/**\n * Creates a gfx container for shapes and connections\n *\n * The layout is as follows:\n *\n * <g class=\"djs-group\">\n *\n *   <!-- the gfx -->\n *   <g class=\"djs-element djs-(shape|connection|frame)\">\n *     <g class=\"djs-visual\">\n *       <!-- the renderer draws in here -->\n *     </g>\n *\n *     <!-- extensions (overlays, click box, ...) goes here\n *   </g>\n *\n *   <!-- the gfx child nodes -->\n *   <g class=\"djs-children\"></g>\n * </g>\n *\n * @param {String} type the type of the element, i.e. shape | connection\n * @param {SVGElement} [childrenGfx]\n * @param {Number} [parentIndex] position to create container in parent\n * @param {Boolean} [isFrame] is frame element\n *\n * @return {SVGElement}\n */\nGraphicsFactory.prototype._createContainer = function(\n    type, childrenGfx, parentIndex, isFrame\n) {\n  var outerGfx = svgCreate('g');\n  svgClasses(outerGfx).add('djs-group');\n\n  // insert node at position\n  if (typeof parentIndex !== 'undefined') {\n    prependTo(outerGfx, childrenGfx, childrenGfx.childNodes[parentIndex]);\n  } else {\n    svgAppend(childrenGfx, outerGfx);\n  }\n\n  var gfx = svgCreate('g');\n  svgClasses(gfx).add('djs-element');\n  svgClasses(gfx).add('djs-' + type);\n\n  if (isFrame) {\n    svgClasses(gfx).add('djs-frame');\n  }\n\n  svgAppend(outerGfx, gfx);\n\n  // create visual\n  var visual = svgCreate('g');\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(gfx, visual);\n\n  return gfx;\n};\n\nGraphicsFactory.prototype.create = function(type, element, parentIndex) {\n  var childrenGfx = this._getChildren(element.parent);\n  return this._createContainer(type, childrenGfx, parentIndex, isFrameElement(element));\n};\n\nGraphicsFactory.prototype.updateContainments = function(elements) {\n\n  var self = this,\n      elementRegistry = this._elementRegistry,\n      parents;\n\n  parents = reduce(elements, function(map, e) {\n\n    if (e.parent) {\n      map[e.parent.id] = e.parent;\n    }\n\n    return map;\n  }, {});\n\n  // update all parents of changed and reorganized their children\n  // in the correct order (as indicated in our model)\n  forEach(parents, function(parent) {\n\n    var children = parent.children;\n\n    if (!children) {\n      return;\n    }\n\n    var childGfx = self._getChildren(parent);\n\n    forEach(children.slice().reverse(), function(c) {\n      var gfx = elementRegistry.getGraphics(c);\n\n      prependTo(gfx.parentNode, childGfx);\n    });\n  });\n};\n\nGraphicsFactory.prototype.drawShape = function(visual, element) {\n  var eventBus = this._eventBus;\n\n  return eventBus.fire('render.shape', { gfx: visual, element: element });\n};\n\nGraphicsFactory.prototype.getShapePath = function(element) {\n  var eventBus = this._eventBus;\n\n  return eventBus.fire('render.getShapePath', element);\n};\n\nGraphicsFactory.prototype.drawConnection = function(visual, element) {\n  var eventBus = this._eventBus;\n\n  return eventBus.fire('render.connection', { gfx: visual, element: element });\n};\n\nGraphicsFactory.prototype.getConnectionPath = function(waypoints) {\n  var eventBus = this._eventBus;\n\n  return eventBus.fire('render.getConnectionPath', waypoints);\n};\n\nGraphicsFactory.prototype.update = function(type, element, gfx) {\n\n  // do NOT update root element\n  if (!element.parent) {\n    return;\n  }\n\n  var visual = this._clear(gfx);\n\n  // redraw\n  if (type === 'shape') {\n    this.drawShape(visual, element);\n\n    // update positioning\n    translate(gfx, element.x, element.y);\n  } else\n  if (type === 'connection') {\n    this.drawConnection(visual, element);\n  } else {\n    throw new Error('unknown type: ' + type);\n  }\n\n  if (element.hidden) {\n    svgAttr(gfx, 'display', 'none');\n  } else {\n    svgAttr(gfx, 'display', 'block');\n  }\n};\n\nGraphicsFactory.prototype.remove = function(element) {\n  var gfx = this._elementRegistry.getGraphics(element);\n\n  // remove\n  svgRemove(gfx.parentNode);\n};\n\n\n// helpers //////////\n\nfunction prependTo(newNode, parentNode, siblingNode) {\n  var node = siblingNode || parentNode.firstChild;\n\n  // do not prepend node to itself to prevent IE from crashing\n  // https://github.com/bpmn-io/bpmn-js/issues/746\n  if (newNode === node) {\n    return;\n  }\n\n  parentNode.insertBefore(newNode, node);\n}\n","import DrawModule from '../draw';\n\nimport Canvas from './Canvas';\nimport ElementRegistry from './ElementRegistry';\nimport ElementFactory from './ElementFactory';\nimport EventBus from './EventBus';\nimport GraphicsFactory from './GraphicsFactory';\n\nexport default {\n  __depends__: [ DrawModule ],\n  __init__: [ 'canvas' ],\n  canvas: [ 'type', Canvas ],\n  elementRegistry: [ 'type', ElementRegistry ],\n  elementFactory: [ 'type', ElementFactory ],\n  eventBus: [ 'type', EventBus ],\n  graphicsFactory: [ 'type', GraphicsFactory ]\n};","import { Injector } from 'didi';\n\nimport CoreModule from './core';\n\n\n/**\n * Bootstrap an injector from a list of modules, instantiating a number of default components\n *\n * @ignore\n * @param {Array<didi.Module>} bootstrapModules\n *\n * @return {didi.Injector} a injector to use to access the components\n */\nfunction bootstrap(bootstrapModules) {\n\n  var modules = [],\n      components = [];\n\n  function hasModule(m) {\n    return modules.indexOf(m) >= 0;\n  }\n\n  function addModule(m) {\n    modules.push(m);\n  }\n\n  function visit(m) {\n    if (hasModule(m)) {\n      return;\n    }\n\n    (m.__depends__ || []).forEach(visit);\n\n    if (hasModule(m)) {\n      return;\n    }\n\n    addModule(m);\n\n    (m.__init__ || []).forEach(function(c) {\n      components.push(c);\n    });\n  }\n\n  bootstrapModules.forEach(visit);\n\n  var injector = new Injector(modules);\n\n  components.forEach(function(c) {\n\n    try {\n      // eagerly resolve component (fn or string)\n      injector[typeof c === 'string' ? 'get' : 'invoke'](c);\n    } catch (e) {\n      console.error('Failed to instantiate component');\n      console.error(e.stack);\n\n      throw e;\n    }\n  });\n\n  return injector;\n}\n\n/**\n * Creates an injector from passed options.\n *\n * @ignore\n * @param  {Object} options\n * @return {didi.Injector}\n */\nfunction createInjector(options) {\n\n  options = options || {};\n\n  var configModule = {\n    'config': ['value', options]\n  };\n\n  var modules = [ configModule, CoreModule ].concat(options.modules || []);\n\n  return bootstrap(modules);\n}\n\n\n/**\n * The main diagram-js entry point that bootstraps the diagram with the given\n * configuration.\n *\n * To register extensions with the diagram, pass them as Array<didi.Module> to the constructor.\n *\n * @class djs.Diagram\n * @memberOf djs\n * @constructor\n *\n * @example\n *\n * <caption>Creating a plug-in that logs whenever a shape is added to the canvas.</caption>\n *\n * // plug-in implemenentation\n * function MyLoggingPlugin(eventBus) {\n *   eventBus.on('shape.added', function(event) {\n *     console.log('shape ', event.shape, ' was added to the diagram');\n *   });\n * }\n *\n * // export as module\n * export default {\n *   __init__: [ 'myLoggingPlugin' ],\n *     myLoggingPlugin: [ 'type', MyLoggingPlugin ]\n * };\n *\n *\n * // instantiate the diagram with the new plug-in\n *\n * import MyLoggingModule from 'path-to-my-logging-plugin';\n *\n * var diagram = new Diagram({\n *   modules: [\n *     MyLoggingModule\n *   ]\n * });\n *\n * diagram.invoke([ 'canvas', function(canvas) {\n *   // add shape to drawing canvas\n *   canvas.addShape({ x: 10, y: 10 });\n * });\n *\n * // 'shape ... was added to the diagram' logged to console\n *\n * @param {Object} options\n * @param {Array<didi.Module>} [options.modules] external modules to instantiate with the diagram\n * @param {didi.Injector} [injector] an (optional) injector to bootstrap the diagram with\n */\nexport default function Diagram(options, injector) {\n\n  // create injector unless explicitly specified\n  this.injector = injector = injector || createInjector(options);\n\n  // API\n\n  /**\n   * Resolves a diagram service\n   *\n   * @method Diagram#get\n   *\n   * @param {String} name the name of the diagram service to be retrieved\n   * @param {Boolean} [strict=true] if false, resolve missing services to null\n   */\n  this.get = injector.get;\n\n  /**\n   * Executes a function into which diagram services are injected\n   *\n   * @method Diagram#invoke\n   *\n   * @param {Function|Object[]} fn the function to resolve\n   * @param {Object} locals a number of locals to use to resolve certain dependencies\n   */\n  this.invoke = injector.invoke;\n\n  // init\n\n  // indicate via event\n\n\n  /**\n   * An event indicating that all plug-ins are loaded.\n   *\n   * Use this event to fire other events to interested plug-ins\n   *\n   * @memberOf Diagram\n   *\n   * @event diagram.init\n   *\n   * @example\n   *\n   * eventBus.on('diagram.init', function() {\n   *   eventBus.fire('my-custom-event', { foo: 'BAR' });\n   * });\n   *\n   * @type {Object}\n   */\n  this.get('eventBus').fire('diagram.init');\n}\n\n\n/**\n * Destroys the diagram\n *\n * @method  Diagram#destroy\n */\nDiagram.prototype.destroy = function() {\n  this.get('eventBus').fire('diagram.destroy');\n};\n\n/**\n * Clear the diagram, removing all contents.\n */\nDiagram.prototype.clear = function() {\n  this.get('eventBus').fire('diagram.clear');\n};\n","export { default } from './lib/Diagram';","import {\n  pointDistance\n} from './Geometry';\n\nimport intersectPaths from 'path-intersection';\n\nvar round = Math.round,\n    max = Math.max;\n\n\nfunction circlePath(center, r) {\n  var x = center.x,\n      y = center.y;\n\n  return [\n    ['M', x, y],\n    ['m', 0, -r],\n    ['a', r, r, 0, 1, 1, 0, 2 * r],\n    ['a', r, r, 0, 1, 1, 0, -2 * r],\n    ['z']\n  ];\n}\n\nfunction linePath(points) {\n  var segments = [];\n\n  points.forEach(function(p, idx) {\n    segments.push([ idx === 0 ? 'M' : 'L', p.x, p.y ]);\n  });\n\n  return segments;\n}\n\n\nvar INTERSECTION_THRESHOLD = 10;\n\nfunction getBendpointIntersection(waypoints, reference) {\n\n  var i, w;\n\n  for (i = 0; (w = waypoints[i]); i++) {\n\n    if (pointDistance(w, reference) <= INTERSECTION_THRESHOLD) {\n      return {\n        point: waypoints[i],\n        bendpoint: true,\n        index: i\n      };\n    }\n  }\n\n  return null;\n}\n\nfunction getPathIntersection(waypoints, reference) {\n\n  var intersections = intersectPaths(circlePath(reference, INTERSECTION_THRESHOLD), linePath(waypoints));\n\n  var a = intersections[0],\n      b = intersections[intersections.length - 1],\n      idx;\n\n  if (!a) {\n    // no intersection\n    return null;\n  }\n\n  if (a !== b) {\n\n    if (a.segment2 !== b.segment2) {\n      // we use the bendpoint in between both segments\n      // as the intersection point\n\n      idx = max(a.segment2, b.segment2) - 1;\n\n      return {\n        point: waypoints[idx],\n        bendpoint: true,\n        index: idx\n      };\n    }\n\n    return {\n      point: {\n        x: (round(a.x + b.x) / 2),\n        y: (round(a.y + b.y) / 2)\n      },\n      index: a.segment2\n    };\n  }\n\n  return {\n    point: {\n      x: round(a.x),\n      y: round(a.y)\n    },\n    index: a.segment2\n  };\n}\n\n/**\n * Returns the closest point on the connection towards a given reference point.\n *\n * @param  {Array<Point>} waypoints\n * @param  {Point} reference\n *\n * @return {Object} intersection data (segment, point)\n */\nexport function getApproxIntersection(waypoints, reference) {\n  return getBendpointIntersection(waypoints, reference) || getPathIntersection(waypoints, reference);\n}\n","import {\n  toPoint\n} from '../../util/Event';\n\nimport {\n  getMidPoint,\n  pointsAligned\n} from '../../util/Geometry';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  rotate,\n  translate\n} from '../../util/SvgTransformUtil';\n\nimport {\n  getApproxIntersection\n} from '../../util/LineIntersection';\n\nexport var BENDPOINT_CLS = 'djs-bendpoint';\nexport var SEGMENT_DRAGGER_CLS = 'djs-segment-dragger';\n\nexport function toCanvasCoordinates(canvas, event) {\n\n  var position = toPoint(event),\n      clientRect = canvas._container.getBoundingClientRect(),\n      offset;\n\n  // canvas relative position\n\n  offset = {\n    x: clientRect.left,\n    y: clientRect.top\n  };\n\n  // update actual event payload with canvas relative measures\n\n  var viewbox = canvas.viewbox();\n\n  return {\n    x: viewbox.x + (position.x - offset.x) / viewbox.scale,\n    y: viewbox.y + (position.y - offset.y) / viewbox.scale\n  };\n}\n\nexport function getConnectionIntersection(canvas, waypoints, event) {\n  var localPosition = toCanvasCoordinates(canvas, event),\n      intersection = getApproxIntersection(waypoints, localPosition);\n\n  return intersection;\n}\n\nexport function addBendpoint(parentGfx, cls) {\n  var groupGfx = svgCreate('g');\n  svgClasses(groupGfx).add(BENDPOINT_CLS);\n\n  svgAppend(parentGfx, groupGfx);\n\n  var visual = svgCreate('circle');\n  svgAttr(visual, {\n    cx: 0,\n    cy: 0,\n    r: 4\n  });\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(groupGfx, visual);\n\n  var hit = svgCreate('circle');\n  svgAttr(hit, {\n    cx: 0,\n    cy: 0,\n    r: 10\n  });\n  svgClasses(hit).add('djs-hit');\n\n  svgAppend(groupGfx, hit);\n\n  if (cls) {\n    svgClasses(groupGfx).add(cls);\n  }\n\n  return groupGfx;\n}\n\nfunction createParallelDragger(parentGfx, segmentStart, segmentEnd, alignment) {\n  var draggerGfx = svgCreate('g');\n\n  svgAppend(parentGfx, draggerGfx);\n\n  var width = 14,\n      height = 3,\n      padding = 6,\n      hitWidth = calculateHitWidth(segmentStart, segmentEnd, alignment, padding),\n      hitHeight = height + padding;\n\n  var visual = svgCreate('rect');\n  svgAttr(visual, {\n    x: -width / 2,\n    y: -height / 2,\n    width: width,\n    height: height\n  });\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(draggerGfx, visual);\n\n  var hit = svgCreate('rect');\n  svgAttr(hit, {\n    x: -hitWidth / 2,\n    y: -hitHeight / 2,\n    width: hitWidth,\n    height: hitHeight\n  });\n  svgClasses(hit).add('djs-hit');\n\n  svgAppend(draggerGfx, hit);\n\n  rotate(draggerGfx, alignment === 'v' ? 90 : 0, 0, 0);\n\n  return draggerGfx;\n}\n\n\nexport function addSegmentDragger(parentGfx, segmentStart, segmentEnd) {\n\n  var groupGfx = svgCreate('g'),\n      mid = getMidPoint(segmentStart, segmentEnd),\n      alignment = pointsAligned(segmentStart, segmentEnd);\n\n  svgAppend(parentGfx, groupGfx);\n\n  createParallelDragger(groupGfx, segmentStart, segmentEnd, alignment);\n\n  svgClasses(groupGfx).add(SEGMENT_DRAGGER_CLS);\n  svgClasses(groupGfx).add(alignment === 'h' ? 'horizontal' : 'vertical');\n\n  translate(groupGfx, mid.x, mid.y);\n\n  return groupGfx;\n}\n\n/**\n * Calculates region for segment move which is 2/3 of the full segment length\n * @param {Number} segmentLength\n *\n * @return {Number}\n */\nexport function calculateSegmentMoveRegion(segmentLength) {\n  return Math.abs(Math.round(segmentLength * 2 / 3));\n}\n\n// helper //////////\n\nfunction calculateHitWidth(segmentStart, segmentEnd, alignment) {\n  var segmentLengthXAxis = segmentEnd.x - segmentStart.x,\n      segmentLengthYAxis = segmentEnd.y - segmentStart.y;\n\n  return alignment === 'h' ?\n    calculateSegmentMoveRegion(segmentLengthXAxis) :\n    calculateSegmentMoveRegion(segmentLengthYAxis);\n}\n","import { forEach } from 'min-dash';\n\nimport {\n  event as domEvent,\n  query as domQuery,\n  queryAll as domQueryAll\n} from 'min-dom';\n\nimport {\n  BENDPOINT_CLS,\n  SEGMENT_DRAGGER_CLS,\n  addBendpoint,\n  addSegmentDragger,\n  calculateSegmentMoveRegion,\n  getConnectionIntersection\n} from './BendpointUtil';\n\nimport {\n  escapeCSS\n} from '../../util/EscapeUtil';\n\nimport {\n  getVisual\n} from '../../util/GraphicsUtil';\n\nimport {\n  pointsAligned,\n  getMidPoint\n} from '../../util/Geometry';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\n\n/**\n * A service that adds editable bendpoints to connections.\n */\nexport default function Bendpoints(\n    eventBus, canvas, interactionEvents,\n    bendpointMove, connectionSegmentMove) {\n\n  /**\n   * Returns true if intersection point is inside middle region of segment, adjusted by\n   * optional threshold\n   */\n  function isIntersectionMiddle(intersection, waypoints, treshold) {\n    var idx = intersection.index,\n        p = intersection.point,\n        p0, p1, mid, aligned, xDelta, yDelta;\n\n    if (idx <= 0 || intersection.bendpoint) {\n      return false;\n    }\n\n    p0 = waypoints[idx - 1];\n    p1 = waypoints[idx];\n    mid = getMidPoint(p0, p1),\n    aligned = pointsAligned(p0, p1);\n    xDelta = Math.abs(p.x - mid.x);\n    yDelta = Math.abs(p.y - mid.y);\n\n    return aligned && xDelta <= treshold && yDelta <= treshold;\n  }\n\n  /**\n   * Calculates the threshold from a connection's middle which fits the two-third-region\n   */\n  function calculateIntersectionThreshold(connection, intersection) {\n    var waypoints = connection.waypoints,\n        relevantSegment, alignment, segmentLength, threshold;\n\n    if (intersection.index <= 0 || intersection.bendpoint) {\n      return null;\n    }\n\n    // segment relative to connection intersection\n    relevantSegment = {\n      start: waypoints[intersection.index - 1],\n      end: waypoints[intersection.index]\n    };\n\n    alignment = pointsAligned(relevantSegment.start, relevantSegment.end);\n\n    if (!alignment) {\n      return null;\n    }\n\n    if (alignment === 'h') {\n      segmentLength = relevantSegment.end.x - relevantSegment.start.x;\n    } else {\n      segmentLength = relevantSegment.end.y - relevantSegment.start.y;\n    }\n\n    // calculate threshold relative to 2/3 of segment length\n    threshold = calculateSegmentMoveRegion(segmentLength) / 2;\n\n    return threshold;\n  }\n\n  function activateBendpointMove(event, connection) {\n    var waypoints = connection.waypoints,\n        intersection = getConnectionIntersection(canvas, waypoints, event),\n        threshold;\n\n    if (!intersection) {\n      return;\n    }\n\n    threshold = calculateIntersectionThreshold(connection, intersection);\n\n    if (isIntersectionMiddle(intersection, waypoints, threshold)) {\n      connectionSegmentMove.start(event, connection, intersection.index);\n    } else {\n      bendpointMove.start(event, connection, intersection.index, !intersection.bendpoint);\n    }\n\n    // we've handled the event\n    return true;\n  }\n\n  function bindInteractionEvents(node, eventName, element) {\n\n    domEvent.bind(node, eventName, function(event) {\n      interactionEvents.triggerMouseEvent(eventName, event, element);\n      event.stopPropagation();\n    });\n  }\n\n  function getBendpointsContainer(element, create) {\n\n    var layer = canvas.getLayer('overlays'),\n        gfx = domQuery('.djs-bendpoints[data-element-id=\"' + escapeCSS(element.id) + '\"]', layer);\n\n    if (!gfx && create) {\n      gfx = svgCreate('g');\n      svgAttr(gfx, { 'data-element-id': element.id });\n      svgClasses(gfx).add('djs-bendpoints');\n\n      svgAppend(layer, gfx);\n\n      bindInteractionEvents(gfx, 'mousedown', element);\n      bindInteractionEvents(gfx, 'click', element);\n      bindInteractionEvents(gfx, 'dblclick', element);\n    }\n\n    return gfx;\n  }\n\n  function getSegmentDragger(idx, parentGfx) {\n    return domQuery(\n      '.djs-segment-dragger[data-segment-idx=\"' + idx + '\"]',\n      parentGfx\n    );\n  }\n\n  function createBendpoints(gfx, connection) {\n    connection.waypoints.forEach(function(p, idx) {\n      var bendpoint = addBendpoint(gfx);\n\n      svgAppend(gfx, bendpoint);\n\n      translate(bendpoint, p.x, p.y);\n    });\n\n    // add floating bendpoint\n    addBendpoint(gfx, 'floating');\n  }\n\n  function createSegmentDraggers(gfx, connection) {\n\n    var waypoints = connection.waypoints;\n\n    var segmentStart,\n        segmentEnd,\n        segmentDraggerGfx;\n\n    for (var i = 1; i < waypoints.length; i++) {\n\n      segmentStart = waypoints[i - 1];\n      segmentEnd = waypoints[i];\n\n      if (pointsAligned(segmentStart, segmentEnd)) {\n        segmentDraggerGfx = addSegmentDragger(gfx, segmentStart, segmentEnd);\n\n        svgAttr(segmentDraggerGfx, { 'data-segment-idx': i });\n\n        bindInteractionEvents(segmentDraggerGfx, 'mousemove', connection);\n      }\n    }\n  }\n\n  function clearBendpoints(gfx) {\n    forEach(domQueryAll('.' + BENDPOINT_CLS, gfx), function(node) {\n      svgRemove(node);\n    });\n  }\n\n  function clearSegmentDraggers(gfx) {\n    forEach(domQueryAll('.' + SEGMENT_DRAGGER_CLS, gfx), function(node) {\n      svgRemove(node);\n    });\n  }\n\n  function addHandles(connection) {\n\n    var gfx = getBendpointsContainer(connection);\n\n    if (!gfx) {\n      gfx = getBendpointsContainer(connection, true);\n\n      createBendpoints(gfx, connection);\n      createSegmentDraggers(gfx, connection);\n    }\n\n    return gfx;\n  }\n\n  function updateHandles(connection) {\n\n    var gfx = getBendpointsContainer(connection);\n\n    if (gfx) {\n      clearSegmentDraggers(gfx);\n      clearBendpoints(gfx);\n      createSegmentDraggers(gfx, connection);\n      createBendpoints(gfx, connection);\n    }\n  }\n\n  function updateFloatingBendpointPosition(parentGfx, intersection) {\n    var floating = domQuery('.floating', parentGfx),\n        point = intersection.point;\n\n    if (!floating) {\n      return;\n    }\n\n    translate(floating, point.x, point.y);\n\n  }\n\n  function updateSegmentDraggerPosition(parentGfx, intersection, waypoints) {\n\n    var draggerGfx = getSegmentDragger(intersection.index, parentGfx),\n        segmentStart = waypoints[intersection.index - 1],\n        segmentEnd = waypoints[intersection.index],\n        point = intersection.point,\n        mid = getMidPoint(segmentStart, segmentEnd),\n        alignment = pointsAligned(segmentStart, segmentEnd),\n        draggerVisual, relativePosition;\n\n    if (!draggerGfx) {\n      return;\n    }\n\n    draggerVisual = getVisual(draggerGfx);\n\n    relativePosition = {\n      x: point.x - mid.x,\n      y: point.y - mid.y\n    };\n\n    if (alignment === 'v') {\n\n      // rotate position\n      relativePosition = {\n        x: relativePosition.y,\n        y: relativePosition.x\n      };\n    }\n\n    translate(draggerVisual, relativePosition.x, relativePosition.y);\n  }\n\n  eventBus.on('connection.changed', function(event) {\n    updateHandles(event.element);\n  });\n\n  eventBus.on('connection.remove', function(event) {\n    var gfx = getBendpointsContainer(event.element);\n\n    if (gfx) {\n      svgRemove(gfx);\n    }\n  });\n\n  eventBus.on('element.marker.update', function(event) {\n\n    var element = event.element,\n        bendpointsGfx;\n\n    if (!element.waypoints) {\n      return;\n    }\n\n    bendpointsGfx = addHandles(element);\n\n    if (event.add) {\n      svgClasses(bendpointsGfx).add(event.marker);\n    } else {\n      svgClasses(bendpointsGfx).remove(event.marker);\n    }\n  });\n\n  eventBus.on('element.mousemove', function(event) {\n\n    var element = event.element,\n        waypoints = element.waypoints,\n        bendpointsGfx,\n        intersection;\n\n    if (waypoints) {\n      bendpointsGfx = getBendpointsContainer(element, true);\n\n      intersection = getConnectionIntersection(canvas, waypoints, event.originalEvent);\n\n      if (!intersection) {\n        return;\n      }\n\n      updateFloatingBendpointPosition(bendpointsGfx, intersection);\n\n      if (!intersection.bendpoint) {\n        updateSegmentDraggerPosition(bendpointsGfx, intersection, waypoints);\n      }\n\n    }\n  });\n\n  eventBus.on('element.mousedown', function(event) {\n\n    var originalEvent = event.originalEvent,\n        element = event.element,\n        waypoints = element.waypoints;\n\n    if (!waypoints) {\n      return;\n    }\n\n    return activateBendpointMove(originalEvent, element, waypoints);\n  });\n\n  eventBus.on('selection.changed', function(event) {\n    var newSelection = event.newSelection,\n        primary = newSelection[0];\n\n    if (primary && primary.waypoints) {\n      addHandles(primary);\n    }\n  });\n\n  eventBus.on('element.hover', function(event) {\n    var element = event.element;\n\n    if (element.waypoints) {\n      addHandles(element);\n      interactionEvents.registerEvent(event.gfx, 'mousemove', 'element.mousemove');\n    }\n  });\n\n  eventBus.on('element.out', function(event) {\n    interactionEvents.unregisterEvent(event.gfx, 'mousemove', 'element.mousemove');\n  });\n\n  // update bendpoint container data attribute on element ID change\n  eventBus.on('element.updateId', function(context) {\n    var element = context.element,\n        newId = context.newId;\n\n    if (element.waypoints) {\n      var bendpointContainer = getBendpointsContainer(element);\n\n      if (bendpointContainer) {\n        svgAttr(bendpointContainer, { 'data-element-id': newId });\n      }\n    }\n  });\n\n  // API\n\n  this.addHandles = addHandles;\n  this.updateHandles = updateHandles;\n  this.getBendpointsContainer = getBendpointsContainer;\n  this.getSegmentDragger = getSegmentDragger;\n}\n\nBendpoints.$inject = [\n  'eventBus',\n  'canvas',\n  'interactionEvents',\n  'bendpointMove',\n  'connectionSegmentMove'\n];\n","import {\n  filterRedundantWaypoints\n} from '../../layout/LayoutUtil';\n\nvar COMMAND_BENDPOINT_UPDATE = 'connection.updateWaypoints',\n    COMMAND_RECONNECT_START = 'connection.reconnectStart',\n    COMMAND_RECONNECT_END = 'connection.reconnectEnd';\n\nvar round = Math.round;\n\n\n/**\n * A component that implements moving of bendpoints\n */\nexport default function BendpointMove(injector, eventBus, canvas, dragging, rules, modeling) {\n\n  // optional connection docking integration\n  var connectionDocking = injector.get('connectionDocking', false);\n\n\n  // API\n  this.start = function(event, connection, bendpointIndex, insert) {\n\n    var type,\n        context,\n        waypoints = connection.waypoints,\n        gfx = canvas.getGraphics(connection);\n\n    if (!insert && bendpointIndex === 0) {\n      type = COMMAND_RECONNECT_START;\n    } else\n    if (!insert && bendpointIndex === waypoints.length - 1) {\n      type = COMMAND_RECONNECT_END;\n    } else {\n      type = COMMAND_BENDPOINT_UPDATE;\n    }\n\n    context = {\n      connection: connection,\n      bendpointIndex: bendpointIndex,\n      insert: insert,\n      type: type\n    };\n\n    var allowed = context.allowed = rules.allowed(context.type, context);\n\n    if (allowed === false) {\n      return;\n    }\n\n    dragging.init(event, 'bendpoint.move', {\n      data: {\n        connection: connection,\n        connectionGfx: gfx,\n        context: context\n      }\n    });\n  };\n\n  eventBus.on('bendpoint.move.hover', function(e) {\n    var context = e.context;\n\n    context.hover = e.hover;\n\n    if (e.hover) {\n      // asks whether reconnect / bendpoint move / bendpoint add\n      // is allowed at the given position\n      var allowed = context.allowed = rules.allowed(context.type, context);\n\n      if (allowed) {\n        context.target = context.hover;\n      }\n    }\n  });\n\n  eventBus.on([ 'bendpoint.move.out', 'bendpoint.move.cleanup' ], function(event) {\n    var context = event.context;\n\n    context.target = null;\n    context.allowed = false;\n  });\n\n  eventBus.on('bendpoint.move.end', function(e) {\n\n    var context = e.context,\n        connection = context.connection,\n        originalWaypoints = connection.waypoints,\n        newWaypoints = originalWaypoints.slice(),\n        bendpointIndex = context.bendpointIndex,\n        allowed = context.allowed,\n        insert = context.insert,\n        bendpoint,\n        hints;\n\n    // ensure we have actual pixel values bendpoint\n    // coordinates (important when zoom level was > 1 during move)\n    bendpoint = {\n      x: round(e.x),\n      y: round(e.y)\n    };\n\n    if (allowed && context.type === COMMAND_RECONNECT_START) {\n      modeling.reconnectStart(context.connection, context.target, bendpoint);\n    } else if (allowed && context.type === COMMAND_RECONNECT_END) {\n      modeling.reconnectEnd(context.connection, context.target, bendpoint);\n    } else if (allowed !== false && context.type === COMMAND_BENDPOINT_UPDATE) {\n      if (insert) {\n        // insert new bendpoint\n        newWaypoints.splice(bendpointIndex, 0, bendpoint);\n      } else {\n        // swap previous waypoint with the moved one\n        newWaypoints[bendpointIndex] = bendpoint;\n      }\n\n      // pass hints on the actual moved bendpoint\n      // this is useful for connection and label layouting\n      hints = {\n        bendpointMove: {\n          insert: insert,\n          bendpointIndex: bendpointIndex\n        }\n      };\n\n      if (connectionDocking) {\n        // (0) temporarily assign new waypoints\n        connection.waypoints = newWaypoints;\n\n        // (1) crop connection with new waypoints and save them\n        connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n        newWaypoints = connection.waypoints;\n\n        // (2) restore original waypoints to not mutate connection directly\n        connection.waypoints = originalWaypoints;\n      }\n\n      modeling.updateWaypoints(context.connection, filterRedundantWaypoints(newWaypoints), hints);\n    } else {\n      return false;\n    }\n  });\n}\n\nBendpointMove.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'dragging',\n  'rules',\n  'modeling'\n];","import {\n  classes as svgClasses,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  addBendpoint\n} from './BendpointUtil';\n\nimport {\n  filterRedundantWaypoints\n} from '../../layout/LayoutUtil';\n\nimport { translate } from '../../util/SvgTransformUtil';\n\n\nvar MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok',\n    MARKER_CONNECT_HOVER = 'connect-hover',\n    MARKER_CONNECT_UPDATING = 'djs-updating',\n    MARKER_ELEMENT_HIDDEN = 'djs-element-hidden';\n\nvar COMMAND_RECONNECT_START = 'connection.reconnectStart',\n    COMMAND_RECONNECT_END = 'connection.reconnectEnd';\n\nvar HIGH_PRIORITY = 1100;\n\n/**\n * A component that implements moving of bendpoints\n */\nexport default function BendpointMovePreview(injector, eventBus, canvas) {\n\n  var connectionPreview = injector.get('connectionPreview', false),\n      connectionDocking = injector.get('connectionDocking', false);\n\n  // DRAGGING IMPLEMENTATION\n\n  eventBus.on('bendpoint.move.start', function(e) {\n\n    var context = e.context,\n        connection = context.connection,\n        originalWaypoints = connection.waypoints,\n        waypoints = originalWaypoints.slice(),\n        insert = context.insert,\n        idx = context.bendpointIndex;\n\n    // save waypoints to restore at the end\n    context.originalWaypoints = originalWaypoints;\n\n    if (insert) {\n      // insert placeholder for bendpoint to-be-added\n      waypoints.splice(idx, 0, { x: e.x, y: e.y });\n    }\n\n    connection.waypoints = waypoints;\n\n    // add dragger gfx\n    context.draggerGfx = addBendpoint(canvas.getLayer('overlays'));\n    svgClasses(context.draggerGfx).add('djs-dragging');\n\n    canvas.addMarker(connection, MARKER_CONNECT_UPDATING);\n    canvas.addMarker(connection, MARKER_ELEMENT_HIDDEN);\n  });\n\n  eventBus.on('bendpoint.move.hover', function(e) {\n    var context = e.context,\n        allowed = context.allowed,\n        hover = context.hover,\n        moveType = context.type;\n\n    if (e.hover) {\n      canvas.addMarker(hover, MARKER_CONNECT_HOVER);\n\n      if (\n        moveType !== COMMAND_RECONNECT_START &&\n        moveType !== COMMAND_RECONNECT_END\n      ) {\n        return;\n      }\n\n      if (allowed) {\n        canvas.removeMarker(hover, MARKER_NOT_OK);\n        canvas.addMarker(hover, MARKER_OK);\n      } else if (allowed === false) {\n        canvas.removeMarker(hover, MARKER_OK);\n        canvas.addMarker(hover, MARKER_NOT_OK);\n      }\n    }\n  });\n\n  eventBus.on([\n    'bendpoint.move.out',\n    'bendpoint.move.cleanup'\n  ], HIGH_PRIORITY, function(e) {\n\n    // remove connect marker\n    // if it was added\n    var hover = e.context.hover;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_CONNECT_HOVER);\n      canvas.removeMarker(hover, e.context.target ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n  eventBus.on('bendpoint.move.move', function(e) {\n\n    var context = e.context,\n        moveType = context.type,\n        connection = e.connection,\n        originalWaypoints = connection.waypoints,\n        waypoints = originalWaypoints.slice(),\n        bendpoint = { x: e.x, y: e.y },\n        hints;\n\n    if (connectionPreview) {\n      hints = {\n        source: connection.source,\n        target: connection.target\n      };\n\n      if (moveType === COMMAND_RECONNECT_START) {\n        hints.source = context.target;\n        hints.connectionStart = bendpoint;\n      } else if (moveType === COMMAND_RECONNECT_END) {\n        hints.target = context.target;\n        hints.connectionEnd = bendpoint;\n      } else {\n        hints.noCropping = true;\n        hints.noLayout = true;\n        waypoints[context.bendpointIndex] = bendpoint;\n      }\n\n      if (connectionDocking) {\n        // (0) temporarily assign new waypoints\n        connection.waypoints = waypoints;\n\n        // (1) crop connection with new waypoints and save them\n        connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n        waypoints = connection.waypoints;\n\n        // (2) restore original waypoints to not mutate connection directly\n        connection.waypoints = originalWaypoints;\n      }\n\n      // remove overlapping points\n      hints.waypoints = filterRedundantWaypoints(waypoints);\n\n      connectionPreview.drawPreview(context, context.allowed, hints);\n    }\n\n    // add dragger gfx\n    translate(context.draggerGfx, e.x, e.y);\n  });\n\n  eventBus.on([\n    'bendpoint.move.end',\n    'bendpoint.move.cancel'\n  ], HIGH_PRIORITY, function(e) {\n\n    var context = e.context,\n        hover = context.hover,\n        connection = context.connection;\n\n    // reassign original waypoints\n    connection.waypoints = context.originalWaypoints;\n\n    // remove dragger gfx\n    svgRemove(context.draggerGfx);\n\n    canvas.removeMarker(connection, MARKER_CONNECT_UPDATING);\n    canvas.removeMarker(connection, MARKER_ELEMENT_HIDDEN);\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_OK);\n      canvas.removeMarker(hover, context.target ? MARKER_OK : MARKER_NOT_OK);\n    }\n\n    if (connectionPreview) {\n      connectionPreview.cleanUp(context);\n    }\n  });\n}\n\nBendpointMovePreview.$inject = [\n  'injector',\n  'eventBus',\n  'canvas'\n];\n","import {\n  pointsAligned,\n  pointsOnLine\n} from '../../util/Geometry';\n\nimport {\n  addSegmentDragger,\n  getConnectionIntersection\n} from './BendpointUtil';\n\nimport {\n  getMid,\n  getOrientation\n} from '../../layout/LayoutUtil';\n\nvar MARKER_CONNECT_HOVER = 'connect-hover',\n    MARKER_CONNECT_UPDATING = 'djs-updating';\n\nimport {\n  classes as svgClasses,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\n\nfunction axisAdd(point, axis, delta) {\n  return axisSet(point, axis, point[axis] + delta);\n}\n\nfunction axisSet(point, axis, value) {\n  return {\n    x: (axis === 'x' ? value : point.x),\n    y: (axis === 'y' ? value : point.y)\n  };\n}\n\nfunction axisFenced(position, segmentStart, segmentEnd, axis) {\n\n  var maxValue = Math.max(segmentStart[axis], segmentEnd[axis]),\n      minValue = Math.min(segmentStart[axis], segmentEnd[axis]);\n\n  var padding = 20;\n\n  var fencedValue = Math.min(Math.max(minValue + padding, position[axis]), maxValue - padding);\n\n  return axisSet(segmentStart, axis, fencedValue);\n}\n\nfunction flipAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\n\n/**\n * Get the docking point on the given element.\n *\n * Compute a reasonable docking, if non exists.\n *\n * @param  {Point} point\n * @param  {djs.model.Shape} referenceElement\n * @param  {String} moveAxis (x|y)\n *\n * @return {Point}\n */\nfunction getDocking(point, referenceElement, moveAxis) {\n\n  var referenceMid,\n      inverseAxis;\n\n  if (point.original) {\n    return point.original;\n  } else {\n    referenceMid = getMid(referenceElement);\n    inverseAxis = flipAxis(moveAxis);\n\n    return axisSet(point, inverseAxis, referenceMid[inverseAxis]);\n  }\n}\n\n/**\n * A component that implements moving of bendpoints\n */\nexport default function ConnectionSegmentMove(\n    injector, eventBus, canvas,\n    dragging, graphicsFactory, modeling) {\n\n  // optional connection docking integration\n  var connectionDocking = injector.get('connectionDocking', false);\n\n\n  // API\n\n  this.start = function(event, connection, idx) {\n\n    var context,\n        gfx = canvas.getGraphics(connection),\n        segmentStartIndex = idx - 1,\n        segmentEndIndex = idx,\n        waypoints = connection.waypoints,\n        segmentStart = waypoints[segmentStartIndex],\n        segmentEnd = waypoints[segmentEndIndex],\n        intersection = getConnectionIntersection(canvas, waypoints, event),\n        direction, axis, dragPosition;\n\n    direction = pointsAligned(segmentStart, segmentEnd);\n\n    // do not move diagonal connection\n    if (!direction) {\n      return;\n    }\n\n    // the axis where we are going to move things\n    axis = direction === 'v' ? 'x' : 'y';\n\n    if (segmentStartIndex === 0) {\n      segmentStart = getDocking(segmentStart, connection.source, axis);\n    }\n\n    if (segmentEndIndex === waypoints.length - 1) {\n      segmentEnd = getDocking(segmentEnd, connection.target, axis);\n    }\n\n    if (intersection) {\n      dragPosition = intersection.point;\n    } else {\n      // set to segment center as default\n      dragPosition = {\n        x: (segmentStart.x + segmentEnd.x) / 2,\n        y: (segmentStart.y + segmentEnd.y) / 2\n      };\n    }\n\n    context = {\n      connection: connection,\n      segmentStartIndex: segmentStartIndex,\n      segmentEndIndex: segmentEndIndex,\n      segmentStart: segmentStart,\n      segmentEnd: segmentEnd,\n      axis: axis,\n      dragPosition: dragPosition\n    };\n\n    dragging.init(event, dragPosition, 'connectionSegment.move', {\n      cursor: axis === 'x' ? 'resize-ew' : 'resize-ns',\n      data: {\n        connection: connection,\n        connectionGfx: gfx,\n        context: context\n      }\n    });\n  };\n\n  /**\n   * Crop connection if connection cropping is provided.\n   *\n   * @param {Connection} connection\n   * @param {Array<Point>} newWaypoints\n   *\n   * @return {Array<Point>} cropped connection waypoints\n   */\n  function cropConnection(connection, newWaypoints) {\n\n    // crop connection, if docking service is provided only\n    if (!connectionDocking) {\n      return newWaypoints;\n    }\n\n    var oldWaypoints = connection.waypoints,\n        croppedWaypoints;\n\n    // temporary set new waypoints\n    connection.waypoints = newWaypoints;\n\n    croppedWaypoints = connectionDocking.getCroppedWaypoints(connection);\n\n    // restore old waypoints\n    connection.waypoints = oldWaypoints;\n\n    return croppedWaypoints;\n  }\n\n  // DRAGGING IMPLEMENTATION\n\n  function redrawConnection(data) {\n    graphicsFactory.update('connection', data.connection, data.connectionGfx);\n  }\n\n  function updateDragger(context, segmentOffset, event) {\n\n    var newWaypoints = context.newWaypoints,\n        segmentStartIndex = context.segmentStartIndex + segmentOffset,\n        segmentStart = newWaypoints[segmentStartIndex],\n        segmentEndIndex = context.segmentEndIndex + segmentOffset,\n        segmentEnd = newWaypoints[segmentEndIndex],\n        axis = flipAxis(context.axis);\n\n    // make sure the dragger does not move\n    // outside the connection\n    var draggerPosition = axisFenced(event, segmentStart, segmentEnd, axis);\n\n    // update dragger\n    translate(context.draggerGfx, draggerPosition.x, draggerPosition.y);\n  }\n\n  /**\n   * Filter waypoints for redundant ones (i.e. on the same axis).\n   * Returns the filtered waypoints and the offset related to the segment move.\n   *\n   * @param {Array<Point>} waypoints\n   * @param {Integer} segmentStartIndex of moved segment start\n   *\n   * @return {Object} { filteredWaypoints, segmentOffset }\n   */\n  function filterRedundantWaypoints(waypoints, segmentStartIndex) {\n\n    var segmentOffset = 0;\n\n    var filteredWaypoints = waypoints.filter(function(r, idx) {\n      if (pointsOnLine(waypoints[idx - 1], waypoints[idx + 1], r)) {\n\n        // remove point and increment offset\n        segmentOffset = idx <= segmentStartIndex ? segmentOffset - 1 : segmentOffset;\n        return false;\n      }\n\n      // dont remove point\n      return true;\n    });\n\n    return {\n      waypoints: filteredWaypoints,\n      segmentOffset: segmentOffset\n    };\n  }\n\n  eventBus.on('connectionSegment.move.start', function(e) {\n\n    var context = e.context,\n        connection = e.connection,\n        layer = canvas.getLayer('overlays');\n\n    context.originalWaypoints = connection.waypoints.slice();\n\n    // add dragger gfx\n    context.draggerGfx = addSegmentDragger(layer, context.segmentStart, context.segmentEnd);\n    svgClasses(context.draggerGfx).add('djs-dragging');\n\n    canvas.addMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on('connectionSegment.move.move', function(e) {\n\n    var context = e.context,\n        connection = context.connection,\n        segmentStartIndex = context.segmentStartIndex,\n        segmentEndIndex = context.segmentEndIndex,\n        segmentStart = context.segmentStart,\n        segmentEnd = context.segmentEnd,\n        axis = context.axis;\n\n    var newWaypoints = context.originalWaypoints.slice(),\n        newSegmentStart = axisAdd(segmentStart, axis, e['d' + axis]),\n        newSegmentEnd = axisAdd(segmentEnd, axis, e['d' + axis]);\n\n    // original waypoint count and added / removed\n    // from start waypoint delta. We use the later\n    // to retrieve the updated segmentStartIndex / segmentEndIndex\n    var waypointCount = newWaypoints.length,\n        segmentOffset = 0;\n\n    // move segment start / end by axis delta\n    newWaypoints[segmentStartIndex] = newSegmentStart;\n    newWaypoints[segmentEndIndex] = newSegmentEnd;\n\n    var sourceToSegmentOrientation,\n        targetToSegmentOrientation;\n\n    // handle first segment\n    if (segmentStartIndex < 2) {\n      sourceToSegmentOrientation = getOrientation(connection.source, newSegmentStart);\n\n      // first bendpoint, remove first segment if intersecting\n      if (segmentStartIndex === 1) {\n\n        if (sourceToSegmentOrientation === 'intersect') {\n          newWaypoints.shift();\n          newWaypoints[0] = newSegmentStart;\n          segmentOffset--;\n        }\n      }\n\n      // docking point, add segment if not intersecting anymore\n      else {\n        if (sourceToSegmentOrientation !== 'intersect') {\n          newWaypoints.unshift(segmentStart);\n          segmentOffset++;\n        }\n      }\n    }\n\n    // handle last segment\n    if (segmentEndIndex > waypointCount - 3) {\n      targetToSegmentOrientation = getOrientation(connection.target, newSegmentEnd);\n\n      // last bendpoint, remove last segment if intersecting\n      if (segmentEndIndex === waypointCount - 2) {\n\n        if (targetToSegmentOrientation === 'intersect') {\n          newWaypoints.pop();\n          newWaypoints[newWaypoints.length - 1] = newSegmentEnd;\n        }\n      }\n\n      // last bendpoint, remove last segment if intersecting\n      else {\n        if (targetToSegmentOrientation !== 'intersect') {\n          newWaypoints.push(segmentEnd);\n        }\n      }\n    }\n\n    // update connection waypoints\n    context.newWaypoints = connection.waypoints = cropConnection(connection, newWaypoints);\n\n    // update dragger position\n    updateDragger(context, segmentOffset, e);\n\n    // save segmentOffset in context\n    context.newSegmentStartIndex = segmentStartIndex + segmentOffset;\n\n    // redraw connection\n    redrawConnection(e);\n  });\n\n  eventBus.on('connectionSegment.move.hover', function(e) {\n\n    e.context.hover = e.hover;\n    canvas.addMarker(e.hover, MARKER_CONNECT_HOVER);\n  });\n\n  eventBus.on([\n    'connectionSegment.move.out',\n    'connectionSegment.move.cleanup'\n  ], function(e) {\n\n    // remove connect marker\n    // if it was added\n    var hover = e.context.hover;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_CONNECT_HOVER);\n    }\n  });\n\n  eventBus.on('connectionSegment.move.cleanup', function(e) {\n\n    var context = e.context,\n        connection = context.connection;\n\n    // remove dragger gfx\n    if (context.draggerGfx) {\n      svgRemove(context.draggerGfx);\n    }\n\n    canvas.removeMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on([\n    'connectionSegment.move.cancel',\n    'connectionSegment.move.end'\n  ], function(e) {\n    var context = e.context,\n        connection = context.connection;\n\n    connection.waypoints = context.originalWaypoints;\n\n    redrawConnection(e);\n  });\n\n  eventBus.on('connectionSegment.move.end', function(e) {\n\n    var context = e.context,\n        connection = context.connection,\n        newWaypoints = context.newWaypoints,\n        newSegmentStartIndex = context.newSegmentStartIndex;\n\n    // ensure we have actual pixel values bendpoint\n    // coordinates (important when zoom level was > 1 during move)\n    newWaypoints = newWaypoints.map(function(p) {\n      return {\n        original: p.original,\n        x: Math.round(p.x),\n        y: Math.round(p.y)\n      };\n    });\n\n    // apply filter redunant waypoints\n    var filtered = filterRedundantWaypoints(newWaypoints, newSegmentStartIndex);\n\n    // get filtered waypoints\n    var filteredWaypoints = filtered.waypoints,\n        croppedWaypoints = cropConnection(connection, filteredWaypoints),\n        segmentOffset = filtered.segmentOffset;\n\n    var hints = {\n      segmentMove: {\n        segmentStartIndex: context.segmentStartIndex,\n        newSegmentStartIndex: newSegmentStartIndex + segmentOffset\n      }\n    };\n\n    modeling.updateWaypoints(connection, croppedWaypoints, hints);\n  });\n}\n\nConnectionSegmentMove.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'dragging',\n  'graphicsFactory',\n  'modeling'\n];\n","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport { setSnapped } from '../snapping/SnapUtil';\n\nvar abs= Math.abs,\n    round = Math.round;\n\nvar TOLERANCE = 10;\n\n\nexport default function BendpointSnapping(eventBus) {\n\n  function snapTo(values, value) {\n\n    if (isArray(values)) {\n      var i = values.length;\n\n      while (i--) if (abs(values[i] - value) <= TOLERANCE) {\n        return values[i];\n      }\n    } else {\n      values = +values;\n      var rem = value % values;\n\n      if (rem < TOLERANCE) {\n        return value - rem;\n      }\n\n      if (rem > values - TOLERANCE) {\n        return value - rem + values;\n      }\n    }\n\n    return value;\n  }\n\n  function mid(element) {\n    if (element.width) {\n      return {\n        x: round(element.width / 2 + element.x),\n        y: round(element.height / 2 + element.y)\n      };\n    }\n  }\n\n  // connection segment snapping //////////////////////\n\n  function getConnectionSegmentSnaps(context) {\n\n    var snapPoints = context.snapPoints,\n        connection = context.connection,\n        waypoints = connection.waypoints,\n        segmentStart = context.segmentStart,\n        segmentStartIndex = context.segmentStartIndex,\n        segmentEnd = context.segmentEnd,\n        segmentEndIndex = context.segmentEndIndex,\n        axis = context.axis;\n\n    if (snapPoints) {\n      return snapPoints;\n    }\n\n    var referenceWaypoints = [\n      waypoints[segmentStartIndex - 1],\n      segmentStart,\n      segmentEnd,\n      waypoints[segmentEndIndex + 1]\n    ];\n\n    if (segmentStartIndex < 2) {\n      referenceWaypoints.unshift(mid(connection.source));\n    }\n\n    if (segmentEndIndex > waypoints.length - 3) {\n      referenceWaypoints.unshift(mid(connection.target));\n    }\n\n    context.snapPoints = snapPoints = { horizontal: [] , vertical: [] };\n\n    forEach(referenceWaypoints, function(p) {\n      // we snap on existing bendpoints only,\n      // not placeholders that are inserted during add\n      if (p) {\n        p = p.original || p;\n\n        if (axis === 'y') {\n          snapPoints.horizontal.push(p.y);\n        }\n\n        if (axis === 'x') {\n          snapPoints.vertical.push(p.x);\n        }\n      }\n    });\n\n    return snapPoints;\n  }\n\n  eventBus.on('connectionSegment.move.move', 1500, function(event) {\n    var context = event.context,\n        snapPoints = getConnectionSegmentSnaps(context),\n        x = event.x,\n        y = event.y,\n        sx, sy;\n\n    if (!snapPoints) {\n      return;\n    }\n\n    // snap\n    sx = snapTo(snapPoints.vertical, x);\n    sy = snapTo(snapPoints.horizontal, y);\n\n\n    // correction x/y\n    var cx = (x - sx),\n        cy = (y - sy);\n\n    // update delta\n    assign(event, {\n      dx: event.dx - cx,\n      dy: event.dy - cy,\n      x: sx,\n      y: sy\n    });\n\n    // only set snapped if actually snapped\n    if (cx || snapPoints.vertical.indexOf(x) !== -1) {\n      setSnapped(event, 'x', sx);\n    }\n\n    if (cy || snapPoints.horizontal.indexOf(y) !== -1) {\n      setSnapped(event, 'y', sy);\n    }\n  });\n\n\n  // bendpoint snapping //////////////////////\n\n  function getBendpointSnaps(context) {\n\n    var snapPoints = context.snapPoints,\n        waypoints = context.connection.waypoints,\n        bendpointIndex = context.bendpointIndex;\n\n    if (snapPoints) {\n      return snapPoints;\n    }\n\n    var referenceWaypoints = [ waypoints[bendpointIndex - 1], waypoints[bendpointIndex + 1] ];\n\n    context.snapPoints = snapPoints = { horizontal: [] , vertical: [] };\n\n    forEach(referenceWaypoints, function(p) {\n      // we snap on existing bendpoints only,\n      // not placeholders that are inserted during add\n      if (p) {\n        p = p.original || p;\n\n        snapPoints.horizontal.push(p.y);\n        snapPoints.vertical.push(p.x);\n      }\n    });\n\n    return snapPoints;\n  }\n\n\n  eventBus.on([ 'bendpoint.move.move', 'bendpoint.move.end' ], 1500, function(event) {\n\n    var context = event.context,\n        snapPoints = getBendpointSnaps(context),\n        target = context.target,\n        targetMid = target && mid(target),\n        x = event.x,\n        y = event.y,\n        sx, sy;\n\n    if (!snapPoints) {\n      return;\n    }\n\n    // snap\n    sx = snapTo(targetMid ? snapPoints.vertical.concat([ targetMid.x ]) : snapPoints.vertical, x);\n    sy = snapTo(targetMid ? snapPoints.horizontal.concat([ targetMid.y ]) : snapPoints.horizontal, y);\n\n    // correction x/y\n    var cx = (x - sx),\n        cy = (y - sy);\n\n    // update delta\n    assign(event, {\n      dx: event.dx - cx,\n      dy: event.dy - cy,\n      x: event.x - cx,\n      y: event.y - cy\n    });\n\n    // only set snapped if actually snapped\n    if (cx || snapPoints.vertical.indexOf(x) !== -1) {\n      setSnapped(event, 'x', sx);\n    }\n\n    if (cy || snapPoints.horizontal.indexOf(y) !== -1) {\n      setSnapped(event, 'y', sy);\n    }\n  });\n}\n\n\nBendpointSnapping.$inject = [ 'eventBus' ];","import DraggingModule from '../dragging';\nimport RulesModule from '../rules';\n\nimport Bendpoints from './Bendpoints';\nimport BendpointMove from './BendpointMove';\nimport BendpointMovePreview from './BendpointMovePreview';\nimport ConnectionSegmentMove from './ConnectionSegmentMove';\nimport BendpointSnapping from './BendpointSnapping';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    RulesModule\n  ],\n  __init__: [ 'bendpoints', 'bendpointSnapping', 'bendpointMovePreview' ],\n  bendpoints: [ 'type', Bendpoints ],\n  bendpointMove: [ 'type', BendpointMove ],\n  bendpointMovePreview: [ 'type', BendpointMovePreview ],\n  connectionSegmentMove: [ 'type', ConnectionSegmentMove ],\n  bendpointSnapping: [ 'type', BendpointSnapping ]\n};\n","import { bind } from 'min-dash';\n\n\nexport default function MouseTracking(eventBus, canvas) {\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n\n  this._init();\n}\n\nMouseTracking.$inject = [\n  'eventBus',\n  'canvas'\n];\n\n\nMouseTracking.prototype.getHoverContext = function() {\n  var viewbox = this._canvas.viewbox();\n\n  return {\n    element: this._hoverElement,\n    point: {\n      x: viewbox.x + Math.round(this._mouseX / viewbox.scale),\n      y: viewbox.y + Math.round(this._mouseY / viewbox.scale)\n    }\n  };\n};\n\nMouseTracking.prototype._init = function() {\n  var eventBus = this._eventBus,\n      canvas = this._canvas;\n\n  var container = canvas.getContainer();\n\n  this._setMousePosition = bind(this._setMousePosition, this);\n\n  container.addEventListener('mousemove', this._setMousePosition);\n\n  eventBus.on('diagram.destroy', function() {\n    container.removeEventListener('mousemove', this._setMousePosition);\n  }, this);\n\n  eventBus.on('element.hover', this._setHoverElement, this);\n};\n\n\nMouseTracking.prototype._setHoverElement = function(event) {\n  this._hoverElement = event.element;\n};\n\n\nMouseTracking.prototype._setMousePosition = function(event) {\n  this._mouseX = event.layerX;\n  this._mouseY = event.layerY;\n};\n","import MouseTracking from './MouseTracking';\n\nexport default {\n  __init__: [ 'mouseTracking' ],\n  mouseTracking: [ 'type', MouseTracking ]\n};\n","import { assign } from 'min-dash';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\n\n/**\n * Initiates canvas scrolling if current cursor point is close to a border.\n * Cancelled when current point moves back inside the scrolling borders\n * or cancelled manually.\n *\n * Default options :\n *   scrollThresholdIn: [ 20, 20, 20, 20 ],\n *   scrollThresholdOut: [ 0, 0, 0, 0 ],\n *   scrollRepeatTimeout: 15,\n *   scrollStep: 10\n *\n * Threshold order:\n *   [ left, top, right, bottom ]\n */\nexport default function AutoScroll(config, eventBus, canvas, mouseTracking) {\n\n  this._canvas = canvas;\n  this._mouseTracking = mouseTracking;\n\n  this._opts = assign({\n    scrollThresholdIn: [ 20, 20, 20, 20 ],\n    scrollThresholdOut: [ 0, 0, 0, 0 ],\n    scrollRepeatTimeout: 15,\n    scrollStep: 10\n  }, config);\n\n  var self = this;\n\n  eventBus.on('drag.move', function(e) {\n    var point = self._toBorderPoint(e);\n\n    self.startScroll(point);\n  });\n\n  eventBus.on([ 'drag.cleanup' ], function() {\n    self.stopScroll();\n  });\n}\n\nAutoScroll.$inject = [\n  'config.autoScroll',\n  'eventBus',\n  'canvas',\n  'mouseTracking'\n];\n\n\n/**\n * Starts scrolling loop.\n * Point is given in global scale in canvas container box plane.\n *\n * @param  {Object} point { x: X, y: Y }\n */\nAutoScroll.prototype.startScroll = function(point) {\n\n  var canvas = this._canvas;\n  var opts = this._opts;\n  var self = this;\n\n  var clientRect = canvas.getContainer().getBoundingClientRect();\n\n  var diff = [\n    point.x,\n    point.y,\n    clientRect.width - point.x,\n    clientRect.height - point.y\n  ];\n\n  this.stopScroll();\n\n  var dx = 0,\n      dy = 0;\n\n  for (var i = 0; i < 4; i++) {\n    if (between(diff[i], opts.scrollThresholdOut[i], opts.scrollThresholdIn[i])) {\n      if (i === 0) {\n        dx = opts.scrollStep;\n      } else if (i == 1) {\n        dy = opts.scrollStep;\n      } else if (i == 2) {\n        dx = -opts.scrollStep;\n      } else if (i == 3) {\n        dy = -opts.scrollStep;\n      }\n    }\n  }\n\n  if (dx !== 0 || dy !== 0) {\n    canvas.scroll({ dx: dx, dy: dy });\n\n    this._scrolling = setTimeout(function() {\n      self.startScroll(point);\n    }, opts.scrollRepeatTimeout);\n  }\n};\n\nfunction between(val, start, end) {\n  if (start < val && val < end) {\n    return true;\n  }\n\n  return false;\n}\n\n\n/**\n * Stops scrolling loop.\n */\nAutoScroll.prototype.stopScroll = function() {\n  clearTimeout(this._scrolling);\n};\n\n\n/**\n * Overrides defaults options.\n *\n * @param  {Object} options\n */\nAutoScroll.prototype.setOptions = function(options) {\n  this._opts = assign({}, this._opts, options);\n};\n\n\n/**\n * Converts event to a point in canvas container plane in global scale.\n *\n * @param  {Event} event\n * @return {Point}\n */\nAutoScroll.prototype._toBorderPoint = function(event) {\n  var clientRect = this._canvas._container.getBoundingClientRect();\n\n  var globalPosition = toPoint(event.originalEvent);\n\n  return {\n    x: globalPosition.x - clientRect.left,\n    y: globalPosition.y - clientRect.top\n  };\n};","import DraggingModule from '../dragging';\nimport MouseTrackingModule from '../mouse-tracking';\n\nimport AutoScroll from './AutoScroll';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    MouseTrackingModule\n  ],\n  __init__: [ 'autoScroll' ],\n  autoScroll: [ 'type', AutoScroll ]\n};","import {\n  pick,\n  assign\n} from 'min-dash';\n\nimport {\n  resizeBounds,\n  ensureConstraints,\n  computeChildrenBBox,\n  getMinResizeBounds\n} from './ResizeUtil';\n\nimport {\n  asTRBL,\n  roundBounds\n} from '../../layout/LayoutUtil';\n\nvar DEFAULT_MIN_WIDTH = 10;\n\n\n/**\n * A component that provides resizing of shapes on the canvas.\n *\n * The following components are part of shape resize:\n *\n *  * adding resize handles,\n *  * creating a visual during resize\n *  * checking resize rules\n *  * committing a change once finished\n *\n *\n * ## Customizing\n *\n * It's possible to customize the resizing behaviour by intercepting 'resize.start'\n * and providing the following parameters through the 'context':\n *\n *   * minDimensions ({ width, height }): minimum shape dimensions\n *\n *   * childrenBoxPadding ({ left, top, bottom, right } || number):\n *     gap between the minimum bounding box and the container\n *\n * f.ex:\n *\n * ```javascript\n * eventBus.on('resize.start', 1500, function(event) {\n *   var context = event.context,\n *\n *  context.minDimensions = { width: 140, height: 120 };\n *\n *  // Passing general padding\n *  context.childrenBoxPadding = 30;\n *\n *  // Passing padding to a specific side\n *  context.childrenBoxPadding.left = 20;\n * });\n * ```\n */\nexport default function Resize(eventBus, rules, modeling, dragging) {\n\n  this._dragging = dragging;\n  this._rules = rules;\n\n  var self = this;\n\n\n  /**\n   * Handle resize move by specified delta.\n   *\n   * @param {Object} context\n   * @param {Point} delta\n   */\n  function handleMove(context, delta) {\n\n    var shape = context.shape,\n        direction = context.direction,\n        resizeConstraints = context.resizeConstraints,\n        newBounds;\n\n    context.delta = delta;\n\n    newBounds = resizeBounds(shape, direction, delta);\n\n    // ensure constraints during resize\n    context.newBounds = ensureConstraints(newBounds, resizeConstraints);\n\n    // update + cache executable state\n    context.canExecute = self.canResize(context);\n  }\n\n  /**\n   * Handle resize start.\n   *\n   * @param  {Object} context\n   */\n  function handleStart(context) {\n\n    var resizeConstraints = context.resizeConstraints,\n        // evaluate minBounds for backwards compatibility\n        minBounds = context.minBounds;\n\n    if (resizeConstraints !== undefined) {\n      return;\n    }\n\n    if (minBounds === undefined) {\n      minBounds = self.computeMinResizeBox(context);\n    }\n\n    context.resizeConstraints = {\n      min: asTRBL(minBounds)\n    };\n  }\n\n  /**\n   * Handle resize end.\n   *\n   * @param  {Object} context\n   */\n  function handleEnd(context) {\n    var shape = context.shape,\n        canExecute = context.canExecute,\n        newBounds = context.newBounds;\n\n    if (canExecute) {\n\n      // ensure we have actual pixel values for new bounds\n      // (important when zoom level was > 1 during move)\n      newBounds = roundBounds(newBounds);\n\n      if (!boundsChanged(shape, newBounds)) {\n\n        // no resize necessary\n        return;\n      }\n\n      // perform the actual resize\n      modeling.resizeShape(shape, newBounds);\n    }\n  }\n\n\n  eventBus.on('resize.start', function(event) {\n    handleStart(event.context);\n  });\n\n  eventBus.on('resize.move', function(event) {\n    var delta = {\n      x: event.dx,\n      y: event.dy\n    };\n\n    handleMove(event.context, delta);\n  });\n\n  eventBus.on('resize.end', function(event) {\n    handleEnd(event.context);\n  });\n\n}\n\n\nResize.prototype.canResize = function(context) {\n  var rules = this._rules;\n\n  var ctx = pick(context, [ 'newBounds', 'shape', 'delta', 'direction' ]);\n\n  return rules.allowed('shape.resize', ctx);\n};\n\n/**\n * Activate a resize operation.\n *\n * You may specify additional contextual information and must specify a\n * resize direction during activation of the resize event.\n *\n * @param {MouseEvent} event\n * @param {djs.model.Shape} shape\n * @param {Object|String} contextOrDirection\n */\nResize.prototype.activate = function(event, shape, contextOrDirection) {\n  var dragging = this._dragging,\n      context,\n      direction;\n\n  if (typeof contextOrDirection === 'string') {\n    contextOrDirection = {\n      direction: contextOrDirection\n    };\n  }\n\n  context = assign({ shape: shape }, contextOrDirection);\n\n  direction = context.direction;\n\n  if (!direction) {\n    throw new Error('must provide a direction (nw|se|ne|sw)');\n  }\n\n  var referencePoint = {\n    x: /w/.test(direction) ? shape.x : shape.x + shape.width,\n    y: /n/.test(direction) ? shape.y : shape.y + shape.height\n  };\n\n  dragging.init(event, referencePoint, 'resize', {\n    autoActivate: true,\n    cursor: 'resize-' + (/nw|se/.test(direction) ? 'nwse' : 'nesw'),\n    data: {\n      shape: shape,\n      context: context\n    }\n  });\n};\n\nResize.prototype.computeMinResizeBox = function(context) {\n  var shape = context.shape,\n      direction = context.direction,\n      minDimensions,\n      childrenBounds;\n\n  minDimensions = context.minDimensions || {\n    width: DEFAULT_MIN_WIDTH,\n    height: DEFAULT_MIN_WIDTH\n  };\n\n  // get children bounds\n  childrenBounds = computeChildrenBBox(shape, context.childrenBoxPadding);\n\n  // get correct minimum bounds from given resize direction\n  // basically ensures that the minBounds is max(childrenBounds, minDimensions)\n  return getMinResizeBounds(direction, shape, minDimensions, childrenBounds);\n};\n\n\nResize.$inject = [\n  'eventBus',\n  'rules',\n  'modeling',\n  'dragging'\n];\n\n// helpers //////////\n\nfunction boundsChanged(shape, newBounds) {\n  return shape.x !== newBounds.x ||\n    shape.y !== newBounds.y ||\n    shape.width !== newBounds.width ||\n    shape.height !== newBounds.height;\n}","var MARKER_RESIZING = 'djs-resizing',\n    MARKER_RESIZE_NOT_OK = 'resize-not-ok';\n\nvar LOW_PRIORITY = 500;\n\nimport {\n  attr as svgAttr,\n  remove as svgRemove,\n  classes as svgClasses\n} from 'tiny-svg';\n\n\n/**\n * Provides previews for resizing shapes when resizing.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {PreviewSupport} previewSupport\n */\nexport default function ResizePreview(eventBus, canvas, previewSupport) {\n\n  /**\n   * Update resizer frame.\n   *\n   * @param {Object} context\n   */\n  function updateFrame(context) {\n\n    var shape = context.shape,\n        bounds = context.newBounds,\n        frame = context.frame;\n\n    if (!frame) {\n      frame = context.frame = previewSupport.addFrame(shape, canvas.getDefaultLayer());\n\n      canvas.addMarker(shape, MARKER_RESIZING);\n    }\n\n    if (bounds.width > 5) {\n      svgAttr(frame, { x: bounds.x, width: bounds.width });\n    }\n\n    if (bounds.height > 5) {\n      svgAttr(frame, { y: bounds.y, height: bounds.height });\n    }\n\n    if (context.canExecute) {\n      svgClasses(frame).remove(MARKER_RESIZE_NOT_OK);\n    } else {\n      svgClasses(frame).add(MARKER_RESIZE_NOT_OK);\n    }\n  }\n\n  /**\n   * Remove resizer frame.\n   *\n   * @param {Object} context\n   */\n  function removeFrame(context) {\n    var shape = context.shape,\n        frame = context.frame;\n\n    if (frame) {\n      svgRemove(context.frame);\n    }\n\n    canvas.removeMarker(shape, MARKER_RESIZING);\n  }\n\n  // add and update previews\n  eventBus.on('resize.move', LOW_PRIORITY, function(event) {\n    updateFrame(event.context);\n  });\n\n  // remove previews\n  eventBus.on('resize.cleanup', function(event) {\n    removeFrame(event.context);\n  });\n\n}\n\nResizePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'previewSupport'\n];","import {\n  bind,\n  forEach\n} from 'min-dash';\n\nvar HANDLE_OFFSET = -2,\n    HANDLE_SIZE = 5,\n    HANDLE_HIT_SIZE = 20;\n\nvar CLS_RESIZER = 'djs-resizer';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  clear as svgClear,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  isPrimaryButton\n} from '../../util/Mouse';\n\nimport {\n  asTRBL\n} from '../../layout/LayoutUtil';\n\nimport {\n  transform\n} from '../../util/SvgTransformUtil';\n\n\n/**\n * This component is responsible for adding resize handles.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Selection} selection\n * @param {Resize} resize\n */\nexport default function ResizeHandles(eventBus, canvas, selection, resize) {\n\n  this._resize = resize;\n  this._canvas = canvas;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n    var newSelection = e.newSelection;\n\n    // remove old selection markers\n    self.removeResizers();\n\n    // add new selection markers ONLY if single selection\n    if (newSelection.length === 1) {\n      forEach(newSelection, bind(self.addResizer, self));\n    }\n  });\n\n  eventBus.on('shape.changed', function(e) {\n    var shape = e.element;\n\n    if (selection.isSelected(shape)) {\n      self.removeResizers();\n\n      self.addResizer(shape);\n    }\n  });\n}\n\n\nResizeHandles.prototype.makeDraggable = function(element, gfx, direction) {\n  var resize = this._resize;\n\n  function startResize(event) {\n    // only trigger on left mouse button\n    if (isPrimaryButton(event)) {\n      resize.activate(event, element, direction);\n    }\n  }\n\n  domEvent.bind(gfx, 'mousedown', startResize);\n  domEvent.bind(gfx, 'touchstart', startResize);\n};\n\n\nResizeHandles.prototype._createResizer = function(element, x, y, rotation, direction) {\n  var resizersParent = this._getResizersParent();\n\n  var group = svgCreate('g');\n  svgClasses(group).add(CLS_RESIZER);\n  svgClasses(group).add(CLS_RESIZER + '-' + element.id);\n  svgClasses(group).add(CLS_RESIZER + '-' + direction);\n\n  svgAppend(resizersParent, group);\n\n  var origin = -HANDLE_SIZE + HANDLE_OFFSET;\n\n  // Create four drag indicators on the outline\n  var visual = svgCreate('rect');\n  svgAttr(visual, {\n    x: origin,\n    y: origin,\n    width: HANDLE_SIZE,\n    height: HANDLE_SIZE\n  });\n  svgClasses(visual).add(CLS_RESIZER + '-visual');\n\n  svgAppend(group, visual);\n\n  var hit = svgCreate('rect');\n  svgAttr(hit, {\n    x: origin,\n    y: origin,\n    width: HANDLE_HIT_SIZE,\n    height: HANDLE_HIT_SIZE\n  });\n  svgClasses(hit).add(CLS_RESIZER + '-hit');\n\n  svgAppend(group, hit);\n\n  transform(group, x, y, rotation);\n\n  return group;\n};\n\nResizeHandles.prototype.createResizer = function(element, direction) {\n  var resizer;\n\n  var trbl = asTRBL(element);\n\n  if (direction === 'nw') {\n    resizer = this._createResizer(element, trbl.left, trbl.top, 0, direction);\n  } else if (direction === 'ne') {\n    resizer = this._createResizer(element, trbl.right, trbl.top, 90, direction);\n  } else if (direction === 'se') {\n    resizer = this._createResizer(element, trbl.right, trbl.bottom, 180, direction);\n  } else {\n    resizer = this._createResizer(element, trbl.left, trbl.bottom, 270, direction);\n  }\n\n  this.makeDraggable(element, resizer, direction);\n};\n\n// resize handles implementation ///////////////////////////////\n\n/**\n * Add resizers for a given element.\n *\n * @param {djs.model.Shape} shape\n */\nResizeHandles.prototype.addResizer = function(shape) {\n  var resize = this._resize;\n\n  if (!resize.canResize({ shape: shape })) {\n    return;\n  }\n\n  this.createResizer(shape, 'nw');\n  this.createResizer(shape, 'ne');\n  this.createResizer(shape, 'se');\n  this.createResizer(shape, 'sw');\n};\n\n/**\n * Remove all resizers\n */\nResizeHandles.prototype.removeResizers = function() {\n  var resizersParent = this._getResizersParent();\n\n  svgClear(resizersParent);\n};\n\nResizeHandles.prototype._getResizersParent = function() {\n  return this._canvas.getLayer('resizers');\n};\n\nResizeHandles.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'resize'\n];\n","import RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\n\nimport Resize from './Resize';\nimport ResizePreview from './ResizePreview';\nimport ResizeHandles from './ResizeHandles';\n\nexport default {\n  __depends__: [\n    RulesModule,\n    DraggingModule,\n    PreviewSupportModule\n  ],\n  __init__: [\n    'resize',\n    'resizePreview',\n    'resizeHandles'\n  ],\n  resize: [ 'type', Resize ],\n  resizePreview: [ 'type', ResizePreview ],\n  resizeHandles: [ 'type', ResizeHandles ]\n};\n","import {\n  getDirection\n} from './SpaceUtil';\n\nimport {\n  set as cursorSet\n} from '../../util/Cursor';\n\nimport {\n  hasPrimaryModifier\n} from '../../util/Mouse';\n\nvar abs = Math.abs,\n    round = Math.round;\n\nvar HIGH_PRIORITY = 1500,\n    SPACE_TOOL_CURSOR = 'crosshair';\n\nvar AXIS_TO_DIMENSION = { x: 'width', y: 'height' },\n    AXIS_INVERTED = { x: 'y', y: 'x' };\n\nimport {\n  selfAndAllChildren as getAllChildren\n} from '../../util/Elements';\n\nimport {\n  assign,\n  forEach\n} from 'min-dash';\n\n\n/**\n * A tool that allows users to create and remove space in a diagram.\n *\n * The tool needs to be activated manually via {@link SpaceTool#activate(MouseEvent)}.\n */\nexport default function SpaceTool(\n    eventBus, dragging, canvas,\n    modeling, rules, toolManager) {\n\n  this._canvas = canvas;\n  this._dragging = dragging;\n  this._modeling = modeling;\n  this._rules = rules;\n  this._toolManager = toolManager;\n\n  var self = this;\n\n  toolManager.registerTool('space', {\n    tool: 'spaceTool.selection',\n    dragging: 'spaceTool'\n  });\n\n  eventBus.on('spaceTool.selection.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return;\n    }\n\n    eventBus.once('spaceTool.selection.ended', function() {\n      self.activateMakeSpace(event.originalEvent);\n    });\n  });\n\n\n  eventBus.on('spaceTool.move', HIGH_PRIORITY , function(event) {\n\n    var context = event.context;\n\n    if (!context.initialized) {\n      context.initialized = self.initializeMakeSpace(event, context);\n    }\n  });\n\n\n  eventBus.on('spaceTool.end', function(event) {\n\n    var context = event.context,\n        axis = context.axis,\n        direction = context.direction,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes;\n\n    // skip if create space has not been initialized yet\n    if (!context.initialized) {\n      return;\n    }\n\n    var delta = { x: round(event.dx), y: round(event.dy) };\n    delta[ AXIS_INVERTED[ axis ] ] = 0;\n\n    var insideBounds = true;\n\n    // check if the space tool cursor is inside of bounds of\n    // any of the shapes that would be resized.\n    forEach(resizingShapes, function(shape) {\n\n      if ((direction === 'w' && event.x > shape.x + shape.width) ||\n          (direction === 'e' && event.x < shape.x) ||\n          (direction === 'n' && event.y > shape.y + shape.height) ||\n          (direction === 's' && event.y < shape.y)) {\n\n        insideBounds = false;\n        return;\n      }\n    });\n\n    if (insideBounds) {\n      // make space only if the cursor is inside bounds\n      self.makeSpace(movingShapes, resizingShapes, delta, direction);\n    }\n\n    eventBus.once('spaceTool.ended', function(event) {\n      // reactivate space tool after usage\n      self.activateSelection(event.originalEvent, true, true);\n    });\n\n  });\n}\n\nSpaceTool.$inject = [\n  'eventBus',\n  'dragging',\n  'canvas',\n  'modeling',\n  'rules',\n  'toolManager'\n];\n\n\n/**\n * Activate space tool selection\n *\n * @param  {MouseEvent} event\n * @param  {Boolean} autoActivate\n */\nSpaceTool.prototype.activateSelection = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'spaceTool.selection', {\n    trapClick: false,\n    cursor: SPACE_TOOL_CURSOR,\n    autoActivate: autoActivate,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    }\n  });\n};\n\n/**\n * Activate make space\n *\n * @param  {MouseEvent} event\n */\nSpaceTool.prototype.activateMakeSpace = function(event) {\n  this._dragging.init(event, 'spaceTool', {\n    autoActivate: true,\n    cursor: SPACE_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\n/**\n * Actually make space on the diagram\n *\n * @param  {Array<djs.model.Shape>} movingShapes\n * @param  {Array<djs.model.Shape>} resizingShapes\n * @param  {Point} delta\n * @param  {String} direction\n */\nSpaceTool.prototype.makeSpace = function(movingShapes, resizingShapes, delta, direction) {\n  return this._modeling.createSpace(movingShapes, resizingShapes, delta, direction);\n};\n\n/**\n * Initialize make space and return true if that was successful.\n *\n * @param {Event} event\n * @param {Object} context\n *\n * @return {Boolean} true, if successful\n */\nSpaceTool.prototype.initializeMakeSpace = function(event, context) {\n\n  var axis = abs(event.dx) > abs(event.dy) ? 'x' : 'y',\n      offset = event['d' + axis],\n      // start point of create space operation\n      spacePos = event[axis] - offset;\n\n  if (abs(offset) < 5) {\n    return false;\n  }\n\n  // invert the offset in order to remove space when moving left\n  if (offset < 0) {\n    offset *= -1;\n  }\n\n  // inverts the offset to choose the shapes\n  // on the opposite side of the resizer if\n  // a key modifier is pressed\n  if (hasPrimaryModifier(event)) {\n    offset *= -1;\n  }\n\n  var rootShape = this._canvas.getRootElement();\n\n  var allShapes = getAllChildren(rootShape, true);\n\n  var adjustments = this.calculateAdjustments(allShapes, axis, offset, spacePos);\n\n  // store data in context\n  assign(context, adjustments, {\n    axis: axis,\n    direction: getDirection(axis, offset)\n  });\n\n  cursorSet('resize-' + (axis === 'x' ? 'ew' : 'ns'));\n\n  return true;\n};\n\n/**\n * Calculate adjustments needed when making space\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {String} axis\n * @param  {Number} offset\n * @param  {Number} spacePos\n *\n * @return {Object}\n */\nSpaceTool.prototype.calculateAdjustments = function(elements, axis, offset, spacePos) {\n\n  var movingShapes = [],\n      resizingShapes = [];\n\n  var rules = this._rules;\n\n  // collect all elements that need to be moved _AND_\n  // resized given on the initial create space position\n  elements.forEach(function(shape) {\n\n    var shapeStart = shape[axis],\n        shapeEnd = shapeStart + shape[AXIS_TO_DIMENSION[axis]];\n\n    // checking if it's root\n    if (!shape.parent) {\n      return;\n    }\n\n    // checking if it's a shape\n    if (shape.waypoints) {\n      return;\n    }\n\n    // shape after spacePos\n    if (offset > 0 && shapeStart > spacePos) {\n      return movingShapes.push(shape);\n    }\n\n    // shape before spacePos\n    if (offset < 0 && shapeEnd < spacePos) {\n      return movingShapes.push(shape);\n    }\n\n    // shape on top of spacePos, resize only if allowed\n    if (shapeStart < spacePos &&\n        shapeEnd > spacePos &&\n        rules.allowed('shape.resize', { shape: shape })) {\n\n      return resizingShapes.push(shape);\n    }\n  });\n\n  return {\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes\n  };\n};\n\nSpaceTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateSelection();\n  }\n};\n\nSpaceTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^spaceTool/.test(context.prefix);\n};\n","import {\n  forEach\n} from 'min-dash';\n\nvar MARKER_DRAGGING = 'djs-dragging',\n    MARKER_RESIZING = 'djs-resizing';\n\nvar LOW_PRIORITY = 250;\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\nvar max = Math.max;\n\n\n/**\n * Provides previews for selecting/moving/resizing shapes when creating/removing space.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Canvas} canvas\n * @param {Styles} styles\n */\nexport default function SpaceToolPreview(\n    eventBus, elementRegistry, canvas,\n    styles, previewSupport) {\n\n  function addPreviewGfx(collection, dragGroup) {\n    forEach(collection, function(element) {\n      previewSupport.addDragger(element, dragGroup);\n\n      canvas.addMarker(element, MARKER_DRAGGING);\n    });\n  }\n\n  // add crosshair\n  eventBus.on('spaceTool.selection.start', function(event) {\n    var space = canvas.getLayer('space'),\n        context = event.context;\n\n    var orientation = {\n      x: 'M 0,-10000 L 0,10000',\n      y: 'M -10000,0 L 10000,0'\n    };\n\n    var crosshairGroup = svgCreate('g');\n    svgAttr(crosshairGroup, styles.cls('djs-crosshair-group', [ 'no-events' ]));\n\n    svgAppend(space, crosshairGroup);\n\n    // horizontal path\n    var pathX = svgCreate('path');\n    svgAttr(pathX, 'd', orientation.x);\n    svgClasses(pathX).add('djs-crosshair');\n\n    svgAppend(crosshairGroup, pathX);\n\n    // vertical path\n    var pathY = svgCreate('path');\n    svgAttr(pathY, 'd', orientation.y);\n    svgClasses(pathY).add('djs-crosshair');\n\n    svgAppend(crosshairGroup, pathY);\n\n    context.crosshairGroup = crosshairGroup;\n  });\n\n  // update crosshair\n  eventBus.on('spaceTool.selection.move', function(event) {\n    var crosshairGroup = event.context.crosshairGroup;\n\n    translate(crosshairGroup, event.x, event.y);\n  });\n\n  // remove crosshair\n  eventBus.on('spaceTool.selection.cleanup', function(event) {\n    var context = event.context,\n        crosshairGroup = context.crosshairGroup;\n\n    if (crosshairGroup) {\n      svgRemove(crosshairGroup);\n    }\n  });\n\n  // add and update move/resize previews\n  eventBus.on('spaceTool.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        line = context.line,\n        axis = context.axis,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes;\n\n    if (!context.initialized) {\n      return;\n    }\n\n    if (!context.dragGroup) {\n      var spaceLayer = canvas.getLayer('space');\n\n      line = svgCreate('path');\n      svgAttr(line, 'd', 'M0,0 L0,0');\n      svgClasses(line).add('djs-crosshair');\n\n      svgAppend(spaceLayer, line);\n\n      context.line = line;\n\n      var dragGroup = svgCreate('g');\n      svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\n\n      svgAppend(canvas.getDefaultLayer(), dragGroup);\n\n      // shapes\n      addPreviewGfx(movingShapes, dragGroup);\n\n      // connections\n      var movingConnections = context.movingConnections = elementRegistry.filter(function(element) {\n        var sourceIsMoving = false;\n\n        forEach(movingShapes, function(shape) {\n          forEach(shape.outgoing, function(connection) {\n            if (element === connection) {\n              sourceIsMoving = true;\n            }\n          });\n        });\n\n        var targetIsMoving = false;\n\n        forEach(movingShapes, function(shape) {\n          forEach(shape.incoming, function(connection) {\n            if (element === connection) {\n              targetIsMoving = true;\n            }\n          });\n        });\n\n        var sourceIsResizing = false;\n\n        forEach(resizingShapes, function(shape) {\n          forEach(shape.outgoing, function(connection) {\n            if (element === connection) {\n              sourceIsResizing = true;\n            }\n          });\n        });\n\n        var targetIsResizing = false;\n\n        forEach(resizingShapes, function(shape) {\n          forEach(shape.incoming, function(connection) {\n            if (element === connection) {\n              targetIsResizing = true;\n            }\n          });\n        });\n\n        return isConnection(element)\n          && (sourceIsMoving || sourceIsResizing)\n          && (targetIsMoving || targetIsResizing);\n      });\n\n\n      addPreviewGfx(movingConnections, dragGroup);\n\n      context.dragGroup = dragGroup;\n    }\n\n    if (!context.frameGroup) {\n      var frameGroup = svgCreate('g');\n      svgAttr(frameGroup, styles.cls('djs-frame-group', [ 'no-events' ]));\n\n      svgAppend(canvas.getDefaultLayer(), frameGroup);\n\n      var frames = [];\n\n      forEach(resizingShapes, function(shape) {\n        var frame = previewSupport.addFrame(shape, frameGroup);\n\n        var initialBounds = frame.getBBox();\n\n        frames.push({\n          element: frame,\n          initialBounds: initialBounds\n        });\n\n        canvas.addMarker(shape, MARKER_RESIZING);\n      });\n\n      context.frameGroup = frameGroup;\n      context.frames = frames;\n    }\n\n    var orientation = {\n      x: 'M' + event.x + ', -10000 L' + event.x + ', 10000',\n      y: 'M -10000, ' + event.y + ' L 10000, ' + event.y\n    };\n\n    svgAttr(line, { path: orientation[ axis ], display: '' });\n\n    var opposite = { x: 'y', y: 'x' };\n    var delta = { x: event.dx, y: event.dy };\n    delta[ opposite[ context.axis ] ] = 0;\n\n    // update move previews\n    translate(context.dragGroup, delta.x, delta.y);\n\n    // update resize previews\n    forEach(context.frames, function(frame) {\n      var element = frame.element,\n          initialBounds = frame.initialBounds,\n          width,\n          height;\n\n      if (context.direction === 'e') {\n        svgAttr(element, {\n          width: max(initialBounds.width + delta.x, 5)\n        });\n      } else {\n        width = max(initialBounds.width - delta.x, 5);\n\n        svgAttr(element, {\n          width: width,\n          x: initialBounds.x + initialBounds.width - width\n        });\n      }\n\n      if (context.direction === 's') {\n        svgAttr(element, {\n          height: max(initialBounds.height + delta.y, 5)\n        });\n      } else {\n        height = max(initialBounds.height - delta.y, 5);\n\n        svgAttr(element, {\n          height: height,\n          y: initialBounds.y + initialBounds.height - height\n        });\n      }\n    });\n\n  });\n\n  // remove move/resize previews\n  eventBus.on('spaceTool.cleanup', function(event) {\n\n    var context = event.context,\n        movingShapes = context.movingShapes,\n        movingConnections = context.movingConnections,\n        resizingShapes = context.resizingShapes,\n        line = context.line,\n        dragGroup = context.dragGroup,\n        frameGroup = context.frameGroup;\n\n    // moving shapes\n    forEach(movingShapes, function(shape) {\n      canvas.removeMarker(shape, MARKER_DRAGGING);\n    });\n\n    // moving connections\n    forEach(movingConnections, function(connection) {\n      canvas.removeMarker(connection, MARKER_DRAGGING);\n    });\n\n    if (dragGroup) {\n      svgRemove(line);\n      svgRemove(dragGroup);\n    }\n\n    forEach(resizingShapes, function(shape) {\n      canvas.removeMarker(shape, MARKER_RESIZING);\n    });\n\n    if (frameGroup) {\n      svgRemove(frameGroup);\n    }\n  });\n}\n\nSpaceToolPreview.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'canvas',\n  'styles',\n  'previewSupport'\n];\n\n\n// helpers //////////////////////\n\n/**\n * Checks if an element is a connection.\n */\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import DraggingModule from '../dragging';\nimport RulesModule from '../rules';\nimport ToolManagerModule from '../tool-manager';\nimport PreviewSupportModule from '../preview-support';\n\nimport SpaceTool from './SpaceTool';\nimport SpaceToolPreview from './SpaceToolPreview';\n\nexport default {\n  __init__: ['spaceToolPreview'],\n  __depends__: [\n    DraggingModule,\n    RulesModule,\n    ToolManagerModule,\n    PreviewSupportModule\n  ],\n  spaceTool: ['type', SpaceTool ],\n  spaceToolPreview: ['type', SpaceToolPreview ]\n};\n","import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  bottomLeft,\r\n  bottomRight,\r\n  getChildren,\r\n  isSnapped,\r\n  topLeft,\r\n  topRight\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport { forEach } from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during resize.\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function ResizeSnapping(eventBus, snapping) {\r\n  var self = this;\r\n\r\n  eventBus.on([ 'resize.start' ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'resize.move',\r\n    'resize.end',\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        parent = shape.parent,\r\n        direction = context.direction,\r\n        snapContext = context.snapContext;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event)) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(parent);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, parent, direction);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([ 'resize.cleanup' ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nResizeSnapping.prototype.initSnap = function(event) {\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      direction = context.direction,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var snapCorner = getCorner(shape, direction);\r\n\r\n  snapContext.setSnapOrigin('corner', {\r\n    x: snapCorner.x - event.x,\r\n    y: snapCorner.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nResizeSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target, direction) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n    snapPoints.add('corner', bottomRight(snapTarget));\r\n    snapPoints.add('corner', topLeft(snapTarget));\r\n  });\r\n\r\n  snapPoints.add('corner', getCorner(shape, direction));\r\n\r\n  return snapPoints;\r\n};\r\n\r\nResizeSnapping.$inject = [\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nResizeSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isAttached(child, shape)\r\n      && !isConnection(child)\r\n      && !isHidden(child)\r\n      && !isLabel(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction getCorner(shape, direction) {\r\n  if (direction === 'nw') {\r\n    return topLeft(shape);\r\n  } else if (direction === 'ne') {\r\n    return topRight(shape);\r\n  } else if (direction === 'sw') {\r\n    return bottomLeft(shape);\r\n  } else {\r\n    return bottomRight(shape);\r\n  }\r\n}\r\n\r\nfunction isAttached(element, host) {\r\n  return element.host === host;\r\n}\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isLabel(element) {\r\n  return !!element.labelTarget;\r\n}","import {\n  bind,\n  debounce,\n  forEach,\n  isNumber,\n  isObject\n} from 'min-dash';\n\nimport {\n  isSnapped,\n  setSnapped\n} from './SnapUtil';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate\n} from 'tiny-svg';\n\nvar SNAP_TOLERANCE = 7;\n\nexport var SNAP_LINE_HIDE_DELAY = 1000;\n\n\n/**\n * Generic snapping feature.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function Snapping(canvas) {\n  this._canvas = canvas;\n\n  // delay hide by 1000 seconds since last snap\n  this._asyncHide = debounce(bind(this.hide, this), SNAP_LINE_HIDE_DELAY);\n}\n\nSnapping.$inject = [ 'canvas' ];\n\n/**\n * Snap an event to given snap points.\n *\n * @param {Event} event\n * @param {SnapPoints} snapPoints\n */\nSnapping.prototype.snap = function(event, snapPoints) {\n  var context = event.context,\n      snapContext = context.snapContext,\n      snapLocations = snapContext.getSnapLocations();\n\n  var snapping = {\n    x: isSnapped(event, 'x'),\n    y: isSnapped(event, 'y')\n  };\n\n  forEach(snapLocations, function(location) {\n    var snapOrigin = snapContext.getSnapOrigin(location);\n\n    var snapCurrent = {\n      x: event.x + snapOrigin.x,\n      y: event.y + snapOrigin.y\n    };\n\n    // snap both axis if not snapped already\n    forEach([ 'x', 'y' ], function(axis) {\n      var locationSnapping;\n\n      if (!snapping[axis]) {\n        locationSnapping = snapPoints.snap(snapCurrent, location, axis, SNAP_TOLERANCE);\n\n        if (locationSnapping !== undefined) {\n          snapping[axis] = {\n            value: locationSnapping,\n            originValue: locationSnapping - snapOrigin[axis]\n          };\n        }\n      }\n    });\n\n    // no need to continue snapping\n    if (snapping.x && snapping.y) {\n      return false;\n    }\n  });\n\n  // show snap lines\n  this.showSnapLine('vertical', snapping.x && snapping.x.value);\n  this.showSnapLine('horizontal', snapping.y && snapping.y.value);\n\n  // snap event\n  forEach([ 'x', 'y' ], function(axis) {\n    var axisSnapping = snapping[axis];\n\n    if (isObject(axisSnapping)) {\n      setSnapped(event, axis, axisSnapping.originValue);\n    }\n  });\n};\n\nSnapping.prototype._createLine = function(orientation) {\n  var root = this._canvas.getLayer('snap');\n\n  var line = svgCreate('path');\n\n  svgAttr(line, { d: 'M0,0 L0,0' });\n\n  svgClasses(line).add('djs-snap-line');\n\n  svgAppend(root, line);\n\n  return {\n    update: function(position) {\n\n      if (!isNumber(position)) {\n        svgAttr(line, { display: 'none' });\n      } else {\n        if (orientation === 'horizontal') {\n          svgAttr(line, {\n            d: 'M-100000,' + position + ' L+100000,' + position,\n            display: ''\n          });\n        } else {\n          svgAttr(line, {\n            d: 'M ' + position + ',-100000 L ' + position + ', +100000',\n            display: ''\n          });\n        }\n      }\n    }\n  };\n};\n\nSnapping.prototype._createSnapLines = function() {\n  this._snapLines = {\n    horizontal: this._createLine('horizontal'),\n    vertical: this._createLine('vertical')\n  };\n};\n\nSnapping.prototype.showSnapLine = function(orientation, position) {\n\n  var line = this.getSnapLine(orientation);\n\n  if (line) {\n    line.update(position);\n  }\n\n  this._asyncHide();\n};\n\nSnapping.prototype.getSnapLine = function(orientation) {\n  if (!this._snapLines) {\n    this._createSnapLines();\n  }\n\n  return this._snapLines[orientation];\n};\n\nSnapping.prototype.hide = function() {\n  forEach(this._snapLines, function(snapLine) {\n    snapLine.update();\n  });\n};\n","import CreateMoveSnapping from './CreateMoveSnapping';\nimport ResizeSnapping from './ResizeSnapping';\nimport Snapping from './Snapping';\n\nexport default {\n  __init__: [\n    'createMoveSnapping',\n    'resizeSnapping',\n    'snapping'\n  ],\n  createMoveSnapping: [ 'type', CreateMoveSnapping ],\n  resizeSnapping: [ 'type', ResizeSnapping ],\n  snapping: [ 'type', Snapping ]\n};","import { assign } from 'min-dash';\n\n\nvar DEFAULT_CONFIG = {\n  moveSpeed: 50,\n  moveSpeedAccelerated: 200\n};\n\n\n/**\n * A feature that allows users to move the canvas using the keyboard.\n *\n * @param {Object} config\n * @param {Number} [config.moveSpeed=50]\n * @param {Number} [config.moveSpeedAccelerated=200]\n * @param {Keyboard} keyboard\n * @param {Canvas} canvas\n */\nexport default function KeyboardMove(\n    config,\n    keyboard,\n    canvas\n) {\n\n  var self = this;\n\n  this._config = assign({}, DEFAULT_CONFIG, config || {});\n\n  keyboard.addListener(arrowsListener);\n\n\n  function arrowsListener(context) {\n\n    var event = context.keyEvent,\n        config = self._config;\n\n    if (!keyboard.isCmd(event)) {\n      return;\n    }\n\n    if (keyboard.isKey([\n      'ArrowLeft', 'Left',\n      'ArrowUp', 'Up',\n      'ArrowDown', 'Down',\n      'ArrowRight', 'Right'\n    ], event)) {\n\n      var speed = (\n        keyboard.isShift(event) ?\n          config.moveSpeedAccelerated :\n          config.moveSpeed\n      );\n\n      var direction;\n\n      switch (event.key) {\n      case 'ArrowLeft':\n      case 'Left':\n        direction = 'left';\n        break;\n      case 'ArrowUp':\n      case 'Up':\n        direction = 'up';\n        break;\n      case 'ArrowRight':\n      case 'Right':\n        direction = 'right';\n        break;\n      case 'ArrowDown':\n      case 'Down':\n        direction = 'down';\n        break;\n      }\n\n      self.moveCanvas({\n        speed: speed,\n        direction: direction\n      });\n\n      return true;\n    }\n  }\n\n  this.moveCanvas = function(opts) {\n\n    var dx = 0,\n        dy = 0,\n        speed = opts.speed;\n\n    var actualSpeed = speed / Math.min(Math.sqrt(canvas.viewbox().scale), 1);\n\n    switch (opts.direction) {\n    case 'left': // Left\n      dx = actualSpeed;\n      break;\n    case 'up': // Up\n      dy = actualSpeed;\n      break;\n    case 'right': // Right\n      dx = -actualSpeed;\n      break;\n    case 'down': // Down\n      dy = -actualSpeed;\n      break;\n    }\n\n    canvas.scroll({\n      dx: dx,\n      dy: dy\n    });\n  };\n\n}\n\n\nKeyboardMove.$inject = [\n  'config.keyboardMove',\n  'keyboard',\n  'canvas'\n];\n","import KeyboardModule from '../../features/keyboard';\n\nimport KeyboardMove from './KeyboardMove';\n\n\nexport default {\n  __depends__: [\n    KeyboardModule\n  ],\n  __init__: [ 'keyboardMove' ],\n  keyboardMove: [ 'type', KeyboardMove ]\n};","import {\n  assign\n} from 'min-dash';\n\n\nvar DEFAULT_CONFIG = {\n  moveSpeed: 1,\n  moveSpeedAccelerated: 10\n};\n\nvar HIGHER_PRIORITY = 1500;\n\nvar LEFT = 'left';\nvar UP = 'up';\nvar RIGHT = 'right';\nvar DOWN = 'down';\n\nvar KEY_TO_DIRECTION = {\n  ArrowLeft: LEFT,\n  Left: LEFT,\n  ArrowUp: UP,\n  Up: UP,\n  ArrowRight: RIGHT,\n  Right: RIGHT,\n  ArrowDown: DOWN,\n  Down: DOWN\n};\n\nvar DIRECTIONS_DELTA = {\n  left: function(speed) {\n    return {\n      x: -speed,\n      y: 0\n    };\n  },\n  up: function(speed) {\n    return {\n      x: 0,\n      y: -speed\n    };\n  },\n  right: function(speed) {\n    return {\n      x: speed,\n      y: 0\n    };\n  },\n  down: function(speed) {\n    return {\n      x: 0,\n      y: speed\n    };\n  }\n};\n\n\n/**\n * Enables to move selection with keyboard arrows.\n * Use with Shift for modified speed (default=1, with Shift=10).\n * Pressed Cmd/Ctrl turns the feature off.\n *\n * @param {Object} config\n * @param {Number} [config.moveSpeed=1]\n * @param {Number} [config.moveSpeedAccelerated=10]\n * @param {Keyboard} keyboard\n * @param {Modeling} modeling\n * @param {Selection} selection\n */\nexport default function KeyboardMoveSelection(\n    config, keyboard,\n    modeling, selection\n) {\n\n  var self = this;\n\n  this._config = assign({}, DEFAULT_CONFIG, config || {});\n\n  keyboard.addListener(HIGHER_PRIORITY, function(event) {\n\n    var keyEvent = event.keyEvent;\n\n    var direction = KEY_TO_DIRECTION[keyEvent.key];\n\n    if (!direction) {\n      return;\n    }\n\n    if (keyboard.isCmd(keyEvent)) {\n      return;\n    }\n\n    var accelerated = keyboard.isShift(keyEvent);\n\n    self.moveSelection(direction, accelerated);\n\n    return true;\n  });\n\n\n  /**\n   * Move selected elements in the given direction,\n   * optionally specifying accelerated movement.\n   *\n   * @param {String} direction\n   * @param {Boolean} [accelerated=false]\n   */\n  this.moveSelection = function(direction, accelerated) {\n\n    var selectedElements = selection.get();\n\n    if (!selectedElements.length) {\n      return;\n    }\n\n    var speed = this._config[\n      accelerated ?\n        'moveSpeedAccelerated' :\n        'moveSpeed'\n    ];\n\n    var delta = DIRECTIONS_DELTA[direction](speed);\n\n    modeling.moveElements(selectedElements, delta);\n  };\n\n}\n\nKeyboardMoveSelection.$inject = [\n  'config.keyboardMoveSelection',\n  'keyboard',\n  'modeling',\n  'selection'\n];","import KeyboardModule from '../keyboard';\nimport SelectionModule from '../selection';\n\nimport KeyboardMoveSelection from './KeyboardMoveSelection';\n\nexport default {\n  __depends__: [\n    KeyboardModule,\n    SelectionModule\n  ],\n  __init__: [\n    'keyboardMoveSelection'\n  ],\n  keyboardMoveSelection: [ 'type', KeyboardMoveSelection ]\n};\n","import {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove,\n  clear as svgClear\n} from 'tiny-svg';\n\nimport {\n  isObject\n} from 'min-dash';\n\nimport {\n  getElementLineIntersection,\n  getMid\n} from '../../layout/LayoutUtil';\n\n\nvar MARKER_CONNECTION_PREVIEW = 'djs-connection-preview';\n\n/**\n * Draws connection preview. Optionally, this can use layouter and connection docking to draw\n * better looking previews.\n *\n * @param {didi.Injector} injector\n * @param {Canvas} canvas\n * @param {GraphicsFactory} graphicsFactory\n * @param {ElementFactory} elementFactory\n */\nexport default function ConnectionPreview(\n    injector,\n    canvas,\n    graphicsFactory,\n    elementFactory\n) {\n  this._canvas = canvas;\n  this._graphicsFactory = graphicsFactory;\n  this._elementFactory = elementFactory;\n\n  // optional components\n  this._connectionDocking = injector.get('connectionDocking', false);\n  this._layouter = injector.get('layouter', false);\n}\n\nConnectionPreview.$inject = [\n  'injector',\n  'canvas',\n  'graphicsFactory',\n  'elementFactory'\n];\n\n/**\n * Draw connection preview.\n *\n * Provide at least one of <source, connectionStart> and <target, connectionEnd> to create a preview.\n * In the clean up stage, call `connectionPreview#cleanUp` with the context to remove preview.\n *\n * @param {Object} context\n * @param {Object|boolean} canConnect\n * @param {Object} hints\n * @param {djs.model.shape} [hints.source] source element\n * @param {djs.model.shape} [hints.target] target element\n * @param {Point} [hints.connectionStart] connection preview start\n * @param {Point} [hints.connectionEnd] connection preview end\n * @param {Array<Point>} [hints.waypoints] provided waypoints for preview\n * @param {boolean} [hints.noLayout] true if preview should not be laid out\n * @param {boolean} [hints.noCropping] true if preview should not be cropped\n * @param {boolean} [hints.noNoop] true if simple connection should not be drawn\n */\nConnectionPreview.prototype.drawPreview = function(context, canConnect, hints) {\n\n  hints = hints || {};\n\n  var connectionPreviewGfx = context.connectionPreviewGfx,\n      getConnection = context.getConnection,\n      source = hints.source,\n      target = hints.target,\n      waypoints = hints.waypoints,\n      connectionStart = hints.connectionStart,\n      connectionEnd = hints.connectionEnd,\n      noLayout = hints.noLayout,\n      noCropping = hints.noCropping,\n      noNoop = hints.noNoop,\n      connection;\n\n  var self = this;\n\n  if (!connectionPreviewGfx) {\n    connectionPreviewGfx = context.connectionPreviewGfx = this.createConnectionPreviewGfx();\n  }\n\n  svgClear(connectionPreviewGfx);\n\n  if (!getConnection) {\n    getConnection = context.getConnection = cacheReturnValues(function(canConnect, source, target) {\n      return self.getConnection(canConnect, source, target);\n    });\n  }\n\n  if (canConnect) {\n    connection = getConnection(canConnect, source, target);\n  }\n\n  if (!connection) {\n    !noNoop && this.drawNoopPreview(connectionPreviewGfx, hints);\n    return;\n  }\n\n  connection.waypoints = waypoints || [];\n\n  // optional layout\n  if (this._layouter && !noLayout) {\n    connection.waypoints = this._layouter.layoutConnection(connection, {\n      source: source,\n      target: target,\n      connectionStart: connectionStart,\n      connectionEnd: connectionEnd\n    });\n  }\n\n  // fallback if no waypoints were provided nor created with layouter\n  if (!connection.waypoints || !connection.waypoints.length) {\n    connection.waypoints = [\n      source ? getMid(source) : connectionStart,\n      target ? getMid(target) : connectionEnd\n    ];\n  }\n\n  // optional cropping\n  if (this._connectionDocking && (source || target) && !noCropping) {\n    connection.waypoints = this._connectionDocking.getCroppedWaypoints(connection, source, target);\n  }\n\n  this._graphicsFactory.drawConnection(connectionPreviewGfx, connection);\n};\n\n/**\n * Draw simple connection between source and target or provided points.\n *\n * @param {SVGElement} connectionPreviewGfx container for the connection\n * @param {Object} hints\n * @param {djs.model.shape} [hints.source] source element\n * @param {djs.model.shape} [hints.target] target element\n * @param {Point} [hints.connectionStart] required if source is not provided\n * @param {Point} [hints.connectionEnd] required if target is not provided\n */\nConnectionPreview.prototype.drawNoopPreview = function(connectionPreviewGfx, hints) {\n  var source = hints.source,\n      target = hints.target,\n      start = hints.connectionStart || getMid(source),\n      end = hints.connectionEnd || getMid(target);\n\n  var waypoints = this.cropWaypoints(start, end, source, target);\n\n  var connection = this.createNoopConnection(waypoints[0], waypoints[1]);\n\n  svgAppend(connectionPreviewGfx, connection);\n};\n\n/**\n * Return cropped waypoints.\n *\n * @param {Point} start\n * @param {Point} end\n * @param {djs.model.shape} source\n * @param {djs.model.shape} target\n *\n * @returns {Array}\n */\nConnectionPreview.prototype.cropWaypoints = function(start, end, source, target) {\n  var graphicsFactory = this._graphicsFactory,\n      sourcePath = source && graphicsFactory.getShapePath(source),\n      targetPath = target && graphicsFactory.getShapePath(target),\n      connectionPath = graphicsFactory.getConnectionPath({ waypoints: [ start, end ] });\n\n  start = (source && getElementLineIntersection(sourcePath, connectionPath, true)) || start;\n  end = (target && getElementLineIntersection(targetPath, connectionPath, false)) || end;\n\n  return [ start, end ];\n};\n\n/**\n * Remove connection preview container if it exists.\n *\n * @param {Object} [context]\n * @param {SVGElement} [context.connectionPreviewGfx] preview container\n */\nConnectionPreview.prototype.cleanUp = function(context) {\n  if (context && context.connectionPreviewGfx) {\n    svgRemove(context.connectionPreviewGfx);\n  }\n};\n\n/**\n * Get connection that connects source and target.\n *\n * @param {Object|boolean} canConnect\n *\n * @returns {djs.model.connection}\n */\nConnectionPreview.prototype.getConnection = function(canConnect) {\n  var attrs = ensureConnectionAttrs(canConnect);\n\n  return this._elementFactory.createConnection(attrs);\n};\n\n\n/**\n * Add and return preview graphics.\n *\n * @returns {SVGElement}\n */\nConnectionPreview.prototype.createConnectionPreviewGfx = function() {\n  var gfx = svgCreate('g');\n\n  svgAttr(gfx, {\n    pointerEvents: 'none'\n  });\n\n  svgClasses(gfx).add(MARKER_CONNECTION_PREVIEW);\n\n  svgAppend(this._canvas.getDefaultLayer(), gfx);\n\n  return gfx;\n};\n\n/**\n * Create and return simple connection.\n *\n * @param {Point} start\n * @param {Point} end\n *\n * @returns {SVGElement}\n */\nConnectionPreview.prototype.createNoopConnection = function(start, end) {\n  var connection = svgCreate('polyline');\n\n  svgAttr(connection, {\n    'stroke': '#333',\n    'strokeDasharray': [ 1 ],\n    'strokeWidth': 2,\n    'pointer-events': 'none'\n  });\n\n  svgAttr(connection, { 'points': [ start.x, start.y, end.x, end.y ] });\n\n  return connection;\n};\n\n// helpers //////////\n\n/**\n * Returns function that returns cached return values referenced by stringified first argument.\n *\n * @param {Function} fn\n *\n * @return {Function}\n */\nfunction cacheReturnValues(fn) {\n  var returnValues = {};\n\n  /**\n   * Return cached return value referenced by stringified first argument.\n   *\n   * @returns {*}\n   */\n  return function(firstArgument) {\n    var key = JSON.stringify(firstArgument);\n\n    var returnValue = returnValues[key];\n\n    if (!returnValue) {\n      returnValue = returnValues[key] = fn.apply(null, arguments);\n    }\n\n    return returnValue;\n  };\n}\n\n/**\n * Ensure connection attributes is object.\n *\n * @param {Object|boolean} canConnect\n *\n * @returns {Object}\n */\nfunction ensureConnectionAttrs(canConnect) {\n  if (isObject(canConnect)) {\n    return canConnect;\n  } else {\n    return {};\n  }\n}\n","import ConnectionPreview from './ConnectionPreview';\n\nexport default {\n  __init__: [ 'connectionPreview' ],\n  connectionPreview: [ 'type', ConnectionPreview ]\n};\n","import inherits from 'inherits';\n\nimport { getBBox as getBoundingBox } from '../../util/Elements';\n\nimport {\n  asTRBL,\n  asBounds\n} from '../../layout/LayoutUtil';\n\nimport {\n  assign,\n  flatten,\n  forEach,\n  groupBy,\n  isArray,\n  pick,\n  values\n} from 'min-dash';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * An auto resize component that takes care of expanding a parent element\n * if child elements are created or moved close the parents edge.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function AutoResize(eventBus, elementRegistry, modeling, rules) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this._elementRegistry = elementRegistry;\n  this._modeling = modeling;\n  this._rules = rules;\n\n  var self = this;\n\n  this.postExecuted([ 'shape.create' ], function(event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        parent = context.parent || context.newParent;\n\n    if (hints && (hints.root === false || hints.autoResize === false)) {\n      return;\n    }\n\n    self._expand([ shape ], parent);\n  });\n\n  this.postExecuted([ 'elements.move' ], function(event) {\n    var context = event.context,\n        elements = flatten(values(context.closure.topLevel)),\n        hints = context.hints;\n\n    var autoResize = hints ? hints.autoResize : true;\n\n    if (autoResize === false) {\n      return;\n    }\n\n    var expandings = groupBy(elements, function(element) {\n      return element.parent.id;\n    });\n\n    forEach(expandings, function(elements, parentId) {\n\n      // optionally filter elements to be considered when resizing\n      if (isArray(autoResize)) {\n        elements = elements.filter(function(element) {\n          return autoResize.indexOf(element) !== -1;\n        });\n      }\n\n      self._expand(elements, parentId);\n    });\n  });\n\n  this.postExecuted([ 'shape.toggleCollapse' ], function(event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape;\n\n    if (hints && (hints.root === false || hints.autoResize === false)) {\n      return;\n    }\n\n    if (shape.collapsed) {\n      return;\n    }\n\n    self._expand(shape.children || [], shape);\n  });\n\n  this.postExecuted([ 'shape.resize' ], function(event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        parent = shape.parent;\n\n    if (hints && (hints.root === false || hints.autoResize === false)) {\n      return;\n    }\n\n    if (parent) {\n      self._expand([ shape ], parent);\n    }\n  });\n\n}\n\nAutoResize.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'modeling',\n  'rules'\n];\n\ninherits(AutoResize, CommandInterceptor);\n\n\n/**\n * Calculate the new bounds of the target shape, given\n * a number of elements have been moved or added into the parent.\n *\n * This method considers the current size, the added elements as well as\n * the provided padding for the new bounds.\n *\n * @param {Array<djs.model.Shape>} elements\n * @param {djs.model.Shape} target\n */\nAutoResize.prototype._getOptimalBounds = function(elements, target) {\n\n  var offset = this.getOffset(target),\n      padding = this.getPadding(target);\n\n  var elementsTrbl = asTRBL(getBoundingBox(elements)),\n      targetTrbl = asTRBL(target);\n\n  var newTrbl = {};\n\n  if (elementsTrbl.top - targetTrbl.top < padding.top) {\n    newTrbl.top = elementsTrbl.top - offset.top;\n  }\n\n  if (elementsTrbl.left - targetTrbl.left < padding.left) {\n    newTrbl.left = elementsTrbl.left - offset.left;\n  }\n\n  if (targetTrbl.right - elementsTrbl.right < padding.right) {\n    newTrbl.right = elementsTrbl.right + offset.right;\n  }\n\n  if (targetTrbl.bottom - elementsTrbl.bottom < padding.bottom) {\n    newTrbl.bottom = elementsTrbl.bottom + offset.bottom;\n  }\n\n  return asBounds(assign({}, targetTrbl, newTrbl));\n};\n\n\n/**\n * Expand the target shape respecting rules, offset and padding\n *\n * @param {Array<djs.model.Shape>} elements\n * @param {djs.model.Shape|String} target|targetId\n */\nAutoResize.prototype._expand = function(elements, target) {\n\n  if (typeof target === 'string') {\n    target = this._elementRegistry.get(target);\n  }\n\n  var allowed = this._rules.allowed('element.autoResize', {\n    elements: elements,\n    target: target\n  });\n\n  if (!allowed) {\n    return;\n  }\n\n  // calculate the new bounds\n  var newBounds = this._getOptimalBounds(elements, target);\n\n  if (!boundsChanged(newBounds, target)) {\n    return;\n  }\n\n  var resizeDirections = getResizeDirections(pick(target, [ 'x', 'y', 'width', 'height' ]), newBounds);\n\n  // resize the parent shape\n  this.resize(target, newBounds, {\n    autoResize: resizeDirections\n  });\n\n  var parent = target.parent;\n\n  // recursively expand parent elements\n  if (parent) {\n    this._expand([ target ], parent);\n  }\n};\n\n\n/**\n * Get the amount to expand the given shape in each direction.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {TRBL}\n */\nAutoResize.prototype.getOffset = function(shape) {\n  return { top: 60, bottom: 60, left: 100, right: 100 };\n};\n\n\n/**\n * Get the activation threshold for each side for which\n * resize triggers.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {TRBL}\n */\nAutoResize.prototype.getPadding = function(shape) {\n  return { top: 2, bottom: 2, left: 15, right: 15 };\n};\n\n\n/**\n * Perform the actual resize operation.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n * @param {Object} [hints]\n * @param {string} [hints.autoResize]\n */\nAutoResize.prototype.resize = function(shape, newBounds, hints) {\n  this._modeling.resizeShape(shape, newBounds, null, hints);\n};\n\n\nfunction boundsChanged(newBounds, oldBounds) {\n  return (\n    newBounds.x !== oldBounds.x ||\n    newBounds.y !== oldBounds.y ||\n    newBounds.width !== oldBounds.width ||\n    newBounds.height !== oldBounds.height\n  );\n}\n\n/**\n * Get directions of resize as {n|w|s|e} e.g. \"nw\".\n *\n * @param {Bounds} oldBounds\n * @param {Bounds} newBounds\n *\n * @returns {string} Resize directions as {n|w|s|e}.\n */\nfunction getResizeDirections(oldBounds, newBounds) {\n  var directions = '';\n\n  oldBounds = asTRBL(oldBounds);\n  newBounds = asTRBL(newBounds);\n\n  if (oldBounds.top > newBounds.top) {\n    directions = directions.concat('n');\n  }\n\n  if (oldBounds.right < newBounds.right) {\n    directions = directions.concat('w');\n  }\n\n  if (oldBounds.bottom < newBounds.bottom) {\n    directions = directions.concat('s');\n  }\n\n  if (oldBounds.left > newBounds.left) {\n    directions = directions.concat('e');\n  }\n\n  return directions;\n}","import AutoResize from './AutoResize';\n\nexport default {\n  __init__: [ 'autoResize' ],\n  autoResize: [ 'type', AutoResize ]\n};\n","import {\n  assign,\n  isFunction,\n  isArray,\n  forEach,\n  isDefined\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  event as domEvent,\n  attr as domAttr,\n  query as domQuery,\n  classes as domClasses,\n  domify as domify\n} from 'min-dom';\n\nvar entrySelector = '.entry';\n\n\n/**\n * A context pad that displays element specific, contextual actions next\n * to a diagram element.\n *\n * @param {Object} config\n * @param {Boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {Number} [config.scale.min]\n * @param {Number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Overlays} overlays\n */\nexport default function ContextPad(config, eventBus, overlays) {\n\n  this._providers = [];\n\n  this._eventBus = eventBus;\n  this._overlays = overlays;\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n\n  this._overlaysConfig = {\n    position: {\n      right: -9,\n      top: -6\n    },\n    scale: scale\n  };\n\n  this._current = null;\n\n  this._init();\n}\n\nContextPad.$inject = [\n  'config.contextPad',\n  'eventBus',\n  'overlays'\n];\n\n\n/**\n * Registers events needed for interaction with other components\n */\nContextPad.prototype._init = function() {\n\n  var eventBus = this._eventBus;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n\n    var selection = e.newSelection;\n\n    if (selection.length === 1) {\n      self.open(selection[0]);\n    } else {\n      self.close();\n    }\n  });\n\n  eventBus.on('elements.delete', function(event) {\n    var elements = event.elements;\n\n    forEach(elements, function(e) {\n      if (self.isOpen(e)) {\n        self.close();\n      }\n    });\n  });\n\n  eventBus.on('element.changed', function(event) {\n    var element = event.element,\n        current = self._current;\n\n    // force reopen if element for which we are currently opened changed\n    if (current && current.element === element) {\n      self.open(element, true);\n    }\n  });\n};\n\n\n/**\n * Register a provider with the context pad\n *\n * @param  {ContextPadProvider} provider\n */\nContextPad.prototype.registerProvider = function(provider) {\n  this._providers.push(provider);\n};\n\n\n/**\n * Returns the context pad entries for a given element\n *\n * @param {djs.element.Base} element\n *\n * @return {Array<ContextPadEntryDescriptor>} list of entries\n */\nContextPad.prototype.getEntries = function(element) {\n  var entries = {};\n\n  // loop through all providers and their entries.\n  // group entries by id so that overriding an entry is possible\n  forEach(this._providers, function(provider) {\n    var e = provider.getContextPadEntries(element);\n\n    forEach(e, function(entry, id) {\n      entries[id] = entry;\n    });\n  });\n\n  return entries;\n};\n\n\n/**\n * Trigger an action available on the opened context pad\n *\n * @param  {String} action\n * @param  {Event} event\n * @param  {Boolean} [autoActivate=false]\n */\nContextPad.prototype.trigger = function(action, event, autoActivate) {\n\n  var element = this._current.element,\n      entries = this._current.entries,\n      entry,\n      handler,\n      originalEvent,\n      button = event.delegateTarget || event.target;\n\n  if (!button) {\n    return event.preventDefault();\n  }\n\n  entry = entries[domAttr(button, 'data-action')];\n  handler = entry.action;\n\n  originalEvent = event.originalEvent || event;\n\n  // simple action (via callback function)\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      return handler(originalEvent, element, autoActivate);\n    }\n  } else {\n    if (handler[action]) {\n      return handler[action](originalEvent, element, autoActivate);\n    }\n  }\n\n  // silence other actions\n  event.preventDefault();\n};\n\n\n/**\n * Open the context pad for the given element\n *\n * @param {djs.model.Base} element\n * @param {Boolean} force if true, force reopening the context pad\n */\nContextPad.prototype.open = function(element, force) {\n  if (!force && this.isOpen(element)) {\n    return;\n  }\n\n  this.close();\n  this._updateAndOpen(element);\n};\n\n\nContextPad.prototype._updateAndOpen = function(element) {\n\n  var entries = this.getEntries(element),\n      pad = this.getPad(element),\n      html = pad.html;\n\n  forEach(entries, function(entry, id) {\n    var grouping = entry.group || 'default',\n        control = domify(entry.html || '<div class=\"entry\" draggable=\"true\"></div>'),\n        container;\n\n    domAttr(control, 'data-action', id);\n\n    container = domQuery('[data-group=' + grouping + ']', html);\n    if (!container) {\n      container = domify('<div class=\"group\" data-group=\"' + grouping + '\"></div>');\n      html.appendChild(container);\n    }\n\n    container.appendChild(control);\n\n    if (entry.className) {\n      addClasses(control, entry.className);\n    }\n\n    if (entry.title) {\n      domAttr(control, 'title', entry.title);\n    }\n\n    if (entry.imageUrl) {\n      control.appendChild(domify('<img src=\"' + entry.imageUrl + '\">'));\n    }\n  });\n\n  domClasses(html).add('open');\n\n  this._current = {\n    element: element,\n    pad: pad,\n    entries: entries\n  };\n\n  this._eventBus.fire('contextPad.open', { current: this._current });\n};\n\n\nContextPad.prototype.getPad = function(element) {\n  if (this.isOpen()) {\n    return this._current.pad;\n  }\n\n  var self = this;\n\n  var overlays = this._overlays;\n\n  var html = domify('<div class=\"djs-context-pad\"></div>');\n\n  var overlaysConfig = assign({\n    html: html\n  }, this._overlaysConfig);\n\n  domDelegate.bind(html, entrySelector, 'click', function(event) {\n    self.trigger('click', event);\n  });\n\n  domDelegate.bind(html, entrySelector, 'dragstart', function(event) {\n    self.trigger('dragstart', event);\n  });\n\n  // stop propagation of mouse events\n  domEvent.bind(html, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  this._overlayId = overlays.add(element, 'context-pad', overlaysConfig);\n\n  var pad = overlays.get(this._overlayId);\n\n  this._eventBus.fire('contextPad.create', { element: element, pad: pad });\n\n  return pad;\n};\n\n\n/**\n * Close the context pad\n */\nContextPad.prototype.close = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._overlays.remove(this._overlayId);\n\n  this._overlayId = null;\n\n  this._eventBus.fire('contextPad.close', { current: this._current });\n\n  this._current = null;\n};\n\n/**\n * Check if pad is open. If element is given, will check\n * if pad is opened with given element.\n *\n * @param {Element} element\n * @return {Boolean}\n */\nContextPad.prototype.isOpen = function(element) {\n  return !!this._current && (!element ? true : this._current.element === element);\n};\n\n\n\n\n// helpers //////////////////////\n\nfunction addClasses(element, classNames) {\n\n  var classes = domClasses(element);\n\n  var actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\n  actualClassNames.forEach(function(cls) {\n    classes.add(cls);\n  });\n}","import InteractionEventsModule from '../interaction-events';\nimport OverlaysModule from '../overlays';\n\nimport ContextPad from './ContextPad';\n\n\nexport default {\n  __depends__: [\n    InteractionEventsModule,\n    OverlaysModule\n  ],\n  contextPad: [ 'type', ContextPad ]\n};","import {\n  forEach,\n  filter\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nvar LOW_PRIORITY = 250,\n    HIGH_PRIORITY = 1400;\n\nimport {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../util/Collections';\n\nimport { saveClear } from '../../util/Removal';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * A handler that makes sure labels are properly moved with\n * their label targets.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function LabelSupport(injector, eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var movePreview = injector.get('movePreview', false);\n\n  // remove labels from the collection that are being\n  // moved with other elements anyway\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        validatedShapes = context.validatedShapes;\n\n    context.shapes = removeLabels(shapes);\n    context.validatedShapes = removeLabels(validatedShapes);\n  });\n\n  // add labels to visual's group\n  movePreview && eventBus.on('shape.move.start', LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes;\n\n    var labels = [];\n\n    forEach(shapes, function(element) {\n\n      forEach(element.labels, function(label) {\n\n        if (!label.hidden && context.shapes.indexOf(label) === -1) {\n          labels.push(label);\n        }\n\n        if (element.labelTarget) {\n          labels.push(element);\n        }\n      });\n    });\n\n    forEach(labels, function(label) {\n      movePreview.makeDraggable(context, label, true);\n    });\n\n  });\n\n  // add all labels to move closure\n  this.preExecuted('elements.move', HIGH_PRIORITY, function(e) {\n    var context = e.context,\n        closure = context.closure,\n        enclosedElements = closure.enclosedElements;\n\n    var enclosedLabels = [];\n\n    // find labels that are not part of\n    // move closure yet and add them\n    forEach(enclosedElements, function(element) {\n      forEach(element.labels, function(label) {\n\n        if (!enclosedElements[label.id]) {\n          enclosedLabels.push(label);\n        }\n      });\n    });\n\n    closure.addAll(enclosedLabels);\n  });\n\n\n  this.preExecute([\n    'connection.delete',\n    'shape.delete'\n  ], function(e) {\n\n    var context = e.context,\n        element = context.connection || context.shape;\n\n    saveClear(element.labels, function(label) {\n      modeling.removeShape(label, { nested: true });\n    });\n  });\n\n\n  this.execute('shape.delete', function(e) {\n\n    var context = e.context,\n        shape = context.shape,\n        labelTarget = shape.labelTarget;\n\n    // unset labelTarget\n    if (labelTarget) {\n      context.labelTargetIndex = collectionIdx(labelTarget.labels, shape);\n      context.labelTarget = labelTarget;\n\n      shape.labelTarget = null;\n    }\n  });\n\n  this.revert('shape.delete', function(e) {\n\n    var context = e.context,\n        shape = context.shape,\n        labelTarget = context.labelTarget,\n        labelTargetIndex = context.labelTargetIndex;\n\n    // restore labelTarget\n    if (labelTarget) {\n      collectionAdd(labelTarget.labels, shape, labelTargetIndex);\n\n      shape.labelTarget = labelTarget;\n    }\n  });\n\n}\n\ninherits(LabelSupport, CommandInterceptor);\n\nLabelSupport.$inject = [\n  'injector',\n  'eventBus',\n  'modeling'\n];\n\n\n/**\n * Return a filtered list of elements that do not\n * contain attached elements with hosts being part\n * of the selection.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeLabels(elements) {\n\n  return filter(elements, function(element) {\n\n    // filter out labels that are move together\n    // with their label targets\n    return elements.indexOf(element.labelTarget) === -1;\n  });\n}\n","import LabelSupport from './LabelSupport';\n\nexport default {\n  __init__: [ 'labelSupport'],\n  labelSupport: [ 'type', LabelSupport ]\n};\n","import {\n  flatten,\n  filter,\n  forEach,\n  groupBy,\n  map,\n  unionBy\n} from 'min-dash';\n\nimport { saveClear } from '../../util/Removal';\n\nimport {\n  remove as collectionRemove\n} from '../../util/Collections';\n\nimport { getNewAttachShapeDelta } from '../../util/AttachUtil';\n\nimport inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\nvar LOW_PRIORITY = 251,\n    HIGH_PRIORITY = 1401;\n\nvar MARKER_ATTACH = 'attach-ok';\n\n\n/**\n * Adds the notion of attached elements to the modeler.\n *\n * Optionally depends on `diagram-js/lib/features/move` to render\n * the attached elements during move preview.\n *\n * Optionally depends on `diagram-js/lib/features/label-support`\n * to render attached labels during move preview.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Rules} rules\n * @param {Modeling} modeling\n */\nexport default function AttachSupport(injector, eventBus, canvas, rules, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var movePreview = injector.get('movePreview', false);\n\n\n  // remove all the attached elements from the shapes to be validated\n  // add all the attached shapes to the overall list of moved shapes\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        validatedShapes = context.validatedShapes;\n\n    context.shapes = addAttached(shapes);\n\n    context.validatedShapes = removeAttached(validatedShapes);\n  });\n\n  // add attachers to the visual's group\n  movePreview && eventBus.on('shape.move.start', LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        attachers = getAttachers(shapes);\n\n    forEach(attachers, function(attacher) {\n      movePreview.makeDraggable(context, attacher, true);\n\n      forEach(attacher.labels, function(label) {\n        movePreview.makeDraggable(context, label, true);\n      });\n    });\n  });\n\n  // add attach-ok marker to current host\n  movePreview && eventBus.on('shape.move.start', function(event) {\n    var context = event.context,\n        shapes = context.shapes;\n\n    if (shapes.length !== 1) {\n      return;\n    }\n\n    var shape = shapes[0];\n\n    var host = shape.host;\n\n    if (host) {\n      canvas.addMarker(host, MARKER_ATTACH);\n\n      eventBus.once([\n        'shape.move.out',\n        'shape.move.cleanup'\n      ], function() {\n        canvas.removeMarker(host, MARKER_ATTACH);\n      });\n    }\n  });\n\n  // add all attachers to move closure\n  this.preExecuted('elements.move', HIGH_PRIORITY, function(e) {\n    var context = e.context,\n        closure = context.closure,\n        shapes = context.shapes,\n        attachers = getAttachers(shapes);\n\n    forEach(attachers, function(attacher) {\n      closure.add(attacher, closure.topLevel[attacher.host.id]);\n    });\n  });\n\n  // perform the attaching after shapes are done moving\n  this.postExecuted('elements.move', function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        newHost = context.newHost,\n        attachers;\n\n    // we only support attachment / detachment of one element\n    if (shapes.length !== 1) {\n      return;\n    }\n\n    if (newHost) {\n\n      attachers = shapes;\n    } else {\n\n      attachers = filter(shapes, function(s) {\n        return !!s.host;\n      });\n    }\n\n    forEach(attachers, function(attacher) {\n      modeling.updateAttachment(attacher, newHost);\n    });\n  });\n\n  // ensure invalid attachment connections are removed\n  this.postExecuted('elements.move', function(e) {\n\n    var shapes = e.context.shapes;\n\n    forEach(shapes, function(shape) {\n\n      forEach(shape.attachers, function(attacher) {\n\n        // remove invalid outgoing connections\n        forEach(attacher.outgoing.slice(), function(connection) {\n          var allowed = rules.allowed('connection.reconnectStart', {\n            connection: connection,\n            source: connection.source,\n            target: connection.target\n          });\n\n          if (!allowed) {\n            modeling.removeConnection(connection);\n          }\n        });\n\n        // remove invalid incoming connections\n        forEach(attacher.incoming.slice(), function(connection) {\n          var allowed = rules.allowed('connection.reconnectEnd', {\n            connection: connection,\n            source: connection.source,\n            target: connection.target\n          });\n\n          if (!allowed) {\n            modeling.removeConnection(connection);\n          }\n        });\n      });\n    });\n  });\n\n  this.postExecute('shape.create', function(e) {\n    var context = e.context,\n        shape = context.shape,\n        host = context.host;\n\n    if (host) {\n      modeling.updateAttachment(shape, host);\n    }\n  });\n\n  // update attachments if the host is replaced\n  this.postExecute('shape.replace', function(e) {\n\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape;\n\n    // move the attachers to the new host\n    saveClear(oldShape.attachers, function(attacher) {\n      var allowed = rules.allowed('elements.move', {\n        target: newShape,\n        shapes: [attacher]\n      });\n\n      if (allowed === 'attach') {\n        modeling.updateAttachment(attacher, newShape);\n      } else {\n        modeling.removeShape(attacher);\n      }\n    });\n\n    // move attachers if new host has different size\n    if (newShape.attachers.length) {\n\n      forEach(newShape.attachers, function(attacher) {\n        var delta = getNewAttachShapeDelta(attacher, oldShape, newShape);\n        modeling.moveShape(attacher, delta, attacher.parent);\n      });\n    }\n\n  });\n\n  // move shape on host resize\n  this.postExecute('shape.resize', function(event) {\n    var context = event.context,\n        shape = context.shape,\n        oldBounds = context.oldBounds,\n        newBounds = context.newBounds,\n        attachers = shape.attachers;\n\n    forEach(attachers, function(attacher) {\n      var delta = getNewAttachShapeDelta(attacher, oldBounds, newBounds);\n\n      modeling.moveShape(attacher, delta, attacher.parent);\n\n      forEach(attacher.labels, function(label) {\n        modeling.moveShape(label, delta, label.parent);\n      });\n    });\n  });\n\n  // remove attachments\n  this.preExecute('shape.delete', function(event) {\n\n    var shape = event.context.shape;\n\n    saveClear(shape.attachers, function(attacher) {\n      modeling.removeShape(attacher);\n    });\n\n    if (shape.host) {\n      modeling.updateAttachment(shape, null);\n    }\n  });\n\n\n  // Prevent attachers and their labels from moving, when the space tool is performed.\n  // Otherwise the attachers and their labels would be moved twice.\n  eventBus.on('spaceTool.move', function(event) {\n\n    var context = event.context,\n        initialized = context.initialized,\n        attachSupportInitialized = context.attachSupportInitialized;\n\n    if (!initialized || attachSupportInitialized) {\n      return;\n    }\n\n    var movingShapes = context.movingShapes;\n\n    // collect attachers whose host is not being moved using the space tool\n    var staticAttachers = filter(movingShapes, function(shape) {\n      var host = shape.host;\n\n      return host && movingShapes.indexOf(host) === -1;\n    });\n\n    // remove attachers that are not going to be moved from moving shapes\n    forEach(staticAttachers, function(shape) {\n      collectionRemove(movingShapes, shape);\n\n      forEach(shape.labels, function(label) {\n        collectionRemove(movingShapes, shape.label);\n      });\n    });\n\n    context.attachSupportInitialized = true;\n  });\n}\n\ninherits(AttachSupport, CommandInterceptor);\n\nAttachSupport.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'rules',\n  'modeling'\n];\n\n\n/**\n * Return attachers of the given shapes\n *\n * @param {Array<djs.model.Base>} shapes\n * @return {Array<djs.model.Base>}\n */\nfunction getAttachers(shapes) {\n  return flatten(map(shapes, function(s) {\n    return s.attachers || [];\n  }));\n}\n\n/**\n * Return a combined list of elements and\n * attachers.\n *\n * @param {Array<djs.model.Base>} elements\n * @return {Array<djs.model.Base>} filtered\n */\nfunction addAttached(elements) {\n  var attachers = getAttachers(elements);\n\n  return unionBy('id', elements, attachers);\n}\n\n/**\n * Return a filtered list of elements that do not\n * contain attached elements with hosts being part\n * of the selection.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeAttached(elements) {\n\n  var ids = groupBy(elements, 'id');\n\n  return filter(elements, function(element) {\n    while (element) {\n\n      // host in selection\n      if (element.host && ids[element.host.id]) {\n        return false;\n      }\n\n      element = element.parent;\n    }\n\n    return true;\n  });\n}\n","import RulesModule from '../rules';\n\nimport AttachSupport from './AttachSupport';\n\nexport default {\n  __depends__: [\n    RulesModule\n  ],\n  __init__: [ 'attachSupport' ],\n  attachSupport: [ 'type', AttachSupport ]\n};\n","import {\n  isFunction,\n  isArray,\n  forEach\n} from 'min-dash';\n\nimport {\n  domify,\n  query as domQuery,\n  attr as domAttr,\n  clear as domClear,\n  classes as domClasses,\n  matches as domMatches,\n  delegate as domDelegate,\n  event as domEvent\n} from 'min-dom';\n\n\nvar TOGGLE_SELECTOR = '.djs-palette-toggle',\n    ENTRY_SELECTOR = '.entry',\n    ELEMENT_SELECTOR = TOGGLE_SELECTOR + ', ' + ENTRY_SELECTOR;\n\nvar PALETTE_OPEN_CLS = 'open',\n    PALETTE_TWO_COLUMN_CLS = 'two-column';\n\n\n/**\n * A palette containing modeling elements.\n */\nexport default function Palette(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n\n  this._providers = [];\n\n  var self = this;\n\n  eventBus.on('tool-manager.update', function(event) {\n    var tool = event.tool;\n\n    self.updateToolHighlight(tool);\n  });\n\n  eventBus.on('i18n.changed', function() {\n    self._update();\n  });\n\n  eventBus.on('diagram.init', function() {\n\n    self._diagramInitialized = true;\n\n    // initialize + update once diagram is ready\n    if (self._providers.length) {\n      self._init();\n\n      self._update();\n    }\n  });\n}\n\nPalette.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Register a provider with the palette\n *\n * @param  {PaletteProvider} provider\n */\nPalette.prototype.registerProvider = function(provider) {\n  this._providers.push(provider);\n\n  // postpone init / update until diagram is initialized\n  if (!this._diagramInitialized) {\n    return;\n  }\n\n  if (!this._container) {\n    this._init();\n  }\n\n  this._update();\n};\n\n\n/**\n * Returns the palette entries for a given element\n *\n * @return {Array<PaletteEntryDescriptor>} list of entries\n */\nPalette.prototype.getEntries = function() {\n\n  var entries = {};\n\n  // loop through all providers and their entries.\n  // group entries by id so that overriding an entry is possible\n  forEach(this._providers, function(provider) {\n    var e = provider.getPaletteEntries();\n\n    forEach(e, function(entry, id) {\n      entries[id] = entry;\n    });\n  });\n\n  return entries;\n};\n\n\n/**\n * Initialize\n */\nPalette.prototype._init = function() {\n  var canvas = this._canvas,\n      eventBus = this._eventBus;\n\n  var parent = canvas.getContainer(),\n      container = this._container = domify(Palette.HTML_MARKUP),\n      self = this;\n\n  parent.appendChild(container);\n\n  domDelegate.bind(container, ELEMENT_SELECTOR, 'click', function(event) {\n\n    var target = event.delegateTarget;\n\n    if (domMatches(target, TOGGLE_SELECTOR)) {\n      return self.toggle();\n    }\n\n    self.trigger('click', event);\n  });\n\n  // prevent drag propagation\n  domEvent.bind(container, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  // prevent drag propagation\n  domDelegate.bind(container, ENTRY_SELECTOR, 'dragstart', function(event) {\n    self.trigger('dragstart', event);\n  });\n\n  eventBus.on('canvas.resized', this._layoutChanged, this);\n\n  eventBus.fire('palette.create', {\n    container: container\n  });\n};\n\n/**\n * Update palette state.\n *\n * @param  {Object} [state] { open, twoColumn }\n */\nPalette.prototype._toggleState = function(state) {\n\n  state = state || {};\n\n  var parent = this._getParentContainer(),\n      container = this._container;\n\n  var eventBus = this._eventBus;\n\n  var twoColumn;\n\n  var cls = domClasses(container);\n\n  if ('twoColumn' in state) {\n    twoColumn = state.twoColumn;\n  } else {\n    twoColumn = this._needsCollapse(parent.clientHeight, this._entries || {});\n  }\n\n  // always update two column\n  cls.toggle(PALETTE_TWO_COLUMN_CLS, twoColumn);\n\n  if ('open' in state) {\n    cls.toggle(PALETTE_OPEN_CLS, state.open);\n  }\n\n  eventBus.fire('palette.changed', {\n    twoColumn: twoColumn,\n    open: this.isOpen()\n  });\n};\n\nPalette.prototype._update = function() {\n\n  var entriesContainer = domQuery('.djs-palette-entries', this._container),\n      entries = this._entries = this.getEntries();\n\n  domClear(entriesContainer);\n\n  forEach(entries, function(entry, id) {\n\n    var grouping = entry.group || 'default';\n\n    var container = domQuery('[data-group=' + grouping + ']', entriesContainer);\n    if (!container) {\n      container = domify('<div class=\"group\" data-group=\"' + grouping + '\"></div>');\n      entriesContainer.appendChild(container);\n    }\n\n    var html = entry.html || (\n      entry.separator ?\n        '<hr class=\"separator\" />' :\n        '<div class=\"entry\" draggable=\"true\"></div>');\n\n\n    var control = domify(html);\n    container.appendChild(control);\n\n    if (!entry.separator) {\n      domAttr(control, 'data-action', id);\n\n      if (entry.title) {\n        domAttr(control, 'title', entry.title);\n      }\n\n      if (entry.className) {\n        addClasses(control, entry.className);\n      }\n\n      if (entry.imageUrl) {\n        control.appendChild(domify('<img src=\"' + entry.imageUrl + '\">'));\n      }\n    }\n  });\n\n  // open after update\n  this.open();\n};\n\n\n/**\n * Trigger an action available on the palette\n *\n * @param  {String} action\n * @param  {Event} event\n */\nPalette.prototype.trigger = function(action, event, autoActivate) {\n  var entries = this._entries,\n      entry,\n      handler,\n      originalEvent,\n      button = event.delegateTarget || event.target;\n\n  if (!button) {\n    return event.preventDefault();\n  }\n\n  entry = entries[domAttr(button, 'data-action')];\n\n  // when user clicks on the palette and not on an action\n  if (!entry) {\n    return;\n  }\n\n  handler = entry.action;\n\n  originalEvent = event.originalEvent || event;\n\n  // simple action (via callback function)\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      handler(originalEvent, autoActivate);\n    }\n  } else {\n    if (handler[action]) {\n      handler[action](originalEvent, autoActivate);\n    }\n  }\n\n  // silence other actions\n  event.preventDefault();\n};\n\nPalette.prototype._layoutChanged = function() {\n  this._toggleState({});\n};\n\n/**\n * Do we need to collapse to two columns?\n *\n * @param {Number} availableHeight\n * @param {Object} entries\n *\n * @return {Boolean}\n */\nPalette.prototype._needsCollapse = function(availableHeight, entries) {\n\n  // top margin + bottom toggle + bottom margin\n  // implementors must override this method if they\n  // change the palette styles\n  var margin = 20 + 10 + 20;\n\n  var entriesHeight = Object.keys(entries).length * 46;\n\n  return availableHeight < entriesHeight + margin;\n};\n\n/**\n * Close the palette\n */\nPalette.prototype.close = function() {\n\n  this._toggleState({\n    open: false,\n    twoColumn: false\n  });\n};\n\n\n/**\n * Open the palette\n */\nPalette.prototype.open = function() {\n  this._toggleState({ open: true });\n};\n\n\nPalette.prototype.toggle = function(open) {\n  if (this.isOpen()) {\n    this.close();\n  } else {\n    this.open();\n  }\n};\n\nPalette.prototype.isActiveTool = function(tool) {\n  return tool && this._activeTool === tool;\n};\n\nPalette.prototype.updateToolHighlight = function(name) {\n  var entriesContainer,\n      toolsContainer;\n\n  if (!this._toolsContainer) {\n    entriesContainer = domQuery('.djs-palette-entries', this._container);\n\n    this._toolsContainer = domQuery('[data-group=tools]', entriesContainer);\n  }\n\n  toolsContainer = this._toolsContainer;\n\n  forEach(toolsContainer.children, function(tool) {\n    var actionName = tool.getAttribute('data-action');\n\n    if (!actionName) {\n      return;\n    }\n\n    var toolClasses = domClasses(tool);\n\n    actionName = actionName.replace('-tool', '');\n\n    if (toolClasses.contains('entry') && actionName === name) {\n      toolClasses.add('highlighted-entry');\n    } else {\n      toolClasses.remove('highlighted-entry');\n    }\n  });\n};\n\n\n/**\n * Return true if the palette is opened.\n *\n * @example\n *\n * palette.open();\n *\n * if (palette.isOpen()) {\n *   // yes, we are open\n * }\n *\n * @return {boolean} true if palette is opened\n */\nPalette.prototype.isOpen = function() {\n  return domClasses(this._container).has(PALETTE_OPEN_CLS);\n};\n\n/**\n * Get container the palette lives in.\n *\n * @return {Element}\n */\nPalette.prototype._getParentContainer = function() {\n  return this._canvas.getContainer();\n};\n\n\n/* markup definition */\n\nPalette.HTML_MARKUP =\n  '<div class=\"djs-palette\">' +\n    '<div class=\"djs-palette-entries\"></div>' +\n    '<div class=\"djs-palette-toggle\"></div>' +\n  '</div>';\n\n\n// helpers //////////////////////\n\nfunction addClasses(element, classNames) {\n\n  var classes = domClasses(element);\n\n  var actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\n  actualClassNames.forEach(function(cls) {\n    classes.add(cls);\n  });\n}\n","import Palette from './Palette';\n\nexport default {\n  __init__: [ 'palette' ],\n  palette: [ 'type', Palette ]\n};\n","import { values } from 'min-dash';\n\nimport { getEnclosedElements } from '../../util/Elements';\n\nimport { hasSecondaryModifier } from '../../util/Mouse';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nvar LASSO_TOOL_CURSOR = 'crosshair';\n\n\nexport default function LassoTool(\n    eventBus, canvas, dragging,\n    elementRegistry, selection, toolManager) {\n\n  this._selection = selection;\n  this._dragging = dragging;\n\n  var self = this;\n\n  // lasso visuals implementation\n\n  /**\n  * A helper that realizes the selection box visual\n  */\n  var visuals = {\n\n    create: function(context) {\n      var container = canvas.getDefaultLayer(),\n          frame;\n\n      frame = context.frame = svgCreate('rect');\n      svgAttr(frame, {\n        class: 'djs-lasso-overlay',\n        width:  1,\n        height: 1,\n        x: 0,\n        y: 0\n      });\n\n      svgAppend(container, frame);\n    },\n\n    update: function(context) {\n      var frame = context.frame,\n          bbox = context.bbox;\n\n      svgAttr(frame, {\n        x: bbox.x,\n        y: bbox.y,\n        width: bbox.width,\n        height: bbox.height\n      });\n    },\n\n    remove: function(context) {\n\n      if (context.frame) {\n        svgRemove(context.frame);\n      }\n    }\n  };\n\n  toolManager.registerTool('lasso', {\n    tool: 'lasso.selection',\n    dragging: 'lasso'\n  });\n\n  eventBus.on('lasso.selection.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return;\n    }\n\n    eventBus.once('lasso.selection.ended', function() {\n      self.activateLasso(event.originalEvent, true);\n    });\n  });\n\n  // lasso interaction implementation\n\n  eventBus.on('lasso.end', function(event) {\n\n    var bbox = toBBox(event);\n\n    var elements = elementRegistry.filter(function(element) {\n      return element;\n    });\n\n    self.select(elements, bbox);\n  });\n\n  eventBus.on('lasso.start', function(event) {\n\n    var context = event.context;\n\n    context.bbox = toBBox(event);\n    visuals.create(context);\n  });\n\n  eventBus.on('lasso.move', function(event) {\n\n    var context = event.context;\n\n    context.bbox = toBBox(event);\n    visuals.update(context);\n  });\n\n  eventBus.on('lasso.cleanup', function(event) {\n\n    var context = event.context;\n\n    visuals.remove(context);\n  });\n\n\n  // event integration\n\n  eventBus.on('element.mousedown', 1500, function(event) {\n\n    if (hasSecondaryModifier(event)) {\n      self.activateLasso(event.originalEvent);\n\n      // we've handled the event\n      return true;\n    }\n  });\n}\n\nLassoTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'elementRegistry',\n  'selection',\n  'toolManager'\n];\n\n\nLassoTool.prototype.activateLasso = function(event, autoActivate) {\n\n  this._dragging.init(event, 'lasso', {\n    autoActivate: autoActivate,\n    cursor: LASSO_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\nLassoTool.prototype.activateSelection = function(event) {\n\n  this._dragging.init(event, 'lasso.selection', {\n    trapClick: false,\n    cursor: LASSO_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\nLassoTool.prototype.select = function(elements, bbox) {\n  var selectedElements = getEnclosedElements(elements, bbox);\n\n  this._selection.select(values(selectedElements));\n};\n\nLassoTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateSelection();\n  }\n};\n\nLassoTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^lasso/.test(context.prefix);\n};\n\n\n\nfunction toBBox(event) {\n\n  var start = {\n\n    x: event.x - event.dx,\n    y: event.y - event.dy\n  };\n\n  var end = {\n    x: event.x,\n    y: event.y\n  };\n\n  var bbox;\n\n  if ((start.x <= end.x && start.y < end.y) ||\n      (start.x < end.x && start.y <= end.y)) {\n\n    bbox = {\n      x: start.x,\n      y: start.y,\n      width:  end.x - start.x,\n      height: end.y - start.y\n    };\n  } else if ((start.x >= end.x && start.y < end.y) ||\n             (start.x > end.x && start.y <= end.y)) {\n\n    bbox = {\n      x: end.x,\n      y: start.y,\n      width:  start.x - end.x,\n      height: end.y - start.y\n    };\n  } else if ((start.x <= end.x && start.y > end.y) ||\n             (start.x < end.x && start.y >= end.y)) {\n\n    bbox = {\n      x: start.x,\n      y: end.y,\n      width:  end.x - start.x,\n      height: start.y - end.y\n    };\n  } else if ((start.x >= end.x && start.y > end.y) ||\n             (start.x > end.x && start.y >= end.y)) {\n\n    bbox = {\n      x: end.x,\n      y: end.y,\n      width:  start.x - end.x,\n      height: start.y - end.y\n    };\n  } else {\n\n    bbox = {\n      x: end.x,\n      y: end.y,\n      width:  0,\n      height: 0\n    };\n  }\n  return bbox;\n}\n","import ToolManagerModule from '../tool-manager';\n\nimport LassoTool from './LassoTool';\n\nexport default {\n  __depends__: [\n    ToolManagerModule\n  ],\n  __init__: [ 'lassoTool' ],\n  lassoTool: [ 'type', LassoTool ]\n};\n","import { hasPrimaryModifier } from '../../util/Mouse';\n\nimport { isKey } from '../../features/keyboard/KeyboardUtil';\n\nvar HIGH_PRIORITY = 1500;\nvar HAND_CURSOR = 'grab';\n\n\nexport default function HandTool(eventBus, canvas, dragging, injector, toolManager) {\n  this._dragging = dragging;\n\n  var self = this,\n      keyboard = injector.get('keyboard', false);\n\n  toolManager.registerTool('hand', {\n    tool: 'hand',\n    dragging: 'hand.move'\n  });\n\n  eventBus.on('element.mousedown', HIGH_PRIORITY, function(event) {\n    if (hasPrimaryModifier(event)) {\n      this.activateMove(event.originalEvent);\n\n      return false;\n    }\n  }, this);\n\n  keyboard && keyboard.addListener(HIGH_PRIORITY, function(e) {\n    if (!isSpace(e.keyEvent)) {\n      return;\n    }\n\n    if (self.isActive()) {\n      return;\n    }\n\n    function activateMove(event) {\n      self.activateMove(event);\n\n      window.removeEventListener('mousemove', activateMove);\n    }\n\n    window.addEventListener('mousemove', activateMove);\n\n    function deactivateMove(e) {\n      if (!isSpace(e.keyEvent)) {\n        return;\n      }\n\n      window.removeEventListener('mousemove', activateMove);\n\n      keyboard.removeListener(deactivateMove, 'keyboard.keyup');\n\n      dragging.cancel();\n    }\n\n    keyboard.addListener(HIGH_PRIORITY, deactivateMove, 'keyboard.keyup');\n  }, 'keyboard.keydown');\n\n  eventBus.on('hand.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return false;\n    }\n\n    eventBus.once('hand.ended', function() {\n      this.activateMove(event.originalEvent, { reactivate: true });\n    }, this);\n\n  }, this);\n\n\n  eventBus.on('hand.move.move', function(event) {\n    var scale = canvas.viewbox().scale;\n\n    canvas.scroll({\n      dx: event.dx * scale,\n      dy: event.dy * scale\n    });\n  });\n\n  eventBus.on('hand.move.end', function(event) {\n    var context = event.context,\n        reactivate = context.reactivate;\n\n    // Don't reactivate if the user is using the keyboard keybinding\n    if (!hasPrimaryModifier(event) && reactivate) {\n\n      eventBus.once('hand.move.ended', function(event) {\n        this.activateHand(event.originalEvent, true, true);\n      }, this);\n\n    }\n\n    return false;\n  }, this);\n\n}\n\nHandTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'injector',\n  'toolManager'\n];\n\n\nHandTool.prototype.activateMove = function(event, autoActivate, context) {\n  if (typeof autoActivate === 'object') {\n    context = autoActivate;\n    autoActivate = false;\n  }\n\n  this._dragging.init(event, 'hand.move', {\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: context || {}\n    }\n  });\n};\n\nHandTool.prototype.activateHand = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'hand', {\n    trapClick: false,\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    }\n  });\n};\n\nHandTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateHand();\n  }\n};\n\nHandTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  if (context) {\n    return /^(hand|hand\\.move)$/.test(context.prefix);\n  }\n\n  return false;\n};\n\n// helpers //////////\n\nfunction isSpace(keyEvent) {\n  return isKey(' ', keyEvent);\n}","import ToolManagerModule from '../tool-manager';\n\nimport HandTool from './HandTool';\n\nexport default {\n  __depends__: [\n    ToolManagerModule\n  ],\n  __init__: [ 'handTool' ],\n  handTool: [ 'type', HandTool ]\n};\n","var MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n/**\n * @class\n * @constructor\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Connect} connect\n * @param {Canvas} canvas\n * @param {ToolManager} toolManager\n * @param {Rules} rules\n */\nexport default function GlobalConnect(\n    eventBus, dragging, connect,\n    canvas, toolManager, rules) {\n\n  var self = this;\n\n  this._dragging = dragging;\n  this._rules = rules;\n\n  toolManager.registerTool('global-connect', {\n    tool: 'global-connect',\n    dragging: 'global-connect.drag'\n  });\n\n  eventBus.on('global-connect.hover', function(event) {\n    var context = event.context,\n        startTarget = event.hover;\n\n    var canStartConnect = context.canStartConnect = self.canStartConnect(startTarget);\n\n    // simply ignore hover\n    if (canStartConnect === null) {\n      return;\n    }\n\n    context.startTarget = startTarget;\n\n    canvas.addMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n\n  eventBus.on([ 'global-connect.out', 'global-connect.cleanup' ], function(event) {\n    var startTarget = event.context.startTarget,\n        canStartConnect = event.context.canStartConnect;\n\n    if (startTarget) {\n      canvas.removeMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n\n  eventBus.on([ 'global-connect.ended' ], function(event) {\n    var context = event.context,\n        startTarget = context.startTarget,\n        startPosition = {\n          x: event.x,\n          y: event.y\n        };\n\n    var canStartConnect = self.canStartConnect(startTarget);\n\n    if (!canStartConnect) {\n      return;\n    }\n\n    eventBus.once('element.out', function() {\n      eventBus.once([ 'connect.ended', 'connect.canceled' ], function() {\n        eventBus.fire('global-connect.drag.ended');\n      });\n\n      connect.start(null, startTarget, startPosition);\n    });\n\n    return false;\n  });\n}\n\nGlobalConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'connect',\n  'canvas',\n  'toolManager',\n  'rules'\n];\n\n/**\n * Initiates tool activity.\n */\nGlobalConnect.prototype.start = function(event) {\n  this._dragging.init(event, 'global-connect', {\n    trapClick: false,\n    data: {\n      context: {}\n    }\n  });\n};\n\nGlobalConnect.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.start();\n  }\n};\n\nGlobalConnect.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^global-connect/.test(context.prefix);\n};\n\n/**\n * Check if source shape can initiate connection.\n *\n * @param  {Shape} startTarget\n * @return {Boolean}\n */\nGlobalConnect.prototype.canStartConnect = function(startTarget) {\n  return this._rules.allowed('connection.start', { source: startTarget });\n};\n","import ConnectModule from '../connect';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport ToolManagerModule from '../tool-manager';\n\nimport GlobalConnect from './GlobalConnect';\n\nexport default {\n  __depends__: [\n    ConnectModule,\n    RulesModule,\n    DraggingModule,\n    ToolManagerModule\n  ],\n  globalConnect: [ 'type', GlobalConnect ]\n};\n","import {\n  clear as domClear,\n  delegate as domDelegate,\n  query as domQuery,\n  classes as domClasses,\n  attr as domAttr,\n  domify as domify\n} from 'min-dom';\n\nimport {\n  getBBox as getBoundingBox\n} from '../../util/Elements';\n\nimport {\n  escapeHTML\n} from '../../util/EscapeUtil';\n\n/**\n * Provides searching infrastructure\n */\nexport default function SearchPad(canvas, eventBus, overlays, selection) {\n  this._open = false;\n  this._results = [];\n  this._eventMaps = [];\n\n  this._canvas = canvas;\n  this._eventBus = eventBus;\n  this._overlays = overlays;\n  this._selection = selection;\n\n  // setup elements\n  this._container = domify(SearchPad.BOX_HTML);\n  this._searchInput = domQuery(SearchPad.INPUT_SELECTOR, this._container);\n  this._resultsContainer = domQuery(SearchPad.RESULTS_CONTAINER_SELECTOR, this._container);\n\n  // attach search pad\n  this._canvas.getContainer().appendChild(this._container);\n\n  // cleanup on destroy\n  eventBus.on([ 'canvas.destroy', 'diagram.destroy' ], this.close, this);\n}\n\n\nSearchPad.$inject = [\n  'canvas',\n  'eventBus',\n  'overlays',\n  'selection'\n];\n\n\n/**\n * Binds and keeps track of all event listereners\n */\nSearchPad.prototype._bindEvents = function() {\n  var self = this;\n\n  function listen(el, selector, type, fn) {\n    self._eventMaps.push({\n      el: el,\n      type: type,\n      listener: domDelegate.bind(el, selector, type, fn)\n    });\n  }\n\n  // close search on clicking anywhere outside\n  listen(document, 'html', 'click', function(e) {\n    self.close();\n  }, true);\n\n  // stop event from propagating and closing search\n  // focus on input\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'click', function(e) {\n    e.stopPropagation();\n    e.delegateTarget.focus();\n  });\n\n  // preselect result on hover\n  listen(this._container, SearchPad.RESULT_SELECTOR, 'mouseover', function(e) {\n    e.stopPropagation();\n    self._scrollToNode(e.delegateTarget);\n    self._preselect(e.delegateTarget);\n  });\n\n  // selects desired result on mouse click\n  listen(this._container, SearchPad.RESULT_SELECTOR, 'click', function(e) {\n    e.stopPropagation();\n    self._select(e.delegateTarget);\n  });\n\n  // prevent cursor in input from going left and right when using up/down to\n  // navigate results\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'keydown', function(e) {\n    // up\n    if (e.keyCode === 38) {\n      e.preventDefault();\n    }\n\n    // down\n    if (e.keyCode === 40) {\n      e.preventDefault();\n    }\n  });\n\n  // handle keyboard input\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'keyup', function(e) {\n    // escape\n    if (e.keyCode === 27) {\n      return self.close();\n    }\n\n    // enter\n    if (e.keyCode === 13) {\n      var selected = self._getCurrentResult();\n\n      return selected ? self._select(selected) : self.close();\n    }\n\n    // up\n    if (e.keyCode === 38) {\n      return self._scrollToDirection(true);\n    }\n\n    // down\n    if (e.keyCode === 40) {\n      return self._scrollToDirection();\n    }\n\n    // left && right\n    // do not search while navigating text input\n    if (e.keyCode === 37 || e.keyCode === 39) {\n      return;\n    }\n\n    // anything else\n    self._search(e.delegateTarget.value);\n  });\n};\n\n\n/**\n * Unbinds all previously established listeners\n */\nSearchPad.prototype._unbindEvents = function() {\n  this._eventMaps.forEach(function(m) {\n    domDelegate.unbind(m.el, m.type, m.listener);\n  });\n};\n\n\n/**\n * Performs a search for the given pattern.\n *\n * @param  {String} pattern\n */\nSearchPad.prototype._search = function(pattern) {\n  var self = this;\n\n  this._clearResults();\n\n  // do not search on empty query\n  if (!pattern || pattern === '') {\n    return;\n  }\n\n  var searchResults = this._searchProvider.find(pattern);\n\n  if (!searchResults.length) {\n    return;\n  }\n\n  // append new results\n  searchResults.forEach(function(result) {\n    var id = result.element.id;\n    var node = self._createResultNode(result, id);\n    self._results[id] = {\n      element: result.element,\n      node: node\n    };\n  });\n\n  // preselect first result\n  var node = domQuery(SearchPad.RESULT_SELECTOR, this._resultsContainer);\n  this._scrollToNode(node);\n  this._preselect(node);\n};\n\n\n/**\n * Navigate to the previous/next result. Defaults to next result.\n * @param  {Boolean} previous\n */\nSearchPad.prototype._scrollToDirection = function(previous) {\n  var selected = this._getCurrentResult();\n  if (!selected) {\n    return;\n  }\n\n  var node = previous ? selected.previousElementSibling : selected.nextElementSibling;\n  if (node) {\n    this._scrollToNode(node);\n    this._preselect(node);\n  }\n};\n\n\n/**\n * Scroll to the node if it is not visible.\n *\n * @param  {Element} node\n */\nSearchPad.prototype._scrollToNode = function(node) {\n  if (!node || node === this._getCurrentResult()) {\n    return;\n  }\n\n  var nodeOffset = node.offsetTop;\n  var containerScroll = this._resultsContainer.scrollTop;\n\n  var bottomScroll = nodeOffset - this._resultsContainer.clientHeight + node.clientHeight;\n\n  if (nodeOffset < containerScroll) {\n    this._resultsContainer.scrollTop = nodeOffset;\n  } else if (containerScroll < bottomScroll) {\n    this._resultsContainer.scrollTop = bottomScroll;\n  }\n};\n\n\n/**\n * Clears all results data.\n */\nSearchPad.prototype._clearResults = function() {\n  domClear(this._resultsContainer);\n\n  this._results = [];\n\n  this._resetOverlay();\n\n  this._eventBus.fire('searchPad.cleared');\n};\n\n\n/**\n * Get currently selected result.\n *\n * @return {Element}\n */\nSearchPad.prototype._getCurrentResult = function() {\n  return domQuery(SearchPad.RESULT_SELECTED_SELECTOR, this._resultsContainer);\n};\n\n\n/**\n * Create result DOM element within results container\n * that corresponds to a search result.\n *\n * 'result' : one of the elements returned by SearchProvider\n * 'id' : id attribute value to assign to the new DOM node\n * return : created DOM element\n *\n * @param  {SearchResult} result\n * @param  {String} id\n * @return {Element}\n */\nSearchPad.prototype._createResultNode = function(result, id) {\n  var node = domify(SearchPad.RESULT_HTML);\n\n  // create only if available\n  if (result.primaryTokens.length > 0) {\n    createInnerTextNode(node, result.primaryTokens, SearchPad.RESULT_PRIMARY_HTML);\n  }\n\n  // secondary tokens (represent element ID) are allways available\n  createInnerTextNode(node, result.secondaryTokens, SearchPad.RESULT_SECONDARY_HTML);\n\n  domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE, id);\n\n  this._resultsContainer.appendChild(node);\n\n  return node;\n};\n\n\n/**\n * Register search element provider.\n *\n * SearchProvider.find - provides search function over own elements\n *  (pattern) => [{ text: <String>, element: <Element>}, ...]\n *\n * @param  {SearchProvider} provider\n */\nSearchPad.prototype.registerProvider = function(provider) {\n  this._searchProvider = provider;\n};\n\n\n/**\n * Open search pad.\n */\nSearchPad.prototype.open = function() {\n  if (!this._searchProvider) {\n    throw new Error('no search provider registered');\n  }\n\n  if (this.isOpen()) {\n    return;\n  }\n\n  this._bindEvents();\n\n  this._open = true;\n\n  domClasses(this._container).add('open');\n\n  this._searchInput.focus();\n\n  this._eventBus.fire('searchPad.opened');\n};\n\n\n/**\n * Close search pad.\n */\nSearchPad.prototype.close = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._unbindEvents();\n\n  this._open = false;\n\n  domClasses(this._container).remove('open');\n\n  this._clearResults();\n\n  this._searchInput.value = '';\n  this._searchInput.blur();\n\n  this._resetOverlay();\n\n  this._eventBus.fire('searchPad.closed');\n};\n\n\n/**\n * Toggles search pad on/off.\n */\nSearchPad.prototype.toggle = function() {\n  this.isOpen() ? this.close() : this.open();\n};\n\n\n/**\n * Report state of search pad.\n */\nSearchPad.prototype.isOpen = function() {\n  return this._open;\n};\n\n\n/**\n * Preselect result entry.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._preselect = function(node) {\n  var selectedNode = this._getCurrentResult();\n\n  // already selected\n  if (node === selectedNode) {\n    return;\n  }\n\n  // removing preselection from current node\n  if (selectedNode) {\n    domClasses(selectedNode).remove(SearchPad.RESULT_SELECTED_CLASS);\n  }\n\n  var id = domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE);\n  var element = this._results[id].element;\n\n  domClasses(node).add(SearchPad.RESULT_SELECTED_CLASS);\n\n  this._resetOverlay(element);\n\n  this._centerViewbox(element);\n\n  this._selection.select(element);\n\n  this._eventBus.fire('searchPad.preselected', element);\n};\n\n\n/**\n * Select result node.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._select = function(node) {\n  var id = domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE);\n  var element = this._results[id].element;\n\n  this.close();\n\n  this._resetOverlay();\n\n  this._centerViewbox(element);\n\n  this._selection.select(element);\n\n  this._eventBus.fire('searchPad.selected', element);\n};\n\n\n/**\n * Center viewbox on the element middle point.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._centerViewbox = function(element) {\n  var viewbox = this._canvas.viewbox();\n\n  var box = getBoundingBox(element);\n\n  var newViewbox = {\n    x: (box.x + box.width/2) - viewbox.outer.width/2,\n    y: (box.y + box.height/2) - viewbox.outer.height/2,\n    width: viewbox.outer.width,\n    height: viewbox.outer.height\n  };\n\n  this._canvas.viewbox(newViewbox);\n\n  this._canvas.zoom(viewbox.scale);\n};\n\n\n/**\n * Reset overlay removes and, optionally, set\n * overlay to a new element.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._resetOverlay = function(element) {\n  if (this._overlayId) {\n    this._overlays.remove(this._overlayId);\n  }\n\n  if (element) {\n    var box = getBoundingBox(element);\n    var overlay = constructOverlay(box);\n    this._overlayId = this._overlays.add(element, overlay);\n  }\n};\n\n\n/**\n * Construct overlay object for the given bounding box.\n *\n * @param  {BoundingBox} box\n * @return {Object}\n */\nfunction constructOverlay(box) {\n\n  var offset = 6;\n  var w = box.width + offset * 2;\n  var h = box.height + offset * 2;\n\n  var styles = [\n    'width: '+ w +'px',\n    'height: '+ h + 'px'\n  ].join('; ');\n\n  return {\n    position: {\n      bottom: h - offset,\n      right: w - offset\n    },\n    show: true,\n    html: '<div style=\"' + styles + '\" class=\"' + SearchPad.OVERLAY_CLASS + '\"></div>'\n  };\n}\n\n\n/**\n * Creates and appends child node from result tokens and HTML template.\n *\n * @param  {Element} node\n * @param  {Array<Object>} tokens\n * @param  {String} template\n */\nfunction createInnerTextNode(parentNode, tokens, template) {\n  var text = createHtmlText(tokens);\n  var childNode = domify(template);\n  childNode.innerHTML = text;\n  parentNode.appendChild(childNode);\n}\n\n/**\n * Create internal HTML markup from result tokens.\n * Caters for highlighting pattern matched tokens.\n *\n * @param  {Array<Object>} tokens\n * @return {String}\n */\nfunction createHtmlText(tokens) {\n  var htmlText = '';\n\n  tokens.forEach(function(t) {\n    if (t.matched) {\n      htmlText += '<strong class=\"' + SearchPad.RESULT_HIGHLIGHT_CLASS + '\">' + escapeHTML(t.matched) + '</strong>';\n    } else {\n      htmlText += escapeHTML(t.normal);\n    }\n  });\n\n  return htmlText !== '' ? htmlText : null;\n}\n\n\n/**\n * CONSTANTS\n */\nSearchPad.CONTAINER_SELECTOR = '.djs-search-container';\nSearchPad.INPUT_SELECTOR = '.djs-search-input input';\nSearchPad.RESULTS_CONTAINER_SELECTOR = '.djs-search-results';\nSearchPad.RESULT_SELECTOR = '.djs-search-result';\nSearchPad.RESULT_SELECTED_CLASS = 'djs-search-result-selected';\nSearchPad.RESULT_SELECTED_SELECTOR = '.' + SearchPad.RESULT_SELECTED_CLASS;\nSearchPad.RESULT_ID_ATTRIBUTE = 'data-result-id';\nSearchPad.RESULT_HIGHLIGHT_CLASS = 'djs-search-highlight';\nSearchPad.OVERLAY_CLASS = 'djs-search-overlay';\n\nSearchPad.BOX_HTML =\n  '<div class=\"djs-search-container djs-draggable djs-scrollable\">' +\n    '<div class=\"djs-search-input\">' +\n      '<input type=\"text\"/>' +\n    '</div>' +\n    '<div class=\"djs-search-results\"></div>' +\n  '</div>';\n\nSearchPad.RESULT_HTML =\n  '<div class=\"djs-search-result\"></div>';\n\nSearchPad.RESULT_PRIMARY_HTML =\n  '<div class=\"djs-search-result-primary\"></div>';\n\nSearchPad.RESULT_SECONDARY_HTML =\n  '<p class=\"djs-search-result-secondary\"></p>';\n","import OverlaysModule from '../overlays';\nimport SelectionModule from '../selection';\n\nimport SearchPad from './SearchPad';\n\nexport default {\n  __depends__: [\n    OverlaysModule,\n    SelectionModule\n  ],\n  searchPad: [ 'type', SearchPad ]\n};\n","import {\n  forEach,\n  assign,\n  find,\n  matchPattern,\n  isDefined\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  domify as domify,\n  classes as domClasses,\n  attr as domAttr,\n  remove as domRemove\n} from 'min-dom';\n\nvar DATA_REF = 'data-id';\n\n\n/**\n * A popup menu that can be used to display a list of actions anywhere in the canvas.\n *\n * @param {Object} config\n * @param {Boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {Number} [config.scale.min]\n * @param {Number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n *\n * @class\n * @constructor\n */\nexport default function PopupMenu(config, eventBus, canvas) {\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n\n  this._config = {\n    scale: scale\n  };\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._providers = {};\n  this._current = {};\n}\n\nPopupMenu.$inject = [\n  'config.popupMenu',\n  'eventBus',\n  'canvas'\n];\n\n/**\n * Registers a popup menu provider\n *\n * @param  {String} id\n * @param  {Object} provider\n *\n * @example\n *\n * popupMenu.registerProvider('myMenuID', {\n *   getEntries: function(element) {\n *     return [\n *       {\n *         id: 'entry-1',\n *         label: 'My Entry',\n *         action: 'alert(\"I have been clicked!\")'\n *       }\n *     ];\n *   }\n * });\n */\nPopupMenu.prototype.registerProvider = function(id, provider) {\n  this._providers[id] = provider;\n};\n\n\n/**\n * Determine if the popup menu has entries.\n *\n * @return {Boolean} true if empty\n */\nPopupMenu.prototype.isEmpty = function(element, providerId) {\n  if (!element) {\n    throw new Error('element parameter is missing');\n  }\n\n  if (!providerId) {\n    throw new Error('providerId parameter is missing');\n  }\n\n  var provider = this._providers[providerId];\n\n  var entries = provider.getEntries(element),\n      headerEntries = provider.getHeaderEntries && provider.getHeaderEntries(element);\n\n  var hasEntries = entries.length > 0,\n      hasHeaderEntries = headerEntries && headerEntries.length > 0;\n\n  return !hasEntries && !hasHeaderEntries;\n};\n\n\n/**\n * Create entries and open popup menu at given position\n *\n * @param  {Object} element\n * @param  {String} id provider id\n * @param  {Object} position\n *\n * @return {Object} popup menu instance\n */\nPopupMenu.prototype.open = function(element, id, position) {\n\n  var provider = this._providers[id];\n\n  if (!element) {\n    throw new Error('Element is missing');\n  }\n\n  if (!provider) {\n    throw new Error('Provider is not registered: ' + id);\n  }\n\n  if (!position) {\n    throw new Error('the position argument is missing');\n  }\n\n  if (this.isOpen()) {\n    this.close();\n  }\n\n  this._emit('open');\n\n  var current = this._current = {\n    provider: provider,\n    className: id,\n    element: element,\n    position: position\n  };\n\n  if (provider.getHeaderEntries) {\n    current.headerEntries = provider.getHeaderEntries(element);\n  }\n\n  current.entries = provider.getEntries(element);\n\n  current.container = this._createContainer();\n\n  var headerEntries = current.headerEntries || [],\n      entries = current.entries || [];\n\n  if (headerEntries.length) {\n    current.container.appendChild(\n      this._createEntries(current.headerEntries, 'djs-popup-header')\n    );\n  }\n\n  if (entries.length) {\n    current.container.appendChild(\n      this._createEntries(current.entries, 'djs-popup-body')\n    );\n  }\n\n  var canvas = this._canvas,\n      parent = canvas.getContainer();\n\n  this._attachContainer(current.container, parent, position.cursor);\n};\n\n\n/**\n * Removes the popup menu and unbinds the event handlers.\n */\nPopupMenu.prototype.close = function() {\n\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._emit('close');\n\n  this._unbindHandlers();\n  domRemove(this._current.container);\n  this._current.container = null;\n};\n\n\n/**\n * Determine if an open popup menu exist.\n *\n * @return {Boolean} true if open\n */\nPopupMenu.prototype.isOpen = function() {\n  return !!this._current.container;\n};\n\n\n/**\n * Trigger an action associated with an entry.\n *\n * @param {Object} event\n *\n * @return the result of the action callback, if any\n */\nPopupMenu.prototype.trigger = function(event) {\n\n  // silence other actions\n  event.preventDefault();\n\n  var element = event.delegateTarget || event.target,\n      entryId = domAttr(element, DATA_REF);\n\n  var entry = this._getEntry(entryId);\n\n  if (entry.action) {\n    return entry.action.call(null, event, entry);\n  }\n};\n\n/**\n * Gets an entry instance (either entry or headerEntry) by id.\n *\n * @param  {String} entryId\n *\n * @return {Object} entry instance\n */\nPopupMenu.prototype._getEntry = function(entryId) {\n\n  var search = matchPattern({ id: entryId });\n\n  var entry = find(this._current.entries, search) || find(this._current.headerEntries, search);\n\n  if (!entry) {\n    throw new Error('entry not found');\n  }\n\n  return entry;\n};\n\nPopupMenu.prototype._emit = function(eventName) {\n  this._eventBus.fire('popupMenu.' + eventName);\n};\n\n/**\n * Creates the popup menu container.\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createContainer = function() {\n  var container = domify('<div class=\"djs-popup\">'),\n      position = this._current.position,\n      className = this._current.className;\n\n  assign(container.style, {\n    position: 'absolute',\n    left: position.x + 'px',\n    top: position.y + 'px',\n    visibility: 'hidden'\n  });\n\n  domClasses(container).add(className);\n\n  return container;\n};\n\n\n/**\n * Attaches the container to the DOM and binds the event handlers.\n *\n * @param {Object} container\n * @param {Object} parent\n */\nPopupMenu.prototype._attachContainer = function(container, parent, cursor) {\n  var self = this;\n\n  // Event handler\n  domDelegate.bind(container, '.entry' ,'click', function(event) {\n    self.trigger(event);\n  });\n\n  this._updateScale(container);\n\n  // Attach to DOM\n  parent.appendChild(container);\n\n  if (cursor) {\n    this._assureIsInbounds(container, cursor);\n  }\n\n  // Add Handler\n  this._bindHandlers();\n};\n\n\n/**\n * Updates popup style.transform with respect to the config and zoom level.\n *\n * @method _updateScale\n *\n * @param {Object} container\n */\nPopupMenu.prototype._updateScale = function(container) {\n  var zoom = this._canvas.zoom();\n\n  var scaleConfig = this._config.scale,\n      minScale,\n      maxScale,\n      scale = zoom;\n\n  if (scaleConfig !== true) {\n\n    if (scaleConfig === false) {\n      minScale = 1;\n      maxScale = 1;\n    } else {\n      minScale = scaleConfig.min;\n      maxScale = scaleConfig.max;\n    }\n\n    if (isDefined(minScale) && zoom < minScale) {\n      scale = minScale;\n    }\n\n    if (isDefined(maxScale) && zoom > maxScale) {\n      scale = maxScale;\n    }\n\n  }\n\n  setTransform(container, 'scale(' + scale + ')');\n};\n\n\n/**\n * Make sure that the menu is always fully shown\n *\n * @method function\n *\n * @param  {Object} container\n * @param  {Position} cursor {x, y}\n */\nPopupMenu.prototype._assureIsInbounds = function(container, cursor) {\n  var canvas = this._canvas,\n      clientRect = canvas._container.getBoundingClientRect();\n\n  var containerX = container.offsetLeft,\n      containerY = container.offsetTop,\n      containerWidth = container.scrollWidth,\n      containerHeight = container.scrollHeight,\n      overAxis = {},\n      left, top;\n\n  var cursorPosition = {\n    x: cursor.x - clientRect.left,\n    y: cursor.y - clientRect.top\n  };\n\n  if (containerX + containerWidth > clientRect.width) {\n    overAxis.x = true;\n  }\n\n  if (containerY + containerHeight > clientRect.height) {\n    overAxis.y = true;\n  }\n\n  if (overAxis.x && overAxis.y) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  } else if (overAxis.x) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y + 'px';\n  } else if (overAxis.y && cursorPosition.y < containerHeight) {\n    left = cursorPosition.x + 'px';\n    top = 10 + 'px';\n  } else if (overAxis.y) {\n    left = cursorPosition.x + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  }\n\n  assign(container.style, { left: left, top: top }, { visibility: 'visible', 'z-index': 1000 });\n};\n\n\n/**\n * Creates a list of entries and returns them as a DOM container.\n *\n * @param {Array<Object>} entries an array of entry objects\n * @param {String} className the class name of the entry container\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createEntries = function(entries, className) {\n\n  var entriesContainer = domify('<div>'),\n      self = this;\n\n  domClasses(entriesContainer).add(className);\n\n  forEach(entries, function(entry) {\n    var entryContainer = self._createEntry(entry, entriesContainer);\n    entriesContainer.appendChild(entryContainer);\n  });\n\n  return entriesContainer;\n};\n\n\n/**\n * Creates a single entry and returns it as a DOM container.\n *\n * @param  {Object} entry\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createEntry = function(entry) {\n\n  if (!entry.id) {\n    throw new Error ('every entry must have the id property set');\n  }\n\n  var entryContainer = domify('<div>'),\n      entryClasses = domClasses(entryContainer);\n\n  entryClasses.add('entry');\n\n  if (entry.className) {\n    entry.className.split(' ').forEach(function(className) {\n      entryClasses.add(className);\n    });\n  }\n\n  domAttr(entryContainer, DATA_REF, entry.id);\n\n  if (entry.label) {\n    var label = domify('<span>');\n    label.textContent = entry.label;\n    entryContainer.appendChild(label);\n  }\n\n  if (entry.imageUrl) {\n    entryContainer.appendChild(domify('<img src=\"' + entry.imageUrl + '\" />'));\n  }\n\n  if (entry.active === true) {\n    entryClasses.add('active');\n  }\n\n  if (entry.disabled === true) {\n    entryClasses.add('disabled');\n  }\n\n  if (entry.title) {\n    entryContainer.title = entry.title;\n  }\n\n  return entryContainer;\n};\n\n\n/**\n * Binds the `close` method to 'contextPad.close' & 'canvas.viewbox.changed'.\n */\nPopupMenu.prototype._bindHandlers = function() {\n\n  var eventBus = this._eventBus,\n      self = this;\n\n  function close() {\n    self.close();\n  }\n\n  eventBus.once('contextPad.close', close);\n  eventBus.once('canvas.viewbox.changing', close);\n  eventBus.once('commandStack.changed', close);\n};\n\n\n/**\n * Unbinds the `close` method to 'contextPad.close' & 'canvas.viewbox.changing'.\n */\nPopupMenu.prototype._unbindHandlers = function() {\n\n  var eventBus = this._eventBus,\n      self = this;\n\n  function close() {\n    self.close();\n  }\n\n  eventBus.off('contextPad.close', close);\n  eventBus.off('canvas.viewbox.changed', close);\n  eventBus.off('commandStack.changed', close);\n};\n\n\n\n// helpers /////////////////////////////\n\nfunction setTransform(element, transform) {\n  element.style['transform-origin'] = 'top left';\n\n  [ '', '-ms-', '-webkit-' ].forEach(function(prefix) {\n    element.style[prefix + 'transform'] = transform;\n  });\n}","import PopupMenu from './PopupMenu';\n\nexport default {\n  __init__: [ 'popupMenu' ],\n  popupMenu: [ 'type', PopupMenu ]\n};\n","var round = Math.round;\n\n/**\n * Service that allow replacing of elements.\n */\nexport default function Replace(modeling) {\n\n  this._modeling = modeling;\n}\n\nReplace.$inject = [ 'modeling' ];\n\n/**\n * @param {Element} oldElement - Element to be replaced\n * @param {Object}  newElementData - Containing information about the new Element, for example height, width, type.\n * @param {Object}  options - Custom options that will be attached to the context. It can be used to inject data\n *                            that is needed in the command chain. For example it could be used in\n *                            eventbus.on('commandStack.shape.replace.postExecute') to change shape attributes after\n *                            shape creation.\n */\nReplace.prototype.replaceElement = function(oldElement, newElementData, options) {\n\n  var modeling = this._modeling;\n\n  var newElement = null;\n\n  if (oldElement.waypoints) {\n    // TODO\n    // modeling.replaceConnection\n  } else {\n    // set center of element for modeling API\n    // if no new width / height is given use old elements size\n    newElementData.x = round(oldElement.x + (newElementData.width || oldElement.width) / 2);\n    newElementData.y = round(oldElement.y + (newElementData.height || oldElement.height) / 2);\n\n    newElement = modeling.replaceShape(oldElement, newElementData, options);\n  }\n\n  return newElement;\n};\n","import Replace from './Replace';\n\nexport default {\n  __init__: [ 'replace' ],\n  replace: [ 'type', Replace ]\n};"],"sourceRoot":""}