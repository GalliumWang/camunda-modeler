(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{883:function(t,e,n){var o=n(884);"string"==typeof o&&(o=[[t.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(12)(o,i);o.locals&&(t.exports=o.locals)},884:function(t,e,n){(e=t.exports=n(11)(!1)).push([t.i,".n4ouuFKRR0Cst6UWuYgf {\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n}\n.n4ouuFKRR0Cst6UWuYgf .form {\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n}\n.n4ouuFKRR0Cst6UWuYgf .form .fjs-container {\n  --font-family: inherit;\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n}\n.n4ouuFKRR0Cst6UWuYgf .form .fjs-editor-container .fjs-form,\n.n4ouuFKRR0Cst6UWuYgf .form .fjs-editor-container .fjs-palette,\n.n4ouuFKRR0Cst6UWuYgf .form .fjs-editor-container .fjs-properties-panel {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow-y: auto;\n}\n.n4ouuFKRR0Cst6UWuYgf .form .fjs-powered-by {\n  display: none;\n}\n",""]),e.locals={FormEditor:"n4ouuFKRR0Cst6UWuYgf"}},902:function(t,e,n){var o=n(903);"string"==typeof o&&(o=[[t.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(12)(o,i);o.locals&&(t.exports=o.locals)},903:function(t,e,n){(e=t.exports=n(11)(!1)).push([t.i,"._3CZho0zRJdxdg8qDAb9d8d {\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n  overflow: auto;\n}\n._3CZho0zRJdxdg8qDAb9d8d .content {\n  flex: 1;\n  position: relative;\n}\n._3CZho0zRJdxdg8qDAb9d8d .CodeMirror {\n  height: 100%;\n  font-size: 13px;\n  font-family: var(--font-family-monospace);\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n",""]),e.locals={JSONEditor:"_3CZho0zRJdxdg8qDAb9d8d"}},939:function(t,e,n){"use strict";n.r(e);var o=n(0),i=n.n(o),a=n(3),r=n(87),s=n(81),c=n(33),d=n(883),h=n.n(d),l=n(288);function m(t){const{inputActive:e}=t;return Object(l.e)(e)}function f(t){const{defaultUndoRedo:e}=t;return[e?Object(l.f)(!0):Object(l.j)(t),m(t),Object(l.h)(t)]}var u=n(307),p=(n(885),n(887),n(889),n(553)),g=n(19),C=n(82),x=n(360),b=n(14),y=n(361),S=n(333),v=n(362);function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const j={executionPlatform:b.a.PLATFORM};class O extends s.a{constructor(t){super(t),k(this,"handleChanged",()=>{const{onChanged:t}=this.props,{form:e}=this.getCached(),n=e.get("commandStack"),o=Object(u.a)(),i={defaultUndoRedo:o,dirty:this.isDirty(),inputActive:o,redo:n.canRedo(),removeSelected:o,save:!0,selectAll:!0,undo:n.canUndo()};Object(a.isFunction)(t)&&t({...i,editMenu:f(i)}),this.setState(i);try{const t=this.engineProfile.get();this.engineProfile.setCached(t)}catch(t){}}),k(this,"handleLinting",()=>{const t=this.engineProfile.getCached(),{form:e}=this.getCached();if(!t||!t.executionPlatformVersion)return;const n=e.getSchema(),{onAction:o}=this.props;o("lint-tab",{contents:n})}),this.ref=Object(o.createRef)(),this.state={importing:!1},this.engineProfile=new x.a({get:()=>{const{form:t}=this.getCached(),e=t.getSchema();return Object(C.d)(e,j)},set:t=>{const{form:e}=this.getCached(),n=e._state.schema;e.get("modeling").editFormField(n,t)},getCached:()=>this.getCached(),setCached:t=>this.setCached(t)}),this.handleLintingDebounced=Object(r.a)(this.handleLinting.bind(this))}componentDidMount(){this._isMounted=!0;let{form:t}=this.getCached();this.listen("on"),this.ref.current&&t.attachTo(this.ref.current),this.checkImport()}componentWillUnmount(){this._isMounted=!1;const{form:t}=this.getCached();t.detach(),this.listen("off")}componentDidUpdate(t){this.checkImport(t),function(t,e){return t.cachedState!==e.cachedState}(t,this.props)&&this.handleChanged()}checkImport(t){if(!this.isImportNeeded(t))return;const{xml:e}=this.props;this.importSchema(e)}isImportNeeded(t={}){const{importing:e}=this.state;if(e)return!1;const{xml:n}=this.props,{xml:o}=t;if(n===o)return!1;const{lastSchema:i}=this.getCached();return n!==i}async importSchema(t){this.setState({importing:!0});const{form:e}=this.getCached();let n=null,o=null;try{const i=JSON.parse(t);({error:n,warnings:o}=await e.importSchema(i))}catch(t){n=t,t.warnings&&(o=t.warnings)}this._isMounted&&this.handleImport(n,o)}handleImport(t,e){const{form:n}=this.getCached(),o=n.get("commandStack")._stackIdx,{onImport:i,xml:a}=this.props;let r=null;try{r=this.engineProfile.get(!0)}catch(e){t=e}t?this.setCached({engineProfile:null,lastSchema:null}):(this.setCached({engineProfile:r,lastSchema:a,stackIdx:o}),this.handleLinting()),this.setState({importing:!1}),i(t,e)}listen(t){const{form:e}=this.getCached();["attach","commandStack.changed","import.done","propertiesPanel.focusin","propertiesPanel.focusout","selection.changed"].forEach(n=>e[t](n,this.handleChanged)),"on"===t?e.on("commandStack.changed",500,this.handleLintingDebounced):"off"===t&&e.off("commandStack.changed",this.handleLintingDebounced)}isDirty(){const{form:t,stackIdx:e}=this.getCached();return t.get("commandStack")._stackIdx!==e}getXML(){const{form:t,lastSchema:e}=this.getCached(),n=t.get("commandStack")._stackIdx;if(!this.isDirty())return e||this.props.xml;const o=JSON.stringify(t.saveSchema(),null,2);return this.setCached({lastSchema:o,stackIdx:n}),o}triggerAction(t,e){const{form:n}=this.getCached(),o=n.get("editorActions");if("selectElement"===t&&o.trigger("selectFormField",e),o.isRegistered(t))return o.trigger(t,e)}render(){const t=this.engineProfile.getCached(),{layout:e,linting:n=[],onAction:a,onLayoutChanged:r}=this.props,{importing:s}=this.state;return i.a.createElement("div",{className:h.a.FormEditor},i.a.createElement(c.a,{hidden:!s}),i.a.createElement("div",{className:"form",onFocus:this.handleChanged,ref:this.ref}),t&&i.a.createElement(C.a,{engineProfile:t,onChange:t=>this.engineProfile.set(t)}),t&&i.a.createElement(o.Fragment,null,i.a.createElement(S.a,{layout:e},i.a.createElement(v.a,{layout:e,linting:n,onAction:a,onLayoutChanged:r})),i.a.createElement(y.a,{layout:e,linting:n,onLayoutChanged:r})))}static createCachedState(t){const{onAction:e}=t,{name:n,version:o}=g.a,i=new p.a({exporter:{name:n,version:o}}),a=i.get("commandStack")._stackIdx;return e("emit-event",{type:"form.modeler.created",payload:i}),{__destroy:()=>{i.destroy()},engineProfile:null,form:i,lastSchema:null,stackIdx:a}}}var I=Object(s.b)(Object(s.c)(O));var R=n(290),F=n.n(R);n(901),n(342),n(343),n(334),n(335),n(344),n(345);var P=n(902),w=n.n(P);class N extends s.a{constructor(t){var e,n,o;super(t),o=()=>{const{onChanged:t}=this.props,{editor:e}=this.getCached(),n=e.doc.historySize(),o=(i={canRedo:!!n.redo,canUndo:!!n.undo},[Object(l.j)(i),[{label:"Cut",accelerator:"CmdOrCtrl+X",role:"cut"},{label:"Copy",accelerator:"CmdOrCtrl+C",role:"copy"},{label:"Paste",accelerator:"CmdOrCtrl+V",role:"paste"}],[{label:"Find",accelerator:"CommandOrControl+F",action:"find"},{label:"Find Next",accelerator:"Shift+CommandOrControl+N",action:"findNext"},{label:"Find Previous",accelerator:"Shift+CommandOrControl+P",action:"findPrev"},{label:"Replace",accelerator:"Shift+CommandOrControl+F",action:"replace"}]]);var i;const a={canExport:!1,dirty:this.isDirty(),redo:!!n.redo,undo:!!n.undo,editable:!0,searchable:!0},r=[];"function"==typeof t&&t({...a,editMenu:o,windowMenu:r}),this.setState({...a})},(n="handleChanged")in(e=this)?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,this.state={},this.ref=i.a.createRef()}componentDidMount(){const{editor:t}=this.getCached();t.attachTo(this.ref.current),t.on("change",this.handleChanged),this.handleChanged(),this.checkImport()}componentWillUnmount(){const{editor:t}=this.getCached();t.detach(),t.off("change",this.handleChanged)}componentDidUpdate(t){D(t.xml,this.props.xml)&&this.checkImport(),function(t,e){return t.cachedState!==e.cachedState}(t,this.props)&&this.handleChanged()}triggerAction(t){const{editor:e}=this.getCached();"undo"===t&&e.doc.undo(),"redo"===t&&e.doc.redo(),"find"===t&&e.execCommand("findPersistent"),"findNext"===t&&e.execCommand("findNext"),"findPrev"===t&&e.execCommand("findPrev"),"replace"===t&&e.execCommand("replace")}checkImport(){const{xml:t}=this.props,{editor:e,lastXML:n}=this.getCached();if(D(n,t)){e.importXML(t);const n=e._stackIdx;this.setCached({lastXML:t,stackIdx:n})}e.refresh()}isDirty(){const{editor:t,stackIdx:e}=this.getCached();return t._stackIdx!==e}getXML(){const{editor:t}=this.getCached(),e=t._stackIdx,n=t.getValue();return this.setCached({lastXML:n,stackIdx:e}),n}render(){return i.a.createElement("div",{className:w.a.JSONEditor},i.a.createElement("div",{className:"content",ref:this.ref}))}static createCachedState(){const t=function(t){var e=this,n=F()((function(t){e=t}),{autoCloseTags:!0,dragDrop:!0,allowDropFileTypes:["text/plain","application/json","application/camunda-form"],lineWrapping:!0,lineNumbers:!0,mode:{name:"application/json",json:!0},tabSize:2});return n.attachTo=function(t){t.appendChild(e),this.refresh()},n.detach=function(){e.parentNode&&e.parentNode.removeChild(e)},n.importXML=function(t){this.setValue(t),this.doc.clearHistory()},n.destroy=function(){},Object.defineProperty(n,"_stackIdx",{get(){return this.doc.historySize().undo}}),n}(),e=t._stackIdx;return{__destroy:()=>{t.destroy()},editor:t,lastXML:null,stackIdx:e}}}var _=Object(s.b)(Object(s.c)(N));function D(t,e){return L(t)!==L(e)}function L(t){return Object(a.isString)(t)?t.trim():t}var M=n(311);var E=Object(M.a)("FormTab",[{type:"form",editor:I,defaultName:"Form"},{type:"json",editor:_,isFallback:!0,defaultName:"JSON"}]);n.d(e,"default",(function(){return E}))}}]);
//# sourceMappingURL=6.6.js.map